!function e(t,r,n){function o(i,a){if(!r[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(s)return s(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var f=r[i]={exports:{}};t[i][0].call(f.exports,function(e){var r=t[i][1][e];return o(r?r:e)},f,f.exports,e,t,r,n)}return r[i].exports}for(var s="function"==typeof require&&require,i=0;i<n.length;i++)o(n[i]);return o}({1:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=(0,m.groupBy)(e,"artist");return t}function s(e,t){var r=e.filter(function(e){return e.artist.toString().charAt(0)===t});return r}function i(e,t){v=new h["default"](e,y);var r=v.search(t);return r}function a(e){return d["default"].publish("searchStart",{searchTerm:e}),f["default"].get("search_data.json").then(function(t){return i(t.data,e)}).then(g).then(o)["catch"](function(e){console.error(e)})}function u(e){return d["default"].publish("searchStart",{letter:e}),f["default"].get("search_data.json").then(function(t){return s(t.data,e)}).then(g).then(o)["catch"](function(e){console.error(e)})}Object.defineProperty(r,"__esModule",{value:!0}),r.searchByName=a,r.findArtistsByLetter=u;var c=e("axios"),f=n(c),l=e("fuse.js"),h=n(l),p=e("./pubsub"),d=n(p),m=e("./helpers/underscore"),v=void 0,y={shouldSort:!0,threshold:.1,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:["artist","title"]},g=function(e){var t=e.sort(function(e,t){var r=e.artist.toLowerCase(),n=t.artist.toLowerCase();return r>n?1:r<n?-1:0});return t}},{"./helpers/underscore":5,"./pubsub":7,axios:10,"fuse.js":35}],2:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function s(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}function i(e){var t=e||window.event;t.preventDefault();var r=this.dataset.letter;h.findArtistsByLetter(r).then(function(e){f["default"].publish("searchComplete",{songList:e,searchTerm:r})})}function a(){var e="qwertyuiopasdfghjklzxcvbnm",t=e.toUpperCase(),r=[].concat(s(t)),n=r.sort(),o=n.map(function(e){return'<li class="o-list-inline__item c-az__item"><a class="c-az__letter" data-letter="'+e+'">'+e+"</a></li>"}).join("");return'<ul class="o-list-inline c-az">'+o+"</ul>"}var u=e("./helpers/events"),c=e("./pubsub"),f=o(c),l=e("./api"),h=n(l),p=document.querySelector(".az-search");p.innerHTML=a(),(0,u.delegateEventListener)(p,"click","a",i)},{"./api":1,"./helpers/events":4,"./pubsub":7}],3:[function(e,t,r){"use strict";function n(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}Object.defineProperty(r,"__esModule",{value:!0}),r.hasClass=n;var o=r.addClass=function(e,t){var r=e;r.classList?r.classList.add(t):r.className+=" "+t},s=r.removeClass=function(e,t){var r=e;r.classList?r.classList.remove(t):r.className=r.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")};r.toggleClass=function(e,t){var r=e;n(r,t)?s(r,t):o(r,t)},r.setStyle=function(e,t){var r=t;Object.assign(e.style,r)},r.findParentByTagName=function(e,t){for(var r=e;null!==r&&r.tagName!==t.toUpperCase();)r=r.parentNode;return r}},{}],4:[function(e,t,r){"use strict";function n(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=void 0;window.CustomEvent?n=new CustomEvent(t,{detail:r}):(n=document.createEvent("CustomEvent"),n.initCustomEvent(t,!0,!0,r)),e.dispatchEvent(n)}function o(e,t,r,n){var o=e;o.addEventListener(t,function(t){for(var s=o.querySelectorAll(r),i=t.target,a=0,u=s.length;a<u;a++)for(var c=i,f=s[a];c&&c!==e;){if(c===f)return n.call(f,t);c=c.parentNode}return!1})}Object.defineProperty(r,"__esModule",{value:!0}),r.trigger=n,r.delegateEventListener=o},{}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=Object.prototype.toString,o=function(e){return"[object Function]"===n.call(e)};r.groupBy=function(e,t){return e.reduce(function(e,r){var n=o(t)?t.apply(void 0,[r]):r[t];return e[n]=e[n]||[],e[n].push(r),e},{})}},{}],6:[function(e,t,r){"use strict";e("./az-search"),e("./search"),e("./results")},{"./az-search":2,"./results":8,"./search":9}],7:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=function(){var e={},t=function(t,r){e[t]=e[t]||[],e[t].push(r)},r=function(t,r){if(e[t])for(var n=0,o=e[t].length;n<o;n++)if(e[t][n]===r){e[t].splice(n,1);break}},n=function(t,r){e[t]&&e[t].forEach(function(e){e(r)})};return{subscribe:t,unsubscribe:r,publish:n}}();r["default"]=n},{}],8:[function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(){c.innerHTML="",(0,i.removeClass)(f,"u-hidden")}function s(e){var t=e.songList,r=e.searchTerm,n="";n='<h2 class="c-search__heading">Search Results: <span c-search__term>'+r+'</span></h2><section class="c-search__list">',Object.keys(t).forEach(function(e){n+='<p class="c-search__artist">'+e+"</p><ul>",t[e].forEach(function(e){n+='<li class="c-search__title">'+e.title+"</li>"}),n+="</ul>"}),n+="</section>",(0,i.addClass)(f,"u-hidden"),c.innerHTML=n}var i=e("./helpers/dom-elements"),a=e("./pubsub"),u=n(a),c=document.querySelector("#js-search_results"),f=document.querySelector(".loader");u["default"].subscribe("searchStart",o),u["default"].subscribe("searchComplete",s)},{"./helpers/dom-elements":3,"./pubsub":7}],9:[function(e,t,r){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function s(){p.value=""}function i(e){var t=e||window.event;t.preventDefault();var r=p.value;""!==r&&l.searchByName(r).then(function(e){c["default"].publish("searchComplete",{songList:e,searchTerm:r})})}function a(e){var t=e;t.letter&&s()}var u=e("./pubsub"),c=o(u),f=e("./api"),l=n(f),h=document.querySelector("#js-songsearch"),p=h.querySelector("#js-songsearch__input");h.addEventListener("submit",i),c["default"].subscribe("searchStart",a)},{"./api":1,"./pubsub":7}],10:[function(e,t,r){t.exports=e("./lib/axios")},{"./lib/axios":12}],11:[function(e,t,r){(function(r){"use strict";var n=e("./../utils"),o=e("./../core/settle"),s=e("./../helpers/buildURL"),i=e("./../helpers/parseHeaders"),a=e("./../helpers/isURLSameOrigin"),u=e("../core/createError"),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||e("./../helpers/btoa");t.exports=function(t){return new Promise(function(f,l){var h=t.data,p=t.headers;n.isFormData(h)&&delete p["Content-Type"];var d=new XMLHttpRequest,m="onreadystatechange",v=!1;if("test"===r.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||a(t.url)||(d=new window.XDomainRequest,m="onload",v=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var y=t.auth.username||"",g=t.auth.password||"";p.Authorization="Basic "+c(y+":"+g)}if(d.open(t.method.toUpperCase(),s(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[m]=function(){if(d&&(4===d.readyState||v)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,r=t.responseType&&"text"!==t.responseType?d.response:d.responseText,n={data:r,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:e,config:t,request:d};o(f,l,n),d=null}},d.onerror=function(){l(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){l(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},n.isStandardBrowserEnv()){var b=e("./../helpers/cookies"),w=(t.withCredentials||a(t.url))&&t.xsrfCookieName?b.read(t.xsrfCookieName):void 0;w&&(p[t.xsrfHeaderName]=w)}if("setRequestHeader"in d&&n.forEach(p,function(e,t){"undefined"==typeof h&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(_){if("json"!==t.responseType)throw _}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(e){d&&(d.abort(),l(e),d=null)}),void 0===h&&(h=null),d.send(h)})}}).call(this,e("_process"))},{"../core/createError":18,"./../core/settle":21,"./../helpers/btoa":25,"./../helpers/buildURL":26,"./../helpers/cookies":28,"./../helpers/isURLSameOrigin":30,"./../helpers/parseHeaders":32,"./../utils":34,_process:37}],12:[function(e,t,r){"use strict";function n(e){var t=new i(e),r=s(i.prototype.request,t);return o.extend(r,i.prototype,t),o.extend(r,t),r}var o=e("./utils"),s=e("./helpers/bind"),i=e("./core/Axios"),a=e("./defaults"),u=n(a);u.Axios=i,u.create=function(e){return n(o.merge(a,e))},u.Cancel=e("./cancel/Cancel"),u.CancelToken=e("./cancel/CancelToken"),u.isCancel=e("./cancel/isCancel"),u.all=function(e){return Promise.all(e)},u.spread=e("./helpers/spread"),t.exports=u,t.exports["default"]=u},{"./cancel/Cancel":13,"./cancel/CancelToken":14,"./cancel/isCancel":15,"./core/Axios":16,"./defaults":23,"./helpers/bind":24,"./helpers/spread":33,"./utils":34}],13:[function(e,t,r){"use strict";function n(e){this.message=e}n.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},n.prototype.__CANCEL__=!0,t.exports=n},{}],14:[function(e,t,r){"use strict";function n(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var r=this;e(function(e){r.reason||(r.reason=new o(e),t(r.reason))})}var o=e("./Cancel");n.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},n.source=function(){var e,t=new n(function(t){e=t});return{token:t,cancel:e}},t.exports=n},{"./Cancel":13}],15:[function(e,t,r){"use strict";t.exports=function(e){return!(!e||!e.__CANCEL__)}},{}],16:[function(e,t,r){"use strict";function n(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var o=e("./../defaults"),s=e("./../utils"),i=e("./InterceptorManager"),a=e("./dispatchRequest"),u=e("./../helpers/isAbsoluteURL"),c=e("./../helpers/combineURLs");n.prototype.request=function(e){"string"==typeof e&&(e=s.merge({url:arguments[0]},arguments[1])),e=s.merge(o,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase(),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url));var t=[a,void 0],r=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)r=r.then(t.shift(),t.shift());return r},s.forEach(["delete","get","head","options"],function(e){n.prototype[e]=function(t,r){return this.request(s.merge(r||{},{method:e,url:t}))}}),s.forEach(["post","put","patch"],function(e){n.prototype[e]=function(t,r,n){return this.request(s.merge(n||{},{method:e,url:t,data:r}))}}),t.exports=n},{"./../defaults":23,"./../helpers/combineURLs":27,"./../helpers/isAbsoluteURL":29,"./../utils":34,"./InterceptorManager":17,"./dispatchRequest":19}],17:[function(e,t,r){"use strict";function n(){this.handlers=[]}var o=e("./../utils");n.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},n.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},n.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},t.exports=n},{"./../utils":34}],18:[function(e,t,r){"use strict";var n=e("./enhanceError");t.exports=function(e,t,r,o,s){var i=new Error(e);return n(i,t,r,o,s)}},{"./enhanceError":20}],19:[function(e,t,r){"use strict";function n(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=e("./../utils"),s=e("./transformData"),i=e("../cancel/isCancel"),a=e("../defaults");t.exports=function(e){n(e),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return n(e),t.data=s(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(n(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},{"../cancel/isCancel":15,"../defaults":23,"./../utils":34,"./transformData":22}],20:[function(e,t,r){"use strict";t.exports=function(e,t,r,n,o){return e.config=t,r&&(e.code=r),e.request=n,e.response=o,e}},{}],21:[function(e,t,r){"use strict";var n=e("./createError");t.exports=function(e,t,r){var o=r.config.validateStatus;r.status&&o&&!o(r.status)?t(n("Request failed with status code "+r.status,r.config,null,r.request,r)):e(r)}},{"./createError":18}],22:[function(e,t,r){"use strict";var n=e("./../utils");t.exports=function(e,t,r){return n.forEach(r,function(r){e=r(e,t)}),e}},{"./../utils":34}],23:[function(e,t,r){(function(r){"use strict";function n(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function o(){var t;return"undefined"!=typeof XMLHttpRequest?t=e("./adapters/xhr"):"undefined"!=typeof r&&(t=e("./adapters/http")),t}var s=e("./utils"),i=e("./helpers/normalizeHeaderName"),a={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:o(),transformRequest:[function(e,t){return i(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(n(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(n(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){u.headers[e]={}}),s.forEach(["post","put","patch"],function(e){u.headers[e]=s.merge(a)}),t.exports=u}).call(this,e("_process"))},{"./adapters/http":11,"./adapters/xhr":11,"./helpers/normalizeHeaderName":31,"./utils":34,_process:37}],24:[function(e,t,r){"use strict";t.exports=function(e,t){return function(){for(var r=new Array(arguments.length),n=0;n<r.length;n++)r[n]=arguments[n];return e.apply(t,r)}}},{}],25:[function(e,t,r){"use strict";function n(){this.message="String contains an invalid character"}function o(e){for(var t,r,o=String(e),i="",a=0,u=s;o.charAt(0|a)||(u="=",a%1);i+=u.charAt(63&t>>8-a%1*8)){if(r=o.charCodeAt(a+=.75),r>255)throw new n;t=t<<8|r}return i}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";n.prototype=new Error,n.prototype.code=5,n.prototype.name="InvalidCharacterError",t.exports=o},{}],26:[function(e,t,r){"use strict";function n(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=e("./../utils");t.exports=function(e,t,r){if(!t)return e;var s;if(r)s=r(t);else if(o.isURLSearchParams(t))s=t.toString();else{var i=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)&&(t+="[]"),o.isArray(e)||(e=[e]),o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),i.push(n(t)+"="+n(e))}))}),s=i.join("&")}return s&&(e+=(e.indexOf("?")===-1?"?":"&")+s),e}},{"./../utils":34}],27:[function(e,t,r){"use strict";t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},{}],28:[function(e,t,r){"use strict";var n=e("./../utils");t.exports=n.isStandardBrowserEnv()?function(){return{write:function(e,t,r,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),n.isNumber(r)&&a.push("expires="+new Date(r).toGMTString()),n.isString(o)&&a.push("path="+o),n.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},{"./../utils":34}],29:[function(e,t,r){"use strict";t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},{}],30:[function(e,t,r){"use strict";var n=e("./../utils");t.exports=n.isStandardBrowserEnv()?function(){function e(e){var t=e;return r&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,r=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(r){var o=n.isString(r)?e(r):r;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},{"./../utils":34}],31:[function(e,t,r){"use strict";var n=e("../utils");t.exports=function(e,t){n.forEach(e,function(r,n){n!==t&&n.toUpperCase()===t.toUpperCase()&&(e[t]=r,delete e[n])})}},{"../utils":34}],32:[function(e,t,r){"use strict";var n=e("./../utils");t.exports=function(e){var t,r,o,s={};return e?(n.forEach(e.split("\n"),function(e){o=e.indexOf(":"),t=n.trim(e.substr(0,o)).toLowerCase(),r=n.trim(e.substr(o+1)),t&&(s[t]=s[t]?s[t]+", "+r:r)}),s):s}},{"./../utils":34}],33:[function(e,t,r){"use strict";t.exports=function(e){return function(t){return e.apply(null,t)}}},{}],34:[function(e,t,r){"use strict";function n(e){return"[object Array]"===L.call(e)}function o(e){return"[object ArrayBuffer]"===L.call(e)}function s(e){return"undefined"!=typeof FormData&&e instanceof FormData}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function f(e){return null!==e&&"object"==typeof e}function l(e){return"[object Date]"===L.call(e)}function h(e){return"[object File]"===L.call(e)}function p(e){return"[object Blob]"===L.call(e)}function d(e){return"[object Function]"===L.call(e)}function m(e){return f(e)&&d(e.pipe)}function v(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function y(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function g(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function b(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||n(e)||(e=[e]),n(e))for(var r=0,o=e.length;r<o;r++)t.call(null,e[r],r,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function w(){function e(e,r){"object"==typeof t[r]&&"object"==typeof e?t[r]=w(t[r],e):t[r]=e}for(var t={},r=0,n=arguments.length;r<n;r++)b(arguments[r],e);return t}function _(e,t,r){return b(t,function(t,n){r&&"function"==typeof t?e[n]=x(t,r):e[n]=t}),e}var x=e("./helpers/bind"),S=e("is-buffer"),L=Object.prototype.toString;t.exports={isArray:n,isArrayBuffer:o,isBuffer:S,isFormData:s,isArrayBufferView:i,isString:a,isNumber:u,isObject:f,isUndefined:c,isDate:l,isFile:h,isBlob:p,isFunction:d,isStream:m,isURLSearchParams:v,isStandardBrowserEnv:g,forEach:b,merge:w,extend:_,trim:y}},{"./helpers/bind":24,"is-buffer":36}],35:[function(e,t,r){!function(e){"use strict";function n(){console.log.apply(console,arguments)}function o(e,t){var r;this.list=e,this.options=t=t||{};for(r in u)u.hasOwnProperty(r)&&("boolean"==typeof u[r]?this.options[r]=r in t?t[r]:u[r]:this.options[r]=t[r]||u[r])}function s(e,t,r){var n,o,a,u,c,f;if(t){if(a=t.indexOf("."),a!==-1?(n=t.slice(0,a),o=t.slice(a+1)):n=t,u=e[n],null!==u&&void 0!==u)if(o||"string"!=typeof u&&"number"!=typeof u)if(i(u))for(c=0,f=u.length;c<f;c++)s(u[c],o,r);else o&&s(u,o,r);else r.push(u)}else r.push(e);return r}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t){t=t||{},this.options=t,this.options.location=t.location||a.defaultOptions.location,this.options.distance="distance"in t?t.distance:a.defaultOptions.distance,this.options.threshold="threshold"in t?t.threshold:a.defaultOptions.threshold,this.options.maxPatternLength=t.maxPatternLength||a.defaultOptions.maxPatternLength,this.pattern=t.caseSensitive?e:e.toLowerCase(),this.patternLen=e.length,this.patternLen<=this.options.maxPatternLength&&(this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet())}var u={id:null,caseSensitive:!1,include:[],shouldSort:!0,searchFn:a,sortFn:function(e,t){return e.score-t.score},getFn:s,keys:[],verbose:!1,tokenize:!1,matchAllTokens:!1,tokenSeparator:/ +/g,minMatchCharLength:1,findAllMatches:!1};o.VERSION="2.7.3",o.prototype.set=function(e){return this.list=e,e},o.prototype.search=function(e){this.options.verbose&&n("\nSearch term:",e,"\n"),this.pattern=e,this.results=[],this.resultMap={},this._keyMap=null,this._prepareSearchers(),this._startSearch(),this._computeScore(),this._sort();var t=this._format();return t},o.prototype._prepareSearchers=function(){var e=this.options,t=this.pattern,r=e.searchFn,n=t.split(e.tokenSeparator),o=0,s=n.length;if(this.options.tokenize)for(this.tokenSearchers=[];o<s;o++)this.tokenSearchers.push(new r(n[o],e));this.fullSeacher=new r(t,e)},o.prototype._startSearch=function(){var e,t,r,n,o=this.options,s=o.getFn,i=this.list,a=i.length,u=this.options.keys,c=u.length,f=null;if("string"==typeof i[0])for(r=0;r<a;r++)this._analyze("",i[r],r,r);else for(this._keyMap={},r=0;r<a;r++)for(f=i[r],n=0;n<c;n++){if(e=u[n],"string"!=typeof e){if(t=1-e.weight||1,this._keyMap[e.name]={weight:t},e.weight<=0||e.weight>1)throw new Error("Key weight has to be > 0 and <= 1");e=e.name}else this._keyMap[e]={weight:1};this._analyze(e,s(f,e,[]),f,r)}},o.prototype._analyze=function(e,t,r,o){var s,a,u,c,f,l,h,p,d,m,v,y,g,b,w,_=this.options,x=!1;if(void 0!==t&&null!==t){a=[];var S=0;if("string"==typeof t){if(s=t.split(_.tokenSeparator),_.verbose&&n("---------\nKey:",e),this.options.tokenize){for(b=0;b<this.tokenSearchers.length;b++){for(p=this.tokenSearchers[b],_.verbose&&n("Pattern:",p.pattern),d=[],y=!1,w=0;w<s.length;w++){m=s[w],v=p.search(m);var L={};v.isMatch?(L[m]=v.score,x=!0,y=!0,a.push(v.score)):(L[m]=1,this.options.matchAllTokens||a.push(1)),d.push(L)}y&&S++,_.verbose&&n("Token scores:",d)}for(c=a[0],l=a.length,b=1;b<l;b++)c+=a[b];c/=l,_.verbose&&n("Token score average:",c)}h=this.fullSeacher.search(t),_.verbose&&n("Full text score:",h.score),f=h.score,void 0!==c&&(f=(f+c)/2),_.verbose&&n("Score average:",f),g=!this.options.tokenize||!this.options.matchAllTokens||S>=this.tokenSearchers.length,_.verbose&&n("Check Matches",g),(x||h.isMatch)&&g&&(u=this.resultMap[o],u?u.output.push({key:e,score:f,matchedIndices:h.matchedIndices}):(this.resultMap[o]={item:r,output:[{key:e,score:f,matchedIndices:h.matchedIndices}]},this.results.push(this.resultMap[o])))}else if(i(t))for(b=0;b<t.length;b++)this._analyze(e,t[b],r,o)}},o.prototype._computeScore=function(){var e,t,r,o,s,i,a,u,c,f=this._keyMap,l=this.results;for(this.options.verbose&&n("\n\nComputing score:\n"),e=0;e<l.length;e++){for(r=0,o=l[e].output,s=o.length,u=1,t=0;t<s;t++)i=o[t].score,a=f?f[o[t].key].weight:1,c=i*a,1!==a?u=Math.min(u,c):(r+=c,o[t].nScore=c);1===u?l[e].score=r/s:l[e].score=u,this.options.verbose&&n(l[e])}},o.prototype._sort=function(){var e=this.options;e.shouldSort&&(e.verbose&&n("\n\nSorting...."),this.results.sort(e.sortFn))},o.prototype._format=function(){var e,t,r,o,s=this.options,i=s.getFn,a=[],u=this.results,c=s.include;for(s.verbose&&n("\n\nOutput:\n\n",u),r=s.id?function(e){u[e].item=i(u[e].item,s.id,[])[0]}:function(){},o=function(e){var t,r,n,o,s,i=u[e];if(c.length>0){if(t={item:i.item},c.indexOf("matches")!==-1)for(n=i.output,t.matches=[],r=0;r<n.length;r++)o=n[r],s={indices:o.matchedIndices},o.key&&(s.key=o.key),t.matches.push(s);c.indexOf("score")!==-1&&(t.score=u[e].score)}else t=i.item;return t},e=0,t=u.length;e<t;e++)r(e),a.push(o(e));return a},a.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},a.prototype._calculatePatternAlphabet=function(){var e={},t=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]|=1<<this.pattern.length-t-1;return e},a.prototype._bitapScore=function(e,t){var r=e/this.patternLen,n=Math.abs(this.options.location-t);return this.options.distance?r+n/this.options.distance:n?1:r},a.prototype.search=function(e){var t,r,n,o,s,i,a,u,c,f,l,h,p,d,m,v,y,g,b,w,_,x,S,L=this.options;if(e=L.caseSensitive?e:e.toLowerCase(),this.pattern===e)return{isMatch:!0,score:0,matchedIndices:[[0,e.length-1]]};if(this.patternLen>L.maxPatternLength){if(g=e.match(new RegExp(this.pattern.replace(L.tokenSeparator,"|"))),b=!!g)for(_=[],t=0,x=g.length;t<x;t++)S=g[t],_.push([e.indexOf(S),S.length-1]);return{isMatch:b,score:b?.5:1,matchedIndices:_}}for(o=L.findAllMatches,s=L.location,n=e.length,i=L.threshold,a=e.indexOf(this.pattern,s),w=[],t=0;t<n;t++)w[t]=0;for(a!=-1&&(i=Math.min(this._bitapScore(0,a),i),a=e.lastIndexOf(this.pattern,s+this.patternLen),a!=-1&&(i=Math.min(this._bitapScore(0,a),i))),a=-1,v=1,y=[],f=this.patternLen+n,t=0;t<this.patternLen;t++){for(u=0,c=f;u<c;)this._bitapScore(t,s+c)<=i?u=c:f=c,c=Math.floor((f-u)/2+u);for(f=c,l=Math.max(1,s-c+1),h=o?n:Math.min(s+c,n)+this.patternLen,p=Array(h+2),p[h+1]=(1<<t)-1,r=h;r>=l;r--)if(m=this.patternAlphabet[e.charAt(r-1)],m&&(w[r-1]=1),p[r]=(p[r+1]<<1|1)&m,0!==t&&(p[r]|=(d[r+1]|d[r])<<1|1|d[r+1]),p[r]&this.matchmask&&(v=this._bitapScore(t,r-1),v<=i)){if(i=v,a=r-1,y.push(a),a<=s)break;l=Math.max(1,2*s-a)}if(this._bitapScore(t+1,s)>i)break;d=p}return _=this._getMatchedIndices(w),{isMatch:a>=0,score:0===v?.001:v,matchedIndices:_}},a.prototype._getMatchedIndices=function(e){for(var t,r=[],n=-1,o=-1,s=0,i=e.length;s<i;s++)t=e[s],t&&n===-1?n=s:t||n===-1||(o=s-1,o-n+1>=this.options.minMatchCharLength&&r.push([n,o]),n=-1);return e[s-1]&&s-1-n+1>=this.options.minMatchCharLength&&r.push([n,s-1]),r},"object"==typeof r?t.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):e.Fuse=o}(this)},{}],36:[function(e,t,r){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}t.exports=function(e){return null!=e&&(n(e)||o(e)||!!e._isBuffer)}},{}],37:[function(e,t,r){function n(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(l===setTimeout)return setTimeout(e,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function i(e){if(h===clearTimeout)return clearTimeout(e);if((h===o||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?m=d.concat(m):y=-1,m.length&&u())}function u(){if(!v){var e=s(a);v=!0;for(var t=m.length;t;){for(d=m,m=[];++y<t;)d&&d[y].run();y=-1,t=m.length}d=null,v=!1,i(e)}}function c(e,t){this.fun=e,this.array=t}function f(){}var l,h,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(e){l=n}try{h="function"==typeof clearTimeout?clearTimeout:o}catch(e){h=o}}();var d,m=[],v=!1,y=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];m.push(new c(e,t)),1!==m.length||v||s(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=f,p.addListener=f,p.once=f,p.off=f,p.removeListener=f,p.removeAllListeners=f,p.emit=f,p.prependListener=f,p.prependOnceListener=f,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}]},{},[6]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzY3JpcHRzLm1pbi5qcyIsIl9hc3NldHMvc2NyaXB0cy9hcGkuanMiLCJfYXNzZXRzL3NjcmlwdHMvYXotc2VhcmNoLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvZG9tLWVsZW1lbnRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvZXZlbnRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvdW5kZXJzY29yZS5qcyIsIl9hc3NldHMvc2NyaXB0cy9tYWluLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL3B1YnN1Yi5qcyIsIl9hc3NldHMvc2NyaXB0cy9yZXN1bHRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL3NlYXJjaC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvYWRhcHRlcnMveGhyLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9heGlvcy5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL0NhbmNlbC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL0NhbmNlbFRva2VuLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jYW5jZWwvaXNDYW5jZWwuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvQXhpb3MuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvSW50ZXJjZXB0b3JNYW5hZ2VyLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2NyZWF0ZUVycm9yLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2Rpc3BhdGNoUmVxdWVzdC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS9lbmhhbmNlRXJyb3IuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvc2V0dGxlLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL3RyYW5zZm9ybURhdGEuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2RlZmF1bHRzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2JpbmQuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYnRvYS5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9idWlsZFVSTC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9jb21iaW5lVVJMcy5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9jb29raWVzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2lzQWJzb2x1dGVVUkwuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvcGFyc2VIZWFkZXJzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL3NwcmVhZC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvdXRpbHMuanMiLCJub2RlX21vZHVsZXMvZnVzZS5qcy9zcmMvZnVzZS5qcyIsIm5vZGVfbW9kdWxlcy9pcy1idWZmZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdyb3VwU29uZ3MiLCJzb25nTGlzdCIsImdyb3VwZWQiLCJfdW5kZXJzY29yZSIsImdyb3VwQnkiLCJmaWx0ZXJCeUxldHRlciIsImxldHRlciIsImZpbHQiLCJmaWx0ZXIiLCJpdGVtIiwiYXJ0aXN0IiwidG9TdHJpbmciLCJjaGFyQXQiLCJmaWx0ZXJCeVRlcm0iLCJzZWFyY2hUZXJtIiwiZnVzZSIsIl9mdXNlMiIsImZ1c2VPcHRpb25zIiwiZnVzZVJlc3VsdHMiLCJzZWFyY2giLCJzZWFyY2hCeU5hbWUiLCJfcHVic3ViMiIsInB1Ymxpc2giLCJfYXhpb3MyIiwiZ2V0IiwidGhlbiIsInJlc3VsdHMiLCJkYXRhIiwic29ydFNvbmdzIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluZEFydGlzdHNCeUxldHRlciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfYXhpb3MiLCJfZnVzZSIsIl9wdWJzdWIiLCJzaG91bGRTb3J0IiwidGhyZXNob2xkIiwibG9jYXRpb24iLCJkaXN0YW5jZSIsIm1heFBhdHRlcm5MZW5ndGgiLCJtaW5NYXRjaENoYXJMZW5ndGgiLCJrZXlzIiwic29ydGVkIiwic29ydCIsImIiLCJhbGMiLCJ0b0xvd2VyQ2FzZSIsImJsYyIsIi4vaGVscGVycy91bmRlcnNjb3JlIiwiLi9wdWJzdWIiLCJheGlvcyIsImZ1c2UuanMiLCIyIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJuZXdPYmoiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIkFycmF5IiwiaXNBcnJheSIsImFycjIiLCJmcm9tIiwibGV0dGVyQ2xpY2tIYW5kbGVyIiwiZXZ0Iiwid2luZG93IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInRoZUxldHRlciIsInRoaXMiLCJkYXRhc2V0IiwiYXBpIiwiaW5pdExldHRlck1lbnUiLCJsZXR0ZXJzIiwidXBwZXJjYXNlTGV0dGVycyIsInRvVXBwZXJDYXNlIiwibGV0dGVyTGlzdCIsImNvbmNhdCIsInNvcnRlZExpc3QiLCJodG1sTGlzdCIsIm1hcCIsImpvaW4iLCJfZXZlbnRzIiwiX2FwaSIsImxldHRlck1lbnVDb250YWluZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJpbm5lckhUTUwiLCJkZWxlZ2F0ZUV2ZW50TGlzdGVuZXIiLCIuL2FwaSIsIi4vaGVscGVycy9ldmVudHMiLCIzIiwiaGFzQ2xhc3MiLCJlbCIsImNsYXNzTmFtZSIsImNsYXNzTGlzdCIsImNvbnRhaW5zIiwiUmVnRXhwIiwidGVzdCIsImFkZENsYXNzIiwiZWxlbWVudCIsImFkZCIsInJlbW92ZUNsYXNzIiwicmVtb3ZlIiwicmVwbGFjZSIsInNwbGl0IiwidG9nZ2xlQ2xhc3MiLCJzZXRTdHlsZSIsInByb3BlcnR5T2JqZWN0Iiwic3R5bGVzIiwiYXNzaWduIiwic3R5bGUiLCJmaW5kUGFyZW50QnlUYWdOYW1lIiwidGFnTmFtZSIsInBhcmVudCIsInBhcmVudE5vZGUiLCI0IiwidHJpZ2dlciIsImV2ZW50bmFtZSIsImFyZ3VtZW50cyIsInVuZGVmaW5lZCIsIkN1c3RvbUV2ZW50IiwiZGV0YWlsIiwiY3JlYXRlRXZlbnQiLCJpbml0Q3VzdG9tRXZlbnQiLCJkaXNwYXRjaEV2ZW50Iiwic2VsZWN0b3IiLCJoYW5kbGVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsInBvc3NpYmxlVGFyZ2V0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0YXJnZXQiLCJwIiwiNSIsImlzRnVuY3Rpb24iLCJsaXN0IiwicHJvcCIsInJlZHVjZSIsImFwcGx5IiwicHVzaCIsIjYiLCIuL2F6LXNlYXJjaCIsIi4vcmVzdWx0cyIsIi4vc2VhcmNoIiwiNyIsInB1YnN1YiIsInRvcGljcyIsInN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwidW5zdWJzY3JpYmUiLCJsZW4iLCJzcGxpY2UiLCJmb3JFYWNoIiwiOCIsImNsZWFyUmVzdWx0cyIsInBsYWNlaG9sZGVyIiwiX2RvbUVsZW1lbnRzIiwibG9hZHIiLCJyZW5kZXIiLCJwdWJvYmoiLCJodG1sU3R1ZmYiLCJ0aXRsZSIsIi4vaGVscGVycy9kb20tZWxlbWVudHMiLCI5IiwiY2xlYXJTZWFyY2giLCJzZWFyY2hJbnB1dCIsInNlYXJjaEhhbmRsZXIiLCJvblNlYXJjaFN0YXJ0IiwicHMiLCJwdWJzdWJPYmplY3QiLCJzZWFyY2hGb3JtIiwiMTAiLCIuL2xpYi9heGlvcyIsIjExIiwicHJvY2VzcyIsInV0aWxzIiwic2V0dGxlIiwiYnVpbGRVUkwiLCJwYXJzZUhlYWRlcnMiLCJpc1VSTFNhbWVPcmlnaW4iLCJjcmVhdGVFcnJvciIsImJ0b2EiLCJiaW5kIiwiY29uZmlnIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXF1ZXN0RGF0YSIsInJlcXVlc3RIZWFkZXJzIiwiaGVhZGVycyIsImlzRm9ybURhdGEiLCJyZXF1ZXN0IiwiWE1MSHR0cFJlcXVlc3QiLCJsb2FkRXZlbnQiLCJ4RG9tYWluIiwiZW52IiwiTk9ERV9FTlYiLCJYRG9tYWluUmVxdWVzdCIsInVybCIsIm9ucHJvZ3Jlc3MiLCJvbnRpbWVvdXQiLCJhdXRoIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIkF1dGhvcml6YXRpb24iLCJvcGVuIiwibWV0aG9kIiwicGFyYW1zIiwicGFyYW1zU2VyaWFsaXplciIsInRpbWVvdXQiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VVUkwiLCJpbmRleE9mIiwicmVzcG9uc2VIZWFkZXJzIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwicmVzcG9uc2VEYXRhIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2UiLCJyZXNwb25zZVRleHQiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsImlzU3RhbmRhcmRCcm93c2VyRW52IiwiY29va2llcyIsInhzcmZWYWx1ZSIsIndpdGhDcmVkZW50aWFscyIsInhzcmZDb29raWVOYW1lIiwicmVhZCIsInhzcmZIZWFkZXJOYW1lIiwidmFsIiwic2V0UmVxdWVzdEhlYWRlciIsIm9uRG93bmxvYWRQcm9ncmVzcyIsIm9uVXBsb2FkUHJvZ3Jlc3MiLCJ1cGxvYWQiLCJjYW5jZWxUb2tlbiIsInByb21pc2UiLCJjYW5jZWwiLCJhYm9ydCIsInNlbmQiLCIuLi9jb3JlL2NyZWF0ZUVycm9yIiwiLi8uLi9jb3JlL3NldHRsZSIsIi4vLi4vaGVscGVycy9idG9hIiwiLi8uLi9oZWxwZXJzL2J1aWxkVVJMIiwiLi8uLi9oZWxwZXJzL2Nvb2tpZXMiLCIuLy4uL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luIiwiLi8uLi9oZWxwZXJzL3BhcnNlSGVhZGVycyIsIi4vLi4vdXRpbHMiLCJfcHJvY2VzcyIsIjEyIiwiY3JlYXRlSW5zdGFuY2UiLCJkZWZhdWx0Q29uZmlnIiwiY29udGV4dCIsIkF4aW9zIiwiaW5zdGFuY2UiLCJleHRlbmQiLCJkZWZhdWx0cyIsImNyZWF0ZSIsImluc3RhbmNlQ29uZmlnIiwibWVyZ2UiLCJDYW5jZWwiLCJDYW5jZWxUb2tlbiIsImlzQ2FuY2VsIiwiYWxsIiwicHJvbWlzZXMiLCJzcHJlYWQiLCIuL2NhbmNlbC9DYW5jZWwiLCIuL2NhbmNlbC9DYW5jZWxUb2tlbiIsIi4vY2FuY2VsL2lzQ2FuY2VsIiwiLi9jb3JlL0F4aW9zIiwiLi9kZWZhdWx0cyIsIi4vaGVscGVycy9iaW5kIiwiLi9oZWxwZXJzL3NwcmVhZCIsIi4vdXRpbHMiLCIxMyIsIm1lc3NhZ2UiLCJfX0NBTkNFTF9fIiwiMTQiLCJleGVjdXRvciIsIlR5cGVFcnJvciIsInJlc29sdmVQcm9taXNlIiwidG9rZW4iLCJyZWFzb24iLCJ0aHJvd0lmUmVxdWVzdGVkIiwic291cmNlIiwiYyIsIi4vQ2FuY2VsIiwiMTUiLCIxNiIsImludGVyY2VwdG9ycyIsIkludGVyY2VwdG9yTWFuYWdlciIsImRpc3BhdGNoUmVxdWVzdCIsImlzQWJzb2x1dGVVUkwiLCJjb21iaW5lVVJMcyIsImJhc2VVUkwiLCJjaGFpbiIsImludGVyY2VwdG9yIiwidW5zaGlmdCIsImZ1bGZpbGxlZCIsInJlamVjdGVkIiwic2hpZnQiLCIuLy4uL2RlZmF1bHRzIiwiLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzIiwiLi8uLi9oZWxwZXJzL2lzQWJzb2x1dGVVUkwiLCIuL0ludGVyY2VwdG9yTWFuYWdlciIsIi4vZGlzcGF0Y2hSZXF1ZXN0IiwiMTciLCJoYW5kbGVycyIsInVzZSIsImVqZWN0IiwiaWQiLCJmbiIsImgiLCIxOCIsImVuaGFuY2VFcnJvciIsIi4vZW5oYW5jZUVycm9yIiwiMTkiLCJ0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkIiwidHJhbnNmb3JtRGF0YSIsInRyYW5zZm9ybVJlcXVlc3QiLCJjb21tb24iLCJhZGFwdGVyIiwidHJhbnNmb3JtUmVzcG9uc2UiLCIuLi9jYW5jZWwvaXNDYW5jZWwiLCIuLi9kZWZhdWx0cyIsIi4vdHJhbnNmb3JtRGF0YSIsIjIwIiwiMjEiLCJ2YWxpZGF0ZVN0YXR1cyIsIi4vY3JlYXRlRXJyb3IiLCIyMiIsImZucyIsIjIzIiwic2V0Q29udGVudFR5cGVJZlVuc2V0IiwiaXNVbmRlZmluZWQiLCJnZXREZWZhdWx0QWRhcHRlciIsIm5vcm1hbGl6ZUhlYWRlck5hbWUiLCJERUZBVUxUX0NPTlRFTlRfVFlQRSIsIkNvbnRlbnQtVHlwZSIsImlzQXJyYXlCdWZmZXIiLCJpc0J1ZmZlciIsImlzU3RyZWFtIiwiaXNGaWxlIiwiaXNCbG9iIiwiaXNBcnJheUJ1ZmZlclZpZXciLCJidWZmZXIiLCJpc1VSTFNlYXJjaFBhcmFtcyIsImlzT2JqZWN0IiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlIiwibWF4Q29udGVudExlbmd0aCIsIkFjY2VwdCIsIi4vYWRhcHRlcnMvaHR0cCIsIi4vYWRhcHRlcnMveGhyIiwiLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUiLCIyNCIsInRoaXNBcmciLCJhcmdzIiwiMjUiLCJFIiwiaW5wdXQiLCJibG9jayIsImNoYXJDb2RlIiwic3RyIiwiU3RyaW5nIiwib3V0cHV0IiwiaWR4IiwiY2hhcnMiLCJjaGFyQ29kZUF0IiwibmFtZSIsIjI2IiwiZW5jb2RlIiwiZW5jb2RlVVJJQ29tcG9uZW50Iiwic2VyaWFsaXplZFBhcmFtcyIsInBhcnRzIiwidiIsImlzRGF0ZSIsInRvSVNPU3RyaW5nIiwiMjciLCJyZWxhdGl2ZVVSTCIsIjI4Iiwid3JpdGUiLCJleHBpcmVzIiwicGF0aCIsImRvbWFpbiIsInNlY3VyZSIsImNvb2tpZSIsImlzTnVtYmVyIiwiRGF0ZSIsInRvR01UU3RyaW5nIiwiaXNTdHJpbmciLCJtYXRjaCIsImRlY29kZVVSSUNvbXBvbmVudCIsIm5vdyIsIjI5IiwiMzAiLCJyZXNvbHZlVVJMIiwiaHJlZiIsIm1zaWUiLCJ1cmxQYXJzaW5nTm9kZSIsInNldEF0dHJpYnV0ZSIsInByb3RvY29sIiwiaG9zdCIsImhhc2giLCJob3N0bmFtZSIsInBvcnQiLCJwYXRobmFtZSIsIm9yaWdpblVSTCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsImNyZWF0ZUVsZW1lbnQiLCJyZXF1ZXN0VVJMIiwicGFyc2VkIiwiMzEiLCJub3JtYWxpemVkTmFtZSIsIi4uL3V0aWxzIiwiMzIiLCJsaW5lIiwidHJpbSIsInN1YnN0ciIsIjMzIiwiMzQiLCJGb3JtRGF0YSIsInJlc3VsdCIsIkFycmF5QnVmZmVyIiwiaXNWaWV3IiwicGlwZSIsIlVSTFNlYXJjaFBhcmFtcyIsInByb2R1Y3QiLCJhc3NpZ25WYWx1ZSIsImlzLWJ1ZmZlciIsIjM1IiwiZ2xvYmFsIiwibG9nIiwiRnVzZSIsIm9wdGlvbnMiLCJkZWZhdWx0T3B0aW9ucyIsImRlZXBWYWx1ZSIsImZpcnN0U2VnbWVudCIsInJlbWFpbmluZyIsImRvdEluZGV4Iiwic2xpY2UiLCJCaXRhcFNlYXJjaGVyIiwicGF0dGVybiIsImNhc2VTZW5zaXRpdmUiLCJwYXR0ZXJuTGVuIiwibWF0Y2htYXNrIiwicGF0dGVybkFscGhhYmV0IiwiX2NhbGN1bGF0ZVBhdHRlcm5BbHBoYWJldCIsImluY2x1ZGUiLCJzZWFyY2hGbiIsInNvcnRGbiIsInNjb3JlIiwiZ2V0Rm4iLCJ2ZXJib3NlIiwidG9rZW5pemUiLCJtYXRjaEFsbFRva2VucyIsInRva2VuU2VwYXJhdG9yIiwiZmluZEFsbE1hdGNoZXMiLCJWRVJTSU9OIiwic2V0IiwicmVzdWx0TWFwIiwiX2tleU1hcCIsIl9wcmVwYXJlU2VhcmNoZXJzIiwiX3N0YXJ0U2VhcmNoIiwiX2NvbXB1dGVTY29yZSIsIl9zb3J0IiwiX2Zvcm1hdCIsInRva2VucyIsInRva2VuU2VhcmNoZXJzIiwiZnVsbFNlYWNoZXIiLCJ3ZWlnaHQiLCJqIiwibGlzdExlbiIsImtleXNMZW4iLCJfYW5hbHl6ZSIsInRleHQiLCJlbnRpdHkiLCJpbmRleCIsIndvcmRzIiwic2NvcmVzIiwiZXhpc3RpbmdSZXN1bHQiLCJhdmVyYWdlU2NvcmUiLCJmaW5hbFNjb3JlIiwic2NvcmVzTGVuIiwibWFpblNlYXJjaFJlc3VsdCIsInRva2VuU2VhcmNoZXIiLCJ0ZXJtU2NvcmVzIiwid29yZCIsInRva2VuU2VhcmNoUmVzdWx0IiwiaGFzTWF0Y2hJblRleHQiLCJjaGVja1RleHRNYXRjaGVzIiwiZXhpc3RzIiwibnVtVGV4dE1hdGNoZXMiLCJpc01hdGNoIiwibWF0Y2hlZEluZGljZXMiLCJ0b3RhbFNjb3JlIiwic2NvcmVMZW4iLCJiZXN0U2NvcmUiLCJuU2NvcmUiLCJrZXlNYXAiLCJNYXRoIiwibWluIiwicmVwbGFjZVZhbHVlIiwiZ2V0SXRlbUF0SW5kZXgiLCJmaW5hbE91dHB1dCIsIl9pdGVtIiwiX3Jlc3VsdCIsInJlY29yZCIsIm1hdGNoZXMiLCJpbmRpY2VzIiwibWFzayIsIl9iaXRhcFNjb3JlIiwiZXJyb3JzIiwiYWNjdXJhY3kiLCJwcm94aW1pdHkiLCJhYnMiLCJ0ZXh0TGVuIiwiYmVzdExvYyIsImJpbk1pbiIsImJpbk1pZCIsImJpbk1heCIsInN0YXJ0IiwiZmluaXNoIiwiYml0QXJyIiwibGFzdEJpdEFyciIsImNoYXJNYXRjaCIsImxvY2F0aW9ucyIsImlzTWF0Y2hlZCIsIm1hdGNoTWFzayIsIm1hdGNoZXNMZW4iLCJsYXN0SW5kZXhPZiIsImZsb29yIiwibWF4IiwiX2dldE1hdGNoZWRJbmRpY2VzIiwiZW5kIiwiZGVmaW5lIiwiYW1kIiwiMzYiLCJjb25zdHJ1Y3RvciIsImlzU2xvd0J1ZmZlciIsInJlYWRGbG9hdExFIiwiX2lzQnVmZmVyIiwiMzciLCJkZWZhdWx0U2V0VGltb3V0IiwiZGVmYXVsdENsZWFyVGltZW91dCIsInJ1blRpbWVvdXQiLCJmdW4iLCJjYWNoZWRTZXRUaW1lb3V0Iiwic2V0VGltZW91dCIsInJ1bkNsZWFyVGltZW91dCIsIm1hcmtlciIsImNhY2hlZENsZWFyVGltZW91dCIsImNsZWFyVGltZW91dCIsImNsZWFuVXBOZXh0VGljayIsImRyYWluaW5nIiwiY3VycmVudFF1ZXVlIiwicXVldWUiLCJxdWV1ZUluZGV4IiwiZHJhaW5RdWV1ZSIsInJ1biIsIkl0ZW0iLCJhcnJheSIsIm5vb3AiLCJuZXh0VGljayIsImJyb3dzZXIiLCJhcmd2IiwidmVyc2lvbiIsInZlcnNpb25zIiwib24iLCJhZGRMaXN0ZW5lciIsIm9uY2UiLCJvZmYiLCJyZW1vdmVMaXN0ZW5lciIsInJlbW92ZUFsbExpc3RlbmVycyIsImVtaXQiLCJwcmVwZW5kTGlzdGVuZXIiLCJwcmVwZW5kT25jZUxpc3RlbmVyIiwibGlzdGVuZXJzIiwiYmluZGluZyIsImN3ZCIsImNoZGlyIiwiZGlyIiwidW1hc2siXSwibWFwcGluZ3MiOiJDQUFBLFFBQUFBLEdBQUFDLEVBQUFDLEVBQUFDLEdBQUEsUUFBQUMsR0FBQUMsRUFBQUMsR0FBQSxJQUFBSixFQUFBRyxHQUFBLENBQUEsSUFBQUosRUFBQUksR0FBQSxDQUFBLEdBQUFFLEdBQUEsa0JBQUFDLFVBQUFBLE9BQUEsS0FBQUYsR0FBQUMsRUFBQSxNQUFBQSxHQUFBRixHQUFBLEVBQUEsSUFBQUksRUFBQSxNQUFBQSxHQUFBSixHQUFBLEVBQUEsSUFBQUssR0FBQSxHQUFBQyxPQUFBLHVCQUFBTixFQUFBLElBQUEsTUFBQUssR0FBQUUsS0FBQSxtQkFBQUYsRUFBQSxHQUFBRyxHQUFBWCxFQUFBRyxJQUFBUyxXQUFBYixHQUFBSSxHQUFBLEdBQUFVLEtBQUFGLEVBQUFDLFFBQUEsU0FBQWQsR0FBQSxHQUFBRSxHQUFBRCxFQUFBSSxHQUFBLEdBQUFMLEVBQUEsT0FBQUksR0FB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QUdBK0wsRUFBQXNaLElBQUEsV0FBQSxNQUFBLEtBQ0F0WixFQUFBdVosTUFBQSxTQUFBQyxHQUNBLEtBQUEsSUFBQXZsQixPQUFBLG1DQUVBK0wsRUFBQXlaLE1BQUEsV0FBQSxNQUFBLGNyQ211RlciLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuc2VhcmNoQnlOYW1lID0gc2VhcmNoQnlOYW1lO1xuZXhwb3J0cy5maW5kQXJ0aXN0c0J5TGV0dGVyID0gZmluZEFydGlzdHNCeUxldHRlcjtcblxudmFyIF9heGlvcyA9IHJlcXVpcmUoJ2F4aW9zJyk7XG5cbnZhciBfYXhpb3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXhpb3MpO1xuXG52YXIgX2Z1c2UgPSByZXF1aXJlKCdmdXNlLmpzJyk7XG5cbnZhciBfZnVzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mdXNlKTtcblxudmFyIF9wdWJzdWIgPSByZXF1aXJlKCcuL3B1YnN1YicpO1xuXG52YXIgX3B1YnN1YjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wdWJzdWIpO1xuXG52YXIgX3VuZGVyc2NvcmUgPSByZXF1aXJlKCcuL2hlbHBlcnMvdW5kZXJzY29yZScpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgZnVzZSA9IHZvaWQgMDtcblxuLy8gSW5pdGlhbGl6ZSBmdXNlLmpzIG9wdGlvbnNcbnZhciBmdXNlT3B0aW9ucyA9IHtcbiAgc2hvdWxkU29ydDogdHJ1ZSxcbiAgdGhyZXNob2xkOiAwLjEsXG4gIGxvY2F0aW9uOiAwLFxuICBkaXN0YW5jZTogMTAwLFxuICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMixcbiAgbWluTWF0Y2hDaGFyTGVuZ3RoOiAxLFxuICBrZXlzOiBbJ2FydGlzdCcsICd0aXRsZSddXG59O1xuXG4vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82NzEyMDM0L3NvcnQtYXJyYXktYnktZmlyc3RuYW1lLWFscGhhYmV0aWNhbGx5LWluLWphdmFzY3JpcHRcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU0MjEyNTMvc29ydC1qYXZhc2NyaXB0LWFycmF5LW9mLW9iamVjdHMtYmFzZWQtb24tb25lLW9mLXRoZS1vYmplY3RzLXByb3BlcnRpZXNcbnZhciBzb3J0U29uZ3MgPSBmdW5jdGlvbiBzb3J0U29uZ3Moc29uZ0xpc3QpIHtcbiAgdmFyIHNvcnRlZCA9IHNvbmdMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgYWxjID0gYS5hcnRpc3QudG9Mb3dlckNhc2UoKTtcbiAgICB2YXIgYmxjID0gYi5hcnRpc3QudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoYWxjID4gYmxjKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9IGVsc2UgaWYgKGFsYyA8IGJsYykge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbiAgfSk7XG4gIHJldHVybiBzb3J0ZWQ7XG59O1xuXG5mdW5jdGlvbiBncm91cFNvbmdzKHNvbmdMaXN0KSB7XG4gIHZhciBncm91cGVkID0gKDAsIF91bmRlcnNjb3JlLmdyb3VwQnkpKHNvbmdMaXN0LCAnYXJ0aXN0Jyk7XG4gIHJldHVybiBncm91cGVkO1xufVxuXG5mdW5jdGlvbiBmaWx0ZXJCeUxldHRlcihzb25nTGlzdCwgbGV0dGVyKSB7XG4gIHZhciBmaWx0ID0gc29uZ0xpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgcmV0dXJuIGl0ZW0uYXJ0aXN0LnRvU3RyaW5nKCkuY2hhckF0KDApID09PSBsZXR0ZXI7XG4gIH0pO1xuICByZXR1cm4gZmlsdDtcbn1cblxuZnVuY3Rpb24gZmlsdGVyQnlUZXJtKHNvbmdMaXN0LCBzZWFyY2hUZXJtKSB7XG4gIGZ1c2UgPSBuZXcgX2Z1c2UyLmRlZmF1bHQoc29uZ0xpc3QsIGZ1c2VPcHRpb25zKTtcbiAgdmFyIGZ1c2VSZXN1bHRzID0gZnVzZS5zZWFyY2goc2VhcmNoVGVybSk7XG4gIHJldHVybiBmdXNlUmVzdWx0cztcbn1cblxuZnVuY3Rpb24gc2VhcmNoQnlOYW1lKHNlYXJjaFRlcm0pIHtcbiAgX3B1YnN1YjIuZGVmYXVsdC5wdWJsaXNoKCdzZWFyY2hTdGFydCcsIHsgc2VhcmNoVGVybTogc2VhcmNoVGVybSB9KTtcbiAgcmV0dXJuIF9heGlvczIuZGVmYXVsdC5nZXQoJ3NlYXJjaF9kYXRhLmpzb24nKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgcmV0dXJuIGZpbHRlckJ5VGVybShyZXN1bHRzLmRhdGEsIHNlYXJjaFRlcm0pO1xuICB9KS50aGVuKHNvcnRTb25ncykudGhlbihncm91cFNvbmdzKS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZpbmRBcnRpc3RzQnlMZXR0ZXIobGV0dGVyKSB7XG4gIF9wdWJzdWIyLmRlZmF1bHQucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IGxldHRlcjogbGV0dGVyIH0pO1xuICByZXR1cm4gX2F4aW9zMi5kZWZhdWx0LmdldCgnc2VhcmNoX2RhdGEuanNvbicpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICByZXR1cm4gZmlsdGVyQnlMZXR0ZXIocmVzdWx0cy5kYXRhLCBsZXR0ZXIpO1xuICB9KS50aGVuKHNvcnRTb25ncykudGhlbihncm91cFNvbmdzXG4gIC8vIC50aGVuKHJlc3VsdHMgPT4gc29ydFNvbmdzKHJlc3VsdHMsIGxldHRlcikpXG4gICkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0pO1xufVxuLypcbmZ1bmN0aW9uIHNlYXJjaCgpIHtcbiAgYXhpb3MuZ2V0KCdzZWFyY2hfZGF0YS5qc29uJylcbiAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgbG9hZHIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICBjb25zdCBmaWx0ID0gZGF0YS5maWx0ZXIoaXRlbSA9PiBpdGVtLmFydGlzdC50b1N0cmluZygpLmNoYXJBdCgwKSA9PT0gdGhpcy5kYXRhc2V0LmxldHRlcik7XG5cbiAgICBQdWJTdWIucHVibGlzaCgndXBkYXRlTGlzdCcsIHsgbGlzdDogZmlsdCB9KTtcblxuICAgIGRpc3BsYXlTZWFyY2hSZXN1bHRzKGZpbHQpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc29ydFNvbmdzKHJlc3VsdHMsIGxldHRlcikge1xuICBjb25zb2xlLmxvZygnc29ydFNvbmdzJyk7XG4gIGNvbnN0IGFsbFNvbmdzID0gcmVzdWx0cy5kYXRhO1xuICBjb25zdCBmaWx0ZXJlZFNvbmdzID0gYWxsU29uZ3MuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IGxldHRlcik7XG5cbiAgY29uc3Qgc29uZ2xpc3RTb3J0ZWQgPSBmaWx0ZXJlZFNvbmdzLnNvcnQoKGEsIGIpID0+IGIuYXJ0aXN0IC0gYS5hcnRpc3QpO1xuICBjb25zdCBzb25nbGlzdEdyb3VwZWQgPSBncm91cEJ5KHNvbmdsaXN0U29ydGVkLCAnYXJ0aXN0Jyk7XG5cbiAgcmV0dXJuIHNvbmdsaXN0R3JvdXBlZDtcbn1cblxuKi9cblxufSx7XCIuL2hlbHBlcnMvdW5kZXJzY29yZVwiOjUsXCIuL3B1YnN1YlwiOjcsXCJheGlvc1wiOjEwLFwiZnVzZS5qc1wiOjM1fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfZXZlbnRzID0gcmVxdWlyZSgnLi9oZWxwZXJzL2V2ZW50cycpO1xuXG52YXIgX3B1YnN1YiA9IHJlcXVpcmUoJy4vcHVic3ViJyk7XG5cbnZhciBfcHVic3ViMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3B1YnN1Yik7XG5cbnZhciBfYXBpID0gcmVxdWlyZSgnLi9hcGknKTtcblxudmFyIGFwaSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hcGkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxudmFyIGxldHRlck1lbnVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXotc2VhcmNoJyk7XG5cbmZ1bmN0aW9uIGxldHRlckNsaWNrSGFuZGxlcihldnQpIHtcbiAgdmFyIGUgPSBldnQgfHwgd2luZG93LmV2ZW50O1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdmFyIHRoZUxldHRlciA9IHRoaXMuZGF0YXNldC5sZXR0ZXI7XG5cbiAgYXBpLmZpbmRBcnRpc3RzQnlMZXR0ZXIodGhlTGV0dGVyKS50aGVuKGZ1bmN0aW9uIChzb25nTGlzdCkge1xuICAgIF9wdWJzdWIyLmRlZmF1bHQucHVibGlzaCgnc2VhcmNoQ29tcGxldGUnLCB7IHNvbmdMaXN0OiBzb25nTGlzdCwgc2VhcmNoVGVybTogdGhlTGV0dGVyIH0pO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaW5pdExldHRlck1lbnUoKSB7XG4gIHZhciBsZXR0ZXJzID0gJ3F3ZXJ0eXVpb3Bhc2RmZ2hqa2x6eGN2Ym5tJztcbiAgdmFyIHVwcGVyY2FzZUxldHRlcnMgPSBsZXR0ZXJzLnRvVXBwZXJDYXNlKCk7XG4gIHZhciBsZXR0ZXJMaXN0ID0gW10uY29uY2F0KF90b0NvbnN1bWFibGVBcnJheSh1cHBlcmNhc2VMZXR0ZXJzKSk7XG4gIHZhciBzb3J0ZWRMaXN0ID0gbGV0dGVyTGlzdC5zb3J0KCk7XG4gIHZhciBodG1sTGlzdCA9IHNvcnRlZExpc3QubWFwKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgcmV0dXJuICc8bGkgY2xhc3M9XCJvLWxpc3QtaW5saW5lX19pdGVtIGMtYXpfX2l0ZW1cIj48YSBjbGFzcz1cImMtYXpfX2xldHRlclwiIGRhdGEtbGV0dGVyPVwiJyArIGl0ZW0gKyAnXCI+JyArIGl0ZW0gKyAnPC9hPjwvbGk+JztcbiAgfSkuam9pbignJyk7XG4gIC8vIGNvbnRhaW5lci5pbm5lckhUTUwgPSBgPHVsIGNsYXNzPVwiby1saXN0LWlubGluZSBjLWF6XCI+JHtodG1sTGlzdH08L3VsPmA7XG4gIC8vIGNvbnN0IGxldHRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5sZXR0ZXInKTtcblxuICAvLyBsZXR0ZXIuZm9yRWFjaChsZXR0ID0+IGxldHQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBsZXR0ZXJDbGlja0hhbmRsZXIpKTtcbiAgcmV0dXJuICc8dWwgY2xhc3M9XCJvLWxpc3QtaW5saW5lIGMtYXpcIj4nICsgaHRtbExpc3QgKyAnPC91bD4nO1xufVxuXG5sZXR0ZXJNZW51Q29udGFpbmVyLmlubmVySFRNTCA9IGluaXRMZXR0ZXJNZW51KCk7XG4oMCwgX2V2ZW50cy5kZWxlZ2F0ZUV2ZW50TGlzdGVuZXIpKGxldHRlck1lbnVDb250YWluZXIsICdjbGljaycsICdhJywgbGV0dGVyQ2xpY2tIYW5kbGVyKTtcblxufSx7XCIuL2FwaVwiOjEsXCIuL2hlbHBlcnMvZXZlbnRzXCI6NCxcIi4vcHVic3ViXCI6N31dLDM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy5oYXNDbGFzcyA9IGhhc0NsYXNzO1xuLypcbiAqIGFkYXB0ZWQgZnJvbSBodHRwczovL2NvZGVwZW4uaW8vZGl2c3dpdGhjbGFzcy9wZW4vSm9SV2R3XG4gKiBmcm9tIGEgc2luZ2xlIGVsZW1lbnQgKGkuZS4gcXVlcnlTZWxlY3RvciBvciBnZXRFbGVtZW50QnlOYW1lKVxuICogeW91IGNhbiBhZGQsIHJlbW92ZSwgb3IgdG9nZ2xlIGEgY2xhc3NcbiAqXG4gKiBAcGFyYW0ge0RPTSBFbGVtZW50fSBlbCAtIFRoZSBlbGVtZW50IHRvIGFsdGVyXG4gKiBAcGFyYW0ge1N0cmluZ30gY2xhc3NOYW1lIC0gdGhlIGNsYXNzIG5hbWUgdG8gYWRkLCByZW1vdmUsIHRvZ2dsZVxuICovXG5cbnZhciBhZGRDbGFzcyA9IGV4cG9ydHMuYWRkQ2xhc3MgPSBmdW5jdGlvbiBhZGRDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgdmFyIGVsID0gZWxlbWVudDtcblxuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgZWwuY2xhc3NMaXN0LmFkZChjbGFzc05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmNsYXNzTmFtZSArPSAnICcgKyBjbGFzc05hbWU7XG4gIH1cbn07XG5cbnZhciByZW1vdmVDbGFzcyA9IGV4cG9ydHMucmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbGVtZW50LCBjbGFzc05hbWUpIHtcbiAgdmFyIGVsID0gZWxlbWVudDtcblxuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoJyhefFxcXFxiKScgKyBjbGFzc05hbWUuc3BsaXQoJyAnKS5qb2luKCd8JykgKyAnKFxcXFxifCQpJywgJ2dpJyksICcgJyk7XG4gIH1cbn07XG5cbmZ1bmN0aW9uIGhhc0NsYXNzKGVsLCBjbGFzc05hbWUpIHtcbiAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgIHJldHVybiBlbC5jbGFzc0xpc3QuY29udGFpbnMoY2xhc3NOYW1lKTtcbiAgfVxuICByZXR1cm4gbmV3IFJlZ0V4cCgnKF58ICknICsgY2xhc3NOYW1lICsgJyggfCQpJywgJ2dpJykudGVzdChlbC5jbGFzc05hbWUpO1xufVxuXG52YXIgdG9nZ2xlQ2xhc3MgPSBleHBvcnRzLnRvZ2dsZUNsYXNzID0gZnVuY3Rpb24gdG9nZ2xlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gIHZhciBlbCA9IGVsZW1lbnQ7XG5cbiAgaWYgKGhhc0NsYXNzKGVsLCBjbGFzc05hbWUpKSB7XG4gICAgcmVtb3ZlQ2xhc3MoZWwsIGNsYXNzTmFtZSk7XG4gIH0gZWxzZSB7XG4gICAgYWRkQ2xhc3MoZWwsIGNsYXNzTmFtZSk7XG4gIH1cbn07XG5cbnZhciBzZXRTdHlsZSA9IGV4cG9ydHMuc2V0U3R5bGUgPSBmdW5jdGlvbiBzZXRTdHlsZShlbGVtZW50LCBwcm9wZXJ0eU9iamVjdCkge1xuICB2YXIgc3R5bGVzID0gcHJvcGVydHlPYmplY3Q7XG5cbiAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZXMpO1xufTtcblxudmFyIGZpbmRQYXJlbnRCeVRhZ05hbWUgPSBleHBvcnRzLmZpbmRQYXJlbnRCeVRhZ05hbWUgPSBmdW5jdGlvbiBmaW5kUGFyZW50QnlUYWdOYW1lKGVsZW1lbnQsIHRhZ05hbWUpIHtcbiAgdmFyIHBhcmVudCA9IGVsZW1lbnQ7XG5cbiAgd2hpbGUgKHBhcmVudCAhPT0gbnVsbCAmJiBwYXJlbnQudGFnTmFtZSAhPT0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHBhcmVudDtcbn07XG5cbn0se31dLDQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xuZXhwb3J0cy50cmlnZ2VyID0gdHJpZ2dlcjtcbmV4cG9ydHMuZGVsZWdhdGVFdmVudExpc3RlbmVyID0gZGVsZWdhdGVFdmVudExpc3RlbmVyO1xuLyoqXG4gKiBDdXN0b20gamF2YXNjcmlwdCBldmVudHMgb2YgalF1ZXJ5IGZ1bmN0aW9uc1xuICovXG4vKipcbiAqIEN1c3RvbSBldmVudCBkaXNwYXRjaGVyIChtaW1pY3MganF1ZXJ5IHRyaWdnZXIpXG4gKiBAcGFyYW0gIHtlbGVtZW50fSBlbGVtZW50ICAgRWxlbWVudCB0byB0cmlnZ2VyIG9uXG4gKiBAcGFyYW0gIHtzdHJpbmd9IGV2ZW50bmFtZSBDdXN0b20gZXZlbnQgbmFtZVxuICogQHBhcmFtICB7T2JqZWN0fSBbb2JqPXt9XSAgQ3VzdG9tIHBhcmFtZXRlcnMgdG8gcGFzcyBhbG9uZyAoZmluZCBpbiBldmVudC5kZXRhaWwpXG4gKiBAcmV0dXJuIHtudWxsfSAgICAgICAgICAgTm8gcmV0dXJuIHZhbHVlXG4gKi9cbmZ1bmN0aW9uIHRyaWdnZXIoZWxlbWVudCwgZXZlbnRuYW1lKSB7XG4gIHZhciBvYmogPSBhcmd1bWVudHMubGVuZ3RoID4gMiAmJiBhcmd1bWVudHNbMl0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1syXSA6IHt9O1xuXG4gIHZhciBldmVudCA9IHZvaWQgMDtcblxuICBpZiAod2luZG93LkN1c3RvbUV2ZW50KSB7XG4gICAgZXZlbnQgPSBuZXcgQ3VzdG9tRXZlbnQoZXZlbnRuYW1lLCB7IGRldGFpbDogb2JqIH0pO1xuICB9IGVsc2Uge1xuICAgIGV2ZW50ID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gICAgZXZlbnQuaW5pdEN1c3RvbUV2ZW50KGV2ZW50bmFtZSwgdHJ1ZSwgdHJ1ZSwgb2JqKTtcbiAgfVxuXG4gIGVsZW1lbnQuZGlzcGF0Y2hFdmVudChldmVudCk7XG59XG5cbi8qKlxuICogRGVsZWdhdGUgZXZlbnQgbGlzdGVuZXIgdG8gY2hpbGRyZW4gKG1pbWljcyBqcXVlcnkgYmVoYXZpb3IpXG4gKiAoc291cmNlOiBodHRwOi8vYmRhZGFtLmNvbS9ibG9nL3BsYWluLWphdmFzY3JpcHQtZXZlbnQtZGVsZWdhdGlvbi5odG1sKVxuICogQHBhcmFtICB7ZWxlbWVudH0gZWxlbWVudCAgRE9NIHBhcmVudCBlbGVtZW50XG4gKiBAcGFyYW0gIHtzdHJpbmd9IGV2dCAgICAgIEV2ZW50IHRvIGxpc3RlbiB0b1xuICogQHBhcmFtICB7c3RyaW5nfSBzZWxlY3RvciBTZWxlY3RvciB0byBtYXRjaCBjaGlsZHJlbiBieVxuICogQHBhcmFtICB7ZnVuY3Rpb259IGhhbmRsZXIgIEZ1bmN0aW9uIHRvIHJ1biBhcyBldmVudCBoYW5kbGVyXG4gKiBAcmV0dXJuIHtudWxsfSAgICAgICAgICBObyBSZXR1cm5cbiAqL1xuZnVuY3Rpb24gZGVsZWdhdGVFdmVudExpc3RlbmVyKGVsZW1lbnQsIGV2dCwgc2VsZWN0b3IsIGhhbmRsZXIpIHtcbiAgdmFyIGVsID0gZWxlbWVudDtcbiAgZWwuYWRkRXZlbnRMaXN0ZW5lcihldnQsIGZ1bmN0aW9uIChldmVudCkge1xuICAgIHZhciBwb3NzaWJsZVRhcmdldHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICB2YXIgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0O1xuXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBwb3NzaWJsZVRhcmdldHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICB2YXIgdCA9IHRhcmdldDtcbiAgICAgIHZhciBwID0gcG9zc2libGVUYXJnZXRzW2ldO1xuXG4gICAgICB3aGlsZSAodCAmJiB0ICE9PSBlbGVtZW50KSB7XG4gICAgICAgIGlmICh0ID09PSBwKSB7XG4gICAgICAgICAgcmV0dXJuIGhhbmRsZXIuY2FsbChwLCBldmVudCk7XG4gICAgICAgIH1cblxuICAgICAgICB0ID0gdC5wYXJlbnROb2RlO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZmFsc2U7XG4gIH0pO1xuICAvKiBlbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCBmdW5jdGlvbiBjYWxsYmFjayhldmVudCkge1xuICAgIGNvbnN0IGUgPSBldmVudCB8fCB3aW5kb3cuZXZlbnQ7XG4gICAgIGxldCB0ID0gZS50YXJnZXQ7XG4gICAgIHdoaWxlICh0ICYmIHQgIT09IHRoaXMpIHtcbiAgICAgIGNvbnNvbGUubG9nKGB3aGlsZSB0OiAke3R9YCk7XG4gICAgICBpZiAodC5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgbWF0Y2ggdDogJHt0fWApO1xuICAgICAgICBoYW5kbGVyLmNhbGwodCwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coYG91dHNpZGUgdDogJHt0fWApO1xuICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICB9XG4gIH0pO1xuICAqL1xufVxuXG59LHt9XSw1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbi8qXG4gKiBHcm91cEJ5IGZyb20gaHR0cDovL3d3dy5kYXRjaGxleS5uYW1lL2dldHRpbmctZnVuY3Rpb25hbC13aXRoLWphdmFzY3JpcHQtcGFydC0yL1xuICovXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG52YXIgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIGlzRnVuY3Rpb24obykge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn07XG5cbi8qIGVzbGludCBuby1wYXJhbS1yZWFzc2lnbjogW1wiZXJyb3JcIiwgeyBcInByb3BzXCI6IGZhbHNlIH1dKi9cbnZhciBncm91cEJ5ID0gZXhwb3J0cy5ncm91cEJ5ID0gZnVuY3Rpb24gZ3JvdXBCeShsaXN0LCBwcm9wKSB7XG4gIHJldHVybiBsaXN0LnJlZHVjZShmdW5jdGlvbiAoZ3JvdXBlZCwgaXRlbSkge1xuICAgIHZhciBrZXkgPSBpc0Z1bmN0aW9uKHByb3ApID8gcHJvcC5hcHBseSh1bmRlZmluZWQsIFtpdGVtXSkgOiBpdGVtW3Byb3BdO1xuICAgIGdyb3VwZWRba2V5XSA9IGdyb3VwZWRba2V5XSB8fCBbXTtcbiAgICBncm91cGVkW2tleV0ucHVzaChpdGVtKTtcbiAgICByZXR1cm4gZ3JvdXBlZDtcbiAgfSwge30pO1xufTtcblxufSx7fV0sNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnJlcXVpcmUoJy4vYXotc2VhcmNoJyk7XG5cbnJlcXVpcmUoJy4vc2VhcmNoJyk7XG5cbnJlcXVpcmUoJy4vcmVzdWx0cycpO1xuXG59LHtcIi4vYXotc2VhcmNoXCI6MixcIi4vcmVzdWx0c1wiOjgsXCIuL3NlYXJjaFwiOjl9XSw3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcblwidXNlIHN0cmljdFwiO1xuXG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHtcbiAgdmFsdWU6IHRydWVcbn0pO1xudmFyIHB1YnN1YiA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRvcGljcyA9IHt9O1xuXG4gIHZhciBzdWJzY3JpYmUgPSBmdW5jdGlvbiBzdWJzY3JpYmUoZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgIHRvcGljc1tldmVudE5hbWVdID0gdG9waWNzW2V2ZW50TmFtZV0gfHwgW107XG4gICAgdG9waWNzW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG4gIH07XG5cbiAgdmFyIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24gdW5zdWJzY3JpYmUoZXZlbnROYW1lLCBjYWxsYmFjaykge1xuICAgIGlmICh0b3BpY3NbZXZlbnROYW1lXSkge1xuICAgICAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IHRvcGljc1tldmVudE5hbWVdLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIGlmICh0b3BpY3NbZXZlbnROYW1lXVtpXSA9PT0gY2FsbGJhY2spIHtcbiAgICAgICAgICB0b3BpY3NbZXZlbnROYW1lXS5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH07XG5cbiAgdmFyIHB1Ymxpc2ggPSBmdW5jdGlvbiBwdWJsaXNoKGV2ZW50TmFtZSwgZGF0YSkge1xuICAgIGlmICh0b3BpY3NbZXZlbnROYW1lXSkge1xuICAgICAgdG9waWNzW2V2ZW50TmFtZV0uZm9yRWFjaChmdW5jdGlvbiAoY2FsbGJhY2spIHtcbiAgICAgICAgY2FsbGJhY2soZGF0YSk7XG4gICAgICB9KTtcbiAgICB9XG4gIH07XG5cbiAgcmV0dXJuIHtcbiAgICBzdWJzY3JpYmU6IHN1YnNjcmliZSxcbiAgICB1bnN1YnNjcmliZTogdW5zdWJzY3JpYmUsXG4gICAgcHVibGlzaDogcHVibGlzaFxuICB9O1xufSgpO1xuXG5leHBvcnRzLmRlZmF1bHQgPSBwdWJzdWI7XG5cbn0se31dLDg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX2RvbUVsZW1lbnRzID0gcmVxdWlyZSgnLi9oZWxwZXJzL2RvbS1lbGVtZW50cycpO1xuXG52YXIgX3B1YnN1YiA9IHJlcXVpcmUoJy4vcHVic3ViJyk7XG5cbnZhciBfcHVic3ViMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3B1YnN1Yik7XG5cbmZ1bmN0aW9uIF9pbnRlcm9wUmVxdWlyZURlZmF1bHQob2JqKSB7IHJldHVybiBvYmogJiYgb2JqLl9fZXNNb2R1bGUgPyBvYmogOiB7IGRlZmF1bHQ6IG9iaiB9OyB9XG5cbnZhciBwbGFjZWhvbGRlciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNqcy1zZWFyY2hfcmVzdWx0cycpO1xudmFyIGxvYWRyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWRlcicpO1xuXG5mdW5jdGlvbiBjbGVhclJlc3VsdHMoKSB7XG4gIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9ICcnO1xuICAoMCwgX2RvbUVsZW1lbnRzLnJlbW92ZUNsYXNzKShsb2FkciwgJ3UtaGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlcihwdWJvYmopIHtcbiAgdmFyIHNvbmdMaXN0ID0gcHVib2JqLnNvbmdMaXN0O1xuICB2YXIgc2VhcmNoVGVybSA9IHB1Ym9iai5zZWFyY2hUZXJtO1xuXG4gIHZhciBodG1sU3R1ZmYgPSAnJztcbiAgaHRtbFN0dWZmID0gJzxoMiBjbGFzcz1cImMtc2VhcmNoX19oZWFkaW5nXCI+U2VhcmNoIFJlc3VsdHM6IDxzcGFuIGMtc2VhcmNoX190ZXJtPicgKyBzZWFyY2hUZXJtICsgJzwvc3Bhbj48L2gyPjxzZWN0aW9uIGNsYXNzPVwiYy1zZWFyY2hfX2xpc3RcIj4nO1xuICBPYmplY3Qua2V5cyhzb25nTGlzdCkuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgaHRtbFN0dWZmICs9ICc8cCBjbGFzcz1cImMtc2VhcmNoX19hcnRpc3RcIj4nICsga2V5ICsgJzwvcD48dWw+JztcbiAgICBzb25nTGlzdFtrZXldLmZvckVhY2goZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICBodG1sU3R1ZmYgKz0gJzxsaSBjbGFzcz1cImMtc2VhcmNoX190aXRsZVwiPicgKyB2YWx1ZS50aXRsZSArICc8L2xpPic7XG4gICAgfSk7XG4gICAgaHRtbFN0dWZmICs9ICc8L3VsPic7XG4gIH0pO1xuICBodG1sU3R1ZmYgKz0gJzwvc2VjdGlvbj4nO1xuICAoMCwgX2RvbUVsZW1lbnRzLmFkZENsYXNzKShsb2FkciwgJ3UtaGlkZGVuJyk7XG4gIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9IGh0bWxTdHVmZjtcbn1cblxuX3B1YnN1YjIuZGVmYXVsdC5zdWJzY3JpYmUoJ3NlYXJjaFN0YXJ0JywgY2xlYXJSZXN1bHRzKTtcbl9wdWJzdWIyLmRlZmF1bHQuc3Vic2NyaWJlKCdzZWFyY2hDb21wbGV0ZScsIHJlbmRlcik7XG5cbn0se1wiLi9oZWxwZXJzL2RvbS1lbGVtZW50c1wiOjMsXCIuL3B1YnN1YlwiOjd9XSw5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9wdWJzdWIgPSByZXF1aXJlKCcuL3B1YnN1YicpO1xuXG52YXIgX3B1YnN1YjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wdWJzdWIpO1xuXG52YXIgX2FwaSA9IHJlcXVpcmUoJy4vYXBpJyk7XG5cbnZhciBhcGkgPSBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChfYXBpKTtcblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQob2JqKSB7IGlmIChvYmogJiYgb2JqLl9fZXNNb2R1bGUpIHsgcmV0dXJuIG9iajsgfSBlbHNlIHsgdmFyIG5ld09iaiA9IHt9OyBpZiAob2JqICE9IG51bGwpIHsgZm9yICh2YXIga2V5IGluIG9iaikgeyBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkgbmV3T2JqW2tleV0gPSBvYmpba2V5XTsgfSB9IG5ld09iai5kZWZhdWx0ID0gb2JqOyByZXR1cm4gbmV3T2JqOyB9IH1cblxuZnVuY3Rpb24gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChvYmopIHsgcmV0dXJuIG9iaiAmJiBvYmouX19lc01vZHVsZSA/IG9iaiA6IHsgZGVmYXVsdDogb2JqIH07IH1cblxudmFyIHNlYXJjaEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtc29uZ3NlYXJjaCcpO1xudmFyIHNlYXJjaElucHV0ID0gc2VhcmNoRm9ybS5xdWVyeVNlbGVjdG9yKCcjanMtc29uZ3NlYXJjaF9faW5wdXQnKTtcblxuZnVuY3Rpb24gY2xlYXJTZWFyY2goKSB7XG4gIHNlYXJjaElucHV0LnZhbHVlID0gJyc7XG59XG5cbmZ1bmN0aW9uIHNlYXJjaEhhbmRsZXIoZXZ0KSB7XG4gIHZhciBlID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIHZhciBzZWFyY2hUZXJtID0gc2VhcmNoSW5wdXQudmFsdWU7XG4gIGlmIChzZWFyY2hUZXJtICE9PSAnJykge1xuICAgIGFwaS5zZWFyY2hCeU5hbWUoc2VhcmNoVGVybSkudGhlbihmdW5jdGlvbiAoc29uZ0xpc3QpIHtcbiAgICAgIF9wdWJzdWIyLmRlZmF1bHQucHVibGlzaCgnc2VhcmNoQ29tcGxldGUnLCB7IHNvbmdMaXN0OiBzb25nTGlzdCwgc2VhcmNoVGVybTogc2VhcmNoVGVybSB9KTtcbiAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvblNlYXJjaFN0YXJ0KHBzKSB7XG4gIHZhciBwdWJzdWJPYmplY3QgPSBwcztcblxuICBpZiAocHVic3ViT2JqZWN0LmxldHRlcikge1xuICAgIGNsZWFyU2VhcmNoKCk7XG4gIH1cbn1cblxuc2VhcmNoRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzZWFyY2hIYW5kbGVyKTtcbl9wdWJzdWIyLmRlZmF1bHQuc3Vic2NyaWJlKCdzZWFyY2hTdGFydCcsIG9uU2VhcmNoU3RhcnQpO1xuLypcblxuXG5mdW5jdGlvbiBzdWNjZXNzSGFuZGxlcihkYXRhKSB7XG4gIGNvbnN0IGkgPSBfKGRhdGEpLnRvQXJyYXkoKTtcblxuICBmdXNlID0gbmV3IEZ1c2VqcyhpLCBvcHRpb25zKTsgLy8gXCJsaXN0XCIgaXMgdGhlIGl0ZW0gYXJyYXlcbn1cblxuLy8gR2V0IHRoZSBnZW5lcmF0ZWQgc2VhcmNoX2RhdGEuanNvbiBmaWxlIHNvIGx1bnIuanMgY2FuIHNlYXJjaCBpdCBsb2NhbGx5LlxuY29uc3Qgc2VhcmNoRGF0YSA9ICQuYWpheCh7XG4gIHVybDogJy4vc2VhcmNoX2RhdGEuanNvbicsXG4gIHR5cGU6ICdHRVQnLCAvLyBkZWZhdWx0IGlzIEdFVCBidXQgeW91IGNhbiB1c2Ugb3RoZXIgdmVyYnMgYmFzZWQgb24geW91ciBuZWVkcy5cbiAgZGF0YVR5cGU6ICdqc29uJywgLy8gc3BlY2lmeSB0aGUgZGF0YVR5cGUgZm9yIGZ1dHVyZSByZWZlcmVuY2Vcbn0pO1xuc2VhcmNoRGF0YS5kb25lKHN1Y2Nlc3NIYW5kbGVyKTtcblxuZnVuY3Rpb24gZGlzcGxheVNlYXJjaFJlc3VsdHMocmVzdWx0cykge1xuICBjb25zb2xlLmxvZygnc3VjY2VzcycpO1xuICBjb25zb2xlLmxvZyhyZXN1bHRzKTtcblxuICBjb25zdCAkcGxhY2Vob2xkZXIgPSAkKCcjanMtc2VhcmNoX3Jlc3VsdHMnKTtcbiAgY29uc3QgdGVzdHMgPSBfLnNvcnRCeShyZXN1bHRzLCAnYXJ0aXN0Jyk7XG4gIGNvbnN0IHRlc3RnID0gXy5ncm91cEJ5KHRlc3RzLCAnYXJ0aXN0Jyk7XG4gIGxldCBodG1sU3R1ZmYgPSAnJztcbiAgaHRtbFN0dWZmID0gJzxoMiBjbGFzcz1cImMtc2VhcmNoX19oZWFkaW5nXCI+U2VhcmNoIFJlc3VsdHM8L2gyPjxzZWN0aW9uIGNsYXNzPVwiYy1zZWFyY2hfX2xpc3RcIj4nO1xuICAkLmVhY2godGVzdGcsIChrZXksIHZhbHVlKSA9PiB7XG4gICAgY29uc29sZS5sb2coYCR7a2V5fTogYCk7XG4gICAgY29uc29sZS5sb2coYHZhbHVlID0gJHt2YWx1ZX1gKTtcbiAgICBodG1sU3R1ZmYgKz0gYDxwIGNsYXNzPVwiYy1zZWFyY2hfX2FydGlzdFwiPiR7a2V5fTwvcD48dWw+YDtcbiAgICBjb25zdCB2YWwgPSBfLnNvcnRCeSh2YWx1ZSwgJ3RpdGxlJyk7XG4gICAgJC5lYWNoKHZhbCwgKGssIHYpID0+IHtcbiAgICAgIGNvbnNvbGUubG9nKGAke2t9Ojo6JHt2LnRpdGxlfWApO1xuXG4gICAgICBodG1sU3R1ZmYgKz0gYDxsaSBjbGFzcz1cImMtc2VhcmNoX190aXRsZVwiPiR7di50aXRsZX08L2xpPmA7XG4gICAgfSk7XG4gICAgaHRtbFN0dWZmICs9ICc8L3VsPic7XG4gIH0pO1xuICBodG1sU3R1ZmYgKz0gJzwvc2VjdGlvbj4nO1xuICAkcGxhY2Vob2xkZXIuZW1wdHkoKS5hcHBlbmQoaHRtbFN0dWZmKTtcbn1cblxuJCgoKSA9PiB7XG4gIC8vIEV2ZW50IHdoZW4gdGhlIGZvcm0gaXMgc3VibWl0dGVkXG4gICQoJyNqcy1zb25nc2VhcmNoJykuc3VibWl0KChldmVudCkgPT4ge1xuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgY29uc3QgJHF1ZXJ5ID0gJCgnI2pzLXNvbmdzZWFyY2hfaW5wdXQnKS52YWwoKTsgLy8gR2V0IHRoZSB2YWx1ZSBmb3IgdGhlIHRleHQgZmllbGRcbiAgICBjb25zdCBmdXNlUmVzdWx0cyA9IGZ1c2Uuc2VhcmNoKCRxdWVyeSk7IC8vIEdldCBmdXNlLmpzIHRvIHBlcmZvcm0gYSBzZWFyY2hcblxuICAgIGRpc3BsYXlTZWFyY2hSZXN1bHRzKGZ1c2VSZXN1bHRzKTsgLy8gSGFuZCB0aGUgcmVzdWx0cyBvZmYgdG8gYmUgZGlzcGxheWVkXG4gIH0pO1xufSk7XG4qL1xuXG59LHtcIi4vYXBpXCI6MSxcIi4vcHVic3ViXCI6N31dLDEwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9saWIvYXhpb3MnKTtcbn0se1wiLi9saWIvYXhpb3NcIjoxMn1dLDExOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2Vzcyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciBzZXR0bGUgPSByZXF1aXJlKCcuLy4uL2NvcmUvc2V0dGxlJyk7XG52YXIgYnVpbGRVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnVpbGRVUkwnKTtcbnZhciBwYXJzZUhlYWRlcnMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvcGFyc2VIZWFkZXJzJyk7XG52YXIgaXNVUkxTYW1lT3JpZ2luID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2lzVVJMU2FtZU9yaWdpbicpO1xudmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnLi4vY29yZS9jcmVhdGVFcnJvcicpO1xudmFyIGJ0b2EgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmJ0b2EgJiYgd2luZG93LmJ0b2EuYmluZCh3aW5kb3cpKSB8fCByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnRvYScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHhockFkYXB0ZXIoY29uZmlnKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBkaXNwYXRjaFhoclJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIHJlcXVlc3REYXRhID0gY29uZmlnLmRhdGE7XG4gICAgdmFyIHJlcXVlc3RIZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XG5cbiAgICBpZiAodXRpbHMuaXNGb3JtRGF0YShyZXF1ZXN0RGF0YSkpIHtcbiAgICAgIGRlbGV0ZSByZXF1ZXN0SGVhZGVyc1snQ29udGVudC1UeXBlJ107IC8vIExldCB0aGUgYnJvd3NlciBzZXQgaXRcbiAgICB9XG5cbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHZhciBsb2FkRXZlbnQgPSAnb25yZWFkeXN0YXRlY2hhbmdlJztcbiAgICB2YXIgeERvbWFpbiA9IGZhbHNlO1xuXG4gICAgLy8gRm9yIElFIDgvOSBDT1JTIHN1cHBvcnRcbiAgICAvLyBPbmx5IHN1cHBvcnRzIFBPU1QgYW5kIEdFVCBjYWxscyBhbmQgZG9lc24ndCByZXR1cm5zIHRoZSByZXNwb25zZSBoZWFkZXJzLlxuICAgIC8vIERPTidUIGRvIHRoaXMgZm9yIHRlc3RpbmcgYi9jIFhNTEh0dHBSZXF1ZXN0IGlzIG1vY2tlZCwgbm90IFhEb21haW5SZXF1ZXN0LlxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnICYmXG4gICAgICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIHdpbmRvdy5YRG9tYWluUmVxdWVzdCAmJiAhKCd3aXRoQ3JlZGVudGlhbHMnIGluIHJlcXVlc3QpICYmXG4gICAgICAgICFpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpIHtcbiAgICAgIHJlcXVlc3QgPSBuZXcgd2luZG93LlhEb21haW5SZXF1ZXN0KCk7XG4gICAgICBsb2FkRXZlbnQgPSAnb25sb2FkJztcbiAgICAgIHhEb21haW4gPSB0cnVlO1xuICAgICAgcmVxdWVzdC5vbnByb2dyZXNzID0gZnVuY3Rpb24gaGFuZGxlUHJvZ3Jlc3MoKSB7fTtcbiAgICAgIHJlcXVlc3Qub250aW1lb3V0ID0gZnVuY3Rpb24gaGFuZGxlVGltZW91dCgpIHt9O1xuICAgIH1cblxuICAgIC8vIEhUVFAgYmFzaWMgYXV0aGVudGljYXRpb25cbiAgICBpZiAoY29uZmlnLmF1dGgpIHtcbiAgICAgIHZhciB1c2VybmFtZSA9IGNvbmZpZy5hdXRoLnVzZXJuYW1lIHx8ICcnO1xuICAgICAgdmFyIHBhc3N3b3JkID0gY29uZmlnLmF1dGgucGFzc3dvcmQgfHwgJyc7XG4gICAgICByZXF1ZXN0SGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0Jhc2ljICcgKyBidG9hKHVzZXJuYW1lICsgJzonICsgcGFzc3dvcmQpO1xuICAgIH1cblxuICAgIHJlcXVlc3Qub3Blbihjb25maWcubWV0aG9kLnRvVXBwZXJDYXNlKCksIGJ1aWxkVVJMKGNvbmZpZy51cmwsIGNvbmZpZy5wYXJhbXMsIGNvbmZpZy5wYXJhbXNTZXJpYWxpemVyKSwgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgdGhlIHJlcXVlc3QgdGltZW91dCBpbiBNU1xuICAgIHJlcXVlc3QudGltZW91dCA9IGNvbmZpZy50aW1lb3V0O1xuXG4gICAgLy8gTGlzdGVuIGZvciByZWFkeSBzdGF0ZVxuICAgIHJlcXVlc3RbbG9hZEV2ZW50XSA9IGZ1bmN0aW9uIGhhbmRsZUxvYWQoKSB7XG4gICAgICBpZiAoIXJlcXVlc3QgfHwgKHJlcXVlc3QucmVhZHlTdGF0ZSAhPT0gNCAmJiAheERvbWFpbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgcmVxdWVzdCBlcnJvcmVkIG91dCBhbmQgd2UgZGlkbid0IGdldCBhIHJlc3BvbnNlLCB0aGlzIHdpbGwgYmVcbiAgICAgIC8vIGhhbmRsZWQgYnkgb25lcnJvciBpbnN0ZWFkXG4gICAgICAvLyBXaXRoIG9uZSBleGNlcHRpb246IHJlcXVlc3QgdGhhdCB1c2luZyBmaWxlOiBwcm90b2NvbCwgbW9zdCBicm93c2Vyc1xuICAgICAgLy8gd2lsbCByZXR1cm4gc3RhdHVzIGFzIDAgZXZlbiB0aG91Z2ggaXQncyBhIHN1Y2Nlc3NmdWwgcmVxdWVzdFxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAwICYmICEocmVxdWVzdC5yZXNwb25zZVVSTCAmJiByZXF1ZXN0LnJlc3BvbnNlVVJMLmluZGV4T2YoJ2ZpbGU6JykgPT09IDApKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSB0aGUgcmVzcG9uc2VcbiAgICAgIHZhciByZXNwb25zZUhlYWRlcnMgPSAnZ2V0QWxsUmVzcG9uc2VIZWFkZXJzJyBpbiByZXF1ZXN0ID8gcGFyc2VIZWFkZXJzKHJlcXVlc3QuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpIDogbnVsbDtcbiAgICAgIHZhciByZXNwb25zZURhdGEgPSAhY29uZmlnLnJlc3BvbnNlVHlwZSB8fCBjb25maWcucmVzcG9uc2VUeXBlID09PSAndGV4dCcgPyByZXF1ZXN0LnJlc3BvbnNlVGV4dCA6IHJlcXVlc3QucmVzcG9uc2U7XG4gICAgICB2YXIgcmVzcG9uc2UgPSB7XG4gICAgICAgIGRhdGE6IHJlc3BvbnNlRGF0YSxcbiAgICAgICAgLy8gSUUgc2VuZHMgMTIyMyBpbnN0ZWFkIG9mIDIwNCAoaHR0cHM6Ly9naXRodWIuY29tL216YWJyaXNraWUvYXhpb3MvaXNzdWVzLzIwMSlcbiAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/ICdObyBDb250ZW50JyA6IHJlcXVlc3Quc3RhdHVzVGV4dCxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgcmVxdWVzdDogcmVxdWVzdFxuICAgICAgfTtcblxuICAgICAgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgcmVzcG9uc2UpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIGxvdyBsZXZlbCBuZXR3b3JrIGVycm9yc1xuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkge1xuICAgICAgLy8gUmVhbCBlcnJvcnMgYXJlIGhpZGRlbiBmcm9tIHVzIGJ5IHRoZSBicm93c2VyXG4gICAgICAvLyBvbmVycm9yIHNob3VsZCBvbmx5IGZpcmUgaWYgaXQncyBhIG5ldHdvcmsgZXJyb3JcbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignTmV0d29yayBFcnJvcicsIGNvbmZpZywgbnVsbCwgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRpbWVvdXRcbiAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7XG4gICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ3RpbWVvdXQgb2YgJyArIGNvbmZpZy50aW1lb3V0ICsgJ21zIGV4Y2VlZGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJyxcbiAgICAgICAgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gQWRkIHhzcmYgaGVhZGVyXG4gICAgLy8gVGhpcyBpcyBvbmx5IGRvbmUgaWYgcnVubmluZyBpbiBhIHN0YW5kYXJkIGJyb3dzZXIgZW52aXJvbm1lbnQuXG4gICAgLy8gU3BlY2lmaWNhbGx5IG5vdCBpZiB3ZSdyZSBpbiBhIHdlYiB3b3JrZXIsIG9yIHJlYWN0LW5hdGl2ZS5cbiAgICBpZiAodXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSkge1xuICAgICAgdmFyIGNvb2tpZXMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvY29va2llcycpO1xuXG4gICAgICAvLyBBZGQgeHNyZiBoZWFkZXJcbiAgICAgIHZhciB4c3JmVmFsdWUgPSAoY29uZmlnLndpdGhDcmVkZW50aWFscyB8fCBpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpICYmIGNvbmZpZy54c3JmQ29va2llTmFtZSA/XG4gICAgICAgICAgY29va2llcy5yZWFkKGNvbmZpZy54c3JmQ29va2llTmFtZSkgOlxuICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHhzcmZWYWx1ZSkge1xuICAgICAgICByZXF1ZXN0SGVhZGVyc1tjb25maWcueHNyZkhlYWRlck5hbWVdID0geHNyZlZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBoZWFkZXJzIHRvIHRoZSByZXF1ZXN0XG4gICAgaWYgKCdzZXRSZXF1ZXN0SGVhZGVyJyBpbiByZXF1ZXN0KSB7XG4gICAgICB1dGlscy5mb3JFYWNoKHJlcXVlc3RIZWFkZXJzLCBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKHZhbCwga2V5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdERhdGEgPT09ICd1bmRlZmluZWQnICYmIGtleS50b0xvd2VyQ2FzZSgpID09PSAnY29udGVudC10eXBlJykge1xuICAgICAgICAgIC8vIFJlbW92ZSBDb250ZW50LVR5cGUgaWYgZGF0YSBpcyB1bmRlZmluZWRcbiAgICAgICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2UgYWRkIGhlYWRlciB0byB0aGUgcmVxdWVzdFxuICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEFkZCB3aXRoQ3JlZGVudGlhbHMgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLndpdGhDcmVkZW50aWFscykge1xuICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIEFkZCByZXNwb25zZVR5cGUgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBjb25maWcucmVzcG9uc2VUeXBlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBFeHBlY3RlZCBET01FeGNlcHRpb24gdGhyb3duIGJ5IGJyb3dzZXJzIG5vdCBjb21wYXRpYmxlIFhNTEh0dHBSZXF1ZXN0IExldmVsIDIuXG4gICAgICAgIC8vIEJ1dCwgdGhpcyBjYW4gYmUgc3VwcHJlc3NlZCBmb3IgJ2pzb24nIHR5cGUgYXMgaXQgY2FuIGJlIHBhcnNlZCBieSBkZWZhdWx0ICd0cmFuc2Zvcm1SZXNwb25zZScgZnVuY3Rpb24uXG4gICAgICAgIGlmIChjb25maWcucmVzcG9uc2VUeXBlICE9PSAnanNvbicpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHByb2dyZXNzIGlmIG5lZWRlZFxuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uRG93bmxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIC8vIE5vdCBhbGwgYnJvd3NlcnMgc3VwcG9ydCB1cGxvYWQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiBjb25maWcub25VcGxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJyAmJiByZXF1ZXN0LnVwbG9hZCkge1xuICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25VcGxvYWRQcm9ncmVzcyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgICAgLy8gSGFuZGxlIGNhbmNlbGxhdGlvblxuICAgICAgY29uZmlnLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbiBvbkNhbmNlbGVkKGNhbmNlbCkge1xuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIHJlamVjdChjYW5jZWwpO1xuICAgICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3REYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcXVlc3REYXRhID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBTZW5kIHRoZSByZXF1ZXN0XG4gICAgcmVxdWVzdC5zZW5kKHJlcXVlc3REYXRhKTtcbiAgfSk7XG59O1xuXG59KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSlcblxufSx7XCIuLi9jb3JlL2NyZWF0ZUVycm9yXCI6MTgsXCIuLy4uL2NvcmUvc2V0dGxlXCI6MjEsXCIuLy4uL2hlbHBlcnMvYnRvYVwiOjI1LFwiLi8uLi9oZWxwZXJzL2J1aWxkVVJMXCI6MjYsXCIuLy4uL2hlbHBlcnMvY29va2llc1wiOjI4LFwiLi8uLi9oZWxwZXJzL2lzVVJMU2FtZU9yaWdpblwiOjMwLFwiLi8uLi9oZWxwZXJzL3BhcnNlSGVhZGVyc1wiOjMyLFwiLi8uLi91dGlsc1wiOjM0LFwiX3Byb2Nlc3NcIjozN31dLDEyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xudmFyIGJpbmQgPSByZXF1aXJlKCcuL2hlbHBlcnMvYmluZCcpO1xudmFyIEF4aW9zID0gcmVxdWlyZSgnLi9jb3JlL0F4aW9zJyk7XG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuL2RlZmF1bHRzJyk7XG5cbi8qKlxuICogQ3JlYXRlIGFuIGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGRlZmF1bHRDb25maWcgVGhlIGRlZmF1bHQgY29uZmlnIGZvciB0aGUgaW5zdGFuY2VcbiAqIEByZXR1cm4ge0F4aW9zfSBBIG5ldyBpbnN0YW5jZSBvZiBBeGlvc1xuICovXG5mdW5jdGlvbiBjcmVhdGVJbnN0YW5jZShkZWZhdWx0Q29uZmlnKSB7XG4gIHZhciBjb250ZXh0ID0gbmV3IEF4aW9zKGRlZmF1bHRDb25maWcpO1xuICB2YXIgaW5zdGFuY2UgPSBiaW5kKEF4aW9zLnByb3RvdHlwZS5yZXF1ZXN0LCBjb250ZXh0KTtcblxuICAvLyBDb3B5IGF4aW9zLnByb3RvdHlwZSB0byBpbnN0YW5jZVxuICB1dGlscy5leHRlbmQoaW5zdGFuY2UsIEF4aW9zLnByb3RvdHlwZSwgY29udGV4dCk7XG5cbiAgLy8gQ29weSBjb250ZXh0IHRvIGluc3RhbmNlXG4gIHV0aWxzLmV4dGVuZChpbnN0YW5jZSwgY29udGV4dCk7XG5cbiAgcmV0dXJuIGluc3RhbmNlO1xufVxuXG4vLyBDcmVhdGUgdGhlIGRlZmF1bHQgaW5zdGFuY2UgdG8gYmUgZXhwb3J0ZWRcbnZhciBheGlvcyA9IGNyZWF0ZUluc3RhbmNlKGRlZmF1bHRzKTtcblxuLy8gRXhwb3NlIEF4aW9zIGNsYXNzIHRvIGFsbG93IGNsYXNzIGluaGVyaXRhbmNlXG5heGlvcy5BeGlvcyA9IEF4aW9zO1xuXG4vLyBGYWN0b3J5IGZvciBjcmVhdGluZyBuZXcgaW5zdGFuY2VzXG5heGlvcy5jcmVhdGUgPSBmdW5jdGlvbiBjcmVhdGUoaW5zdGFuY2VDb25maWcpIHtcbiAgcmV0dXJuIGNyZWF0ZUluc3RhbmNlKHV0aWxzLm1lcmdlKGRlZmF1bHRzLCBpbnN0YW5jZUNvbmZpZykpO1xufTtcblxuLy8gRXhwb3NlIENhbmNlbCAmIENhbmNlbFRva2VuXG5heGlvcy5DYW5jZWwgPSByZXF1aXJlKCcuL2NhbmNlbC9DYW5jZWwnKTtcbmF4aW9zLkNhbmNlbFRva2VuID0gcmVxdWlyZSgnLi9jYW5jZWwvQ2FuY2VsVG9rZW4nKTtcbmF4aW9zLmlzQ2FuY2VsID0gcmVxdWlyZSgnLi9jYW5jZWwvaXNDYW5jZWwnKTtcblxuLy8gRXhwb3NlIGFsbC9zcHJlYWRcbmF4aW9zLmFsbCA9IGZ1bmN0aW9uIGFsbChwcm9taXNlcykge1xuICByZXR1cm4gUHJvbWlzZS5hbGwocHJvbWlzZXMpO1xufTtcbmF4aW9zLnNwcmVhZCA9IHJlcXVpcmUoJy4vaGVscGVycy9zcHJlYWQnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBheGlvcztcblxuLy8gQWxsb3cgdXNlIG9mIGRlZmF1bHQgaW1wb3J0IHN5bnRheCBpbiBUeXBlU2NyaXB0XG5tb2R1bGUuZXhwb3J0cy5kZWZhdWx0ID0gYXhpb3M7XG5cbn0se1wiLi9jYW5jZWwvQ2FuY2VsXCI6MTMsXCIuL2NhbmNlbC9DYW5jZWxUb2tlblwiOjE0LFwiLi9jYW5jZWwvaXNDYW5jZWxcIjoxNSxcIi4vY29yZS9BeGlvc1wiOjE2LFwiLi9kZWZhdWx0c1wiOjIzLFwiLi9oZWxwZXJzL2JpbmRcIjoyNCxcIi4vaGVscGVycy9zcHJlYWRcIjozMyxcIi4vdXRpbHNcIjozNH1dLDEzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBBIGBDYW5jZWxgIGlzIGFuIG9iamVjdCB0aGF0IGlzIHRocm93biB3aGVuIGFuIG9wZXJhdGlvbiBpcyBjYW5jZWxlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWVzc2FnZSBUaGUgbWVzc2FnZS5cbiAqL1xuZnVuY3Rpb24gQ2FuY2VsKG1lc3NhZ2UpIHtcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbn1cblxuQ2FuY2VsLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gJ0NhbmNlbCcgKyAodGhpcy5tZXNzYWdlID8gJzogJyArIHRoaXMubWVzc2FnZSA6ICcnKTtcbn07XG5cbkNhbmNlbC5wcm90b3R5cGUuX19DQU5DRUxfXyA9IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FuY2VsO1xuXG59LHt9XSwxNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBDYW5jZWwgPSByZXF1aXJlKCcuL0NhbmNlbCcpO1xuXG4vKipcbiAqIEEgYENhbmNlbFRva2VuYCBpcyBhbiBvYmplY3QgdGhhdCBjYW4gYmUgdXNlZCB0byByZXF1ZXN0IGNhbmNlbGxhdGlvbiBvZiBhbiBvcGVyYXRpb24uXG4gKlxuICogQGNsYXNzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBleGVjdXRvciBUaGUgZXhlY3V0b3IgZnVuY3Rpb24uXG4gKi9cbmZ1bmN0aW9uIENhbmNlbFRva2VuKGV4ZWN1dG9yKSB7XG4gIGlmICh0eXBlb2YgZXhlY3V0b3IgIT09ICdmdW5jdGlvbicpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdleGVjdXRvciBtdXN0IGJlIGEgZnVuY3Rpb24uJyk7XG4gIH1cblxuICB2YXIgcmVzb2x2ZVByb21pc2U7XG4gIHRoaXMucHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIHByb21pc2VFeGVjdXRvcihyZXNvbHZlKSB7XG4gICAgcmVzb2x2ZVByb21pc2UgPSByZXNvbHZlO1xuICB9KTtcblxuICB2YXIgdG9rZW4gPSB0aGlzO1xuICBleGVjdXRvcihmdW5jdGlvbiBjYW5jZWwobWVzc2FnZSkge1xuICAgIGlmICh0b2tlbi5yZWFzb24pIHtcbiAgICAgIC8vIENhbmNlbGxhdGlvbiBoYXMgYWxyZWFkeSBiZWVuIHJlcXVlc3RlZFxuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIHRva2VuLnJlYXNvbiA9IG5ldyBDYW5jZWwobWVzc2FnZSk7XG4gICAgcmVzb2x2ZVByb21pc2UodG9rZW4ucmVhc29uKTtcbiAgfSk7XG59XG5cbi8qKlxuICogVGhyb3dzIGEgYENhbmNlbGAgaWYgY2FuY2VsbGF0aW9uIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAqL1xuQ2FuY2VsVG9rZW4ucHJvdG90eXBlLnRocm93SWZSZXF1ZXN0ZWQgPSBmdW5jdGlvbiB0aHJvd0lmUmVxdWVzdGVkKCkge1xuICBpZiAodGhpcy5yZWFzb24pIHtcbiAgICB0aHJvdyB0aGlzLnJlYXNvbjtcbiAgfVxufTtcblxuLyoqXG4gKiBSZXR1cm5zIGFuIG9iamVjdCB0aGF0IGNvbnRhaW5zIGEgbmV3IGBDYW5jZWxUb2tlbmAgYW5kIGEgZnVuY3Rpb24gdGhhdCwgd2hlbiBjYWxsZWQsXG4gKiBjYW5jZWxzIHRoZSBgQ2FuY2VsVG9rZW5gLlxuICovXG5DYW5jZWxUb2tlbi5zb3VyY2UgPSBmdW5jdGlvbiBzb3VyY2UoKSB7XG4gIHZhciBjYW5jZWw7XG4gIHZhciB0b2tlbiA9IG5ldyBDYW5jZWxUb2tlbihmdW5jdGlvbiBleGVjdXRvcihjKSB7XG4gICAgY2FuY2VsID0gYztcbiAgfSk7XG4gIHJldHVybiB7XG4gICAgdG9rZW46IHRva2VuLFxuICAgIGNhbmNlbDogY2FuY2VsXG4gIH07XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhbmNlbFRva2VuO1xuXG59LHtcIi4vQ2FuY2VsXCI6MTN9XSwxNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gaXNDYW5jZWwodmFsdWUpIHtcbiAgcmV0dXJuICEhKHZhbHVlICYmIHZhbHVlLl9fQ0FOQ0VMX18pO1xufTtcblxufSx7fV0sMTY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLy4uL2RlZmF1bHRzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgSW50ZXJjZXB0b3JNYW5hZ2VyID0gcmVxdWlyZSgnLi9JbnRlcmNlcHRvck1hbmFnZXInKTtcbnZhciBkaXNwYXRjaFJlcXVlc3QgPSByZXF1aXJlKCcuL2Rpc3BhdGNoUmVxdWVzdCcpO1xudmFyIGlzQWJzb2x1dGVVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTCcpO1xudmFyIGNvbWJpbmVVUkxzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzJyk7XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGluc3RhbmNlQ29uZmlnIFRoZSBkZWZhdWx0IGNvbmZpZyBmb3IgdGhlIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIEF4aW9zKGluc3RhbmNlQ29uZmlnKSB7XG4gIHRoaXMuZGVmYXVsdHMgPSBpbnN0YW5jZUNvbmZpZztcbiAgdGhpcy5pbnRlcmNlcHRvcnMgPSB7XG4gICAgcmVxdWVzdDogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpLFxuICAgIHJlc3BvbnNlOiBuZXcgSW50ZXJjZXB0b3JNYW5hZ2VyKClcbiAgfTtcbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcgc3BlY2lmaWMgZm9yIHRoaXMgcmVxdWVzdCAobWVyZ2VkIHdpdGggdGhpcy5kZWZhdWx0cylcbiAqL1xuQXhpb3MucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiByZXF1ZXN0KGNvbmZpZykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgLy8gQWxsb3cgZm9yIGF4aW9zKCdleGFtcGxlL3VybCdbLCBjb25maWddKSBhIGxhIGZldGNoIEFQSVxuICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25maWcgPSB1dGlscy5tZXJnZSh7XG4gICAgICB1cmw6IGFyZ3VtZW50c1swXVxuICAgIH0sIGFyZ3VtZW50c1sxXSk7XG4gIH1cblxuICBjb25maWcgPSB1dGlscy5tZXJnZShkZWZhdWx0cywgdGhpcy5kZWZhdWx0cywgeyBtZXRob2Q6ICdnZXQnIH0sIGNvbmZpZyk7XG4gIGNvbmZpZy5tZXRob2QgPSBjb25maWcubWV0aG9kLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gU3VwcG9ydCBiYXNlVVJMIGNvbmZpZ1xuICBpZiAoY29uZmlnLmJhc2VVUkwgJiYgIWlzQWJzb2x1dGVVUkwoY29uZmlnLnVybCkpIHtcbiAgICBjb25maWcudXJsID0gY29tYmluZVVSTHMoY29uZmlnLmJhc2VVUkwsIGNvbmZpZy51cmwpO1xuICB9XG5cbiAgLy8gSG9vayB1cCBpbnRlcmNlcHRvcnMgbWlkZGxld2FyZVxuICB2YXIgY2hhaW4gPSBbZGlzcGF0Y2hSZXF1ZXN0LCB1bmRlZmluZWRdO1xuICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShjb25maWcpO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlcXVlc3QuZm9yRWFjaChmdW5jdGlvbiB1bnNoaWZ0UmVxdWVzdEludGVyY2VwdG9ycyhpbnRlcmNlcHRvcikge1xuICAgIGNoYWluLnVuc2hpZnQoaW50ZXJjZXB0b3IuZnVsZmlsbGVkLCBpbnRlcmNlcHRvci5yZWplY3RlZCk7XG4gIH0pO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gcHVzaFJlc3BvbnNlSW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgY2hhaW4ucHVzaChpbnRlcmNlcHRvci5mdWxmaWxsZWQsIGludGVyY2VwdG9yLnJlamVjdGVkKTtcbiAgfSk7XG5cbiAgd2hpbGUgKGNoYWluLmxlbmd0aCkge1xuICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oY2hhaW4uc2hpZnQoKSwgY2hhaW4uc2hpZnQoKSk7XG4gIH1cblxuICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8vIFByb3ZpZGUgYWxpYXNlcyBmb3Igc3VwcG9ydGVkIHJlcXVlc3QgbWV0aG9kc1xudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdvcHRpb25zJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2ROb0RhdGEobWV0aG9kKSB7XG4gIC8qZXNsaW50IGZ1bmMtbmFtZXM6MCovXG4gIEF4aW9zLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odXJsLCBjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHV0aWxzLm1lcmdlKGNvbmZpZyB8fCB7fSwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICB1cmw6IHVybFxuICAgIH0pKTtcbiAgfTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1dGlscy5tZXJnZShjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXhpb3M7XG5cbn0se1wiLi8uLi9kZWZhdWx0c1wiOjIzLFwiLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzXCI6MjcsXCIuLy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTFwiOjI5LFwiLi8uLi91dGlsc1wiOjM0LFwiLi9JbnRlcmNlcHRvck1hbmFnZXJcIjoxNyxcIi4vZGlzcGF0Y2hSZXF1ZXN0XCI6MTl9XSwxNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuZnVuY3Rpb24gSW50ZXJjZXB0b3JNYW5hZ2VyKCkge1xuICB0aGlzLmhhbmRsZXJzID0gW107XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGludGVyY2VwdG9yIHRvIHRoZSBzdGFja1xuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bGZpbGxlZCBUaGUgZnVuY3Rpb24gdG8gaGFuZGxlIGB0aGVuYCBmb3IgYSBgUHJvbWlzZWBcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlamVjdGVkIFRoZSBmdW5jdGlvbiB0byBoYW5kbGUgYHJlamVjdGAgZm9yIGEgYFByb21pc2VgXG4gKlxuICogQHJldHVybiB7TnVtYmVyfSBBbiBJRCB1c2VkIHRvIHJlbW92ZSBpbnRlcmNlcHRvciBsYXRlclxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLnVzZSA9IGZ1bmN0aW9uIHVzZShmdWxmaWxsZWQsIHJlamVjdGVkKSB7XG4gIHRoaXMuaGFuZGxlcnMucHVzaCh7XG4gICAgZnVsZmlsbGVkOiBmdWxmaWxsZWQsXG4gICAgcmVqZWN0ZWQ6IHJlamVjdGVkXG4gIH0pO1xuICByZXR1cm4gdGhpcy5oYW5kbGVycy5sZW5ndGggLSAxO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYW4gaW50ZXJjZXB0b3IgZnJvbSB0aGUgc3RhY2tcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gaWQgVGhlIElEIHRoYXQgd2FzIHJldHVybmVkIGJ5IGB1c2VgXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUuZWplY3QgPSBmdW5jdGlvbiBlamVjdChpZCkge1xuICBpZiAodGhpcy5oYW5kbGVyc1tpZF0pIHtcbiAgICB0aGlzLmhhbmRsZXJzW2lkXSA9IG51bGw7XG4gIH1cbn07XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFsbCB0aGUgcmVnaXN0ZXJlZCBpbnRlcmNlcHRvcnNcbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIGZvciBza2lwcGluZyBvdmVyIGFueVxuICogaW50ZXJjZXB0b3JzIHRoYXQgbWF5IGhhdmUgYmVjb21lIGBudWxsYCBjYWxsaW5nIGBlamVjdGAuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2ggaW50ZXJjZXB0b3JcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gZm9yRWFjaChmbikge1xuICB1dGlscy5mb3JFYWNoKHRoaXMuaGFuZGxlcnMsIGZ1bmN0aW9uIGZvckVhY2hIYW5kbGVyKGgpIHtcbiAgICBpZiAoaCAhPT0gbnVsbCkge1xuICAgICAgZm4oaCk7XG4gICAgfVxuICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW50ZXJjZXB0b3JNYW5hZ2VyO1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDE4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIGVuaGFuY2VFcnJvciA9IHJlcXVpcmUoJy4vZW5oYW5jZUVycm9yJyk7XG5cbi8qKlxuICogQ3JlYXRlIGFuIEVycm9yIHdpdGggdGhlIHNwZWNpZmllZCBtZXNzYWdlLCBjb25maWcsIGVycm9yIGNvZGUsIHJlcXVlc3QgYW5kIHJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSBtZXNzYWdlIFRoZSBlcnJvciBtZXNzYWdlLlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnLlxuICogQHBhcmFtIHtzdHJpbmd9IFtjb2RlXSBUaGUgZXJyb3IgY29kZSAoZm9yIGV4YW1wbGUsICdFQ09OTkFCT1JURUQnKS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVxdWVzdF0gVGhlIHJlcXVlc3QuXG4gKiBAcGFyYW0ge09iamVjdH0gW3Jlc3BvbnNlXSBUaGUgcmVzcG9uc2UuXG4gKiBAcmV0dXJucyB7RXJyb3J9IFRoZSBjcmVhdGVkIGVycm9yLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNyZWF0ZUVycm9yKG1lc3NhZ2UsIGNvbmZpZywgY29kZSwgcmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgdmFyIGVycm9yID0gbmV3IEVycm9yKG1lc3NhZ2UpO1xuICByZXR1cm4gZW5oYW5jZUVycm9yKGVycm9yLCBjb25maWcsIGNvZGUsIHJlcXVlc3QsIHJlc3BvbnNlKTtcbn07XG5cbn0se1wiLi9lbmhhbmNlRXJyb3JcIjoyMH1dLDE5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xudmFyIHRyYW5zZm9ybURhdGEgPSByZXF1aXJlKCcuL3RyYW5zZm9ybURhdGEnKTtcbnZhciBpc0NhbmNlbCA9IHJlcXVpcmUoJy4uL2NhbmNlbC9pc0NhbmNlbCcpO1xudmFyIGRlZmF1bHRzID0gcmVxdWlyZSgnLi4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBUaHJvd3MgYSBgQ2FuY2VsYCBpZiBjYW5jZWxsYXRpb24gaGFzIGJlZW4gcmVxdWVzdGVkLlxuICovXG5mdW5jdGlvbiB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZykge1xuICBpZiAoY29uZmlnLmNhbmNlbFRva2VuKSB7XG4gICAgY29uZmlnLmNhbmNlbFRva2VuLnRocm93SWZSZXF1ZXN0ZWQoKTtcbiAgfVxufVxuXG4vKipcbiAqIERpc3BhdGNoIGEgcmVxdWVzdCB0byB0aGUgc2VydmVyIHVzaW5nIHRoZSBjb25maWd1cmVkIGFkYXB0ZXIuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHRoYXQgaXMgdG8gYmUgdXNlZCBmb3IgdGhlIHJlcXVlc3RcbiAqIEByZXR1cm5zIHtQcm9taXNlfSBUaGUgUHJvbWlzZSB0byBiZSBmdWxmaWxsZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkaXNwYXRjaFJlcXVlc3QoY29uZmlnKSB7XG4gIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKTtcblxuICAvLyBFbnN1cmUgaGVhZGVycyBleGlzdFxuICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuXG4gIC8vIFRyYW5zZm9ybSByZXF1ZXN0IGRhdGFcbiAgY29uZmlnLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgIGNvbmZpZy5kYXRhLFxuICAgIGNvbmZpZy5oZWFkZXJzLFxuICAgIGNvbmZpZy50cmFuc2Zvcm1SZXF1ZXN0XG4gICk7XG5cbiAgLy8gRmxhdHRlbiBoZWFkZXJzXG4gIGNvbmZpZy5oZWFkZXJzID0gdXRpbHMubWVyZ2UoXG4gICAgY29uZmlnLmhlYWRlcnMuY29tbW9uIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzW2NvbmZpZy5tZXRob2RdIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzIHx8IHt9XG4gICk7XG5cbiAgdXRpbHMuZm9yRWFjaChcbiAgICBbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdwb3N0JywgJ3B1dCcsICdwYXRjaCcsICdjb21tb24nXSxcbiAgICBmdW5jdGlvbiBjbGVhbkhlYWRlckNvbmZpZyhtZXRob2QpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcuaGVhZGVyc1ttZXRob2RdO1xuICAgIH1cbiAgKTtcblxuICB2YXIgYWRhcHRlciA9IGNvbmZpZy5hZGFwdGVyIHx8IGRlZmF1bHRzLmFkYXB0ZXI7XG5cbiAgcmV0dXJuIGFkYXB0ZXIoY29uZmlnKS50aGVuKGZ1bmN0aW9uIG9uQWRhcHRlclJlc29sdXRpb24ocmVzcG9uc2UpIHtcbiAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgIHJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgcmVzcG9uc2UuZGF0YSxcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2VcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9LCBmdW5jdGlvbiBvbkFkYXB0ZXJSZWplY3Rpb24ocmVhc29uKSB7XG4gICAgaWYgKCFpc0NhbmNlbChyZWFzb24pKSB7XG4gICAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSByZXNwb25zZSBkYXRhXG4gICAgICBpZiAocmVhc29uICYmIHJlYXNvbi5yZXNwb25zZSkge1xuICAgICAgICByZWFzb24ucmVzcG9uc2UuZGF0YSA9IHRyYW5zZm9ybURhdGEoXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEsXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlYXNvbik7XG4gIH0pO1xufTtcblxufSx7XCIuLi9jYW5jZWwvaXNDYW5jZWxcIjoxNSxcIi4uL2RlZmF1bHRzXCI6MjMsXCIuLy4uL3V0aWxzXCI6MzQsXCIuL3RyYW5zZm9ybURhdGFcIjoyMn1dLDIwOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVcGRhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIGNvbmZpZywgZXJyb3IgY29kZSwgYW5kIHJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIFRoZSBlcnJvciB0byB1cGRhdGUuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGVycm9yLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICBlcnJvci5jb25maWcgPSBjb25maWc7XG4gIGlmIChjb2RlKSB7XG4gICAgZXJyb3IuY29kZSA9IGNvZGU7XG4gIH1cbiAgZXJyb3IucmVxdWVzdCA9IHJlcXVlc3Q7XG4gIGVycm9yLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gIHJldHVybiBlcnJvcjtcbn07XG5cbn0se31dLDIxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnLi9jcmVhdGVFcnJvcicpO1xuXG4vKipcbiAqIFJlc29sdmUgb3IgcmVqZWN0IGEgUHJvbWlzZSBiYXNlZCBvbiByZXNwb25zZSBzdGF0dXMuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZSBBIGZ1bmN0aW9uIHRoYXQgcmVzb2x2ZXMgdGhlIHByb21pc2UuXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWplY3QgQSBmdW5jdGlvbiB0aGF0IHJlamVjdHMgdGhlIHByb21pc2UuXG4gKiBAcGFyYW0ge29iamVjdH0gcmVzcG9uc2UgVGhlIHJlc3BvbnNlLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKSB7XG4gIHZhciB2YWxpZGF0ZVN0YXR1cyA9IHJlc3BvbnNlLmNvbmZpZy52YWxpZGF0ZVN0YXR1cztcbiAgLy8gTm90ZTogc3RhdHVzIGlzIG5vdCBleHBvc2VkIGJ5IFhEb21haW5SZXF1ZXN0XG4gIGlmICghcmVzcG9uc2Uuc3RhdHVzIHx8ICF2YWxpZGF0ZVN0YXR1cyB8fCB2YWxpZGF0ZVN0YXR1cyhyZXNwb25zZS5zdGF0dXMpKSB7XG4gICAgcmVzb2x2ZShyZXNwb25zZSk7XG4gIH0gZWxzZSB7XG4gICAgcmVqZWN0KGNyZWF0ZUVycm9yKFxuICAgICAgJ1JlcXVlc3QgZmFpbGVkIHdpdGggc3RhdHVzIGNvZGUgJyArIHJlc3BvbnNlLnN0YXR1cyxcbiAgICAgIHJlc3BvbnNlLmNvbmZpZyxcbiAgICAgIG51bGwsXG4gICAgICByZXNwb25zZS5yZXF1ZXN0LFxuICAgICAgcmVzcG9uc2VcbiAgICApKTtcbiAgfVxufTtcblxufSx7XCIuL2NyZWF0ZUVycm9yXCI6MTh9XSwyMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuLyoqXG4gKiBUcmFuc2Zvcm0gdGhlIGRhdGEgZm9yIGEgcmVxdWVzdCBvciBhIHJlc3BvbnNlXG4gKlxuICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBkYXRhIFRoZSBkYXRhIHRvIGJlIHRyYW5zZm9ybWVkXG4gKiBAcGFyYW0ge0FycmF5fSBoZWFkZXJzIFRoZSBoZWFkZXJzIGZvciB0aGUgcmVxdWVzdCBvciByZXNwb25zZVxuICogQHBhcmFtIHtBcnJheXxGdW5jdGlvbn0gZm5zIEEgc2luZ2xlIGZ1bmN0aW9uIG9yIEFycmF5IG9mIGZ1bmN0aW9uc1xuICogQHJldHVybnMgeyp9IFRoZSByZXN1bHRpbmcgdHJhbnNmb3JtZWQgZGF0YVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHRyYW5zZm9ybURhdGEoZGF0YSwgaGVhZGVycywgZm5zKSB7XG4gIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICB1dGlscy5mb3JFYWNoKGZucywgZnVuY3Rpb24gdHJhbnNmb3JtKGZuKSB7XG4gICAgZGF0YSA9IGZuKGRhdGEsIGhlYWRlcnMpO1xuICB9KTtcblxuICByZXR1cm4gZGF0YTtcbn07XG5cbn0se1wiLi8uLi91dGlsc1wiOjM0fV0sMjM6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuKGZ1bmN0aW9uIChwcm9jZXNzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi91dGlscycpO1xudmFyIG5vcm1hbGl6ZUhlYWRlck5hbWUgPSByZXF1aXJlKCcuL2hlbHBlcnMvbm9ybWFsaXplSGVhZGVyTmFtZScpO1xuXG52YXIgREVGQVVMVF9DT05URU5UX1RZUEUgPSB7XG4gICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkJ1xufTtcblxuZnVuY3Rpb24gc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsIHZhbHVlKSB7XG4gIGlmICghdXRpbHMuaXNVbmRlZmluZWQoaGVhZGVycykgJiYgdXRpbHMuaXNVbmRlZmluZWQoaGVhZGVyc1snQ29udGVudC1UeXBlJ10pKSB7XG4gICAgaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSB2YWx1ZTtcbiAgfVxufVxuXG5mdW5jdGlvbiBnZXREZWZhdWx0QWRhcHRlcigpIHtcbiAgdmFyIGFkYXB0ZXI7XG4gIGlmICh0eXBlb2YgWE1MSHR0cFJlcXVlc3QgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgLy8gRm9yIGJyb3dzZXJzIHVzZSBYSFIgYWRhcHRlclxuICAgIGFkYXB0ZXIgPSByZXF1aXJlKCcuL2FkYXB0ZXJzL3hocicpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIEZvciBub2RlIHVzZSBIVFRQIGFkYXB0ZXJcbiAgICBhZGFwdGVyID0gcmVxdWlyZSgnLi9hZGFwdGVycy9odHRwJyk7XG4gIH1cbiAgcmV0dXJuIGFkYXB0ZXI7XG59XG5cbnZhciBkZWZhdWx0cyA9IHtcbiAgYWRhcHRlcjogZ2V0RGVmYXVsdEFkYXB0ZXIoKSxcblxuICB0cmFuc2Zvcm1SZXF1ZXN0OiBbZnVuY3Rpb24gdHJhbnNmb3JtUmVxdWVzdChkYXRhLCBoZWFkZXJzKSB7XG4gICAgbm9ybWFsaXplSGVhZGVyTmFtZShoZWFkZXJzLCAnQ29udGVudC1UeXBlJyk7XG4gICAgaWYgKHV0aWxzLmlzRm9ybURhdGEoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzQXJyYXlCdWZmZXIoZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzQnVmZmVyKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc1N0cmVhbShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNGaWxlKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0Jsb2IoZGF0YSlcbiAgICApIHtcbiAgICAgIHJldHVybiBkYXRhO1xuICAgIH1cbiAgICBpZiAodXRpbHMuaXNBcnJheUJ1ZmZlclZpZXcoZGF0YSkpIHtcbiAgICAgIHJldHVybiBkYXRhLmJ1ZmZlcjtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzVVJMU2VhcmNoUGFyYW1zKGRhdGEpKSB7XG4gICAgICBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDtjaGFyc2V0PXV0Zi04Jyk7XG4gICAgICByZXR1cm4gZGF0YS50b1N0cmluZygpO1xuICAgIH1cbiAgICBpZiAodXRpbHMuaXNPYmplY3QoZGF0YSkpIHtcbiAgICAgIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCAnYXBwbGljYXRpb24vanNvbjtjaGFyc2V0PXV0Zi04Jyk7XG4gICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoZGF0YSk7XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XSxcblxuICB0cmFuc2Zvcm1SZXNwb25zZTogW2Z1bmN0aW9uIHRyYW5zZm9ybVJlc3BvbnNlKGRhdGEpIHtcbiAgICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdzdHJpbmcnKSB7XG4gICAgICB0cnkge1xuICAgICAgICBkYXRhID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHsgLyogSWdub3JlICovIH1cbiAgICB9XG4gICAgcmV0dXJuIGRhdGE7XG4gIH1dLFxuXG4gIHRpbWVvdXQ6IDAsXG5cbiAgeHNyZkNvb2tpZU5hbWU6ICdYU1JGLVRPS0VOJyxcbiAgeHNyZkhlYWRlck5hbWU6ICdYLVhTUkYtVE9LRU4nLFxuXG4gIG1heENvbnRlbnRMZW5ndGg6IC0xLFxuXG4gIHZhbGlkYXRlU3RhdHVzOiBmdW5jdGlvbiB2YWxpZGF0ZVN0YXR1cyhzdGF0dXMpIHtcbiAgICByZXR1cm4gc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDA7XG4gIH1cbn07XG5cbmRlZmF1bHRzLmhlYWRlcnMgPSB7XG4gIGNvbW1vbjoge1xuICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbiwgdGV4dC9wbGFpbiwgKi8qJ1xuICB9XG59O1xuXG51dGlscy5mb3JFYWNoKFsnZGVsZXRlJywgJ2dldCcsICdoZWFkJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2ROb0RhdGEobWV0aG9kKSB7XG4gIGRlZmF1bHRzLmhlYWRlcnNbbWV0aG9kXSA9IHt9O1xufSk7XG5cbnV0aWxzLmZvckVhY2goWydwb3N0JywgJ3B1dCcsICdwYXRjaCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kV2l0aERhdGEobWV0aG9kKSB7XG4gIGRlZmF1bHRzLmhlYWRlcnNbbWV0aG9kXSA9IHV0aWxzLm1lcmdlKERFRkFVTFRfQ09OVEVOVF9UWVBFKTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGRlZmF1bHRzO1xuXG59KS5jYWxsKHRoaXMscmVxdWlyZSgnX3Byb2Nlc3MnKSlcblxufSx7XCIuL2FkYXB0ZXJzL2h0dHBcIjoxMSxcIi4vYWRhcHRlcnMveGhyXCI6MTEsXCIuL2hlbHBlcnMvbm9ybWFsaXplSGVhZGVyTmFtZVwiOjMxLFwiLi91dGlsc1wiOjM0LFwiX3Byb2Nlc3NcIjozN31dLDI0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBiaW5kKGZuLCB0aGlzQXJnKSB7XG4gIHJldHVybiBmdW5jdGlvbiB3cmFwKCkge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICB9O1xufTtcblxufSx7fV0sMjU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG4vLyBidG9hIHBvbHlmaWxsIGZvciBJRTwxMCBjb3VydGVzeSBodHRwczovL2dpdGh1Yi5jb20vZGF2aWRjaGFtYmVycy9CYXNlNjQuanNcblxudmFyIGNoYXJzID0gJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5Ky89JztcblxuZnVuY3Rpb24gRSgpIHtcbiAgdGhpcy5tZXNzYWdlID0gJ1N0cmluZyBjb250YWlucyBhbiBpbnZhbGlkIGNoYXJhY3Rlcic7XG59XG5FLnByb3RvdHlwZSA9IG5ldyBFcnJvcjtcbkUucHJvdG90eXBlLmNvZGUgPSA1O1xuRS5wcm90b3R5cGUubmFtZSA9ICdJbnZhbGlkQ2hhcmFjdGVyRXJyb3InO1xuXG5mdW5jdGlvbiBidG9hKGlucHV0KSB7XG4gIHZhciBzdHIgPSBTdHJpbmcoaW5wdXQpO1xuICB2YXIgb3V0cHV0ID0gJyc7XG4gIGZvciAoXG4gICAgLy8gaW5pdGlhbGl6ZSByZXN1bHQgYW5kIGNvdW50ZXJcbiAgICB2YXIgYmxvY2ssIGNoYXJDb2RlLCBpZHggPSAwLCBtYXAgPSBjaGFycztcbiAgICAvLyBpZiB0aGUgbmV4dCBzdHIgaW5kZXggZG9lcyBub3QgZXhpc3Q6XG4gICAgLy8gICBjaGFuZ2UgdGhlIG1hcHBpbmcgdGFibGUgdG8gXCI9XCJcbiAgICAvLyAgIGNoZWNrIGlmIGQgaGFzIG5vIGZyYWN0aW9uYWwgZGlnaXRzXG4gICAgc3RyLmNoYXJBdChpZHggfCAwKSB8fCAobWFwID0gJz0nLCBpZHggJSAxKTtcbiAgICAvLyBcIjggLSBpZHggJSAxICogOFwiIGdlbmVyYXRlcyB0aGUgc2VxdWVuY2UgMiwgNCwgNiwgOFxuICAgIG91dHB1dCArPSBtYXAuY2hhckF0KDYzICYgYmxvY2sgPj4gOCAtIGlkeCAlIDEgKiA4KVxuICApIHtcbiAgICBjaGFyQ29kZSA9IHN0ci5jaGFyQ29kZUF0KGlkeCArPSAzIC8gNCk7XG4gICAgaWYgKGNoYXJDb2RlID4gMHhGRikge1xuICAgICAgdGhyb3cgbmV3IEUoKTtcbiAgICB9XG4gICAgYmxvY2sgPSBibG9jayA8PCA4IHwgY2hhckNvZGU7XG4gIH1cbiAgcmV0dXJuIG91dHB1dDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBidG9hO1xuXG59LHt9XSwyNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuZnVuY3Rpb24gZW5jb2RlKHZhbCkge1xuICByZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHZhbCkuXG4gICAgcmVwbGFjZSgvJTQwL2dpLCAnQCcpLlxuICAgIHJlcGxhY2UoLyUzQS9naSwgJzonKS5cbiAgICByZXBsYWNlKC8lMjQvZywgJyQnKS5cbiAgICByZXBsYWNlKC8lMkMvZ2ksICcsJykuXG4gICAgcmVwbGFjZSgvJTIwL2csICcrJykuXG4gICAgcmVwbGFjZSgvJTVCL2dpLCAnWycpLlxuICAgIHJlcGxhY2UoLyU1RC9naSwgJ10nKTtcbn1cblxuLyoqXG4gKiBCdWlsZCBhIFVSTCBieSBhcHBlbmRpbmcgcGFyYW1zIHRvIHRoZSBlbmRcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBiYXNlIG9mIHRoZSB1cmwgKGUuZy4sIGh0dHA6Ly93d3cuZ29vZ2xlLmNvbSlcbiAqIEBwYXJhbSB7b2JqZWN0fSBbcGFyYW1zXSBUaGUgcGFyYW1zIHRvIGJlIGFwcGVuZGVkXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgZm9ybWF0dGVkIHVybFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGJ1aWxkVVJMKHVybCwgcGFyYW1zLCBwYXJhbXNTZXJpYWxpemVyKSB7XG4gIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICBpZiAoIXBhcmFtcykge1xuICAgIHJldHVybiB1cmw7XG4gIH1cblxuICB2YXIgc2VyaWFsaXplZFBhcmFtcztcbiAgaWYgKHBhcmFtc1NlcmlhbGl6ZXIpIHtcbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFyYW1zU2VyaWFsaXplcihwYXJhbXMpO1xuICB9IGVsc2UgaWYgKHV0aWxzLmlzVVJMU2VhcmNoUGFyYW1zKHBhcmFtcykpIHtcbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFyYW1zLnRvU3RyaW5nKCk7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHBhcnRzID0gW107XG5cbiAgICB1dGlscy5mb3JFYWNoKHBhcmFtcywgZnVuY3Rpb24gc2VyaWFsaXplKHZhbCwga2V5KSB7XG4gICAgICBpZiAodmFsID09PSBudWxsIHx8IHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgaWYgKHV0aWxzLmlzQXJyYXkodmFsKSkge1xuICAgICAgICBrZXkgPSBrZXkgKyAnW10nO1xuICAgICAgfVxuXG4gICAgICBpZiAoIXV0aWxzLmlzQXJyYXkodmFsKSkge1xuICAgICAgICB2YWwgPSBbdmFsXTtcbiAgICAgIH1cblxuICAgICAgdXRpbHMuZm9yRWFjaCh2YWwsIGZ1bmN0aW9uIHBhcnNlVmFsdWUodikge1xuICAgICAgICBpZiAodXRpbHMuaXNEYXRlKHYpKSB7XG4gICAgICAgICAgdiA9IHYudG9JU09TdHJpbmcoKTtcbiAgICAgICAgfSBlbHNlIGlmICh1dGlscy5pc09iamVjdCh2KSkge1xuICAgICAgICAgIHYgPSBKU09OLnN0cmluZ2lmeSh2KTtcbiAgICAgICAgfVxuICAgICAgICBwYXJ0cy5wdXNoKGVuY29kZShrZXkpICsgJz0nICsgZW5jb2RlKHYpKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgc2VyaWFsaXplZFBhcmFtcyA9IHBhcnRzLmpvaW4oJyYnKTtcbiAgfVxuXG4gIGlmIChzZXJpYWxpemVkUGFyYW1zKSB7XG4gICAgdXJsICs9ICh1cmwuaW5kZXhPZignPycpID09PSAtMSA/ICc/JyA6ICcmJykgKyBzZXJpYWxpemVkUGFyYW1zO1xuICB9XG5cbiAgcmV0dXJuIHVybDtcbn07XG5cbn0se1wiLi8uLi91dGlsc1wiOjM0fV0sMjc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG4vKipcbiAqIENyZWF0ZXMgYSBuZXcgVVJMIGJ5IGNvbWJpbmluZyB0aGUgc3BlY2lmaWVkIFVSTHNcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gYmFzZVVSTCBUaGUgYmFzZSBVUkxcbiAqIEBwYXJhbSB7c3RyaW5nfSByZWxhdGl2ZVVSTCBUaGUgcmVsYXRpdmUgVVJMXG4gKiBAcmV0dXJucyB7c3RyaW5nfSBUaGUgY29tYmluZWQgVVJMXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY29tYmluZVVSTHMoYmFzZVVSTCwgcmVsYXRpdmVVUkwpIHtcbiAgcmV0dXJuIHJlbGF0aXZlVVJMXG4gICAgPyBiYXNlVVJMLnJlcGxhY2UoL1xcLyskLywgJycpICsgJy8nICsgcmVsYXRpdmVVUkwucmVwbGFjZSgvXlxcLysvLCAnJylcbiAgICA6IGJhc2VVUkw7XG59O1xuXG59LHt9XSwyODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoXG4gIHV0aWxzLmlzU3RhbmRhcmRCcm93c2VyRW52KCkgP1xuXG4gIC8vIFN0YW5kYXJkIGJyb3dzZXIgZW52cyBzdXBwb3J0IGRvY3VtZW50LmNvb2tpZVxuICAoZnVuY3Rpb24gc3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHJldHVybiB7XG4gICAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUobmFtZSwgdmFsdWUsIGV4cGlyZXMsIHBhdGgsIGRvbWFpbiwgc2VjdXJlKSB7XG4gICAgICAgIHZhciBjb29raWUgPSBbXTtcbiAgICAgICAgY29va2llLnB1c2gobmFtZSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkpO1xuXG4gICAgICAgIGlmICh1dGlscy5pc051bWJlcihleHBpcmVzKSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdleHBpcmVzPScgKyBuZXcgRGF0ZShleHBpcmVzKS50b0dNVFN0cmluZygpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1dGlscy5pc1N0cmluZyhwYXRoKSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdwYXRoPScgKyBwYXRoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh1dGlscy5pc1N0cmluZyhkb21haW4pKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ2RvbWFpbj0nICsgZG9tYWluKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChzZWN1cmUgPT09IHRydWUpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgnc2VjdXJlJyk7XG4gICAgICAgIH1cblxuICAgICAgICBkb2N1bWVudC5jb29raWUgPSBjb29raWUuam9pbignOyAnKTtcbiAgICAgIH0sXG5cbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQobmFtZSkge1xuICAgICAgICB2YXIgbWF0Y2ggPSBkb2N1bWVudC5jb29raWUubWF0Y2gobmV3IFJlZ0V4cCgnKF58O1xcXFxzKikoJyArIG5hbWUgKyAnKT0oW147XSopJykpO1xuICAgICAgICByZXR1cm4gKG1hdGNoID8gZGVjb2RlVVJJQ29tcG9uZW50KG1hdGNoWzNdKSA6IG51bGwpO1xuICAgICAgfSxcblxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUobmFtZSkge1xuICAgICAgICB0aGlzLndyaXRlKG5hbWUsICcnLCBEYXRlLm5vdygpIC0gODY0MDAwMDApO1xuICAgICAgfVxuICAgIH07XG4gIH0pKCkgOlxuXG4gIC8vIE5vbiBzdGFuZGFyZCBicm93c2VyIGVudiAod2ViIHdvcmtlcnMsIHJlYWN0LW5hdGl2ZSkgbGFjayBuZWVkZWQgc3VwcG9ydC5cbiAgKGZ1bmN0aW9uIG5vblN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKCkge30sXG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKCkgeyByZXR1cm4gbnVsbDsgfSxcbiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKCkge31cbiAgICB9O1xuICB9KSgpXG4pO1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDI5OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGVcbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsIFRoZSBVUkwgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHNwZWNpZmllZCBVUkwgaXMgYWJzb2x1dGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQWJzb2x1dGVVUkwodXJsKSB7XG4gIC8vIEEgVVJMIGlzIGNvbnNpZGVyZWQgYWJzb2x1dGUgaWYgaXQgYmVnaW5zIHdpdGggXCI8c2NoZW1lPjovL1wiIG9yIFwiLy9cIiAocHJvdG9jb2wtcmVsYXRpdmUgVVJMKS5cbiAgLy8gUkZDIDM5ODYgZGVmaW5lcyBzY2hlbWUgbmFtZSBhcyBhIHNlcXVlbmNlIG9mIGNoYXJhY3RlcnMgYmVnaW5uaW5nIHdpdGggYSBsZXR0ZXIgYW5kIGZvbGxvd2VkXG4gIC8vIGJ5IGFueSBjb21iaW5hdGlvbiBvZiBsZXR0ZXJzLCBkaWdpdHMsIHBsdXMsIHBlcmlvZCwgb3IgaHlwaGVuLlxuICByZXR1cm4gL14oW2Etel1bYS16XFxkXFwrXFwtXFwuXSo6KT9cXC9cXC8vaS50ZXN0KHVybCk7XG59O1xuXG59LHt9XSwzMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoXG4gIHV0aWxzLmlzU3RhbmRhcmRCcm93c2VyRW52KCkgP1xuXG4gIC8vIFN0YW5kYXJkIGJyb3dzZXIgZW52cyBoYXZlIGZ1bGwgc3VwcG9ydCBvZiB0aGUgQVBJcyBuZWVkZWQgdG8gdGVzdFxuICAvLyB3aGV0aGVyIHRoZSByZXF1ZXN0IFVSTCBpcyBvZiB0aGUgc2FtZSBvcmlnaW4gYXMgY3VycmVudCBsb2NhdGlvbi5cbiAgKGZ1bmN0aW9uIHN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICB2YXIgbXNpZSA9IC8obXNpZXx0cmlkZW50KS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XG4gICAgdmFyIHVybFBhcnNpbmdOb2RlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnYScpO1xuICAgIHZhciBvcmlnaW5VUkw7XG5cbiAgICAvKipcbiAgICAqIFBhcnNlIGEgVVJMIHRvIGRpc2NvdmVyIGl0J3MgY29tcG9uZW50c1xuICAgICpcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSB1cmwgVGhlIFVSTCB0byBiZSBwYXJzZWRcbiAgICAqIEByZXR1cm5zIHtPYmplY3R9XG4gICAgKi9cbiAgICBmdW5jdGlvbiByZXNvbHZlVVJMKHVybCkge1xuICAgICAgdmFyIGhyZWYgPSB1cmw7XG5cbiAgICAgIGlmIChtc2llKSB7XG4gICAgICAgIC8vIElFIG5lZWRzIGF0dHJpYnV0ZSBzZXQgdHdpY2UgdG8gbm9ybWFsaXplIHByb3BlcnRpZXNcbiAgICAgICAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgaHJlZik7XG4gICAgICAgIGhyZWYgPSB1cmxQYXJzaW5nTm9kZS5ocmVmO1xuICAgICAgfVxuXG4gICAgICB1cmxQYXJzaW5nTm9kZS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcblxuICAgICAgLy8gdXJsUGFyc2luZ05vZGUgcHJvdmlkZXMgdGhlIFVybFV0aWxzIGludGVyZmFjZSAtIGh0dHA6Ly91cmwuc3BlYy53aGF0d2cub3JnLyN1cmx1dGlsc1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaHJlZjogdXJsUGFyc2luZ05vZGUuaHJlZixcbiAgICAgICAgcHJvdG9jb2w6IHVybFBhcnNpbmdOb2RlLnByb3RvY29sID8gdXJsUGFyc2luZ05vZGUucHJvdG9jb2wucmVwbGFjZSgvOiQvLCAnJykgOiAnJyxcbiAgICAgICAgaG9zdDogdXJsUGFyc2luZ05vZGUuaG9zdCxcbiAgICAgICAgc2VhcmNoOiB1cmxQYXJzaW5nTm9kZS5zZWFyY2ggPyB1cmxQYXJzaW5nTm9kZS5zZWFyY2gucmVwbGFjZSgvXlxcPy8sICcnKSA6ICcnLFxuICAgICAgICBoYXNoOiB1cmxQYXJzaW5nTm9kZS5oYXNoID8gdXJsUGFyc2luZ05vZGUuaGFzaC5yZXBsYWNlKC9eIy8sICcnKSA6ICcnLFxuICAgICAgICBob3N0bmFtZTogdXJsUGFyc2luZ05vZGUuaG9zdG5hbWUsXG4gICAgICAgIHBvcnQ6IHVybFBhcnNpbmdOb2RlLnBvcnQsXG4gICAgICAgIHBhdGhuYW1lOiAodXJsUGFyc2luZ05vZGUucGF0aG5hbWUuY2hhckF0KDApID09PSAnLycpID9cbiAgICAgICAgICAgICAgICAgIHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lIDpcbiAgICAgICAgICAgICAgICAgICcvJyArIHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lXG4gICAgICB9O1xuICAgIH1cblxuICAgIG9yaWdpblVSTCA9IHJlc29sdmVVUkwod2luZG93LmxvY2F0aW9uLmhyZWYpO1xuXG4gICAgLyoqXG4gICAgKiBEZXRlcm1pbmUgaWYgYSBVUkwgc2hhcmVzIHRoZSBzYW1lIG9yaWdpbiBhcyB0aGUgY3VycmVudCBsb2NhdGlvblxuICAgICpcbiAgICAqIEBwYXJhbSB7U3RyaW5nfSByZXF1ZXN0VVJMIFRoZSBVUkwgdG8gdGVzdFxuICAgICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgVVJMIHNoYXJlcyB0aGUgc2FtZSBvcmlnaW4sIG90aGVyd2lzZSBmYWxzZVxuICAgICovXG4gICAgcmV0dXJuIGZ1bmN0aW9uIGlzVVJMU2FtZU9yaWdpbihyZXF1ZXN0VVJMKSB7XG4gICAgICB2YXIgcGFyc2VkID0gKHV0aWxzLmlzU3RyaW5nKHJlcXVlc3RVUkwpKSA/IHJlc29sdmVVUkwocmVxdWVzdFVSTCkgOiByZXF1ZXN0VVJMO1xuICAgICAgcmV0dXJuIChwYXJzZWQucHJvdG9jb2wgPT09IG9yaWdpblVSTC5wcm90b2NvbCAmJlxuICAgICAgICAgICAgcGFyc2VkLmhvc3QgPT09IG9yaWdpblVSTC5ob3N0KTtcbiAgICB9O1xuICB9KSgpIDpcblxuICAvLyBOb24gc3RhbmRhcmQgYnJvd3NlciBlbnZzICh3ZWIgd29ya2VycywgcmVhY3QtbmF0aXZlKSBsYWNrIG5lZWRlZCBzdXBwb3J0LlxuICAoZnVuY3Rpb24gbm9uU3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHJldHVybiBmdW5jdGlvbiBpc1VSTFNhbWVPcmlnaW4oKSB7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICB9KSgpXG4pO1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDMxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi4vdXRpbHMnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBub3JtYWxpemVIZWFkZXJOYW1lKGhlYWRlcnMsIG5vcm1hbGl6ZWROYW1lKSB7XG4gIHV0aWxzLmZvckVhY2goaGVhZGVycywgZnVuY3Rpb24gcHJvY2Vzc0hlYWRlcih2YWx1ZSwgbmFtZSkge1xuICAgIGlmIChuYW1lICE9PSBub3JtYWxpemVkTmFtZSAmJiBuYW1lLnRvVXBwZXJDYXNlKCkgPT09IG5vcm1hbGl6ZWROYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgIGhlYWRlcnNbbm9ybWFsaXplZE5hbWVdID0gdmFsdWU7XG4gICAgICBkZWxldGUgaGVhZGVyc1tuYW1lXTtcbiAgICB9XG4gIH0pO1xufTtcblxufSx7XCIuLi91dGlsc1wiOjM0fV0sMzI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbi8qKlxuICogUGFyc2UgaGVhZGVycyBpbnRvIGFuIG9iamVjdFxuICpcbiAqIGBgYFxuICogRGF0ZTogV2VkLCAyNyBBdWcgMjAxNCAwODo1ODo0OSBHTVRcbiAqIENvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vanNvblxuICogQ29ubmVjdGlvbjoga2VlcC1hbGl2ZVxuICogVHJhbnNmZXItRW5jb2Rpbmc6IGNodW5rZWRcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBoZWFkZXJzIEhlYWRlcnMgbmVlZGluZyB0byBiZSBwYXJzZWRcbiAqIEByZXR1cm5zIHtPYmplY3R9IEhlYWRlcnMgcGFyc2VkIGludG8gYW4gb2JqZWN0XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gcGFyc2VIZWFkZXJzKGhlYWRlcnMpIHtcbiAgdmFyIHBhcnNlZCA9IHt9O1xuICB2YXIga2V5O1xuICB2YXIgdmFsO1xuICB2YXIgaTtcblxuICBpZiAoIWhlYWRlcnMpIHsgcmV0dXJuIHBhcnNlZDsgfVxuXG4gIHV0aWxzLmZvckVhY2goaGVhZGVycy5zcGxpdCgnXFxuJyksIGZ1bmN0aW9uIHBhcnNlcihsaW5lKSB7XG4gICAgaSA9IGxpbmUuaW5kZXhPZignOicpO1xuICAgIGtleSA9IHV0aWxzLnRyaW0obGluZS5zdWJzdHIoMCwgaSkpLnRvTG93ZXJDYXNlKCk7XG4gICAgdmFsID0gdXRpbHMudHJpbShsaW5lLnN1YnN0cihpICsgMSkpO1xuXG4gICAgaWYgKGtleSkge1xuICAgICAgcGFyc2VkW2tleV0gPSBwYXJzZWRba2V5XSA/IHBhcnNlZFtrZXldICsgJywgJyArIHZhbCA6IHZhbDtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBwYXJzZWQ7XG59O1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDMzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBTeW50YWN0aWMgc3VnYXIgZm9yIGludm9raW5nIGEgZnVuY3Rpb24gYW5kIGV4cGFuZGluZyBhbiBhcnJheSBmb3IgYXJndW1lbnRzLlxuICpcbiAqIENvbW1vbiB1c2UgY2FzZSB3b3VsZCBiZSB0byB1c2UgYEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseWAuXG4gKlxuICogIGBgYGpzXG4gKiAgZnVuY3Rpb24gZih4LCB5LCB6KSB7fVxuICogIHZhciBhcmdzID0gWzEsIDIsIDNdO1xuICogIGYuYXBwbHkobnVsbCwgYXJncyk7XG4gKiAgYGBgXG4gKlxuICogV2l0aCBgc3ByZWFkYCB0aGlzIGV4YW1wbGUgY2FuIGJlIHJlLXdyaXR0ZW4uXG4gKlxuICogIGBgYGpzXG4gKiAgc3ByZWFkKGZ1bmN0aW9uKHgsIHksIHopIHt9KShbMSwgMiwgM10pO1xuICogIGBgYFxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG4gKiBAcmV0dXJucyB7RnVuY3Rpb259XG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc3ByZWFkKGNhbGxiYWNrKSB7XG4gIHJldHVybiBmdW5jdGlvbiB3cmFwKGFycikge1xuICAgIHJldHVybiBjYWxsYmFjay5hcHBseShudWxsLCBhcnIpO1xuICB9O1xufTtcblxufSx7fV0sMzQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgYmluZCA9IHJlcXVpcmUoJy4vaGVscGVycy9iaW5kJyk7XG52YXIgaXNCdWZmZXIgPSByZXF1aXJlKCdpcy1idWZmZXInKTtcblxuLypnbG9iYWwgdG9TdHJpbmc6dHJ1ZSovXG5cbi8vIHV0aWxzIGlzIGEgbGlicmFyeSBvZiBnZW5lcmljIGhlbHBlciBmdW5jdGlvbnMgbm9uLXNwZWNpZmljIHRvIGF4aW9zXG5cbnZhciB0b1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmc7XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gQXJyYXlcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBBcnJheSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXkodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gQXJyYXlCdWZmZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBBcnJheUJ1ZmZlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXIodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEFycmF5QnVmZmVyXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBGb3JtRGF0YVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEZvcm1EYXRhLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGb3JtRGF0YSh2YWwpIHtcbiAgcmV0dXJuICh0eXBlb2YgRm9ybURhdGEgIT09ICd1bmRlZmluZWQnKSAmJiAodmFsIGluc3RhbmNlb2YgRm9ybURhdGEpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgdmlldyBvbiBhbiBBcnJheUJ1ZmZlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgdmlldyBvbiBhbiBBcnJheUJ1ZmZlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQXJyYXlCdWZmZXJWaWV3KHZhbCkge1xuICB2YXIgcmVzdWx0O1xuICBpZiAoKHR5cGVvZiBBcnJheUJ1ZmZlciAhPT0gJ3VuZGVmaW5lZCcpICYmIChBcnJheUJ1ZmZlci5pc1ZpZXcpKSB7XG4gICAgcmVzdWx0ID0gQXJyYXlCdWZmZXIuaXNWaWV3KHZhbCk7XG4gIH0gZWxzZSB7XG4gICAgcmVzdWx0ID0gKHZhbCkgJiYgKHZhbC5idWZmZXIpICYmICh2YWwuYnVmZmVyIGluc3RhbmNlb2YgQXJyYXlCdWZmZXIpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBTdHJpbmdcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFN0cmluZywgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyaW5nKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ3N0cmluZyc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBOdW1iZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIE51bWJlciwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzTnVtYmVyKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ251bWJlcic7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgdW5kZWZpbmVkXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdGhlIHZhbHVlIGlzIHVuZGVmaW5lZCwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIHZhbCA9PT0gJ3VuZGVmaW5lZCc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYW4gT2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gT2JqZWN0LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNPYmplY3QodmFsKSB7XG4gIHJldHVybiB2YWwgIT09IG51bGwgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBEYXRlXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBEYXRlLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNEYXRlKHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBEYXRlXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBGaWxlXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBGaWxlLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGaWxlKHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBGaWxlXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBCbG9iXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBCbG9iLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNCbG9iKHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBCbG9iXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBGdW5jdGlvblxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgRnVuY3Rpb24sIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Z1bmN0aW9uKHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBGdW5jdGlvbl0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgU3RyZWFtXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBTdHJlYW0sIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1N0cmVhbSh2YWwpIHtcbiAgcmV0dXJuIGlzT2JqZWN0KHZhbCkgJiYgaXNGdW5jdGlvbih2YWwucGlwZSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBVUkxTZWFyY2hQYXJhbXMgb2JqZWN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBVUkxTZWFyY2hQYXJhbXMgb2JqZWN0LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNVUkxTZWFyY2hQYXJhbXModmFsKSB7XG4gIHJldHVybiB0eXBlb2YgVVJMU2VhcmNoUGFyYW1zICE9PSAndW5kZWZpbmVkJyAmJiB2YWwgaW5zdGFuY2VvZiBVUkxTZWFyY2hQYXJhbXM7XG59XG5cbi8qKlxuICogVHJpbSBleGNlc3Mgd2hpdGVzcGFjZSBvZmYgdGhlIGJlZ2lubmluZyBhbmQgZW5kIG9mIGEgc3RyaW5nXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IHN0ciBUaGUgU3RyaW5nIHRvIHRyaW1cbiAqIEByZXR1cm5zIHtTdHJpbmd9IFRoZSBTdHJpbmcgZnJlZWQgb2YgZXhjZXNzIHdoaXRlc3BhY2VcbiAqL1xuZnVuY3Rpb24gdHJpbShzdHIpIHtcbiAgcmV0dXJuIHN0ci5yZXBsYWNlKC9eXFxzKi8sICcnKS5yZXBsYWNlKC9cXHMqJC8sICcnKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgd2UncmUgcnVubmluZyBpbiBhIHN0YW5kYXJkIGJyb3dzZXIgZW52aXJvbm1lbnRcbiAqXG4gKiBUaGlzIGFsbG93cyBheGlvcyB0byBydW4gaW4gYSB3ZWIgd29ya2VyLCBhbmQgcmVhY3QtbmF0aXZlLlxuICogQm90aCBlbnZpcm9ubWVudHMgc3VwcG9ydCBYTUxIdHRwUmVxdWVzdCwgYnV0IG5vdCBmdWxseSBzdGFuZGFyZCBnbG9iYWxzLlxuICpcbiAqIHdlYiB3b3JrZXJzOlxuICogIHR5cGVvZiB3aW5kb3cgLT4gdW5kZWZpbmVkXG4gKiAgdHlwZW9mIGRvY3VtZW50IC0+IHVuZGVmaW5lZFxuICpcbiAqIHJlYWN0LW5hdGl2ZTpcbiAqICBuYXZpZ2F0b3IucHJvZHVjdCAtPiAnUmVhY3ROYXRpdmUnXG4gKi9cbmZ1bmN0aW9uIGlzU3RhbmRhcmRCcm93c2VyRW52KCkge1xuICBpZiAodHlwZW9mIG5hdmlnYXRvciAhPT0gJ3VuZGVmaW5lZCcgJiYgbmF2aWdhdG9yLnByb2R1Y3QgPT09ICdSZWFjdE5hdGl2ZScpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgcmV0dXJuIChcbiAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgIHR5cGVvZiBkb2N1bWVudCAhPT0gJ3VuZGVmaW5lZCdcbiAgKTtcbn1cblxuLyoqXG4gKiBJdGVyYXRlIG92ZXIgYW4gQXJyYXkgb3IgYW4gT2JqZWN0IGludm9raW5nIGEgZnVuY3Rpb24gZm9yIGVhY2ggaXRlbS5cbiAqXG4gKiBJZiBgb2JqYCBpcyBhbiBBcnJheSBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBwYXNzaW5nXG4gKiB0aGUgdmFsdWUsIGluZGV4LCBhbmQgY29tcGxldGUgYXJyYXkgZm9yIGVhY2ggaXRlbS5cbiAqXG4gKiBJZiAnb2JqJyBpcyBhbiBPYmplY3QgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgcGFzc2luZ1xuICogdGhlIHZhbHVlLCBrZXksIGFuZCBjb21wbGV0ZSBvYmplY3QgZm9yIGVhY2ggcHJvcGVydHkuXG4gKlxuICogQHBhcmFtIHtPYmplY3R8QXJyYXl9IG9iaiBUaGUgb2JqZWN0IHRvIGl0ZXJhdGVcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBjYWxsYmFjayB0byBpbnZva2UgZm9yIGVhY2ggaXRlbVxuICovXG5mdW5jdGlvbiBmb3JFYWNoKG9iaiwgZm4pIHtcbiAgLy8gRG9uJ3QgYm90aGVyIGlmIG5vIHZhbHVlIHByb3ZpZGVkXG4gIGlmIChvYmogPT09IG51bGwgfHwgdHlwZW9mIG9iaiA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICAvLyBGb3JjZSBhbiBhcnJheSBpZiBub3QgYWxyZWFkeSBzb21ldGhpbmcgaXRlcmFibGVcbiAgaWYgKHR5cGVvZiBvYmogIT09ICdvYmplY3QnICYmICFpc0FycmF5KG9iaikpIHtcbiAgICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgICBvYmogPSBbb2JqXTtcbiAgfVxuXG4gIGlmIChpc0FycmF5KG9iaikpIHtcbiAgICAvLyBJdGVyYXRlIG92ZXIgYXJyYXkgdmFsdWVzXG4gICAgZm9yICh2YXIgaSA9IDAsIGwgPSBvYmoubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgICBmbi5jYWxsKG51bGwsIG9ialtpXSwgaSwgb2JqKTtcbiAgICB9XG4gIH0gZWxzZSB7XG4gICAgLy8gSXRlcmF0ZSBvdmVyIG9iamVjdCBrZXlzXG4gICAgZm9yICh2YXIga2V5IGluIG9iaikge1xuICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIGtleSkpIHtcbiAgICAgICAgZm4uY2FsbChudWxsLCBvYmpba2V5XSwga2V5LCBvYmopO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuXG4vKipcbiAqIEFjY2VwdHMgdmFyYXJncyBleHBlY3RpbmcgZWFjaCBhcmd1bWVudCB0byBiZSBhbiBvYmplY3QsIHRoZW5cbiAqIGltbXV0YWJseSBtZXJnZXMgdGhlIHByb3BlcnRpZXMgb2YgZWFjaCBvYmplY3QgYW5kIHJldHVybnMgcmVzdWx0LlxuICpcbiAqIFdoZW4gbXVsdGlwbGUgb2JqZWN0cyBjb250YWluIHRoZSBzYW1lIGtleSB0aGUgbGF0ZXIgb2JqZWN0IGluXG4gKiB0aGUgYXJndW1lbnRzIGxpc3Qgd2lsbCB0YWtlIHByZWNlZGVuY2UuXG4gKlxuICogRXhhbXBsZTpcbiAqXG4gKiBgYGBqc1xuICogdmFyIHJlc3VsdCA9IG1lcmdlKHtmb286IDEyM30sIHtmb286IDQ1Nn0pO1xuICogY29uc29sZS5sb2cocmVzdWx0LmZvbyk7IC8vIG91dHB1dHMgNDU2XG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gb2JqMSBPYmplY3QgdG8gbWVyZ2VcbiAqIEByZXR1cm5zIHtPYmplY3R9IFJlc3VsdCBvZiBhbGwgbWVyZ2UgcHJvcGVydGllc1xuICovXG5mdW5jdGlvbiBtZXJnZSgvKiBvYmoxLCBvYmoyLCBvYmozLCAuLi4gKi8pIHtcbiAgdmFyIHJlc3VsdCA9IHt9O1xuICBmdW5jdGlvbiBhc3NpZ25WYWx1ZSh2YWwsIGtleSkge1xuICAgIGlmICh0eXBlb2YgcmVzdWx0W2tleV0gPT09ICdvYmplY3QnICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSB7XG4gICAgICByZXN1bHRba2V5XSA9IG1lcmdlKHJlc3VsdFtrZXldLCB2YWwpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZXN1bHRba2V5XSA9IHZhbDtcbiAgICB9XG4gIH1cblxuICBmb3IgKHZhciBpID0gMCwgbCA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICBmb3JFYWNoKGFyZ3VtZW50c1tpXSwgYXNzaWduVmFsdWUpO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbi8qKlxuICogRXh0ZW5kcyBvYmplY3QgYSBieSBtdXRhYmx5IGFkZGluZyB0byBpdCB0aGUgcHJvcGVydGllcyBvZiBvYmplY3QgYi5cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gYSBUaGUgb2JqZWN0IHRvIGJlIGV4dGVuZGVkXG4gKiBAcGFyYW0ge09iamVjdH0gYiBUaGUgb2JqZWN0IHRvIGNvcHkgcHJvcGVydGllcyBmcm9tXG4gKiBAcGFyYW0ge09iamVjdH0gdGhpc0FyZyBUaGUgb2JqZWN0IHRvIGJpbmQgZnVuY3Rpb24gdG9cbiAqIEByZXR1cm4ge09iamVjdH0gVGhlIHJlc3VsdGluZyB2YWx1ZSBvZiBvYmplY3QgYVxuICovXG5mdW5jdGlvbiBleHRlbmQoYSwgYiwgdGhpc0FyZykge1xuICBmb3JFYWNoKGIsIGZ1bmN0aW9uIGFzc2lnblZhbHVlKHZhbCwga2V5KSB7XG4gICAgaWYgKHRoaXNBcmcgJiYgdHlwZW9mIHZhbCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgYVtrZXldID0gYmluZCh2YWwsIHRoaXNBcmcpO1xuICAgIH0gZWxzZSB7XG4gICAgICBhW2tleV0gPSB2YWw7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIGE7XG59XG5cbm1vZHVsZS5leHBvcnRzID0ge1xuICBpc0FycmF5OiBpc0FycmF5LFxuICBpc0FycmF5QnVmZmVyOiBpc0FycmF5QnVmZmVyLFxuICBpc0J1ZmZlcjogaXNCdWZmZXIsXG4gIGlzRm9ybURhdGE6IGlzRm9ybURhdGEsXG4gIGlzQXJyYXlCdWZmZXJWaWV3OiBpc0FycmF5QnVmZmVyVmlldyxcbiAgaXNTdHJpbmc6IGlzU3RyaW5nLFxuICBpc051bWJlcjogaXNOdW1iZXIsXG4gIGlzT2JqZWN0OiBpc09iamVjdCxcbiAgaXNVbmRlZmluZWQ6IGlzVW5kZWZpbmVkLFxuICBpc0RhdGU6IGlzRGF0ZSxcbiAgaXNGaWxlOiBpc0ZpbGUsXG4gIGlzQmxvYjogaXNCbG9iLFxuICBpc0Z1bmN0aW9uOiBpc0Z1bmN0aW9uLFxuICBpc1N0cmVhbTogaXNTdHJlYW0sXG4gIGlzVVJMU2VhcmNoUGFyYW1zOiBpc1VSTFNlYXJjaFBhcmFtcyxcbiAgaXNTdGFuZGFyZEJyb3dzZXJFbnY6IGlzU3RhbmRhcmRCcm93c2VyRW52LFxuICBmb3JFYWNoOiBmb3JFYWNoLFxuICBtZXJnZTogbWVyZ2UsXG4gIGV4dGVuZDogZXh0ZW5kLFxuICB0cmltOiB0cmltXG59O1xuXG59LHtcIi4vaGVscGVycy9iaW5kXCI6MjQsXCJpcy1idWZmZXJcIjozNn1dLDM1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8qKlxuICogQGxpY2Vuc2VcbiAqIEZ1c2UgLSBMaWdodHdlaWdodCBmdXp6eS1zZWFyY2hcbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTItMjAxNiBLaXJvbGxvcyBSaXNrIDxraXJvbGxvc0BnbWFpbC5jb20+LlxuICogQWxsIFJpZ2h0cyBSZXNlcnZlZC4gQXBhY2hlIFNvZnR3YXJlIExpY2Vuc2UgMi4wXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKVxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKlxuICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKlxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxuICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuOyhmdW5jdGlvbiAoZ2xvYmFsKSB7XG4gICd1c2Ugc3RyaWN0J1xuXG4gIC8qKiBAdHlwZSB7ZnVuY3Rpb24oLi4uKil9ICovXG4gIGZ1bmN0aW9uIGxvZyAoKSB7XG4gICAgY29uc29sZS5sb2cuYXBwbHkoY29uc29sZSwgYXJndW1lbnRzKVxuICB9XG5cbiAgdmFyIGRlZmF1bHRPcHRpb25zID0ge1xuICAgIC8vIFRoZSBuYW1lIG9mIHRoZSBpZGVudGlmaWVyIHByb3BlcnR5LiBJZiBzcGVjaWZpZWQsIHRoZSByZXR1cm5lZCByZXN1bHQgd2lsbCBiZSBhIGxpc3RcbiAgICAvLyBvZiB0aGUgaXRlbXMnIGRlbnRpZmllcnMsIG90aGVyd2lzZSBpdCB3aWxsIGJlIGEgbGlzdCBvZiB0aGUgaXRlbXMuXG4gICAgaWQ6IG51bGwsXG5cbiAgICAvLyBJbmRpY2F0ZXMgd2hldGhlciBjb21wYXJpc29ucyBzaG91bGQgYmUgY2FzZSBzZW5zaXRpdmUuXG5cbiAgICBjYXNlU2Vuc2l0aXZlOiBmYWxzZSxcblxuICAgIC8vIEFuIGFycmF5IG9mIHZhbHVlcyB0aGF0IHNob3VsZCBiZSBpbmNsdWRlZCBmcm9tIHRoZSBzZWFyY2hlcidzIG91dHB1dC4gV2hlbiB0aGlzIGFycmF5XG4gICAgLy8gY29udGFpbnMgZWxlbWVudHMsIGVhY2ggcmVzdWx0IGluIHRoZSBsaXN0IHdpbGwgYmUgb2YgdGhlIGZvcm0gYHsgaXRlbTogLi4uLCBpbmNsdWRlMTogLi4uLCBpbmNsdWRlMjogLi4uIH1gLlxuICAgIC8vIFZhbHVlcyB5b3UgY2FuIGluY2x1ZGUgYXJlIGBzY29yZWAsIGBtYXRjaGVkTG9jYXRpb25zYFxuICAgIGluY2x1ZGU6IFtdLFxuXG4gICAgLy8gV2hldGhlciB0byBzb3J0IHRoZSByZXN1bHQgbGlzdCwgYnkgc2NvcmVcbiAgICBzaG91bGRTb3J0OiB0cnVlLFxuXG4gICAgLy8gVGhlIHNlYXJjaCBmdW5jdGlvbiB0byB1c2VcbiAgICAvLyBOb3RlIHRoYXQgdGhlIGRlZmF1bHQgc2VhcmNoIGZ1bmN0aW9uIChbW0Z1bmN0aW9uXV0pIG11c3QgY29uZm9ybSB0byB0aGUgZm9sbG93aW5nIEFQSTpcbiAgICAvL1xuICAgIC8vICBAcGFyYW0gcGF0dGVybiBUaGUgcGF0dGVybiBzdHJpbmcgdG8gc2VhcmNoXG4gICAgLy8gIEBwYXJhbSBvcHRpb25zIFRoZSBzZWFyY2ggb3B0aW9uXG4gICAgLy8gIFtbRnVuY3Rpb25dXS5jb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKHBhdHRlcm4sIG9wdGlvbnMpXG4gICAgLy9cbiAgICAvLyAgQHBhcmFtIHRleHQ6IHRoZSBzdHJpbmcgdG8gc2VhcmNoIGluIGZvciB0aGUgcGF0dGVyblxuICAgIC8vICBAcmV0dXJuIE9iamVjdCBpbiB0aGUgZm9ybSBvZjpcbiAgICAvLyAgICAtIGlzTWF0Y2g6IGJvb2xlYW5cbiAgICAvLyAgICAtIHNjb3JlOiBJbnRcbiAgICAvLyAgW1tGdW5jdGlvbl1dLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbih0ZXh0KVxuICAgIHNlYXJjaEZuOiBCaXRhcFNlYXJjaGVyLFxuXG4gICAgLy8gRGVmYXVsdCBzb3J0IGZ1bmN0aW9uXG4gICAgc29ydEZuOiBmdW5jdGlvbiAoYSwgYikge1xuICAgICAgcmV0dXJuIGEuc2NvcmUgLSBiLnNjb3JlXG4gICAgfSxcblxuICAgIC8vIFRoZSBnZXQgZnVuY3Rpb24gdG8gdXNlIHdoZW4gZmV0Y2hpbmcgYW4gb2JqZWN0J3MgcHJvcGVydGllcy5cbiAgICAvLyBUaGUgZGVmYXVsdCB3aWxsIHNlYXJjaCBuZXN0ZWQgcGF0aHMgKmllIGZvby5iYXIuYmF6KlxuICAgIGdldEZuOiBkZWVwVmFsdWUsXG5cbiAgICAvLyBMaXN0IG9mIHByb3BlcnRpZXMgdGhhdCB3aWxsIGJlIHNlYXJjaGVkLiBUaGlzIGFsc28gc3VwcG9ydHMgbmVzdGVkIHByb3BlcnRpZXMuXG4gICAga2V5czogW10sXG5cbiAgICAvLyBXaWxsIHByaW50IHRvIHRoZSBjb25zb2xlLiBVc2VmdWwgZm9yIGRlYnVnZ2luZy5cbiAgICB2ZXJib3NlOiBmYWxzZSxcblxuICAgIC8vIFdoZW4gdHJ1ZSwgdGhlIHNlYXJjaCBhbGdvcml0aG0gd2lsbCBzZWFyY2ggaW5kaXZpZHVhbCB3b3JkcyAqKmFuZCoqIHRoZSBmdWxsIHN0cmluZyxcbiAgICAvLyBjb21wdXRpbmcgdGhlIGZpbmFsIHNjb3JlIGFzIGEgZnVuY3Rpb24gb2YgYm90aC4gTm90ZSB0aGF0IHdoZW4gYHRva2VuaXplYCBpcyBgdHJ1ZWAsXG4gICAgLy8gdGhlIGB0aHJlc2hvbGRgLCBgZGlzdGFuY2VgLCBhbmQgYGxvY2F0aW9uYCBhcmUgaW5jb25zZXF1ZW50aWFsIGZvciBpbmRpdmlkdWFsIHRva2Vucy5cbiAgICB0b2tlbml6ZTogZmFsc2UsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSByZXN1bHQgc2V0IHdpbGwgb25seSBpbmNsdWRlIHJlY29yZHMgdGhhdCBtYXRjaCBhbGwgdG9rZW5zLiBXaWxsIG9ubHkgd29ya1xuICAgIC8vIGlmIGB0b2tlbml6ZWAgaXMgYWxzbyB0cnVlLlxuICAgIG1hdGNoQWxsVG9rZW5zOiBmYWxzZSxcblxuICAgIC8vIFJlZ2V4IHVzZWQgdG8gc2VwYXJhdGUgd29yZHMgd2hlbiBzZWFyY2hpbmcuIE9ubHkgYXBwbGljYWJsZSB3aGVuIGB0b2tlbml6ZWAgaXMgYHRydWVgLlxuICAgIHRva2VuU2VwYXJhdG9yOiAvICsvZyxcblxuICAgIC8vIE1pbmltdW0gbnVtYmVyIG9mIGNoYXJhY3RlcnMgdGhhdCBtdXN0IGJlIG1hdGNoZWQgYmVmb3JlIGEgcmVzdWx0IGlzIGNvbnNpZGVyZWQgYSBtYXRjaFxuICAgIG1pbk1hdGNoQ2hhckxlbmd0aDogMSxcblxuICAgIC8vIFdoZW4gdHJ1ZSwgdGhlIGFsZ29yaXRobSBjb250aW51ZXMgc2VhcmNoaW5nIHRvIHRoZSBlbmQgb2YgdGhlIGlucHV0IGV2ZW4gaWYgYSBwZXJmZWN0XG4gICAgLy8gbWF0Y2ggaXMgZm91bmQgYmVmb3JlIHRoZSBlbmQgb2YgdGhlIHNhbWUgaW5wdXQuXG4gICAgZmluZEFsbE1hdGNoZXM6IGZhbHNlXG4gIH1cblxuICAvKipcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqIEBwYXJhbSB7IUFycmF5fSBsaXN0XG4gICAqIEBwYXJhbSB7IU9iamVjdDxzdHJpbmcsICo+fSBvcHRpb25zXG4gICAqL1xuICBmdW5jdGlvbiBGdXNlIChsaXN0LCBvcHRpb25zKSB7XG4gICAgdmFyIGtleVxuXG4gICAgdGhpcy5saXN0ID0gbGlzdFxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG5cbiAgICBmb3IgKGtleSBpbiBkZWZhdWx0T3B0aW9ucykge1xuICAgICAgaWYgKCFkZWZhdWx0T3B0aW9ucy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgLy8gQWRkIGJvb2xlYW4gdHlwZSBvcHRpb25zXG4gICAgICBpZiAodHlwZW9mIGRlZmF1bHRPcHRpb25zW2tleV0gPT09ICdib29sZWFuJykge1xuICAgICAgICB0aGlzLm9wdGlvbnNba2V5XSA9IGtleSBpbiBvcHRpb25zID8gb3B0aW9uc1trZXldIDogZGVmYXVsdE9wdGlvbnNba2V5XTtcbiAgICAgIC8vIEFkZCBhbGwgb3RoZXIgb3B0aW9uc1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSBvcHRpb25zW2tleV0gfHwgZGVmYXVsdE9wdGlvbnNba2V5XVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UuVkVSU0lPTiA9ICcyLjcuMydcblxuICAvKipcbiAgICogU2V0cyBhIG5ldyBsaXN0IGZvciBGdXNlIHRvIG1hdGNoIGFnYWluc3QuXG4gICAqIEBwYXJhbSB7IUFycmF5fSBsaXN0XG4gICAqIEByZXR1cm4geyFBcnJheX0gVGhlIG5ld2x5IHNldCBsaXN0XG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEZ1c2UucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uIChsaXN0KSB7XG4gICAgdGhpcy5saXN0ID0gbGlzdFxuICAgIHJldHVybiBsaXN0XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiAocGF0dGVybikge1xuICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5TZWFyY2ggdGVybTonLCBwYXR0ZXJuLCAnXFxuJylcblxuICAgIHRoaXMucGF0dGVybiA9IHBhdHRlcm5cbiAgICB0aGlzLnJlc3VsdHMgPSBbXVxuICAgIHRoaXMucmVzdWx0TWFwID0ge31cbiAgICB0aGlzLl9rZXlNYXAgPSBudWxsXG5cbiAgICB0aGlzLl9wcmVwYXJlU2VhcmNoZXJzKClcbiAgICB0aGlzLl9zdGFydFNlYXJjaCgpXG4gICAgdGhpcy5fY29tcHV0ZVNjb3JlKClcbiAgICB0aGlzLl9zb3J0KClcblxuICAgIHZhciBvdXRwdXQgPSB0aGlzLl9mb3JtYXQoKVxuICAgIHJldHVybiBvdXRwdXRcbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9wcmVwYXJlU2VhcmNoZXJzID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgdmFyIHBhdHRlcm4gPSB0aGlzLnBhdHRlcm5cbiAgICB2YXIgc2VhcmNoRm4gPSBvcHRpb25zLnNlYXJjaEZuXG4gICAgdmFyIHRva2VucyA9IHBhdHRlcm4uc3BsaXQob3B0aW9ucy50b2tlblNlcGFyYXRvcilcbiAgICB2YXIgaSA9IDBcbiAgICB2YXIgbGVuID0gdG9rZW5zLmxlbmd0aFxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbml6ZSkge1xuICAgICAgdGhpcy50b2tlblNlYXJjaGVycyA9IFtdXG4gICAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHRoaXMudG9rZW5TZWFyY2hlcnMucHVzaChuZXcgc2VhcmNoRm4odG9rZW5zW2ldLCBvcHRpb25zKSlcbiAgICAgIH1cbiAgICB9XG4gICAgdGhpcy5mdWxsU2VhY2hlciA9IG5ldyBzZWFyY2hGbihwYXR0ZXJuLCBvcHRpb25zKVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX3N0YXJ0U2VhcmNoID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgdmFyIGdldEZuID0gb3B0aW9ucy5nZXRGblxuICAgIHZhciBsaXN0ID0gdGhpcy5saXN0XG4gICAgdmFyIGxpc3RMZW4gPSBsaXN0Lmxlbmd0aFxuICAgIHZhciBrZXlzID0gdGhpcy5vcHRpb25zLmtleXNcbiAgICB2YXIga2V5c0xlbiA9IGtleXMubGVuZ3RoXG4gICAgdmFyIGtleVxuICAgIHZhciB3ZWlnaHRcbiAgICB2YXIgaXRlbSA9IG51bGxcbiAgICB2YXIgaVxuICAgIHZhciBqXG5cbiAgICAvLyBDaGVjayB0aGUgZmlyc3QgaXRlbSBpbiB0aGUgbGlzdCwgaWYgaXQncyBhIHN0cmluZywgdGhlbiB3ZSBhc3N1bWVcbiAgICAvLyB0aGF0IGV2ZXJ5IGl0ZW0gaW4gdGhlIGxpc3QgaXMgYWxzbyBhIHN0cmluZywgYW5kIHRodXMgaXQncyBhIGZsYXR0ZW5lZCBhcnJheS5cbiAgICBpZiAodHlwZW9mIGxpc3RbMF0gPT09ICdzdHJpbmcnKSB7XG4gICAgICAvLyBJdGVyYXRlIG92ZXIgZXZlcnkgaXRlbVxuICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3RMZW47IGkrKykge1xuICAgICAgICB0aGlzLl9hbmFseXplKCcnLCBsaXN0W2ldLCBpLCBpKVxuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9rZXlNYXAgPSB7fVxuICAgICAgLy8gT3RoZXJ3aXNlLCB0aGUgZmlyc3QgaXRlbSBpcyBhbiBPYmplY3QgKGhvcGVmdWxseSksIGFuZCB0aHVzIHRoZSBzZWFyY2hpbmdcbiAgICAgIC8vIGlzIGRvbmUgb24gdGhlIHZhbHVlcyBvZiB0aGUga2V5cyBvZiBlYWNoIGl0ZW0uXG4gICAgICAvLyBJdGVyYXRlIG92ZXIgZXZlcnkgaXRlbVxuICAgICAgZm9yIChpID0gMDsgaSA8IGxpc3RMZW47IGkrKykge1xuICAgICAgICBpdGVtID0gbGlzdFtpXVxuICAgICAgICAvLyBJdGVyYXRlIG92ZXIgZXZlcnkga2V5XG4gICAgICAgIGZvciAoaiA9IDA7IGogPCBrZXlzTGVuOyBqKyspIHtcbiAgICAgICAgICBrZXkgPSBrZXlzW2pdXG4gICAgICAgICAgaWYgKHR5cGVvZiBrZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB3ZWlnaHQgPSAoMSAtIGtleS53ZWlnaHQpIHx8IDFcbiAgICAgICAgICAgIHRoaXMuX2tleU1hcFtrZXkubmFtZV0gPSB7XG4gICAgICAgICAgICAgIHdlaWdodDogd2VpZ2h0XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoa2V5LndlaWdodCA8PSAwIHx8IGtleS53ZWlnaHQgPiAxKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignS2V5IHdlaWdodCBoYXMgdG8gYmUgPiAwIGFuZCA8PSAxJylcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGtleSA9IGtleS5uYW1lXG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2tleU1hcFtrZXldID0ge1xuICAgICAgICAgICAgICB3ZWlnaHQ6IDFcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy5fYW5hbHl6ZShrZXksIGdldEZuKGl0ZW0sIGtleSwgW10pLCBpdGVtLCBpKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX2FuYWx5emUgPSBmdW5jdGlvbiAoa2V5LCB0ZXh0LCBlbnRpdHksIGluZGV4KSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgd29yZHNcbiAgICB2YXIgc2NvcmVzXG4gICAgdmFyIGV4aXN0cyA9IGZhbHNlXG4gICAgdmFyIGV4aXN0aW5nUmVzdWx0XG4gICAgdmFyIGF2ZXJhZ2VTY29yZVxuICAgIHZhciBmaW5hbFNjb3JlXG4gICAgdmFyIHNjb3Jlc0xlblxuICAgIHZhciBtYWluU2VhcmNoUmVzdWx0XG4gICAgdmFyIHRva2VuU2VhcmNoZXJcbiAgICB2YXIgdGVybVNjb3Jlc1xuICAgIHZhciB3b3JkXG4gICAgdmFyIHRva2VuU2VhcmNoUmVzdWx0XG4gICAgdmFyIGhhc01hdGNoSW5UZXh0XG4gICAgdmFyIGNoZWNrVGV4dE1hdGNoZXNcbiAgICB2YXIgaVxuICAgIHZhciBqXG5cbiAgICAvLyBDaGVjayBpZiB0aGUgdGV4dCBjYW4gYmUgc2VhcmNoZWRcbiAgICBpZiAodGV4dCA9PT0gdW5kZWZpbmVkIHx8IHRleHQgPT09IG51bGwpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHNjb3JlcyA9IFtdXG5cbiAgICB2YXIgbnVtVGV4dE1hdGNoZXMgPSAwXG5cbiAgICBpZiAodHlwZW9mIHRleHQgPT09ICdzdHJpbmcnKSB7XG4gICAgICB3b3JkcyA9IHRleHQuc3BsaXQob3B0aW9ucy50b2tlblNlcGFyYXRvcilcblxuICAgICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCctLS0tLS0tLS1cXG5LZXk6Jywga2V5KVxuXG4gICAgICBpZiAodGhpcy5vcHRpb25zLnRva2VuaXplKSB7XG4gICAgICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnRva2VuU2VhcmNoZXJzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgdG9rZW5TZWFyY2hlciA9IHRoaXMudG9rZW5TZWFyY2hlcnNbaV1cblxuICAgICAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnUGF0dGVybjonLCB0b2tlblNlYXJjaGVyLnBhdHRlcm4pXG5cbiAgICAgICAgICB0ZXJtU2NvcmVzID0gW11cbiAgICAgICAgICBoYXNNYXRjaEluVGV4dCA9IGZhbHNlXG5cbiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgd29yZHMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgIHdvcmQgPSB3b3Jkc1tqXVxuICAgICAgICAgICAgdG9rZW5TZWFyY2hSZXN1bHQgPSB0b2tlblNlYXJjaGVyLnNlYXJjaCh3b3JkKVxuICAgICAgICAgICAgdmFyIG9iaiA9IHt9XG4gICAgICAgICAgICBpZiAodG9rZW5TZWFyY2hSZXN1bHQuaXNNYXRjaCkge1xuICAgICAgICAgICAgICBvYmpbd29yZF0gPSB0b2tlblNlYXJjaFJlc3VsdC5zY29yZVxuICAgICAgICAgICAgICBleGlzdHMgPSB0cnVlXG4gICAgICAgICAgICAgIGhhc01hdGNoSW5UZXh0ID0gdHJ1ZVxuICAgICAgICAgICAgICBzY29yZXMucHVzaCh0b2tlblNlYXJjaFJlc3VsdC5zY29yZSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIG9ialt3b3JkXSA9IDFcbiAgICAgICAgICAgICAgaWYgKCF0aGlzLm9wdGlvbnMubWF0Y2hBbGxUb2tlbnMpIHtcbiAgICAgICAgICAgICAgICBzY29yZXMucHVzaCgxKVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0ZXJtU2NvcmVzLnB1c2gob2JqKVxuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChoYXNNYXRjaEluVGV4dCkge1xuICAgICAgICAgICAgbnVtVGV4dE1hdGNoZXMrK1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnVG9rZW4gc2NvcmVzOicsIHRlcm1TY29yZXMpXG4gICAgICAgIH1cblxuICAgICAgICBhdmVyYWdlU2NvcmUgPSBzY29yZXNbMF1cbiAgICAgICAgc2NvcmVzTGVuID0gc2NvcmVzLmxlbmd0aFxuICAgICAgICBmb3IgKGkgPSAxOyBpIDwgc2NvcmVzTGVuOyBpKyspIHtcbiAgICAgICAgICBhdmVyYWdlU2NvcmUgKz0gc2NvcmVzW2ldXG4gICAgICAgIH1cbiAgICAgICAgYXZlcmFnZVNjb3JlID0gYXZlcmFnZVNjb3JlIC8gc2NvcmVzTGVuXG5cbiAgICAgICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdUb2tlbiBzY29yZSBhdmVyYWdlOicsIGF2ZXJhZ2VTY29yZSlcbiAgICAgIH1cblxuICAgICAgbWFpblNlYXJjaFJlc3VsdCA9IHRoaXMuZnVsbFNlYWNoZXIuc2VhcmNoKHRleHQpXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ0Z1bGwgdGV4dCBzY29yZTonLCBtYWluU2VhcmNoUmVzdWx0LnNjb3JlKVxuXG4gICAgICBmaW5hbFNjb3JlID0gbWFpblNlYXJjaFJlc3VsdC5zY29yZVxuICAgICAgaWYgKGF2ZXJhZ2VTY29yZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGZpbmFsU2NvcmUgPSAoZmluYWxTY29yZSArIGF2ZXJhZ2VTY29yZSkgLyAyXG4gICAgICB9XG5cbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnU2NvcmUgYXZlcmFnZTonLCBmaW5hbFNjb3JlKVxuXG4gICAgICBjaGVja1RleHRNYXRjaGVzID0gKHRoaXMub3B0aW9ucy50b2tlbml6ZSAmJiB0aGlzLm9wdGlvbnMubWF0Y2hBbGxUb2tlbnMpID8gbnVtVGV4dE1hdGNoZXMgPj0gdGhpcy50b2tlblNlYXJjaGVycy5sZW5ndGggOiB0cnVlXG5cbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnQ2hlY2sgTWF0Y2hlcycsIGNoZWNrVGV4dE1hdGNoZXMpXG5cbiAgICAgIC8vIElmIGEgbWF0Y2ggaXMgZm91bmQsIGFkZCB0aGUgaXRlbSB0byA8cmF3UmVzdWx0cz4sIGluY2x1ZGluZyBpdHMgc2NvcmVcbiAgICAgIGlmICgoZXhpc3RzIHx8IG1haW5TZWFyY2hSZXN1bHQuaXNNYXRjaCkgJiYgY2hlY2tUZXh0TWF0Y2hlcykge1xuICAgICAgICAvLyBDaGVjayBpZiB0aGUgaXRlbSBhbHJlYWR5IGV4aXN0cyBpbiBvdXIgcmVzdWx0c1xuICAgICAgICBleGlzdGluZ1Jlc3VsdCA9IHRoaXMucmVzdWx0TWFwW2luZGV4XVxuXG4gICAgICAgIGlmIChleGlzdGluZ1Jlc3VsdCkge1xuICAgICAgICAgIC8vIFVzZSB0aGUgbG93ZXN0IHNjb3JlXG4gICAgICAgICAgLy8gZXhpc3RpbmdSZXN1bHQuc2NvcmUsIGJpdGFwUmVzdWx0LnNjb3JlXG4gICAgICAgICAgZXhpc3RpbmdSZXN1bHQub3V0cHV0LnB1c2goe1xuICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgIG1hdGNoZWRJbmRpY2VzOiBtYWluU2VhcmNoUmVzdWx0Lm1hdGNoZWRJbmRpY2VzXG4gICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBBZGQgaXQgdG8gdGhlIHJhdyByZXN1bHQgbGlzdFxuICAgICAgICAgIHRoaXMucmVzdWx0TWFwW2luZGV4XSA9IHtcbiAgICAgICAgICAgIGl0ZW06IGVudGl0eSxcbiAgICAgICAgICAgIG91dHB1dDogW3tcbiAgICAgICAgICAgICAga2V5OiBrZXksXG4gICAgICAgICAgICAgIHNjb3JlOiBmaW5hbFNjb3JlLFxuICAgICAgICAgICAgICBtYXRjaGVkSW5kaWNlczogbWFpblNlYXJjaFJlc3VsdC5tYXRjaGVkSW5kaWNlc1xuICAgICAgICAgICAgfV1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB0aGlzLnJlc3VsdHMucHVzaCh0aGlzLnJlc3VsdE1hcFtpbmRleF0pXG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGlzQXJyYXkodGV4dCkpIHtcbiAgICAgIGZvciAoaSA9IDA7IGkgPCB0ZXh0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIHRoaXMuX2FuYWx5emUoa2V5LCB0ZXh0W2ldLCBlbnRpdHksIGluZGV4KVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9jb21wdXRlU2NvcmUgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIGlcbiAgICB2YXIgalxuICAgIHZhciBrZXlNYXAgPSB0aGlzLl9rZXlNYXBcbiAgICB2YXIgdG90YWxTY29yZVxuICAgIHZhciBvdXRwdXRcbiAgICB2YXIgc2NvcmVMZW5cbiAgICB2YXIgc2NvcmVcbiAgICB2YXIgd2VpZ2h0XG4gICAgdmFyIHJlc3VsdHMgPSB0aGlzLnJlc3VsdHNcbiAgICB2YXIgYmVzdFNjb3JlXG4gICAgdmFyIG5TY29yZVxuXG4gICAgaWYgKHRoaXMub3B0aW9ucy52ZXJib3NlKSBsb2coJ1xcblxcbkNvbXB1dGluZyBzY29yZTpcXG4nKVxuXG4gICAgZm9yIChpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHtcbiAgICAgIHRvdGFsU2NvcmUgPSAwXG4gICAgICBvdXRwdXQgPSByZXN1bHRzW2ldLm91dHB1dFxuICAgICAgc2NvcmVMZW4gPSBvdXRwdXQubGVuZ3RoXG5cbiAgICAgIGJlc3RTY29yZSA9IDFcblxuICAgICAgZm9yIChqID0gMDsgaiA8IHNjb3JlTGVuOyBqKyspIHtcbiAgICAgICAgc2NvcmUgPSBvdXRwdXRbal0uc2NvcmVcbiAgICAgICAgd2VpZ2h0ID0ga2V5TWFwID8ga2V5TWFwW291dHB1dFtqXS5rZXldLndlaWdodCA6IDFcblxuICAgICAgICBuU2NvcmUgPSBzY29yZSAqIHdlaWdodFxuXG4gICAgICAgIGlmICh3ZWlnaHQgIT09IDEpIHtcbiAgICAgICAgICBiZXN0U2NvcmUgPSBNYXRoLm1pbihiZXN0U2NvcmUsIG5TY29yZSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0b3RhbFNjb3JlICs9IG5TY29yZVxuICAgICAgICAgIG91dHB1dFtqXS5uU2NvcmUgPSBuU2NvcmVcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICBpZiAoYmVzdFNjb3JlID09PSAxKSB7XG4gICAgICAgIHJlc3VsdHNbaV0uc2NvcmUgPSB0b3RhbFNjb3JlIC8gc2NvcmVMZW5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdHNbaV0uc2NvcmUgPSBiZXN0U2NvcmVcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy52ZXJib3NlKSBsb2cocmVzdWx0c1tpXSlcbiAgICB9XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fc29ydCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIGlmIChvcHRpb25zLnNob3VsZFNvcnQpIHtcbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnXFxuXFxuU29ydGluZy4uLi4nKVxuICAgICAgdGhpcy5yZXN1bHRzLnNvcnQob3B0aW9ucy5zb3J0Rm4pXG4gICAgfVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX2Zvcm1hdCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBnZXRGbiA9IG9wdGlvbnMuZ2V0Rm5cbiAgICB2YXIgZmluYWxPdXRwdXQgPSBbXVxuICAgIHZhciBpXG4gICAgdmFyIGxlblxuICAgIHZhciByZXN1bHRzID0gdGhpcy5yZXN1bHRzXG4gICAgdmFyIHJlcGxhY2VWYWx1ZVxuICAgIHZhciBnZXRJdGVtQXRJbmRleFxuICAgIHZhciBpbmNsdWRlID0gb3B0aW9ucy5pbmNsdWRlXG5cbiAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1xcblxcbk91dHB1dDpcXG5cXG4nLCByZXN1bHRzKVxuXG4gICAgLy8gSGVscGVyIGZ1bmN0aW9uLCBoZXJlIGZvciBzcGVlZC11cCwgd2hpY2ggcmVwbGFjZXMgdGhlIGl0ZW0gd2l0aCBpdHMgdmFsdWUsXG4gICAgLy8gaWYgdGhlIG9wdGlvbnMgc3BlY2lmaWVzIGl0LFxuICAgIHJlcGxhY2VWYWx1ZSA9IG9wdGlvbnMuaWQgPyBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgICAgIHJlc3VsdHNbaW5kZXhdLml0ZW0gPSBnZXRGbihyZXN1bHRzW2luZGV4XS5pdGVtLCBvcHRpb25zLmlkLCBbXSlbMF1cbiAgICB9IDogZnVuY3Rpb24gKCkge31cblxuICAgIGdldEl0ZW1BdEluZGV4ID0gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICB2YXIgcmVjb3JkID0gcmVzdWx0c1tpbmRleF1cbiAgICAgIHZhciBkYXRhXG4gICAgICB2YXIgalxuICAgICAgdmFyIG91dHB1dFxuICAgICAgdmFyIF9pdGVtXG4gICAgICB2YXIgX3Jlc3VsdFxuXG4gICAgICAvLyBJZiBgaW5jbHVkZWAgaGFzIHZhbHVlcywgcHV0IHRoZSBpdGVtIGluIHRoZSByZXN1bHRcbiAgICAgIGlmIChpbmNsdWRlLmxlbmd0aCA+IDApIHtcbiAgICAgICAgZGF0YSA9IHtcbiAgICAgICAgICBpdGVtOiByZWNvcmQuaXRlbVxuICAgICAgICB9XG4gICAgICAgIGlmIChpbmNsdWRlLmluZGV4T2YoJ21hdGNoZXMnKSAhPT0gLTEpIHtcbiAgICAgICAgICBvdXRwdXQgPSByZWNvcmQub3V0cHV0XG4gICAgICAgICAgZGF0YS5tYXRjaGVzID0gW11cbiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgb3V0cHV0Lmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICBfaXRlbSA9IG91dHB1dFtqXVxuICAgICAgICAgICAgX3Jlc3VsdCA9IHtcbiAgICAgICAgICAgICAgaW5kaWNlczogX2l0ZW0ubWF0Y2hlZEluZGljZXNcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChfaXRlbS5rZXkpIHtcbiAgICAgICAgICAgICAgX3Jlc3VsdC5rZXkgPSBfaXRlbS5rZXlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGRhdGEubWF0Y2hlcy5wdXNoKF9yZXN1bHQpXG4gICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGluY2x1ZGUuaW5kZXhPZignc2NvcmUnKSAhPT0gLTEpIHtcbiAgICAgICAgICBkYXRhLnNjb3JlID0gcmVzdWx0c1tpbmRleF0uc2NvcmVcbiAgICAgICAgfVxuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkYXRhID0gcmVjb3JkLml0ZW1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGRhdGFcbiAgICB9XG5cbiAgICAvLyBGcm9tIHRoZSByZXN1bHRzLCBwdXNoIGludG8gYSBuZXcgYXJyYXkgb25seSB0aGUgaXRlbSBpZGVudGlmaWVyIChpZiBzcGVjaWZpZWQpXG4gICAgLy8gb2YgdGhlIGVudGlyZSBpdGVtLiAgVGhpcyBpcyBiZWNhdXNlIHdlIGRvbid0IHdhbnQgdG8gcmV0dXJuIHRoZSA8cmVzdWx0cz4sXG4gICAgLy8gc2luY2UgaXQgY29udGFpbnMgb3RoZXIgbWV0YWRhdGFcbiAgICBmb3IgKGkgPSAwLCBsZW4gPSByZXN1bHRzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICByZXBsYWNlVmFsdWUoaSlcbiAgICAgIGZpbmFsT3V0cHV0LnB1c2goZ2V0SXRlbUF0SW5kZXgoaSkpXG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbmFsT3V0cHV0XG4gIH1cblxuICAvLyBIZWxwZXJzXG5cbiAgZnVuY3Rpb24gZGVlcFZhbHVlIChvYmosIHBhdGgsIGxpc3QpIHtcbiAgICB2YXIgZmlyc3RTZWdtZW50XG4gICAgdmFyIHJlbWFpbmluZ1xuICAgIHZhciBkb3RJbmRleFxuICAgIHZhciB2YWx1ZVxuICAgIHZhciBpXG4gICAgdmFyIGxlblxuXG4gICAgaWYgKCFwYXRoKSB7XG4gICAgICAvLyBJZiB0aGVyZSdzIG5vIHBhdGggbGVmdCwgd2UndmUgZ290dGVuIHRvIHRoZSBvYmplY3Qgd2UgY2FyZSBhYm91dC5cbiAgICAgIGxpc3QucHVzaChvYmopXG4gICAgfSBlbHNlIHtcbiAgICAgIGRvdEluZGV4ID0gcGF0aC5pbmRleE9mKCcuJylcblxuICAgICAgaWYgKGRvdEluZGV4ICE9PSAtMSkge1xuICAgICAgICBmaXJzdFNlZ21lbnQgPSBwYXRoLnNsaWNlKDAsIGRvdEluZGV4KVxuICAgICAgICByZW1haW5pbmcgPSBwYXRoLnNsaWNlKGRvdEluZGV4ICsgMSlcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZpcnN0U2VnbWVudCA9IHBhdGhcbiAgICAgIH1cblxuICAgICAgdmFsdWUgPSBvYmpbZmlyc3RTZWdtZW50XVxuICAgICAgaWYgKHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKCFyZW1haW5pbmcgJiYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykpIHtcbiAgICAgICAgICBsaXN0LnB1c2godmFsdWUpXG4gICAgICAgIH0gZWxzZSBpZiAoaXNBcnJheSh2YWx1ZSkpIHtcbiAgICAgICAgICAvLyBTZWFyY2ggZWFjaCBpdGVtIGluIHRoZSBhcnJheS5cbiAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSB2YWx1ZS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICAgICAgZGVlcFZhbHVlKHZhbHVlW2ldLCByZW1haW5pbmcsIGxpc3QpXG4gICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHJlbWFpbmluZykge1xuICAgICAgICAgIC8vIEFuIG9iamVjdC4gUmVjdXJzZSBmdXJ0aGVyLlxuICAgICAgICAgIGRlZXBWYWx1ZSh2YWx1ZSwgcmVtYWluaW5nLCBsaXN0KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIGxpc3RcbiAgfVxuXG4gIGZ1bmN0aW9uIGlzQXJyYXkgKG9iaikge1xuICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKSA9PT0gJ1tvYmplY3QgQXJyYXldJ1xuICB9XG5cbiAgLyoqXG4gICAqIEFkYXB0ZWQgZnJvbSBcIkRpZmYsIE1hdGNoIGFuZCBQYXRjaFwiLCBieSBHb29nbGVcbiAgICpcbiAgICogICBodHRwOi8vY29kZS5nb29nbGUuY29tL3AvZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2gvXG4gICAqXG4gICAqIE1vZGlmaWVkIGJ5OiBLaXJvbGxvcyBSaXNrIDxraXJvbGxvc0BnbWFpbC5jb20+XG4gICAqIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4gICAqIERldGFpbHM6IHRoZSBhbGdvcml0aG0gYW5kIHN0cnVjdHVyZSB3YXMgbW9kaWZpZWQgdG8gYWxsb3cgdGhlIGNyZWF0aW9uIG9mXG4gICAqIDxTZWFyY2hlcj4gaW5zdGFuY2VzIHdpdGggYSA8c2VhcmNoPiBtZXRob2Qgd2hpY2ggZG9lcyB0aGUgYWN0dWFsXG4gICAqIGJpdGFwIHNlYXJjaC4gVGhlIDxwYXR0ZXJuPiAodGhlIHN0cmluZyB0aGF0IGlzIHNlYXJjaGVkIGZvcikgaXMgb25seSBkZWZpbmVkXG4gICAqIG9uY2UgcGVyIGluc3RhbmNlIGFuZCB0aHVzIGl0IGVsaW1pbmF0ZXMgcmVkdW5kYW50IHJlLWNyZWF0aW9uIHdoZW4gc2VhcmNoaW5nXG4gICAqIG92ZXIgYSBsaXN0IG9mIHN0cmluZ3MuXG4gICAqXG4gICAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIilcbiAgICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICAgKlxuICAgKiBAY29uc3RydWN0b3JcbiAgICovXG4gIGZ1bmN0aW9uIEJpdGFwU2VhcmNoZXIgKHBhdHRlcm4sIG9wdGlvbnMpIHtcbiAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuICAgIHRoaXMub3B0aW9ucyA9IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMubG9jYXRpb24gPSBvcHRpb25zLmxvY2F0aW9uIHx8IEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMubG9jYXRpb25cbiAgICB0aGlzLm9wdGlvbnMuZGlzdGFuY2UgPSAnZGlzdGFuY2UnIGluIG9wdGlvbnMgPyBvcHRpb25zLmRpc3RhbmNlIDogQml0YXBTZWFyY2hlci5kZWZhdWx0T3B0aW9ucy5kaXN0YW5jZVxuICAgIHRoaXMub3B0aW9ucy50aHJlc2hvbGQgPSAndGhyZXNob2xkJyBpbiBvcHRpb25zID8gb3B0aW9ucy50aHJlc2hvbGQgOiBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLnRocmVzaG9sZFxuICAgIHRoaXMub3B0aW9ucy5tYXhQYXR0ZXJuTGVuZ3RoID0gb3B0aW9ucy5tYXhQYXR0ZXJuTGVuZ3RoIHx8IEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMubWF4UGF0dGVybkxlbmd0aFxuXG4gICAgdGhpcy5wYXR0ZXJuID0gb3B0aW9ucy5jYXNlU2Vuc2l0aXZlID8gcGF0dGVybiA6IHBhdHRlcm4udG9Mb3dlckNhc2UoKVxuICAgIHRoaXMucGF0dGVybkxlbiA9IHBhdHRlcm4ubGVuZ3RoXG5cbiAgICBpZiAodGhpcy5wYXR0ZXJuTGVuIDw9IHRoaXMub3B0aW9ucy5tYXhQYXR0ZXJuTGVuZ3RoKSB7XG4gICAgICB0aGlzLm1hdGNobWFzayA9IDEgPDwgKHRoaXMucGF0dGVybkxlbiAtIDEpXG4gICAgICB0aGlzLnBhdHRlcm5BbHBoYWJldCA9IHRoaXMuX2NhbGN1bGF0ZVBhdHRlcm5BbHBoYWJldCgpXG4gICAgfVxuICB9XG5cbiAgQml0YXBTZWFyY2hlci5kZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyBBcHByb3hpbWF0ZWx5IHdoZXJlIGluIHRoZSB0ZXh0IGlzIHRoZSBwYXR0ZXJuIGV4cGVjdGVkIHRvIGJlIGZvdW5kP1xuICAgIGxvY2F0aW9uOiAwLFxuXG4gICAgLy8gRGV0ZXJtaW5lcyBob3cgY2xvc2UgdGhlIG1hdGNoIG11c3QgYmUgdG8gdGhlIGZ1enp5IGxvY2F0aW9uIChzcGVjaWZpZWQgYWJvdmUpLlxuICAgIC8vIEFuIGV4YWN0IGxldHRlciBtYXRjaCB3aGljaCBpcyAnZGlzdGFuY2UnIGNoYXJhY3RlcnMgYXdheSBmcm9tIHRoZSBmdXp6eSBsb2NhdGlvblxuICAgIC8vIHdvdWxkIHNjb3JlIGFzIGEgY29tcGxldGUgbWlzbWF0Y2guIEEgZGlzdGFuY2Ugb2YgJzAnIHJlcXVpcmVzIHRoZSBtYXRjaCBiZSBhdFxuICAgIC8vIHRoZSBleGFjdCBsb2NhdGlvbiBzcGVjaWZpZWQsIGEgdGhyZXNob2xkIG9mICcxMDAwJyB3b3VsZCByZXF1aXJlIGEgcGVyZmVjdCBtYXRjaFxuICAgIC8vIHRvIGJlIHdpdGhpbiA4MDAgY2hhcmFjdGVycyBvZiB0aGUgZnV6enkgbG9jYXRpb24gdG8gYmUgZm91bmQgdXNpbmcgYSAwLjggdGhyZXNob2xkLlxuICAgIGRpc3RhbmNlOiAxMDAsXG5cbiAgICAvLyBBdCB3aGF0IHBvaW50IGRvZXMgdGhlIG1hdGNoIGFsZ29yaXRobSBnaXZlIHVwLiBBIHRocmVzaG9sZCBvZiAnMC4wJyByZXF1aXJlcyBhIHBlcmZlY3QgbWF0Y2hcbiAgICAvLyAob2YgYm90aCBsZXR0ZXJzIGFuZCBsb2NhdGlvbiksIGEgdGhyZXNob2xkIG9mICcxLjAnIHdvdWxkIG1hdGNoIGFueXRoaW5nLlxuICAgIHRocmVzaG9sZDogMC42LFxuXG4gICAgLy8gTWFjaGluZSB3b3JkIHNpemVcbiAgICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMlxuICB9XG5cbiAgLyoqXG4gICAqIEluaXRpYWxpemUgdGhlIGFscGhhYmV0IGZvciB0aGUgQml0YXAgYWxnb3JpdGhtLlxuICAgKiBAcmV0dXJuIHtPYmplY3R9IEhhc2ggb2YgY2hhcmFjdGVyIGxvY2F0aW9ucy5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLl9jYWxjdWxhdGVQYXR0ZXJuQWxwaGFiZXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG1hc2sgPSB7fSxcbiAgICAgIGkgPSAwXG5cbiAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy5wYXR0ZXJuTGVuOyBpKyspIHtcbiAgICAgIG1hc2tbdGhpcy5wYXR0ZXJuLmNoYXJBdChpKV0gPSAwXG4gICAgfVxuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMucGF0dGVybkxlbjsgaSsrKSB7XG4gICAgICBtYXNrW3RoaXMucGF0dGVybi5jaGFyQXQoaSldIHw9IDEgPDwgKHRoaXMucGF0dGVybi5sZW5ndGggLSBpIC0gMSlcbiAgICB9XG5cbiAgICByZXR1cm4gbWFza1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGUgYW5kIHJldHVybiB0aGUgc2NvcmUgZm9yIGEgbWF0Y2ggd2l0aCBgZWAgZXJyb3JzIGFuZCBgeGAgbG9jYXRpb24uXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBlcnJvcnMgTnVtYmVyIG9mIGVycm9ycyBpbiBtYXRjaC5cbiAgICogQHBhcmFtIHtudW1iZXJ9IGxvY2F0aW9uIExvY2F0aW9uIG9mIG1hdGNoLlxuICAgKiBAcmV0dXJuIHtudW1iZXJ9IE92ZXJhbGwgc2NvcmUgZm9yIG1hdGNoICgwLjAgPSBnb29kLCAxLjAgPSBiYWQpLlxuICAgKiBAcHJpdmF0ZVxuICAgKi9cbiAgQml0YXBTZWFyY2hlci5wcm90b3R5cGUuX2JpdGFwU2NvcmUgPSBmdW5jdGlvbiAoZXJyb3JzLCBsb2NhdGlvbikge1xuICAgIHZhciBhY2N1cmFjeSA9IGVycm9ycyAvIHRoaXMucGF0dGVybkxlbixcbiAgICAgIHByb3hpbWl0eSA9IE1hdGguYWJzKHRoaXMub3B0aW9ucy5sb2NhdGlvbiAtIGxvY2F0aW9uKVxuXG4gICAgaWYgKCF0aGlzLm9wdGlvbnMuZGlzdGFuY2UpIHtcbiAgICAgIC8vIERvZGdlIGRpdmlkZSBieSB6ZXJvIGVycm9yLlxuICAgICAgcmV0dXJuIHByb3hpbWl0eSA/IDEuMCA6IGFjY3VyYWN5XG4gICAgfVxuICAgIHJldHVybiBhY2N1cmFjeSArIChwcm94aW1pdHkgLyB0aGlzLm9wdGlvbnMuZGlzdGFuY2UpXG4gIH1cblxuICAvKipcbiAgICogQ29tcHV0ZSBhbmQgcmV0dXJuIHRoZSByZXN1bHQgb2YgdGhlIHNlYXJjaFxuICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBUaGUgdGV4dCB0byBzZWFyY2ggaW5cbiAgICogQHJldHVybiB7e2lzTWF0Y2g6IGJvb2xlYW4sIHNjb3JlOiBudW1iZXJ9fSBMaXRlcmFsIGNvbnRhaW5pbmc6XG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICBpc01hdGNoIC0gV2hldGhlciB0aGUgdGV4dCBpcyBhIG1hdGNoIG9yIG5vdFxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgc2NvcmUgLSBPdmVyYWxsIHNjb3JlIGZvciB0aGUgbWF0Y2hcbiAgICogQHB1YmxpY1xuICAgKi9cbiAgQml0YXBTZWFyY2hlci5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24gKHRleHQpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBpXG4gICAgdmFyIGpcbiAgICB2YXIgdGV4dExlblxuICAgIHZhciBmaW5kQWxsTWF0Y2hlc1xuICAgIHZhciBsb2NhdGlvblxuICAgIHZhciB0aHJlc2hvbGRcbiAgICB2YXIgYmVzdExvY1xuICAgIHZhciBiaW5NaW5cbiAgICB2YXIgYmluTWlkXG4gICAgdmFyIGJpbk1heFxuICAgIHZhciBzdGFydCwgZmluaXNoXG4gICAgdmFyIGJpdEFyclxuICAgIHZhciBsYXN0Qml0QXJyXG4gICAgdmFyIGNoYXJNYXRjaFxuICAgIHZhciBzY29yZVxuICAgIHZhciBsb2NhdGlvbnNcbiAgICB2YXIgbWF0Y2hlc1xuICAgIHZhciBpc01hdGNoZWRcbiAgICB2YXIgbWF0Y2hNYXNrXG4gICAgdmFyIG1hdGNoZWRJbmRpY2VzXG4gICAgdmFyIG1hdGNoZXNMZW5cbiAgICB2YXIgbWF0Y2hcblxuICAgIHRleHQgPSBvcHRpb25zLmNhc2VTZW5zaXRpdmUgPyB0ZXh0IDogdGV4dC50b0xvd2VyQ2FzZSgpXG5cbiAgICBpZiAodGhpcy5wYXR0ZXJuID09PSB0ZXh0KSB7XG4gICAgICAvLyBFeGFjdCBtYXRjaFxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNNYXRjaDogdHJ1ZSxcbiAgICAgICAgc2NvcmU6IDAsXG4gICAgICAgIG1hdGNoZWRJbmRpY2VzOiBbWzAsIHRleHQubGVuZ3RoIC0gMV1dXG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gV2hlbiBwYXR0ZXJuIGxlbmd0aCBpcyBncmVhdGVyIHRoYW4gdGhlIG1hY2hpbmUgd29yZCBsZW5ndGgsIGp1c3QgZG8gYSBhIHJlZ2V4IGNvbXBhcmlzb25cbiAgICBpZiAodGhpcy5wYXR0ZXJuTGVuID4gb3B0aW9ucy5tYXhQYXR0ZXJuTGVuZ3RoKSB7XG4gICAgICBtYXRjaGVzID0gdGV4dC5tYXRjaChuZXcgUmVnRXhwKHRoaXMucGF0dGVybi5yZXBsYWNlKG9wdGlvbnMudG9rZW5TZXBhcmF0b3IsICd8JykpKVxuICAgICAgaXNNYXRjaGVkID0gISFtYXRjaGVzXG5cbiAgICAgIGlmIChpc01hdGNoZWQpIHtcbiAgICAgICAgbWF0Y2hlZEluZGljZXMgPSBbXVxuICAgICAgICBmb3IgKGkgPSAwLCBtYXRjaGVzTGVuID0gbWF0Y2hlcy5sZW5ndGg7IGkgPCBtYXRjaGVzTGVuOyBpKyspIHtcbiAgICAgICAgICBtYXRjaCA9IG1hdGNoZXNbaV1cbiAgICAgICAgICBtYXRjaGVkSW5kaWNlcy5wdXNoKFt0ZXh0LmluZGV4T2YobWF0Y2gpLCBtYXRjaC5sZW5ndGggLSAxXSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICByZXR1cm4ge1xuICAgICAgICBpc01hdGNoOiBpc01hdGNoZWQsXG4gICAgICAgIC8vIFRPRE86IHJldmlzaXQgdGhpcyBzY29yZVxuICAgICAgICBzY29yZTogaXNNYXRjaGVkID8gMC41IDogMSxcbiAgICAgICAgbWF0Y2hlZEluZGljZXM6IG1hdGNoZWRJbmRpY2VzXG4gICAgICB9XG4gICAgfVxuXG4gICAgZmluZEFsbE1hdGNoZXMgPSBvcHRpb25zLmZpbmRBbGxNYXRjaGVzXG5cbiAgICBsb2NhdGlvbiA9IG9wdGlvbnMubG9jYXRpb25cbiAgICAvLyBTZXQgc3RhcnRpbmcgbG9jYXRpb24gYXQgYmVnaW5uaW5nIHRleHQgYW5kIGluaXRpYWxpemUgdGhlIGFscGhhYmV0LlxuICAgIHRleHRMZW4gPSB0ZXh0Lmxlbmd0aFxuICAgIC8vIEhpZ2hlc3Qgc2NvcmUgYmV5b25kIHdoaWNoIHdlIGdpdmUgdXAuXG4gICAgdGhyZXNob2xkID0gb3B0aW9ucy50aHJlc2hvbGRcbiAgICAvLyBJcyB0aGVyZSBhIG5lYXJieSBleGFjdCBtYXRjaD8gKHNwZWVkdXApXG4gICAgYmVzdExvYyA9IHRleHQuaW5kZXhPZih0aGlzLnBhdHRlcm4sIGxvY2F0aW9uKVxuXG4gICAgLy8gYSBtYXNrIG9mIHRoZSBtYXRjaGVzXG4gICAgbWF0Y2hNYXNrID0gW11cbiAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dExlbjsgaSsrKSB7XG4gICAgICBtYXRjaE1hc2tbaV0gPSAwXG4gICAgfVxuXG4gICAgaWYgKGJlc3RMb2MgIT0gLTEpIHtcbiAgICAgIHRocmVzaG9sZCA9IE1hdGgubWluKHRoaXMuX2JpdGFwU2NvcmUoMCwgYmVzdExvYyksIHRocmVzaG9sZClcbiAgICAgIC8vIFdoYXQgYWJvdXQgaW4gdGhlIG90aGVyIGRpcmVjdGlvbj8gKHNwZWVkIHVwKVxuICAgICAgYmVzdExvYyA9IHRleHQubGFzdEluZGV4T2YodGhpcy5wYXR0ZXJuLCBsb2NhdGlvbiArIHRoaXMucGF0dGVybkxlbilcblxuICAgICAgaWYgKGJlc3RMb2MgIT0gLTEpIHtcbiAgICAgICAgdGhyZXNob2xkID0gTWF0aC5taW4odGhpcy5fYml0YXBTY29yZSgwLCBiZXN0TG9jKSwgdGhyZXNob2xkKVxuICAgICAgfVxuICAgIH1cblxuICAgIGJlc3RMb2MgPSAtMVxuICAgIHNjb3JlID0gMVxuICAgIGxvY2F0aW9ucyA9IFtdXG4gICAgYmluTWF4ID0gdGhpcy5wYXR0ZXJuTGVuICsgdGV4dExlblxuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMucGF0dGVybkxlbjsgaSsrKSB7XG4gICAgICAvLyBTY2FuIGZvciB0aGUgYmVzdCBtYXRjaDsgZWFjaCBpdGVyYXRpb24gYWxsb3dzIGZvciBvbmUgbW9yZSBlcnJvci5cbiAgICAgIC8vIFJ1biBhIGJpbmFyeSBzZWFyY2ggdG8gZGV0ZXJtaW5lIGhvdyBmYXIgZnJvbSB0aGUgbWF0Y2ggbG9jYXRpb24gd2UgY2FuIHN0cmF5XG4gICAgICAvLyBhdCB0aGlzIGVycm9yIGxldmVsLlxuICAgICAgYmluTWluID0gMFxuICAgICAgYmluTWlkID0gYmluTWF4XG4gICAgICB3aGlsZSAoYmluTWluIDwgYmluTWlkKSB7XG4gICAgICAgIGlmICh0aGlzLl9iaXRhcFNjb3JlKGksIGxvY2F0aW9uICsgYmluTWlkKSA8PSB0aHJlc2hvbGQpIHtcbiAgICAgICAgICBiaW5NaW4gPSBiaW5NaWRcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBiaW5NYXggPSBiaW5NaWRcbiAgICAgICAgfVxuICAgICAgICBiaW5NaWQgPSBNYXRoLmZsb29yKChiaW5NYXggLSBiaW5NaW4pIC8gMiArIGJpbk1pbilcbiAgICAgIH1cblxuICAgICAgLy8gVXNlIHRoZSByZXN1bHQgZnJvbSB0aGlzIGl0ZXJhdGlvbiBhcyB0aGUgbWF4aW11bSBmb3IgdGhlIG5leHQuXG4gICAgICBiaW5NYXggPSBiaW5NaWRcbiAgICAgIHN0YXJ0ID0gTWF0aC5tYXgoMSwgbG9jYXRpb24gLSBiaW5NaWQgKyAxKVxuICAgICAgaWYgKGZpbmRBbGxNYXRjaGVzKSB7XG4gICAgICAgIGZpbmlzaCA9IHRleHRMZW47XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaW5pc2ggPSBNYXRoLm1pbihsb2NhdGlvbiArIGJpbk1pZCwgdGV4dExlbikgKyB0aGlzLnBhdHRlcm5MZW5cbiAgICAgIH1cblxuICAgICAgLy8gSW5pdGlhbGl6ZSB0aGUgYml0IGFycmF5XG4gICAgICBiaXRBcnIgPSBBcnJheShmaW5pc2ggKyAyKVxuXG4gICAgICBiaXRBcnJbZmluaXNoICsgMV0gPSAoMSA8PCBpKSAtIDFcblxuICAgICAgZm9yIChqID0gZmluaXNoOyBqID49IHN0YXJ0OyBqLS0pIHtcbiAgICAgICAgY2hhck1hdGNoID0gdGhpcy5wYXR0ZXJuQWxwaGFiZXRbdGV4dC5jaGFyQXQoaiAtIDEpXVxuXG4gICAgICAgIGlmIChjaGFyTWF0Y2gpIHtcbiAgICAgICAgICBtYXRjaE1hc2tbaiAtIDFdID0gMVxuICAgICAgICB9XG5cbiAgICAgICAgYml0QXJyW2pdID0gKChiaXRBcnJbaiArIDFdIDw8IDEpIHwgMSkgJiBjaGFyTWF0Y2hcblxuICAgICAgICBpZiAoaSAhPT0gMCkge1xuICAgICAgICAgIC8vIFN1YnNlcXVlbnQgcGFzc2VzOiBmdXp6eSBtYXRjaC5cbiAgICAgICAgICBiaXRBcnJbal0gfD0gKCgobGFzdEJpdEFycltqICsgMV0gfCBsYXN0Qml0QXJyW2pdKSA8PCAxKSB8IDEpIHwgbGFzdEJpdEFycltqICsgMV1cbiAgICAgICAgfVxuICAgICAgICBpZiAoYml0QXJyW2pdICYgdGhpcy5tYXRjaG1hc2spIHtcbiAgICAgICAgICBzY29yZSA9IHRoaXMuX2JpdGFwU2NvcmUoaSwgaiAtIDEpXG5cbiAgICAgICAgICAvLyBUaGlzIG1hdGNoIHdpbGwgYWxtb3N0IGNlcnRhaW5seSBiZSBiZXR0ZXIgdGhhbiBhbnkgZXhpc3RpbmcgbWF0Y2guXG4gICAgICAgICAgLy8gQnV0IGNoZWNrIGFueXdheS5cbiAgICAgICAgICBpZiAoc2NvcmUgPD0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgICAvLyBJbmRlZWQgaXQgaXNcbiAgICAgICAgICAgIHRocmVzaG9sZCA9IHNjb3JlXG4gICAgICAgICAgICBiZXN0TG9jID0gaiAtIDFcbiAgICAgICAgICAgIGxvY2F0aW9ucy5wdXNoKGJlc3RMb2MpXG5cbiAgICAgICAgICAgIC8vIEFscmVhZHkgcGFzc2VkIGxvYywgZG93bmhpbGwgZnJvbSBoZXJlIG9uIGluLlxuICAgICAgICAgICAgaWYgKGJlc3RMb2MgPD0gbG9jYXRpb24pIHtcbiAgICAgICAgICAgICAgYnJlYWtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy8gV2hlbiBwYXNzaW5nIGxvYywgZG9uJ3QgZXhjZWVkIG91ciBjdXJyZW50IGRpc3RhbmNlIGZyb20gbG9jLlxuICAgICAgICAgICAgc3RhcnQgPSBNYXRoLm1heCgxLCAyICogbG9jYXRpb24gLSBiZXN0TG9jKVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICAvLyBObyBob3BlIGZvciBhIChiZXR0ZXIpIG1hdGNoIGF0IGdyZWF0ZXIgZXJyb3IgbGV2ZWxzLlxuICAgICAgaWYgKHRoaXMuX2JpdGFwU2NvcmUoaSArIDEsIGxvY2F0aW9uKSA+IHRocmVzaG9sZCkge1xuICAgICAgICBicmVha1xuICAgICAgfVxuICAgICAgbGFzdEJpdEFyciA9IGJpdEFyclxuICAgIH1cblxuICAgIG1hdGNoZWRJbmRpY2VzID0gdGhpcy5fZ2V0TWF0Y2hlZEluZGljZXMobWF0Y2hNYXNrKVxuXG4gICAgLy8gQ291bnQgZXhhY3QgbWF0Y2hlcyAodGhvc2Ugd2l0aCBhIHNjb3JlIG9mIDApIHRvIGJlIFwiYWxtb3N0XCIgZXhhY3RcbiAgICByZXR1cm4ge1xuICAgICAgaXNNYXRjaDogYmVzdExvYyA+PSAwLFxuICAgICAgc2NvcmU6IHNjb3JlID09PSAwID8gMC4wMDEgOiBzY29yZSxcbiAgICAgIG1hdGNoZWRJbmRpY2VzOiBtYXRjaGVkSW5kaWNlc1xuICAgIH1cbiAgfVxuXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLl9nZXRNYXRjaGVkSW5kaWNlcyA9IGZ1bmN0aW9uIChtYXRjaE1hc2spIHtcbiAgICB2YXIgbWF0Y2hlZEluZGljZXMgPSBbXVxuICAgIHZhciBzdGFydCA9IC0xXG4gICAgdmFyIGVuZCA9IC0xXG4gICAgdmFyIGkgPSAwXG4gICAgdmFyIG1hdGNoXG4gICAgdmFyIGxlbiA9IG1hdGNoTWFzay5sZW5ndGhcbiAgICBmb3IgKDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICBtYXRjaCA9IG1hdGNoTWFza1tpXVxuICAgICAgaWYgKG1hdGNoICYmIHN0YXJ0ID09PSAtMSkge1xuICAgICAgICBzdGFydCA9IGlcbiAgICAgIH0gZWxzZSBpZiAoIW1hdGNoICYmIHN0YXJ0ICE9PSAtMSkge1xuICAgICAgICBlbmQgPSBpIC0gMVxuICAgICAgICBpZiAoKGVuZCAtIHN0YXJ0KSArIDEgPj0gdGhpcy5vcHRpb25zLm1pbk1hdGNoQ2hhckxlbmd0aCkge1xuICAgICAgICAgICAgbWF0Y2hlZEluZGljZXMucHVzaChbc3RhcnQsIGVuZF0pXG4gICAgICAgIH1cbiAgICAgICAgc3RhcnQgPSAtMVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAobWF0Y2hNYXNrW2kgLSAxXSkge1xuICAgICAgaWYgKChpLTEgLSBzdGFydCkgKyAxID49IHRoaXMub3B0aW9ucy5taW5NYXRjaENoYXJMZW5ndGgpIHtcbiAgICAgICAgbWF0Y2hlZEluZGljZXMucHVzaChbc3RhcnQsIGkgLSAxXSlcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG1hdGNoZWRJbmRpY2VzXG4gIH1cblxuICAvLyBFeHBvcnQgdG8gQ29tbW9uIEpTIExvYWRlclxuICBpZiAodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnKSB7XG4gICAgLy8gTm9kZS4gRG9lcyBub3Qgd29yayB3aXRoIHN0cmljdCBDb21tb25KUywgYnV0XG4gICAgLy8gb25seSBDb21tb25KUy1saWtlIGVudmlyb25tZW50cyB0aGF0IHN1cHBvcnQgbW9kdWxlLmV4cG9ydHMsXG4gICAgLy8gbGlrZSBOb2RlLlxuICAgIG1vZHVsZS5leHBvcnRzID0gRnVzZVxuICB9IGVsc2UgaWYgKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCkge1xuICAgIC8vIEFNRC4gUmVnaXN0ZXIgYXMgYW4gYW5vbnltb3VzIG1vZHVsZS5cbiAgICBkZWZpbmUoZnVuY3Rpb24gKCkge1xuICAgICAgcmV0dXJuIEZ1c2VcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIC8vIEJyb3dzZXIgZ2xvYmFscyAocm9vdCBpcyB3aW5kb3cpXG4gICAgZ2xvYmFsLkZ1c2UgPSBGdXNlXG4gIH1cblxufSkodGhpcyk7XG5cbn0se31dLDM2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbi8qIVxuICogRGV0ZXJtaW5lIGlmIGFuIG9iamVjdCBpcyBhIEJ1ZmZlclxuICpcbiAqIEBhdXRob3IgICBGZXJvc3MgQWJvdWtoYWRpamVoIDxmZXJvc3NAZmVyb3NzLm9yZz4gPGh0dHA6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG5cbi8vIFRoZSBfaXNCdWZmZXIgY2hlY2sgaXMgZm9yIFNhZmFyaSA1LTcgc3VwcG9ydCwgYmVjYXVzZSBpdCdzIG1pc3Npbmdcbi8vIE9iamVjdC5wcm90b3R5cGUuY29uc3RydWN0b3IuIFJlbW92ZSB0aGlzIGV2ZW50dWFsbHlcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICE9IG51bGwgJiYgKGlzQnVmZmVyKG9iaikgfHwgaXNTbG93QnVmZmVyKG9iaikgfHwgISFvYmouX2lzQnVmZmVyKVxufVxuXG5mdW5jdGlvbiBpc0J1ZmZlciAob2JqKSB7XG4gIHJldHVybiAhIW9iai5jb25zdHJ1Y3RvciAmJiB0eXBlb2Ygb2JqLmNvbnN0cnVjdG9yLmlzQnVmZmVyID09PSAnZnVuY3Rpb24nICYmIG9iai5jb25zdHJ1Y3Rvci5pc0J1ZmZlcihvYmopXG59XG5cbi8vIEZvciBOb2RlIHYwLjEwIHN1cHBvcnQuIFJlbW92ZSB0aGlzIGV2ZW50dWFsbHkuXG5mdW5jdGlvbiBpc1Nsb3dCdWZmZXIgKG9iaikge1xuICByZXR1cm4gdHlwZW9mIG9iai5yZWFkRmxvYXRMRSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2Ygb2JqLnNsaWNlID09PSAnZnVuY3Rpb24nICYmIGlzQnVmZmVyKG9iai5zbGljZSgwLCAwKSlcbn1cblxufSx7fV0sMzc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxufSx7fV19LHt9LFs2XSlcblxuIiwiaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCBGdXNlanMgZnJvbSAnZnVzZS5qcyc7XG5cbmltcG9ydCBQdWJTdWIgZnJvbSAnLi9wdWJzdWInO1xuaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJy4vaGVscGVycy91bmRlcnNjb3JlJztcblxubGV0IGZ1c2U7XG5cbi8vIEluaXRpYWxpemUgZnVzZS5qcyBvcHRpb25zXG5jb25zdCBmdXNlT3B0aW9ucyA9IHtcbiAgc2hvdWxkU29ydDogdHJ1ZSxcbiAgdGhyZXNob2xkOiAwLjEsXG4gIGxvY2F0aW9uOiAwLFxuICBkaXN0YW5jZTogMTAwLFxuICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMixcbiAgbWluTWF0Y2hDaGFyTGVuZ3RoOiAxLFxuICBrZXlzOiBbXG4gICAgJ2FydGlzdCcsXG4gICAgJ3RpdGxlJyxcbiAgXSxcbn07XG5cbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY3MTIwMzQvc29ydC1hcnJheS1ieS1maXJzdG5hbWUtYWxwaGFiZXRpY2FsbHktaW4tamF2YXNjcmlwdFxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTQyMTI1My9zb3J0LWphdmFzY3JpcHQtYXJyYXktb2Ytb2JqZWN0cy1iYXNlZC1vbi1vbmUtb2YtdGhlLW9iamVjdHMtcHJvcGVydGllc1xuY29uc3Qgc29ydFNvbmdzID0gKHNvbmdMaXN0KSA9PiB7XG4gIGNvbnN0IHNvcnRlZCA9IHNvbmdMaXN0LnNvcnQoKGEsIGIpID0+IHtcbiAgICBjb25zdCBhbGMgPSBhLmFydGlzdC50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IGJsYyA9IGIuYXJ0aXN0LnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGFsYyA+IGJsYykge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChhbGMgPCBibGMpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG4gIH0pO1xuICByZXR1cm4gc29ydGVkO1xufTtcblxuZnVuY3Rpb24gZ3JvdXBTb25ncyhzb25nTGlzdCkge1xuICBjb25zdCBncm91cGVkID0gZ3JvdXBCeShzb25nTGlzdCwgJ2FydGlzdCcpO1xuICByZXR1cm4gZ3JvdXBlZDtcbn1cblxuZnVuY3Rpb24gZmlsdGVyQnlMZXR0ZXIoc29uZ0xpc3QsIGxldHRlcikge1xuICBjb25zdCBmaWx0ID0gc29uZ0xpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IGxldHRlcik7XG4gIHJldHVybiBmaWx0O1xufVxuXG5cbmZ1bmN0aW9uIGZpbHRlckJ5VGVybShzb25nTGlzdCwgc2VhcmNoVGVybSkge1xuICBmdXNlID0gbmV3IEZ1c2Vqcyhzb25nTGlzdCwgZnVzZU9wdGlvbnMpO1xuICBjb25zdCBmdXNlUmVzdWx0cyA9IGZ1c2Uuc2VhcmNoKHNlYXJjaFRlcm0pO1xuICByZXR1cm4gZnVzZVJlc3VsdHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWFyY2hCeU5hbWUoc2VhcmNoVGVybSkge1xuICBQdWJTdWIucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IHNlYXJjaFRlcm0gfSk7XG4gIHJldHVybiBheGlvcy5nZXQoJ3NlYXJjaF9kYXRhLmpzb24nKVxuICAgIC50aGVuKHJlc3VsdHMgPT4gZmlsdGVyQnlUZXJtKHJlc3VsdHMuZGF0YSwgc2VhcmNoVGVybSkpXG4gICAgLnRoZW4oc29ydFNvbmdzKVxuICAgIC50aGVuKGdyb3VwU29uZ3MpXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kQXJ0aXN0c0J5TGV0dGVyKGxldHRlcikge1xuICBQdWJTdWIucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IGxldHRlciB9KTtcbiAgcmV0dXJuIGF4aW9zLmdldCgnc2VhcmNoX2RhdGEuanNvbicpXG4gICAgLnRoZW4ocmVzdWx0cyA9PiBmaWx0ZXJCeUxldHRlcihyZXN1bHRzLmRhdGEsIGxldHRlcikpXG4gICAgLnRoZW4oc29ydFNvbmdzKVxuICAgIC50aGVuKGdyb3VwU29uZ3MpXG4gICAgLy8gLnRoZW4ocmVzdWx0cyA9PiBzb3J0U29uZ3MocmVzdWx0cywgbGV0dGVyKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9KTtcbn1cbi8qXG5mdW5jdGlvbiBzZWFyY2goKSB7XG4gIGF4aW9zLmdldCgnc2VhcmNoX2RhdGEuanNvbicpXG4gIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgIGxvYWRyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgY29uc3QgZmlsdCA9IGRhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IHRoaXMuZGF0YXNldC5sZXR0ZXIpO1xuXG4gICAgUHViU3ViLnB1Ymxpc2goJ3VwZGF0ZUxpc3QnLCB7IGxpc3Q6IGZpbHQgfSk7XG5cbiAgICBkaXNwbGF5U2VhcmNoUmVzdWx0cyhmaWx0KTtcbiAgfSlcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNvcnRTb25ncyhyZXN1bHRzLCBsZXR0ZXIpIHtcbiAgY29uc29sZS5sb2coJ3NvcnRTb25ncycpO1xuICBjb25zdCBhbGxTb25ncyA9IHJlc3VsdHMuZGF0YTtcbiAgY29uc3QgZmlsdGVyZWRTb25ncyA9IGFsbFNvbmdzLmZpbHRlcihpdGVtID0+IGl0ZW0uYXJ0aXN0LnRvU3RyaW5nKCkuY2hhckF0KDApID09PSBsZXR0ZXIpO1xuXG4gIGNvbnN0IHNvbmdsaXN0U29ydGVkID0gZmlsdGVyZWRTb25ncy5zb3J0KChhLCBiKSA9PiBiLmFydGlzdCAtIGEuYXJ0aXN0KTtcbiAgY29uc3Qgc29uZ2xpc3RHcm91cGVkID0gZ3JvdXBCeShzb25nbGlzdFNvcnRlZCwgJ2FydGlzdCcpO1xuXG4gIHJldHVybiBzb25nbGlzdEdyb3VwZWQ7XG59XG5cbiovXG4iLCJpbXBvcnQgeyBkZWxlZ2F0ZUV2ZW50TGlzdGVuZXIgfSBmcm9tICcuL2hlbHBlcnMvZXZlbnRzJztcbmltcG9ydCBQdWJTdWIgZnJvbSAnLi9wdWJzdWInO1xuaW1wb3J0ICogYXMgYXBpIGZyb20gJy4vYXBpJztcblxuY29uc3QgbGV0dGVyTWVudUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hei1zZWFyY2gnKTtcblxuZnVuY3Rpb24gbGV0dGVyQ2xpY2tIYW5kbGVyKGV2dCkge1xuICBjb25zdCBlID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHRoZUxldHRlciA9IHRoaXMuZGF0YXNldC5sZXR0ZXI7XG5cblxuICBhcGkuZmluZEFydGlzdHNCeUxldHRlcih0aGVMZXR0ZXIpXG4gICAgLnRoZW4oKHNvbmdMaXN0KSA9PiB7XG4gICAgICBQdWJTdWIucHVibGlzaCgnc2VhcmNoQ29tcGxldGUnLCB7IHNvbmdMaXN0LCBzZWFyY2hUZXJtOiB0aGVMZXR0ZXIgfSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGluaXRMZXR0ZXJNZW51KCkge1xuICBjb25zdCBsZXR0ZXJzID0gJ3F3ZXJ0eXVpb3Bhc2RmZ2hqa2x6eGN2Ym5tJztcbiAgY29uc3QgdXBwZXJjYXNlTGV0dGVycyA9IGxldHRlcnMudG9VcHBlckNhc2UoKTtcbiAgY29uc3QgbGV0dGVyTGlzdCA9IFsuLi51cHBlcmNhc2VMZXR0ZXJzXTtcbiAgY29uc3Qgc29ydGVkTGlzdCA9IGxldHRlckxpc3Quc29ydCgpO1xuICBjb25zdCBodG1sTGlzdCA9IHNvcnRlZExpc3QubWFwKGl0ZW0gPT4gYDxsaSBjbGFzcz1cIm8tbGlzdC1pbmxpbmVfX2l0ZW0gYy1hel9faXRlbVwiPjxhIGNsYXNzPVwiYy1hel9fbGV0dGVyXCIgZGF0YS1sZXR0ZXI9XCIke2l0ZW19XCI+JHtpdGVtfTwvYT48L2xpPmApLmpvaW4oJycpO1xuICAvLyBjb250YWluZXIuaW5uZXJIVE1MID0gYDx1bCBjbGFzcz1cIm8tbGlzdC1pbmxpbmUgYy1helwiPiR7aHRtbExpc3R9PC91bD5gO1xuICAvLyBjb25zdCBsZXR0ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcubGV0dGVyJyk7XG5cbiAgLy8gbGV0dGVyLmZvckVhY2gobGV0dCA9PiBsZXR0LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgbGV0dGVyQ2xpY2tIYW5kbGVyKSk7XG4gIHJldHVybiBgPHVsIGNsYXNzPVwiby1saXN0LWlubGluZSBjLWF6XCI+JHtodG1sTGlzdH08L3VsPmA7XG59XG5cbmxldHRlck1lbnVDb250YWluZXIuaW5uZXJIVE1MID0gaW5pdExldHRlck1lbnUoKTtcbmRlbGVnYXRlRXZlbnRMaXN0ZW5lcihsZXR0ZXJNZW51Q29udGFpbmVyLCAnY2xpY2snLCAnYScsIGxldHRlckNsaWNrSGFuZGxlcik7XG4iLCIvKlxuICogYWRhcHRlZCBmcm9tIGh0dHBzOi8vY29kZXBlbi5pby9kaXZzd2l0aGNsYXNzL3Blbi9Kb1JXZHdcbiAqIGZyb20gYSBzaW5nbGUgZWxlbWVudCAoaS5lLiBxdWVyeVNlbGVjdG9yIG9yIGdldEVsZW1lbnRCeU5hbWUpXG4gKiB5b3UgY2FuIGFkZCwgcmVtb3ZlLCBvciB0b2dnbGUgYSBjbGFzc1xuICpcbiAqIEBwYXJhbSB7RE9NIEVsZW1lbnR9IGVsIC0gVGhlIGVsZW1lbnQgdG8gYWx0ZXJcbiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgLSB0aGUgY2xhc3MgbmFtZSB0byBhZGQsIHJlbW92ZSwgdG9nZ2xlXG4gKi9cblxuZXhwb3J0IGNvbnN0IGFkZENsYXNzID0gKGVsZW1lbnQsIGNsYXNzTmFtZSkgPT4ge1xuICBjb25zdCBlbCA9IGVsZW1lbnQ7XG5cbiAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbC5jbGFzc05hbWUgKz0gYCAke2NsYXNzTmFtZX1gO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgcmVtb3ZlQ2xhc3MgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gIGNvbnN0IGVsID0gZWxlbWVudDtcblxuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYChefFxcXFxiKSR7Y2xhc3NOYW1lLnNwbGl0KCcgJykuam9pbignfCcpfShcXFxcYnwkKWAsICdnaScpLCAnICcpO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICB9XG4gIHJldHVybiBuZXcgUmVnRXhwKGAoXnwgKSR7Y2xhc3NOYW1lfSggfCQpYCwgJ2dpJykudGVzdChlbC5jbGFzc05hbWUpO1xufVxuXG5leHBvcnQgY29uc3QgdG9nZ2xlQ2xhc3MgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gIGNvbnN0IGVsID0gZWxlbWVudDtcblxuICBpZiAoaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkpIHtcbiAgICByZW1vdmVDbGFzcyhlbCwgY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBhZGRDbGFzcyhlbCwgY2xhc3NOYW1lKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHNldFN0eWxlID0gKGVsZW1lbnQsIHByb3BlcnR5T2JqZWN0KSA9PiB7XG4gIGNvbnN0IHN0eWxlcyA9IHByb3BlcnR5T2JqZWN0O1xuXG4gIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGVzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBmaW5kUGFyZW50QnlUYWdOYW1lID0gKGVsZW1lbnQsIHRhZ05hbWUpID0+IHtcbiAgbGV0IHBhcmVudCA9IGVsZW1lbnQ7XG5cbiAgd2hpbGUgKHBhcmVudCAhPT0gbnVsbCAmJiBwYXJlbnQudGFnTmFtZSAhPT0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHBhcmVudDtcbn07XG4iLCIvKipcbiAqIEN1c3RvbSBqYXZhc2NyaXB0IGV2ZW50cyBvZiBqUXVlcnkgZnVuY3Rpb25zXG4gKi9cbi8qKlxuICogQ3VzdG9tIGV2ZW50IGRpc3BhdGNoZXIgKG1pbWljcyBqcXVlcnkgdHJpZ2dlcilcbiAqIEBwYXJhbSAge2VsZW1lbnR9IGVsZW1lbnQgICBFbGVtZW50IHRvIHRyaWdnZXIgb25cbiAqIEBwYXJhbSAge3N0cmluZ30gZXZlbnRuYW1lIEN1c3RvbSBldmVudCBuYW1lXG4gKiBAcGFyYW0gIHtPYmplY3R9IFtvYmo9e31dICBDdXN0b20gcGFyYW1ldGVycyB0byBwYXNzIGFsb25nIChmaW5kIGluIGV2ZW50LmRldGFpbClcbiAqIEByZXR1cm4ge251bGx9ICAgICAgICAgICBObyByZXR1cm4gdmFsdWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyaWdnZXIoZWxlbWVudCwgZXZlbnRuYW1lLCBvYmogPSB7fSkge1xuICBsZXQgZXZlbnQ7XG5cbiAgaWYgKHdpbmRvdy5DdXN0b21FdmVudCkge1xuICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50bmFtZSwgeyBkZXRhaWw6IG9iaiB9KTtcbiAgfSBlbHNlIHtcbiAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGV2ZW50LmluaXRDdXN0b21FdmVudChldmVudG5hbWUsIHRydWUsIHRydWUsIG9iaik7XG4gIH1cblxuICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG4vKipcbiAqIERlbGVnYXRlIGV2ZW50IGxpc3RlbmVyIHRvIGNoaWxkcmVuIChtaW1pY3MganF1ZXJ5IGJlaGF2aW9yKVxuICogKHNvdXJjZTogaHR0cDovL2JkYWRhbS5jb20vYmxvZy9wbGFpbi1qYXZhc2NyaXB0LWV2ZW50LWRlbGVnYXRpb24uaHRtbClcbiAqIEBwYXJhbSAge2VsZW1lbnR9IGVsZW1lbnQgIERPTSBwYXJlbnQgZWxlbWVudFxuICogQHBhcmFtICB7c3RyaW5nfSBldnQgICAgICBFdmVudCB0byBsaXN0ZW4gdG9cbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgU2VsZWN0b3IgdG8gbWF0Y2ggY2hpbGRyZW4gYnlcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBoYW5kbGVyICBGdW5jdGlvbiB0byBydW4gYXMgZXZlbnQgaGFuZGxlclxuICogQHJldHVybiB7bnVsbH0gICAgICAgICAgTm8gUmV0dXJuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWxlZ2F0ZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgZXZ0LCBzZWxlY3RvciwgaGFuZGxlcikge1xuICBjb25zdCBlbCA9IGVsZW1lbnQ7XG4gIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCAoZXZlbnQpID0+IHtcbiAgICBjb25zdCBwb3NzaWJsZVRhcmdldHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvc3NpYmxlVGFyZ2V0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGxldCB0ID0gdGFyZ2V0O1xuICAgICAgY29uc3QgcCA9IHBvc3NpYmxlVGFyZ2V0c1tpXTtcblxuICAgICAgd2hpbGUgKHQgJiYgdCAhPT0gZWxlbWVudCkge1xuICAgICAgICBpZiAodCA9PT0gcCkge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVyLmNhbGwocCwgZXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbiAgLyogZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2dCwgZnVuY3Rpb24gY2FsbGJhY2soZXZlbnQpIHtcbiAgICBjb25zdCBlID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xuXG4gICAgbGV0IHQgPSBlLnRhcmdldDtcblxuICAgIHdoaWxlICh0ICYmIHQgIT09IHRoaXMpIHtcbiAgICAgIGNvbnNvbGUubG9nKGB3aGlsZSB0OiAke3R9YCk7XG4gICAgICBpZiAodC5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgbWF0Y2ggdDogJHt0fWApO1xuICAgICAgICBoYW5kbGVyLmNhbGwodCwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coYG91dHNpZGUgdDogJHt0fWApO1xuICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICB9XG4gIH0pO1xuICAqL1xufVxuIiwiLypcbiAqIEdyb3VwQnkgZnJvbSBodHRwOi8vd3d3LmRhdGNobGV5Lm5hbWUvZ2V0dGluZy1mdW5jdGlvbmFsLXdpdGgtamF2YXNjcmlwdC1wYXJ0LTIvXG4gKi9cblxuY29uc3QgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuY29uc3QgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIGlzRnVuY3Rpb24obykge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn07XG5cbi8qIGVzbGludCBuby1wYXJhbS1yZWFzc2lnbjogW1wiZXJyb3JcIiwgeyBcInByb3BzXCI6IGZhbHNlIH1dKi9cbmV4cG9ydCBjb25zdCBncm91cEJ5ID0gKGxpc3QsIHByb3ApID0+XG4gIGxpc3QucmVkdWNlKChncm91cGVkLCBpdGVtKSA9PiB7XG4gICAgY29uc3Qga2V5ID0gaXNGdW5jdGlvbihwcm9wKSA/IHByb3AuYXBwbHkodGhpcywgW2l0ZW1dKSA6IGl0ZW1bcHJvcF07XG4gICAgZ3JvdXBlZFtrZXldID0gZ3JvdXBlZFtrZXldIHx8IFtdO1xuICAgIGdyb3VwZWRba2V5XS5wdXNoKGl0ZW0pO1xuICAgIHJldHVybiBncm91cGVkO1xuICB9LCB7fSk7XG4iLCJpbXBvcnQgJy4vYXotc2VhcmNoJztcbmltcG9ydCAnLi9zZWFyY2gnO1xuaW1wb3J0ICcuL3Jlc3VsdHMnO1xuIiwiY29uc3QgcHVic3ViID0gKCgpID0+IHtcbiAgY29uc3QgdG9waWNzID0ge307XG5cbiAgY29uc3Qgc3Vic2NyaWJlID0gKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICB0b3BpY3NbZXZlbnROYW1lXSA9IHRvcGljc1tldmVudE5hbWVdIHx8IFtdO1xuICAgIHRvcGljc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICB9O1xuXG4gIGNvbnN0IHVuc3Vic2NyaWJlID0gKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICBpZiAodG9waWNzW2V2ZW50TmFtZV0pIHtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSB0b3BpY3NbZXZlbnROYW1lXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAodG9waWNzW2V2ZW50TmFtZV1baV0gPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgdG9waWNzW2V2ZW50TmFtZV0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHB1Ymxpc2ggPSAoZXZlbnROYW1lLCBkYXRhKSA9PiB7XG4gICAgaWYgKHRvcGljc1tldmVudE5hbWVdKSB7XG4gICAgICB0b3BpY3NbZXZlbnROYW1lXS5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHN1YnNjcmliZSxcbiAgICB1bnN1YnNjcmliZSxcbiAgICBwdWJsaXNoLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgcHVic3ViO1xuIiwiaW1wb3J0IHsgYWRkQ2xhc3MsIHJlbW92ZUNsYXNzIH0gZnJvbSAnLi9oZWxwZXJzL2RvbS1lbGVtZW50cyc7XG5pbXBvcnQgUHViU3ViIGZyb20gJy4vcHVic3ViJztcblxuY29uc3QgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtc2VhcmNoX3Jlc3VsdHMnKTtcbmNvbnN0IGxvYWRyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWRlcicpO1xuXG5mdW5jdGlvbiBjbGVhclJlc3VsdHMoKSB7XG4gIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9ICcnO1xuICByZW1vdmVDbGFzcyhsb2FkciwgJ3UtaGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlcihwdWJvYmopIHtcbiAgY29uc3Qgc29uZ0xpc3QgPSBwdWJvYmouc29uZ0xpc3Q7XG4gIGNvbnN0IHNlYXJjaFRlcm0gPSBwdWJvYmouc2VhcmNoVGVybTtcblxuICBsZXQgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9IGA8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzOiA8c3BhbiBjLXNlYXJjaF9fdGVybT4ke3NlYXJjaFRlcm19PC9zcGFuPjwvaDI+PHNlY3Rpb24gY2xhc3M9XCJjLXNlYXJjaF9fbGlzdFwiPmA7XG4gIE9iamVjdC5rZXlzKHNvbmdMaXN0KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBodG1sU3R1ZmYgKz0gYDxwIGNsYXNzPVwiYy1zZWFyY2hfX2FydGlzdFwiPiR7a2V5fTwvcD48dWw+YDtcbiAgICBzb25nTGlzdFtrZXldLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICBodG1sU3R1ZmYgKz0gYDxsaSBjbGFzcz1cImMtc2VhcmNoX190aXRsZVwiPiR7dmFsdWUudGl0bGV9PC9saT5gO1xuICAgIH0pO1xuICAgIGh0bWxTdHVmZiArPSAnPC91bD4nO1xuICB9KTtcbiAgaHRtbFN0dWZmICs9ICc8L3NlY3Rpb24+JztcbiAgYWRkQ2xhc3MobG9hZHIsICd1LWhpZGRlbicpO1xuICBwbGFjZWhvbGRlci5pbm5lckhUTUwgPSBodG1sU3R1ZmY7XG59XG5cblB1YlN1Yi5zdWJzY3JpYmUoJ3NlYXJjaFN0YXJ0JywgY2xlYXJSZXN1bHRzKTtcblB1YlN1Yi5zdWJzY3JpYmUoJ3NlYXJjaENvbXBsZXRlJywgcmVuZGVyKTtcbiIsImltcG9ydCBQdWJTdWIgZnJvbSAnLi9wdWJzdWInO1xuaW1wb3J0ICogYXMgYXBpIGZyb20gJy4vYXBpJztcblxuY29uc3Qgc2VhcmNoRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNqcy1zb25nc2VhcmNoJyk7XG5jb25zdCBzZWFyY2hJbnB1dCA9IHNlYXJjaEZvcm0ucXVlcnlTZWxlY3RvcignI2pzLXNvbmdzZWFyY2hfX2lucHV0Jyk7XG5cbmZ1bmN0aW9uIGNsZWFyU2VhcmNoKCkge1xuICBzZWFyY2hJbnB1dC52YWx1ZSA9ICcnO1xufVxuXG5mdW5jdGlvbiBzZWFyY2hIYW5kbGVyKGV2dCkge1xuICBjb25zdCBlID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGNvbnN0IHNlYXJjaFRlcm0gPSBzZWFyY2hJbnB1dC52YWx1ZTtcbiAgaWYgKHNlYXJjaFRlcm0gIT09ICcnKSB7XG4gICAgYXBpLnNlYXJjaEJ5TmFtZShzZWFyY2hUZXJtKVxuICAgICAgLnRoZW4oKHNvbmdMaXN0KSA9PiB7XG4gICAgICAgIFB1YlN1Yi5wdWJsaXNoKCdzZWFyY2hDb21wbGV0ZScsIHsgc29uZ0xpc3QsIHNlYXJjaFRlcm0gfSk7XG4gICAgICB9KTtcbiAgfVxufVxuXG5mdW5jdGlvbiBvblNlYXJjaFN0YXJ0KHBzKSB7XG4gIGNvbnN0IHB1YnN1Yk9iamVjdCA9IHBzO1xuXG4gIGlmIChwdWJzdWJPYmplY3QubGV0dGVyKSB7XG4gICAgY2xlYXJTZWFyY2goKTtcbiAgfVxufVxuXG5zZWFyY2hGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHNlYXJjaEhhbmRsZXIpO1xuUHViU3ViLnN1YnNjcmliZSgnc2VhcmNoU3RhcnQnLCBvblNlYXJjaFN0YXJ0KTtcbi8qXG5cblxuZnVuY3Rpb24gc3VjY2Vzc0hhbmRsZXIoZGF0YSkge1xuICBjb25zdCBpID0gXyhkYXRhKS50b0FycmF5KCk7XG5cbiAgZnVzZSA9IG5ldyBGdXNlanMoaSwgb3B0aW9ucyk7IC8vIFwibGlzdFwiIGlzIHRoZSBpdGVtIGFycmF5XG59XG5cbi8vIEdldCB0aGUgZ2VuZXJhdGVkIHNlYXJjaF9kYXRhLmpzb24gZmlsZSBzbyBsdW5yLmpzIGNhbiBzZWFyY2ggaXQgbG9jYWxseS5cbmNvbnN0IHNlYXJjaERhdGEgPSAkLmFqYXgoe1xuICB1cmw6ICcuL3NlYXJjaF9kYXRhLmpzb24nLFxuICB0eXBlOiAnR0VUJywgLy8gZGVmYXVsdCBpcyBHRVQgYnV0IHlvdSBjYW4gdXNlIG90aGVyIHZlcmJzIGJhc2VkIG9uIHlvdXIgbmVlZHMuXG4gIGRhdGFUeXBlOiAnanNvbicsIC8vIHNwZWNpZnkgdGhlIGRhdGFUeXBlIGZvciBmdXR1cmUgcmVmZXJlbmNlXG59KTtcbnNlYXJjaERhdGEuZG9uZShzdWNjZXNzSGFuZGxlcik7XG5cbmZ1bmN0aW9uIGRpc3BsYXlTZWFyY2hSZXN1bHRzKHJlc3VsdHMpIHtcbiAgY29uc29sZS5sb2coJ3N1Y2Nlc3MnKTtcbiAgY29uc29sZS5sb2cocmVzdWx0cyk7XG5cbiAgY29uc3QgJHBsYWNlaG9sZGVyID0gJCgnI2pzLXNlYXJjaF9yZXN1bHRzJyk7XG4gIGNvbnN0IHRlc3RzID0gXy5zb3J0QnkocmVzdWx0cywgJ2FydGlzdCcpO1xuICBjb25zdCB0ZXN0ZyA9IF8uZ3JvdXBCeSh0ZXN0cywgJ2FydGlzdCcpO1xuICBsZXQgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9ICc8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzPC9oMj48c2VjdGlvbiBjbGFzcz1cImMtc2VhcmNoX19saXN0XCI+JztcbiAgJC5lYWNoKHRlc3RnLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGAke2tleX06IGApO1xuICAgIGNvbnNvbGUubG9nKGB2YWx1ZSA9ICR7dmFsdWV9YCk7XG4gICAgaHRtbFN0dWZmICs9IGA8cCBjbGFzcz1cImMtc2VhcmNoX19hcnRpc3RcIj4ke2tleX08L3A+PHVsPmA7XG4gICAgY29uc3QgdmFsID0gXy5zb3J0QnkodmFsdWUsICd0aXRsZScpO1xuICAgICQuZWFjaCh2YWwsIChrLCB2KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgJHtrfTo6OiR7di50aXRsZX1gKTtcblxuICAgICAgaHRtbFN0dWZmICs9IGA8bGkgY2xhc3M9XCJjLXNlYXJjaF9fdGl0bGVcIj4ke3YudGl0bGV9PC9saT5gO1xuICAgIH0pO1xuICAgIGh0bWxTdHVmZiArPSAnPC91bD4nO1xuICB9KTtcbiAgaHRtbFN0dWZmICs9ICc8L3NlY3Rpb24+JztcbiAgJHBsYWNlaG9sZGVyLmVtcHR5KCkuYXBwZW5kKGh0bWxTdHVmZik7XG59XG5cbiQoKCkgPT4ge1xuICAvLyBFdmVudCB3aGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZFxuICAkKCcjanMtc29uZ3NlYXJjaCcpLnN1Ym1pdCgoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0ICRxdWVyeSA9ICQoJyNqcy1zb25nc2VhcmNoX2lucHV0JykudmFsKCk7IC8vIEdldCB0aGUgdmFsdWUgZm9yIHRoZSB0ZXh0IGZpZWxkXG4gICAgY29uc3QgZnVzZVJlc3VsdHMgPSBmdXNlLnNlYXJjaCgkcXVlcnkpOyAvLyBHZXQgZnVzZS5qcyB0byBwZXJmb3JtIGEgc2VhcmNoXG5cbiAgICBkaXNwbGF5U2VhcmNoUmVzdWx0cyhmdXNlUmVzdWx0cyk7IC8vIEhhbmQgdGhlIHJlc3VsdHMgb2ZmIHRvIGJlIGRpc3BsYXllZFxuICB9KTtcbn0pO1xuKi9cbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9saWIvYXhpb3MnKTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciBzZXR0bGUgPSByZXF1aXJlKCcuLy4uL2NvcmUvc2V0dGxlJyk7XG52YXIgYnVpbGRVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnVpbGRVUkwnKTtcbnZhciBwYXJzZUhlYWRlcnMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvcGFyc2VIZWFkZXJzJyk7XG52YXIgaXNVUkxTYW1lT3JpZ2luID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2lzVVJMU2FtZU9yaWdpbicpO1xudmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnLi4vY29yZS9jcmVhdGVFcnJvcicpO1xudmFyIGJ0b2EgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmJ0b2EgJiYgd2luZG93LmJ0b2EuYmluZCh3aW5kb3cpKSB8fCByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnRvYScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHhockFkYXB0ZXIoY29uZmlnKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBkaXNwYXRjaFhoclJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIHJlcXVlc3REYXRhID0gY29uZmlnLmRhdGE7XG4gICAgdmFyIHJlcXVlc3RIZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XG5cbiAgICBpZiAodXRpbHMuaXNGb3JtRGF0YShyZXF1ZXN0RGF0YSkpIHtcbiAgICAgIGRlbGV0ZSByZXF1ZXN0SGVhZGVyc1snQ29udGVudC1UeXBlJ107IC8vIExldCB0aGUgYnJvd3NlciBzZXQgaXRcbiAgICB9XG5cbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHZhciBsb2FkRXZlbnQgPSAnb25yZWFkeXN0YXRlY2hhbmdlJztcbiAgICB2YXIgeERvbWFpbiA9IGZhbHNlO1xuXG4gICAgLy8gRm9yIElFIDgvOSBDT1JTIHN1cHBvcnRcbiAgICAvLyBPbmx5IHN1cHBvcnRzIFBPU1QgYW5kIEdFVCBjYWxscyBhbmQgZG9lc24ndCByZXR1cm5zIHRoZSByZXNwb25zZSBoZWFkZXJzLlxuICAgIC8vIERPTidUIGRvIHRoaXMgZm9yIHRlc3RpbmcgYi9jIFhNTEh0dHBSZXF1ZXN0IGlzIG1vY2tlZCwgbm90IFhEb21haW5SZXF1ZXN0LlxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnICYmXG4gICAgICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIHdpbmRvdy5YRG9tYWluUmVxdWVzdCAmJiAhKCd3aXRoQ3JlZGVudGlhbHMnIGluIHJlcXVlc3QpICYmXG4gICAgICAgICFpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpIHtcbiAgICAgIHJlcXVlc3QgPSBuZXcgd2luZG93LlhEb21haW5SZXF1ZXN0KCk7XG4gICAgICBsb2FkRXZlbnQgPSAnb25sb2FkJztcbiAgICAgIHhEb21haW4gPSB0cnVlO1xuICAgICAgcmVxdWVzdC5vbnByb2dyZXNzID0gZnVuY3Rpb24gaGFuZGxlUHJvZ3Jlc3MoKSB7fTtcbiAgICAgIHJlcXVlc3Qub250aW1lb3V0ID0gZnVuY3Rpb24gaGFuZGxlVGltZW91dCgpIHt9O1xuICAgIH1cblxuICAgIC8vIEhUVFAgYmFzaWMgYXV0aGVudGljYXRpb25cbiAgICBpZiAoY29uZmlnLmF1dGgpIHtcbiAgICAgIHZhciB1c2VybmFtZSA9IGNvbmZpZy5hdXRoLnVzZXJuYW1lIHx8ICcnO1xuICAgICAgdmFyIHBhc3N3b3JkID0gY29uZmlnLmF1dGgucGFzc3dvcmQgfHwgJyc7XG4gICAgICByZXF1ZXN0SGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0Jhc2ljICcgKyBidG9hKHVzZXJuYW1lICsgJzonICsgcGFzc3dvcmQpO1xuICAgIH1cblxuICAgIHJlcXVlc3Qub3Blbihjb25maWcubWV0aG9kLnRvVXBwZXJDYXNlKCksIGJ1aWxkVVJMKGNvbmZpZy51cmwsIGNvbmZpZy5wYXJhbXMsIGNvbmZpZy5wYXJhbXNTZXJpYWxpemVyKSwgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgdGhlIHJlcXVlc3QgdGltZW91dCBpbiBNU1xuICAgIHJlcXVlc3QudGltZW91dCA9IGNvbmZpZy50aW1lb3V0O1xuXG4gICAgLy8gTGlzdGVuIGZvciByZWFkeSBzdGF0ZVxuICAgIHJlcXVlc3RbbG9hZEV2ZW50XSA9IGZ1bmN0aW9uIGhhbmRsZUxvYWQoKSB7XG4gICAgICBpZiAoIXJlcXVlc3QgfHwgKHJlcXVlc3QucmVhZHlTdGF0ZSAhPT0gNCAmJiAheERvbWFpbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgcmVxdWVzdCBlcnJvcmVkIG91dCBhbmQgd2UgZGlkbid0IGdldCBhIHJlc3BvbnNlLCB0aGlzIHdpbGwgYmVcbiAgICAgIC8vIGhhbmRsZWQgYnkgb25lcnJvciBpbnN0ZWFkXG4gICAgICAvLyBXaXRoIG9uZSBleGNlcHRpb246IHJlcXVlc3QgdGhhdCB1c2luZyBmaWxlOiBwcm90b2NvbCwgbW9zdCBicm93c2Vyc1xuICAgICAgLy8gd2lsbCByZXR1cm4gc3RhdHVzIGFzIDAgZXZlbiB0aG91Z2ggaXQncyBhIHN1Y2Nlc3NmdWwgcmVxdWVzdFxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAwICYmICEocmVxdWVzdC5yZXNwb25zZVVSTCAmJiByZXF1ZXN0LnJlc3BvbnNlVVJMLmluZGV4T2YoJ2ZpbGU6JykgPT09IDApKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSB0aGUgcmVzcG9uc2VcbiAgICAgIHZhciByZXNwb25zZUhlYWRlcnMgPSAnZ2V0QWxsUmVzcG9uc2VIZWFkZXJzJyBpbiByZXF1ZXN0ID8gcGFyc2VIZWFkZXJzKHJlcXVlc3QuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpIDogbnVsbDtcbiAgICAgIHZhciByZXNwb25zZURhdGEgPSAhY29uZmlnLnJlc3BvbnNlVHlwZSB8fCBjb25maWcucmVzcG9uc2VUeXBlID09PSAndGV4dCcgPyByZXF1ZXN0LnJlc3BvbnNlVGV4dCA6IHJlcXVlc3QucmVzcG9uc2U7XG4gICAgICB2YXIgcmVzcG9uc2UgPSB7XG4gICAgICAgIGRhdGE6IHJlc3BvbnNlRGF0YSxcbiAgICAgICAgLy8gSUUgc2VuZHMgMTIyMyBpbnN0ZWFkIG9mIDIwNCAoaHR0cHM6Ly9naXRodWIuY29tL216YWJyaXNraWUvYXhpb3MvaXNzdWVzLzIwMSlcbiAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/ICdObyBDb250ZW50JyA6IHJlcXVlc3Quc3RhdHVzVGV4dCxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgcmVxdWVzdDogcmVxdWVzdFxuICAgICAgfTtcblxuICAgICAgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgcmVzcG9uc2UpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIGxvdyBsZXZlbCBuZXR3b3JrIGVycm9yc1xuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkge1xuICAgICAgLy8gUmVhbCBlcnJvcnMgYXJlIGhpZGRlbiBmcm9tIHVzIGJ5IHRoZSBicm93c2VyXG4gICAgICAvLyBvbmVycm9yIHNob3VsZCBvbmx5IGZpcmUgaWYgaXQncyBhIG5ldHdvcmsgZXJyb3JcbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignTmV0d29yayBFcnJvcicsIGNvbmZpZywgbnVsbCwgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRpbWVvdXRcbiAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7XG4gICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ3RpbWVvdXQgb2YgJyArIGNvbmZpZy50aW1lb3V0ICsgJ21zIGV4Y2VlZGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJyxcbiAgICAgICAgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gQWRkIHhzcmYgaGVhZGVyXG4gICAgLy8gVGhpcyBpcyBvbmx5IGRvbmUgaWYgcnVubmluZyBpbiBhIHN0YW5kYXJkIGJyb3dzZXIgZW52aXJvbm1lbnQuXG4gICAgLy8gU3BlY2lmaWNhbGx5IG5vdCBpZiB3ZSdyZSBpbiBhIHdlYiB3b3JrZXIsIG9yIHJlYWN0LW5hdGl2ZS5cbiAgICBpZiAodXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSkge1xuICAgICAgdmFyIGNvb2tpZXMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvY29va2llcycpO1xuXG4gICAgICAvLyBBZGQgeHNyZiBoZWFkZXJcbiAgICAgIHZhciB4c3JmVmFsdWUgPSAoY29uZmlnLndpdGhDcmVkZW50aWFscyB8fCBpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpICYmIGNvbmZpZy54c3JmQ29va2llTmFtZSA/XG4gICAgICAgICAgY29va2llcy5yZWFkKGNvbmZpZy54c3JmQ29va2llTmFtZSkgOlxuICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHhzcmZWYWx1ZSkge1xuICAgICAgICByZXF1ZXN0SGVhZGVyc1tjb25maWcueHNyZkhlYWRlck5hbWVdID0geHNyZlZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBoZWFkZXJzIHRvIHRoZSByZXF1ZXN0XG4gICAgaWYgKCdzZXRSZXF1ZXN0SGVhZGVyJyBpbiByZXF1ZXN0KSB7XG4gICAgICB1dGlscy5mb3JFYWNoKHJlcXVlc3RIZWFkZXJzLCBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKHZhbCwga2V5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdERhdGEgPT09ICd1bmRlZmluZWQnICYmIGtleS50b0xvd2VyQ2FzZSgpID09PSAnY29udGVudC10eXBlJykge1xuICAgICAgICAgIC8vIFJlbW92ZSBDb250ZW50LVR5cGUgaWYgZGF0YSBpcyB1bmRlZmluZWRcbiAgICAgICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2UgYWRkIGhlYWRlciB0byB0aGUgcmVxdWVzdFxuICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEFkZCB3aXRoQ3JlZGVudGlhbHMgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLndpdGhDcmVkZW50aWFscykge1xuICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIEFkZCByZXNwb25zZVR5cGUgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBjb25maWcucmVzcG9uc2VUeXBlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBFeHBlY3RlZCBET01FeGNlcHRpb24gdGhyb3duIGJ5IGJyb3dzZXJzIG5vdCBjb21wYXRpYmxlIFhNTEh0dHBSZXF1ZXN0IExldmVsIDIuXG4gICAgICAgIC8vIEJ1dCwgdGhpcyBjYW4gYmUgc3VwcHJlc3NlZCBmb3IgJ2pzb24nIHR5cGUgYXMgaXQgY2FuIGJlIHBhcnNlZCBieSBkZWZhdWx0ICd0cmFuc2Zvcm1SZXNwb25zZScgZnVuY3Rpb24uXG4gICAgICAgIGlmIChjb25maWcucmVzcG9uc2VUeXBlICE9PSAnanNvbicpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHByb2dyZXNzIGlmIG5lZWRlZFxuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uRG93bmxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIC8vIE5vdCBhbGwgYnJvd3NlcnMgc3VwcG9ydCB1cGxvYWQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiBjb25maWcub25VcGxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJyAmJiByZXF1ZXN0LnVwbG9hZCkge1xuICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25VcGxvYWRQcm9ncmVzcyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgICAgLy8gSGFuZGxlIGNhbmNlbGxhdGlvblxuICAgICAgY29uZmlnLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbiBvbkNhbmNlbGVkKGNhbmNlbCkge1xuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIHJlamVjdChjYW5jZWwpO1xuICAgICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3REYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcXVlc3REYXRhID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBTZW5kIHRoZSByZXF1ZXN0XG4gICAgcmVxdWVzdC5zZW5kKHJlcXVlc3REYXRhKTtcbiAgfSk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgYmluZCA9IHJlcXVpcmUoJy4vaGVscGVycy9iaW5kJyk7XG52YXIgQXhpb3MgPSByZXF1aXJlKCcuL2NvcmUvQXhpb3MnKTtcbnZhciBkZWZhdWx0cyA9IHJlcXVpcmUoJy4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgQXhpb3NcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGVmYXVsdENvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICogQHJldHVybiB7QXhpb3N9IEEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGRlZmF1bHRDb25maWcpIHtcbiAgdmFyIGNvbnRleHQgPSBuZXcgQXhpb3MoZGVmYXVsdENvbmZpZyk7XG4gIHZhciBpbnN0YW5jZSA9IGJpbmQoQXhpb3MucHJvdG90eXBlLnJlcXVlc3QsIGNvbnRleHQpO1xuXG4gIC8vIENvcHkgYXhpb3MucHJvdG90eXBlIHRvIGluc3RhbmNlXG4gIHV0aWxzLmV4dGVuZChpbnN0YW5jZSwgQXhpb3MucHJvdG90eXBlLCBjb250ZXh0KTtcblxuICAvLyBDb3B5IGNvbnRleHQgdG8gaW5zdGFuY2VcbiAgdXRpbHMuZXh0ZW5kKGluc3RhbmNlLCBjb250ZXh0KTtcblxuICByZXR1cm4gaW5zdGFuY2U7XG59XG5cbi8vIENyZWF0ZSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB0byBiZSBleHBvcnRlZFxudmFyIGF4aW9zID0gY3JlYXRlSW5zdGFuY2UoZGVmYXVsdHMpO1xuXG4vLyBFeHBvc2UgQXhpb3MgY2xhc3MgdG8gYWxsb3cgY2xhc3MgaW5oZXJpdGFuY2VcbmF4aW9zLkF4aW9zID0gQXhpb3M7XG5cbi8vIEZhY3RvcnkgZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZXNcbmF4aW9zLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpbnN0YW5jZUNvbmZpZykge1xuICByZXR1cm4gY3JlYXRlSW5zdGFuY2UodXRpbHMubWVyZ2UoZGVmYXVsdHMsIGluc3RhbmNlQ29uZmlnKSk7XG59O1xuXG4vLyBFeHBvc2UgQ2FuY2VsICYgQ2FuY2VsVG9rZW5cbmF4aW9zLkNhbmNlbCA9IHJlcXVpcmUoJy4vY2FuY2VsL0NhbmNlbCcpO1xuYXhpb3MuQ2FuY2VsVG9rZW4gPSByZXF1aXJlKCcuL2NhbmNlbC9DYW5jZWxUb2tlbicpO1xuYXhpb3MuaXNDYW5jZWwgPSByZXF1aXJlKCcuL2NhbmNlbC9pc0NhbmNlbCcpO1xuXG4vLyBFeHBvc2UgYWxsL3NwcmVhZFxuYXhpb3MuYWxsID0gZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG59O1xuYXhpb3Muc3ByZWFkID0gcmVxdWlyZSgnLi9oZWxwZXJzL3NwcmVhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGF4aW9zO1xuXG4vLyBBbGxvdyB1c2Ugb2YgZGVmYXVsdCBpbXBvcnQgc3ludGF4IGluIFR5cGVTY3JpcHRcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBheGlvcztcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBBIGBDYW5jZWxgIGlzIGFuIG9iamVjdCB0aGF0IGlzIHRocm93biB3aGVuIGFuIG9wZXJhdGlvbiBpcyBjYW5jZWxlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWVzc2FnZSBUaGUgbWVzc2FnZS5cbiAqL1xuZnVuY3Rpb24gQ2FuY2VsKG1lc3NhZ2UpIHtcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbn1cblxuQ2FuY2VsLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gJ0NhbmNlbCcgKyAodGhpcy5tZXNzYWdlID8gJzogJyArIHRoaXMubWVzc2FnZSA6ICcnKTtcbn07XG5cbkNhbmNlbC5wcm90b3R5cGUuX19DQU5DRUxfXyA9IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FuY2VsO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQ2FuY2VsID0gcmVxdWlyZSgnLi9DYW5jZWwnKTtcblxuLyoqXG4gKiBBIGBDYW5jZWxUb2tlbmAgaXMgYW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gcmVxdWVzdCBjYW5jZWxsYXRpb24gb2YgYW4gb3BlcmF0aW9uLlxuICpcbiAqIEBjbGFzc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gZXhlY3V0b3IgVGhlIGV4ZWN1dG9yIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBDYW5jZWxUb2tlbihleGVjdXRvcikge1xuICBpZiAodHlwZW9mIGV4ZWN1dG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO1xuICB9XG5cbiAgdmFyIHJlc29sdmVQcm9taXNlO1xuICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlRXhlY3V0b3IocmVzb2x2ZSkge1xuICAgIHJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcbiAgfSk7XG5cbiAgdmFyIHRva2VuID0gdGhpcztcbiAgZXhlY3V0b3IoZnVuY3Rpb24gY2FuY2VsKG1lc3NhZ2UpIHtcbiAgICBpZiAodG9rZW4ucmVhc29uKSB7XG4gICAgICAvLyBDYW5jZWxsYXRpb24gaGFzIGFscmVhZHkgYmVlbiByZXF1ZXN0ZWRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0b2tlbi5yZWFzb24gPSBuZXcgQ2FuY2VsKG1lc3NhZ2UpO1xuICAgIHJlc29sdmVQcm9taXNlKHRva2VuLnJlYXNvbik7XG4gIH0pO1xufVxuXG4vKipcbiAqIFRocm93cyBhIGBDYW5jZWxgIGlmIGNhbmNlbGxhdGlvbiBoYXMgYmVlbiByZXF1ZXN0ZWQuXG4gKi9cbkNhbmNlbFRva2VuLnByb3RvdHlwZS50aHJvd0lmUmVxdWVzdGVkID0gZnVuY3Rpb24gdGhyb3dJZlJlcXVlc3RlZCgpIHtcbiAgaWYgKHRoaXMucmVhc29uKSB7XG4gICAgdGhyb3cgdGhpcy5yZWFzb247XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhIG5ldyBgQ2FuY2VsVG9rZW5gIGFuZCBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLFxuICogY2FuY2VscyB0aGUgYENhbmNlbFRva2VuYC5cbiAqL1xuQ2FuY2VsVG9rZW4uc291cmNlID0gZnVuY3Rpb24gc291cmNlKCkge1xuICB2YXIgY2FuY2VsO1xuICB2YXIgdG9rZW4gPSBuZXcgQ2FuY2VsVG9rZW4oZnVuY3Rpb24gZXhlY3V0b3IoYykge1xuICAgIGNhbmNlbCA9IGM7XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIHRva2VuOiB0b2tlbixcbiAgICBjYW5jZWw6IGNhbmNlbFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYW5jZWxUb2tlbjtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0NhbmNlbCh2YWx1ZSkge1xuICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuX19DQU5DRUxfXyk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLy4uL2RlZmF1bHRzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgSW50ZXJjZXB0b3JNYW5hZ2VyID0gcmVxdWlyZSgnLi9JbnRlcmNlcHRvck1hbmFnZXInKTtcbnZhciBkaXNwYXRjaFJlcXVlc3QgPSByZXF1aXJlKCcuL2Rpc3BhdGNoUmVxdWVzdCcpO1xudmFyIGlzQWJzb2x1dGVVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTCcpO1xudmFyIGNvbWJpbmVVUkxzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzJyk7XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGluc3RhbmNlQ29uZmlnIFRoZSBkZWZhdWx0IGNvbmZpZyBmb3IgdGhlIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIEF4aW9zKGluc3RhbmNlQ29uZmlnKSB7XG4gIHRoaXMuZGVmYXVsdHMgPSBpbnN0YW5jZUNvbmZpZztcbiAgdGhpcy5pbnRlcmNlcHRvcnMgPSB7XG4gICAgcmVxdWVzdDogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpLFxuICAgIHJlc3BvbnNlOiBuZXcgSW50ZXJjZXB0b3JNYW5hZ2VyKClcbiAgfTtcbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcgc3BlY2lmaWMgZm9yIHRoaXMgcmVxdWVzdCAobWVyZ2VkIHdpdGggdGhpcy5kZWZhdWx0cylcbiAqL1xuQXhpb3MucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiByZXF1ZXN0KGNvbmZpZykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgLy8gQWxsb3cgZm9yIGF4aW9zKCdleGFtcGxlL3VybCdbLCBjb25maWddKSBhIGxhIGZldGNoIEFQSVxuICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25maWcgPSB1dGlscy5tZXJnZSh7XG4gICAgICB1cmw6IGFyZ3VtZW50c1swXVxuICAgIH0sIGFyZ3VtZW50c1sxXSk7XG4gIH1cblxuICBjb25maWcgPSB1dGlscy5tZXJnZShkZWZhdWx0cywgdGhpcy5kZWZhdWx0cywgeyBtZXRob2Q6ICdnZXQnIH0sIGNvbmZpZyk7XG4gIGNvbmZpZy5tZXRob2QgPSBjb25maWcubWV0aG9kLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gU3VwcG9ydCBiYXNlVVJMIGNvbmZpZ1xuICBpZiAoY29uZmlnLmJhc2VVUkwgJiYgIWlzQWJzb2x1dGVVUkwoY29uZmlnLnVybCkpIHtcbiAgICBjb25maWcudXJsID0gY29tYmluZVVSTHMoY29uZmlnLmJhc2VVUkwsIGNvbmZpZy51cmwpO1xuICB9XG5cbiAgLy8gSG9vayB1cCBpbnRlcmNlcHRvcnMgbWlkZGxld2FyZVxuICB2YXIgY2hhaW4gPSBbZGlzcGF0Y2hSZXF1ZXN0LCB1bmRlZmluZWRdO1xuICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShjb25maWcpO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlcXVlc3QuZm9yRWFjaChmdW5jdGlvbiB1bnNoaWZ0UmVxdWVzdEludGVyY2VwdG9ycyhpbnRlcmNlcHRvcikge1xuICAgIGNoYWluLnVuc2hpZnQoaW50ZXJjZXB0b3IuZnVsZmlsbGVkLCBpbnRlcmNlcHRvci5yZWplY3RlZCk7XG4gIH0pO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gcHVzaFJlc3BvbnNlSW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgY2hhaW4ucHVzaChpbnRlcmNlcHRvci5mdWxmaWxsZWQsIGludGVyY2VwdG9yLnJlamVjdGVkKTtcbiAgfSk7XG5cbiAgd2hpbGUgKGNoYWluLmxlbmd0aCkge1xuICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oY2hhaW4uc2hpZnQoKSwgY2hhaW4uc2hpZnQoKSk7XG4gIH1cblxuICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8vIFByb3ZpZGUgYWxpYXNlcyBmb3Igc3VwcG9ydGVkIHJlcXVlc3QgbWV0aG9kc1xudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdvcHRpb25zJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2ROb0RhdGEobWV0aG9kKSB7XG4gIC8qZXNsaW50IGZ1bmMtbmFtZXM6MCovXG4gIEF4aW9zLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odXJsLCBjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHV0aWxzLm1lcmdlKGNvbmZpZyB8fCB7fSwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICB1cmw6IHVybFxuICAgIH0pKTtcbiAgfTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1dGlscy5tZXJnZShjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXhpb3M7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuZnVuY3Rpb24gSW50ZXJjZXB0b3JNYW5hZ2VyKCkge1xuICB0aGlzLmhhbmRsZXJzID0gW107XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGludGVyY2VwdG9yIHRvIHRoZSBzdGFja1xuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bGZpbGxlZCBUaGUgZnVuY3Rpb24gdG8gaGFuZGxlIGB0aGVuYCBmb3IgYSBgUHJvbWlzZWBcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlamVjdGVkIFRoZSBmdW5jdGlvbiB0byBoYW5kbGUgYHJlamVjdGAgZm9yIGEgYFByb21pc2VgXG4gKlxuICogQHJldHVybiB7TnVtYmVyfSBBbiBJRCB1c2VkIHRvIHJlbW92ZSBpbnRlcmNlcHRvciBsYXRlclxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLnVzZSA9IGZ1bmN0aW9uIHVzZShmdWxmaWxsZWQsIHJlamVjdGVkKSB7XG4gIHRoaXMuaGFuZGxlcnMucHVzaCh7XG4gICAgZnVsZmlsbGVkOiBmdWxmaWxsZWQsXG4gICAgcmVqZWN0ZWQ6IHJlamVjdGVkXG4gIH0pO1xuICByZXR1cm4gdGhpcy5oYW5kbGVycy5sZW5ndGggLSAxO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYW4gaW50ZXJjZXB0b3IgZnJvbSB0aGUgc3RhY2tcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gaWQgVGhlIElEIHRoYXQgd2FzIHJldHVybmVkIGJ5IGB1c2VgXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUuZWplY3QgPSBmdW5jdGlvbiBlamVjdChpZCkge1xuICBpZiAodGhpcy5oYW5kbGVyc1tpZF0pIHtcbiAgICB0aGlzLmhhbmRsZXJzW2lkXSA9IG51bGw7XG4gIH1cbn07XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFsbCB0aGUgcmVnaXN0ZXJlZCBpbnRlcmNlcHRvcnNcbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIGZvciBza2lwcGluZyBvdmVyIGFueVxuICogaW50ZXJjZXB0b3JzIHRoYXQgbWF5IGhhdmUgYmVjb21lIGBudWxsYCBjYWxsaW5nIGBlamVjdGAuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2ggaW50ZXJjZXB0b3JcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gZm9yRWFjaChmbikge1xuICB1dGlscy5mb3JFYWNoKHRoaXMuaGFuZGxlcnMsIGZ1bmN0aW9uIGZvckVhY2hIYW5kbGVyKGgpIHtcbiAgICBpZiAoaCAhPT0gbnVsbCkge1xuICAgICAgZm4oaCk7XG4gICAgfVxuICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW50ZXJjZXB0b3JNYW5hZ2VyO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZW5oYW5jZUVycm9yID0gcmVxdWlyZSgnLi9lbmhhbmNlRXJyb3InKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIG1lc3NhZ2UsIGNvbmZpZywgZXJyb3IgY29kZSwgcmVxdWVzdCBhbmQgcmVzcG9uc2UuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgVGhlIGVycm9yIG1lc3NhZ2UuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGNyZWF0ZWQgZXJyb3IuXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlRXJyb3IobWVzc2FnZSwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIHJldHVybiBlbmhhbmNlRXJyb3IoZXJyb3IsIGNvbmZpZywgY29kZSwgcmVxdWVzdCwgcmVzcG9uc2UpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xudmFyIHRyYW5zZm9ybURhdGEgPSByZXF1aXJlKCcuL3RyYW5zZm9ybURhdGEnKTtcbnZhciBpc0NhbmNlbCA9IHJlcXVpcmUoJy4uL2NhbmNlbC9pc0NhbmNlbCcpO1xudmFyIGRlZmF1bHRzID0gcmVxdWlyZSgnLi4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBUaHJvd3MgYSBgQ2FuY2VsYCBpZiBjYW5jZWxsYXRpb24gaGFzIGJlZW4gcmVxdWVzdGVkLlxuICovXG5mdW5jdGlvbiB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZykge1xuICBpZiAoY29uZmlnLmNhbmNlbFRva2VuKSB7XG4gICAgY29uZmlnLmNhbmNlbFRva2VuLnRocm93SWZSZXF1ZXN0ZWQoKTtcbiAgfVxufVxuXG4vKipcbiAqIERpc3BhdGNoIGEgcmVxdWVzdCB0byB0aGUgc2VydmVyIHVzaW5nIHRoZSBjb25maWd1cmVkIGFkYXB0ZXIuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHRoYXQgaXMgdG8gYmUgdXNlZCBmb3IgdGhlIHJlcXVlc3RcbiAqIEByZXR1cm5zIHtQcm9taXNlfSBUaGUgUHJvbWlzZSB0byBiZSBmdWxmaWxsZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkaXNwYXRjaFJlcXVlc3QoY29uZmlnKSB7XG4gIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKTtcblxuICAvLyBFbnN1cmUgaGVhZGVycyBleGlzdFxuICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuXG4gIC8vIFRyYW5zZm9ybSByZXF1ZXN0IGRhdGFcbiAgY29uZmlnLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgIGNvbmZpZy5kYXRhLFxuICAgIGNvbmZpZy5oZWFkZXJzLFxuICAgIGNvbmZpZy50cmFuc2Zvcm1SZXF1ZXN0XG4gICk7XG5cbiAgLy8gRmxhdHRlbiBoZWFkZXJzXG4gIGNvbmZpZy5oZWFkZXJzID0gdXRpbHMubWVyZ2UoXG4gICAgY29uZmlnLmhlYWRlcnMuY29tbW9uIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzW2NvbmZpZy5tZXRob2RdIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzIHx8IHt9XG4gICk7XG5cbiAgdXRpbHMuZm9yRWFjaChcbiAgICBbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdwb3N0JywgJ3B1dCcsICdwYXRjaCcsICdjb21tb24nXSxcbiAgICBmdW5jdGlvbiBjbGVhbkhlYWRlckNvbmZpZyhtZXRob2QpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcuaGVhZGVyc1ttZXRob2RdO1xuICAgIH1cbiAgKTtcblxuICB2YXIgYWRhcHRlciA9IGNvbmZpZy5hZGFwdGVyIHx8IGRlZmF1bHRzLmFkYXB0ZXI7XG5cbiAgcmV0dXJuIGFkYXB0ZXIoY29uZmlnKS50aGVuKGZ1bmN0aW9uIG9uQWRhcHRlclJlc29sdXRpb24ocmVzcG9uc2UpIHtcbiAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgIHJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgcmVzcG9uc2UuZGF0YSxcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2VcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9LCBmdW5jdGlvbiBvbkFkYXB0ZXJSZWplY3Rpb24ocmVhc29uKSB7XG4gICAgaWYgKCFpc0NhbmNlbChyZWFzb24pKSB7XG4gICAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSByZXNwb25zZSBkYXRhXG4gICAgICBpZiAocmVhc29uICYmIHJlYXNvbi5yZXNwb25zZSkge1xuICAgICAgICByZWFzb24ucmVzcG9uc2UuZGF0YSA9IHRyYW5zZm9ybURhdGEoXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEsXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlYXNvbik7XG4gIH0pO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVcGRhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIGNvbmZpZywgZXJyb3IgY29kZSwgYW5kIHJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIFRoZSBlcnJvciB0byB1cGRhdGUuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGVycm9yLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICBlcnJvci5jb25maWcgPSBjb25maWc7XG4gIGlmIChjb2RlKSB7XG4gICAgZXJyb3IuY29kZSA9IGNvZGU7XG4gIH1cbiAgZXJyb3IucmVxdWVzdCA9IHJlcXVlc3Q7XG4gIGVycm9yLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gIHJldHVybiBlcnJvcjtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjcmVhdGVFcnJvciA9IHJlcXVpcmUoJy4vY3JlYXRlRXJyb3InKTtcblxuLyoqXG4gKiBSZXNvbHZlIG9yIHJlamVjdCBhIFByb21pc2UgYmFzZWQgb24gcmVzcG9uc2Ugc3RhdHVzLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmUgQSBmdW5jdGlvbiB0aGF0IHJlc29sdmVzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0IEEgZnVuY3Rpb24gdGhhdCByZWplY3RzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIFRoZSByZXNwb25zZS5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCByZXNwb25zZSkge1xuICB2YXIgdmFsaWRhdGVTdGF0dXMgPSByZXNwb25zZS5jb25maWcudmFsaWRhdGVTdGF0dXM7XG4gIC8vIE5vdGU6IHN0YXR1cyBpcyBub3QgZXhwb3NlZCBieSBYRG9tYWluUmVxdWVzdFxuICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCAhdmFsaWRhdGVTdGF0dXMgfHwgdmFsaWRhdGVTdGF0dXMocmVzcG9uc2Uuc3RhdHVzKSkge1xuICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICB9IGVsc2Uge1xuICAgIHJlamVjdChjcmVhdGVFcnJvcihcbiAgICAgICdSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlICcgKyByZXNwb25zZS5zdGF0dXMsXG4gICAgICByZXNwb25zZS5jb25maWcsXG4gICAgICBudWxsLFxuICAgICAgcmVzcG9uc2UucmVxdWVzdCxcbiAgICAgIHJlc3BvbnNlXG4gICAgKSk7XG4gIH1cbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuLyoqXG4gKiBUcmFuc2Zvcm0gdGhlIGRhdGEgZm9yIGEgcmVxdWVzdCBvciBhIHJlc3BvbnNlXG4gKlxuICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBkYXRhIFRoZSBkYXRhIHRvIGJlIHRyYW5zZm9ybWVkXG4gKiBAcGFyYW0ge0FycmF5fSBoZWFkZXJzIFRoZSBoZWFkZXJzIGZvciB0aGUgcmVxdWVzdCBvciByZXNwb25zZVxuICogQHBhcmFtIHtBcnJheXxGdW5jdGlvbn0gZm5zIEEgc2luZ2xlIGZ1bmN0aW9uIG9yIEFycmF5IG9mIGZ1bmN0aW9uc1xuICogQHJldHVybnMgeyp9IFRoZSByZXN1bHRpbmcgdHJhbnNmb3JtZWQgZGF0YVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHRyYW5zZm9ybURhdGEoZGF0YSwgaGVhZGVycywgZm5zKSB7XG4gIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICB1dGlscy5mb3JFYWNoKGZucywgZnVuY3Rpb24gdHJhbnNmb3JtKGZuKSB7XG4gICAgZGF0YSA9IGZuKGRhdGEsIGhlYWRlcnMpO1xuICB9KTtcblxuICByZXR1cm4gZGF0YTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbnZhciBub3JtYWxpemVIZWFkZXJOYW1lID0gcmVxdWlyZSgnLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUnKTtcblxudmFyIERFRkFVTFRfQ09OVEVOVF9UWVBFID0ge1xuICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbn07XG5cbmZ1bmN0aW9uIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCB2YWx1ZSkge1xuICBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnMpICYmIHV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddKSkge1xuICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gdmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdEFkYXB0ZXIoKSB7XG4gIHZhciBhZGFwdGVyO1xuICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIEZvciBicm93c2VycyB1c2UgWEhSIGFkYXB0ZXJcbiAgICBhZGFwdGVyID0gcmVxdWlyZSgnLi9hZGFwdGVycy94aHInKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBGb3Igbm9kZSB1c2UgSFRUUCBhZGFwdGVyXG4gICAgYWRhcHRlciA9IHJlcXVpcmUoJy4vYWRhcHRlcnMvaHR0cCcpO1xuICB9XG4gIHJldHVybiBhZGFwdGVyO1xufVxuXG52YXIgZGVmYXVsdHMgPSB7XG4gIGFkYXB0ZXI6IGdldERlZmF1bHRBZGFwdGVyKCksXG5cbiAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uIHRyYW5zZm9ybVJlcXVlc3QoZGF0YSwgaGVhZGVycykge1xuICAgIG5vcm1hbGl6ZUhlYWRlck5hbWUoaGVhZGVycywgJ0NvbnRlbnQtVHlwZScpO1xuICAgIGlmICh1dGlscy5pc0Zvcm1EYXRhKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0FycmF5QnVmZmVyKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0J1ZmZlcihkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNTdHJlYW0oZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzRmlsZShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNCbG9iKGRhdGEpXG4gICAgKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzQXJyYXlCdWZmZXJWaWV3KGRhdGEpKSB7XG4gICAgICByZXR1cm4gZGF0YS5idWZmZXI7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc1VSTFNlYXJjaFBhcmFtcyhkYXRhKSkge1xuICAgICAgc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIGRhdGEudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfV0sXG5cbiAgdHJhbnNmb3JtUmVzcG9uc2U6IFtmdW5jdGlvbiB0cmFuc2Zvcm1SZXNwb25zZShkYXRhKSB7XG4gICAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICB9IGNhdGNoIChlKSB7IC8qIElnbm9yZSAqLyB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XSxcblxuICB0aW1lb3V0OiAwLFxuXG4gIHhzcmZDb29raWVOYW1lOiAnWFNSRi1UT0tFTicsXG4gIHhzcmZIZWFkZXJOYW1lOiAnWC1YU1JGLVRPS0VOJyxcblxuICBtYXhDb250ZW50TGVuZ3RoOiAtMSxcblxuICB2YWxpZGF0ZVN0YXR1czogZnVuY3Rpb24gdmFsaWRhdGVTdGF0dXMoc3RhdHVzKSB7XG4gICAgcmV0dXJuIHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwO1xuICB9XG59O1xuXG5kZWZhdWx0cy5oZWFkZXJzID0ge1xuICBjb21tb246IHtcbiAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKidcbiAgfVxufTtcblxudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kTm9EYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB7fTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB1dGlscy5tZXJnZShERUZBVUxUX0NPTlRFTlRfVFlQRSk7XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBkZWZhdWx0cztcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBiaW5kKGZuLCB0aGlzQXJnKSB7XG4gIHJldHVybiBmdW5jdGlvbiB3cmFwKCkge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICB9O1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLy8gYnRvYSBwb2x5ZmlsbCBmb3IgSUU8MTAgY291cnRlc3kgaHR0cHM6Ly9naXRodWIuY29tL2RhdmlkY2hhbWJlcnMvQmFzZTY0LmpzXG5cbnZhciBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG5cbmZ1bmN0aW9uIEUoKSB7XG4gIHRoaXMubWVzc2FnZSA9ICdTdHJpbmcgY29udGFpbnMgYW4gaW52YWxpZCBjaGFyYWN0ZXInO1xufVxuRS5wcm90b3R5cGUgPSBuZXcgRXJyb3I7XG5FLnByb3RvdHlwZS5jb2RlID0gNTtcbkUucHJvdG90eXBlLm5hbWUgPSAnSW52YWxpZENoYXJhY3RlckVycm9yJztcblxuZnVuY3Rpb24gYnRvYShpbnB1dCkge1xuICB2YXIgc3RyID0gU3RyaW5nKGlucHV0KTtcbiAgdmFyIG91dHB1dCA9ICcnO1xuICBmb3IgKFxuICAgIC8vIGluaXRpYWxpemUgcmVzdWx0IGFuZCBjb3VudGVyXG4gICAgdmFyIGJsb2NrLCBjaGFyQ29kZSwgaWR4ID0gMCwgbWFwID0gY2hhcnM7XG4gICAgLy8gaWYgdGhlIG5leHQgc3RyIGluZGV4IGRvZXMgbm90IGV4aXN0OlxuICAgIC8vICAgY2hhbmdlIHRoZSBtYXBwaW5nIHRhYmxlIHRvIFwiPVwiXG4gICAgLy8gICBjaGVjayBpZiBkIGhhcyBubyBmcmFjdGlvbmFsIGRpZ2l0c1xuICAgIHN0ci5jaGFyQXQoaWR4IHwgMCkgfHwgKG1hcCA9ICc9JywgaWR4ICUgMSk7XG4gICAgLy8gXCI4IC0gaWR4ICUgMSAqIDhcIiBnZW5lcmF0ZXMgdGhlIHNlcXVlbmNlIDIsIDQsIDYsIDhcbiAgICBvdXRwdXQgKz0gbWFwLmNoYXJBdCg2MyAmIGJsb2NrID4+IDggLSBpZHggJSAxICogOClcbiAgKSB7XG4gICAgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpZHggKz0gMyAvIDQpO1xuICAgIGlmIChjaGFyQ29kZSA+IDB4RkYpIHtcbiAgICAgIHRocm93IG5ldyBFKCk7XG4gICAgfVxuICAgIGJsb2NrID0gYmxvY2sgPDwgOCB8IGNoYXJDb2RlO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnRvYTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5mdW5jdGlvbiBlbmNvZGUodmFsKSB7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQodmFsKS5cbiAgICByZXBsYWNlKC8lNDAvZ2ksICdAJykuXG4gICAgcmVwbGFjZSgvJTNBL2dpLCAnOicpLlxuICAgIHJlcGxhY2UoLyUyNC9nLCAnJCcpLlxuICAgIHJlcGxhY2UoLyUyQy9naSwgJywnKS5cbiAgICByZXBsYWNlKC8lMjAvZywgJysnKS5cbiAgICByZXBsYWNlKC8lNUIvZ2ksICdbJykuXG4gICAgcmVwbGFjZSgvJTVEL2dpLCAnXScpO1xufVxuXG4vKipcbiAqIEJ1aWxkIGEgVVJMIGJ5IGFwcGVuZGluZyBwYXJhbXMgdG8gdGhlIGVuZFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgVGhlIGJhc2Ugb2YgdGhlIHVybCAoZS5nLiwgaHR0cDovL3d3dy5nb29nbGUuY29tKVxuICogQHBhcmFtIHtvYmplY3R9IFtwYXJhbXNdIFRoZSBwYXJhbXMgdG8gYmUgYXBwZW5kZWRcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBmb3JtYXR0ZWQgdXJsXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYnVpbGRVUkwodXJsLCBwYXJhbXMsIHBhcmFtc1NlcmlhbGl6ZXIpIHtcbiAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gIGlmICghcGFyYW1zKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuXG4gIHZhciBzZXJpYWxpemVkUGFyYW1zO1xuICBpZiAocGFyYW1zU2VyaWFsaXplcikge1xuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJhbXNTZXJpYWxpemVyKHBhcmFtcyk7XG4gIH0gZWxzZSBpZiAodXRpbHMuaXNVUkxTZWFyY2hQYXJhbXMocGFyYW1zKSkge1xuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgcGFydHMgPSBbXTtcblxuICAgIHV0aWxzLmZvckVhY2gocGFyYW1zLCBmdW5jdGlvbiBzZXJpYWxpemUodmFsLCBrZXkpIHtcbiAgICAgIGlmICh2YWwgPT09IG51bGwgfHwgdHlwZW9mIHZhbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodXRpbHMuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIGtleSA9IGtleSArICdbXSc7XG4gICAgICB9XG5cbiAgICAgIGlmICghdXRpbHMuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIHZhbCA9IFt2YWxdO1xuICAgICAgfVxuXG4gICAgICB1dGlscy5mb3JFYWNoKHZhbCwgZnVuY3Rpb24gcGFyc2VWYWx1ZSh2KSB7XG4gICAgICAgIGlmICh1dGlscy5pc0RhdGUodikpIHtcbiAgICAgICAgICB2ID0gdi50b0lTT1N0cmluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWxzLmlzT2JqZWN0KHYpKSB7XG4gICAgICAgICAgdiA9IEpTT04uc3RyaW5naWZ5KHYpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnRzLnB1c2goZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUodikpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFydHMuam9pbignJicpO1xuICB9XG5cbiAgaWYgKHNlcmlhbGl6ZWRQYXJhbXMpIHtcbiAgICB1cmwgKz0gKHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnKSArIHNlcmlhbGl6ZWRQYXJhbXM7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFVSTCBieSBjb21iaW5pbmcgdGhlIHNwZWNpZmllZCBVUkxzXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJhc2VVUkwgVGhlIGJhc2UgVVJMXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVUkwgVGhlIHJlbGF0aXZlIFVSTFxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNvbWJpbmVkIFVSTFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNvbWJpbmVVUkxzKGJhc2VVUkwsIHJlbGF0aXZlVVJMKSB7XG4gIHJldHVybiByZWxhdGl2ZVVSTFxuICAgID8gYmFzZVVSTC5yZXBsYWNlKC9cXC8rJC8sICcnKSArICcvJyArIHJlbGF0aXZlVVJMLnJlcGxhY2UoL15cXC8rLywgJycpXG4gICAgOiBiYXNlVVJMO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgdXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSA/XG5cbiAgLy8gU3RhbmRhcmQgYnJvd3NlciBlbnZzIHN1cHBvcnQgZG9jdW1lbnQuY29va2llXG4gIChmdW5jdGlvbiBzdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShuYW1lLCB2YWx1ZSwgZXhwaXJlcywgcGF0aCwgZG9tYWluLCBzZWN1cmUpIHtcbiAgICAgICAgdmFyIGNvb2tpZSA9IFtdO1xuICAgICAgICBjb29raWUucHVzaChuYW1lICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSk7XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzTnVtYmVyKGV4cGlyZXMpKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ2V4cGlyZXM9JyArIG5ldyBEYXRlKGV4cGlyZXMpLnRvR01UU3RyaW5nKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKHBhdGgpKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ3BhdGg9JyArIHBhdGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKGRvbWFpbikpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgnZG9tYWluPScgKyBkb21haW4pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNlY3VyZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdzZWN1cmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZS5qb2luKCc7ICcpO1xuICAgICAgfSxcblxuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZChuYW1lKSB7XG4gICAgICAgIHZhciBtYXRjaCA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaChuZXcgUmVnRXhwKCcoXnw7XFxcXHMqKSgnICsgbmFtZSArICcpPShbXjtdKiknKSk7XG4gICAgICAgIHJldHVybiAobWF0Y2ggPyBkZWNvZGVVUklDb21wb25lbnQobWF0Y2hbM10pIDogbnVsbCk7XG4gICAgICB9LFxuXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShuYW1lKSB7XG4gICAgICAgIHRoaXMud3JpdGUobmFtZSwgJycsIERhdGUubm93KCkgLSA4NjQwMDAwMCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSkoKSA6XG5cbiAgLy8gTm9uIHN0YW5kYXJkIGJyb3dzZXIgZW52ICh3ZWIgd29ya2VycywgcmVhY3QtbmF0aXZlKSBsYWNrIG5lZWRlZCBzdXBwb3J0LlxuICAoZnVuY3Rpb24gbm9uU3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHJldHVybiB7XG4gICAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoKSB7fSxcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQoKSB7IHJldHVybiBudWxsOyB9LFxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7fVxuICAgIH07XG4gIH0pKClcbik7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0Fic29sdXRlVVJMKHVybCkge1xuICAvLyBBIFVSTCBpcyBjb25zaWRlcmVkIGFic29sdXRlIGlmIGl0IGJlZ2lucyB3aXRoIFwiPHNjaGVtZT46Ly9cIiBvciBcIi8vXCIgKHByb3RvY29sLXJlbGF0aXZlIFVSTCkuXG4gIC8vIFJGQyAzOTg2IGRlZmluZXMgc2NoZW1lIG5hbWUgYXMgYSBzZXF1ZW5jZSBvZiBjaGFyYWN0ZXJzIGJlZ2lubmluZyB3aXRoIGEgbGV0dGVyIGFuZCBmb2xsb3dlZFxuICAvLyBieSBhbnkgY29tYmluYXRpb24gb2YgbGV0dGVycywgZGlnaXRzLCBwbHVzLCBwZXJpb2QsIG9yIGh5cGhlbi5cbiAgcmV0dXJuIC9eKFthLXpdW2EtelxcZFxcK1xcLVxcLl0qOik/XFwvXFwvL2kudGVzdCh1cmwpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgdXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSA/XG5cbiAgLy8gU3RhbmRhcmQgYnJvd3NlciBlbnZzIGhhdmUgZnVsbCBzdXBwb3J0IG9mIHRoZSBBUElzIG5lZWRlZCB0byB0ZXN0XG4gIC8vIHdoZXRoZXIgdGhlIHJlcXVlc3QgVVJMIGlzIG9mIHRoZSBzYW1lIG9yaWdpbiBhcyBjdXJyZW50IGxvY2F0aW9uLlxuICAoZnVuY3Rpb24gc3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHZhciBtc2llID0gLyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICB2YXIgdXJsUGFyc2luZ05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgdmFyIG9yaWdpblVSTDtcblxuICAgIC8qKlxuICAgICogUGFyc2UgYSBVUkwgdG8gZGlzY292ZXIgaXQncyBjb21wb25lbnRzXG4gICAgKlxuICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCBUaGUgVVJMIHRvIGJlIHBhcnNlZFxuICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc29sdmVVUkwodXJsKSB7XG4gICAgICB2YXIgaHJlZiA9IHVybDtcblxuICAgICAgaWYgKG1zaWUpIHtcbiAgICAgICAgLy8gSUUgbmVlZHMgYXR0cmlidXRlIHNldCB0d2ljZSB0byBub3JtYWxpemUgcHJvcGVydGllc1xuICAgICAgICB1cmxQYXJzaW5nTm9kZS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcbiAgICAgICAgaHJlZiA9IHVybFBhcnNpbmdOb2RlLmhyZWY7XG4gICAgICB9XG5cbiAgICAgIHVybFBhcnNpbmdOb2RlLnNldEF0dHJpYnV0ZSgnaHJlZicsIGhyZWYpO1xuXG4gICAgICAvLyB1cmxQYXJzaW5nTm9kZSBwcm92aWRlcyB0aGUgVXJsVXRpbHMgaW50ZXJmYWNlIC0gaHR0cDovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybHV0aWxzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBocmVmOiB1cmxQYXJzaW5nTm9kZS5ocmVmLFxuICAgICAgICBwcm90b2NvbDogdXJsUGFyc2luZ05vZGUucHJvdG9jb2wgPyB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbC5yZXBsYWNlKC86JC8sICcnKSA6ICcnLFxuICAgICAgICBob3N0OiB1cmxQYXJzaW5nTm9kZS5ob3N0LFxuICAgICAgICBzZWFyY2g6IHVybFBhcnNpbmdOb2RlLnNlYXJjaCA/IHVybFBhcnNpbmdOb2RlLnNlYXJjaC5yZXBsYWNlKC9eXFw/LywgJycpIDogJycsXG4gICAgICAgIGhhc2g6IHVybFBhcnNpbmdOb2RlLmhhc2ggPyB1cmxQYXJzaW5nTm9kZS5oYXNoLnJlcGxhY2UoL14jLywgJycpIDogJycsXG4gICAgICAgIGhvc3RuYW1lOiB1cmxQYXJzaW5nTm9kZS5ob3N0bmFtZSxcbiAgICAgICAgcG9ydDogdXJsUGFyc2luZ05vZGUucG9ydCxcbiAgICAgICAgcGF0aG5hbWU6ICh1cmxQYXJzaW5nTm9kZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJykgP1xuICAgICAgICAgICAgICAgICAgdXJsUGFyc2luZ05vZGUucGF0aG5hbWUgOlxuICAgICAgICAgICAgICAgICAgJy8nICsgdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcbiAgICAgIH07XG4gICAgfVxuXG4gICAgb3JpZ2luVVJMID0gcmVzb2x2ZVVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgICAvKipcbiAgICAqIERldGVybWluZSBpZiBhIFVSTCBzaGFyZXMgdGhlIHNhbWUgb3JpZ2luIGFzIHRoZSBjdXJyZW50IGxvY2F0aW9uXG4gICAgKlxuICAgICogQHBhcmFtIHtTdHJpbmd9IHJlcXVlc3RVUkwgVGhlIFVSTCB0byB0ZXN0XG4gICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBVUkwgc2hhcmVzIHRoZSBzYW1lIG9yaWdpbiwgb3RoZXJ3aXNlIGZhbHNlXG4gICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24gaXNVUkxTYW1lT3JpZ2luKHJlcXVlc3RVUkwpIHtcbiAgICAgIHZhciBwYXJzZWQgPSAodXRpbHMuaXNTdHJpbmcocmVxdWVzdFVSTCkpID8gcmVzb2x2ZVVSTChyZXF1ZXN0VVJMKSA6IHJlcXVlc3RVUkw7XG4gICAgICByZXR1cm4gKHBhcnNlZC5wcm90b2NvbCA9PT0gb3JpZ2luVVJMLnByb3RvY29sICYmXG4gICAgICAgICAgICBwYXJzZWQuaG9zdCA9PT0gb3JpZ2luVVJMLmhvc3QpO1xuICAgIH07XG4gIH0pKCkgOlxuXG4gIC8vIE5vbiBzdGFuZGFyZCBicm93c2VyIGVudnMgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gIChmdW5jdGlvbiBub25TdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGlzVVJMU2FtZU9yaWdpbigpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gIH0pKClcbik7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbm9ybWFsaXplSGVhZGVyTmFtZShoZWFkZXJzLCBub3JtYWxpemVkTmFtZSkge1xuICB1dGlscy5mb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIHByb2Nlc3NIZWFkZXIodmFsdWUsIG5hbWUpIHtcbiAgICBpZiAobmFtZSAhPT0gbm9ybWFsaXplZE5hbWUgJiYgbmFtZS50b1VwcGVyQ2FzZSgpID09PSBub3JtYWxpemVkTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICBoZWFkZXJzW25vcm1hbGl6ZWROYW1lXSA9IHZhbHVlO1xuICAgICAgZGVsZXRlIGhlYWRlcnNbbmFtZV07XG4gICAgfVxuICB9KTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuLyoqXG4gKiBQYXJzZSBoZWFkZXJzIGludG8gYW4gb2JqZWN0XG4gKlxuICogYGBgXG4gKiBEYXRlOiBXZWQsIDI3IEF1ZyAyMDE0IDA4OjU4OjQ5IEdNVFxuICogQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uXG4gKiBDb25uZWN0aW9uOiBrZWVwLWFsaXZlXG4gKiBUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZFxuICogYGBgXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGhlYWRlcnMgSGVhZGVycyBuZWVkaW5nIHRvIGJlIHBhcnNlZFxuICogQHJldHVybnMge09iamVjdH0gSGVhZGVycyBwYXJzZWQgaW50byBhbiBvYmplY3RcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYXJzZUhlYWRlcnMoaGVhZGVycykge1xuICB2YXIgcGFyc2VkID0ge307XG4gIHZhciBrZXk7XG4gIHZhciB2YWw7XG4gIHZhciBpO1xuXG4gIGlmICghaGVhZGVycykgeyByZXR1cm4gcGFyc2VkOyB9XG5cbiAgdXRpbHMuZm9yRWFjaChoZWFkZXJzLnNwbGl0KCdcXG4nKSwgZnVuY3Rpb24gcGFyc2VyKGxpbmUpIHtcbiAgICBpID0gbGluZS5pbmRleE9mKCc6Jyk7XG4gICAga2V5ID0gdXRpbHMudHJpbShsaW5lLnN1YnN0cigwLCBpKSkudG9Mb3dlckNhc2UoKTtcbiAgICB2YWwgPSB1dGlscy50cmltKGxpbmUuc3Vic3RyKGkgKyAxKSk7XG5cbiAgICBpZiAoa2V5KSB7XG4gICAgICBwYXJzZWRba2V5XSA9IHBhcnNlZFtrZXldID8gcGFyc2VkW2tleV0gKyAnLCAnICsgdmFsIDogdmFsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHBhcnNlZDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogU3ludGFjdGljIHN1Z2FyIGZvciBpbnZva2luZyBhIGZ1bmN0aW9uIGFuZCBleHBhbmRpbmcgYW4gYXJyYXkgZm9yIGFyZ3VtZW50cy5cbiAqXG4gKiBDb21tb24gdXNlIGNhc2Ugd291bGQgYmUgdG8gdXNlIGBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHlgLlxuICpcbiAqICBgYGBqc1xuICogIGZ1bmN0aW9uIGYoeCwgeSwgeikge31cbiAqICB2YXIgYXJncyA9IFsxLCAyLCAzXTtcbiAqICBmLmFwcGx5KG51bGwsIGFyZ3MpO1xuICogIGBgYFxuICpcbiAqIFdpdGggYHNwcmVhZGAgdGhpcyBleGFtcGxlIGNhbiBiZSByZS13cml0dGVuLlxuICpcbiAqICBgYGBqc1xuICogIHNwcmVhZChmdW5jdGlvbih4LCB5LCB6KSB7fSkoWzEsIDIsIDNdKTtcbiAqICBgYGBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHJldHVybnMge0Z1bmN0aW9ufVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNwcmVhZChjYWxsYmFjaykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcChhcnIpIHtcbiAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkobnVsbCwgYXJyKTtcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcbnZhciBpc0J1ZmZlciA9IHJlcXVpcmUoJ2lzLWJ1ZmZlcicpO1xuXG4vKmdsb2JhbCB0b1N0cmluZzp0cnVlKi9cblxuLy8gdXRpbHMgaXMgYSBsaWJyYXJ5IG9mIGdlbmVyaWMgaGVscGVyIGZ1bmN0aW9ucyBub24tc3BlY2lmaWMgdG8gYXhpb3NcblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheUJ1ZmZlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZvcm1EYXRhXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gRm9ybURhdGEsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Zvcm1EYXRhKHZhbCkge1xuICByZXR1cm4gKHR5cGVvZiBGb3JtRGF0YSAhPT0gJ3VuZGVmaW5lZCcpICYmICh2YWwgaW5zdGFuY2VvZiBGb3JtRGF0YSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlclZpZXcodmFsKSB7XG4gIHZhciByZXN1bHQ7XG4gIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJykgJiYgKEFycmF5QnVmZmVyLmlzVmlldykpIHtcbiAgICByZXN1bHQgPSBBcnJheUJ1ZmZlci5pc1ZpZXcodmFsKTtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQgPSAodmFsKSAmJiAodmFsLmJ1ZmZlcikgJiYgKHZhbC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFN0cmluZ1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgU3RyaW5nLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTdHJpbmcodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIE51bWJlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgTnVtYmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNOdW1iZXIodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnbnVtYmVyJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyB1bmRlZmluZWRcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgdW5kZWZpbmVkLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBPYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIERhdGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIERhdGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0RhdGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZpbGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEZpbGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0ZpbGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZpbGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEJsb2JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEJsb2IsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Jsb2IodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEJsb2JdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBGdW5jdGlvbiwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBTdHJlYW1cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFN0cmVhbSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyZWFtKHZhbCkge1xuICByZXR1cm4gaXNPYmplY3QodmFsKSAmJiBpc0Z1bmN0aW9uKHZhbC5waXBlKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1VSTFNlYXJjaFBhcmFtcyh2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiBVUkxTZWFyY2hQYXJhbXMgIT09ICd1bmRlZmluZWQnICYmIHZhbCBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtcztcbn1cblxuLyoqXG4gKiBUcmltIGV4Y2VzcyB3aGl0ZXNwYWNlIG9mZiB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YgYSBzdHJpbmdcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBTdHJpbmcgdG8gdHJpbVxuICogQHJldHVybnMge1N0cmluZ30gVGhlIFN0cmluZyBmcmVlZCBvZiBleGNlc3Mgd2hpdGVzcGFjZVxuICovXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqLywgJycpLnJlcGxhY2UoL1xccyokLywgJycpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiB3ZSdyZSBydW5uaW5nIGluIGEgc3RhbmRhcmQgYnJvd3NlciBlbnZpcm9ubWVudFxuICpcbiAqIFRoaXMgYWxsb3dzIGF4aW9zIHRvIHJ1biBpbiBhIHdlYiB3b3JrZXIsIGFuZCByZWFjdC1uYXRpdmUuXG4gKiBCb3RoIGVudmlyb25tZW50cyBzdXBwb3J0IFhNTEh0dHBSZXF1ZXN0LCBidXQgbm90IGZ1bGx5IHN0YW5kYXJkIGdsb2JhbHMuXG4gKlxuICogd2ViIHdvcmtlcnM6XG4gKiAgdHlwZW9mIHdpbmRvdyAtPiB1bmRlZmluZWRcbiAqICB0eXBlb2YgZG9jdW1lbnQgLT4gdW5kZWZpbmVkXG4gKlxuICogcmVhY3QtbmF0aXZlOlxuICogIG5hdmlnYXRvci5wcm9kdWN0IC0+ICdSZWFjdE5hdGl2ZSdcbiAqL1xuZnVuY3Rpb24gaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gJ1JlYWN0TmF0aXZlJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gKFxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJ1xuICApO1xufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBBcnJheSBvciBhbiBPYmplY3QgaW52b2tpbmcgYSBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmIGBvYmpgIGlzIGFuIEFycmF5IGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIHBhc3NpbmdcbiAqIHRoZSB2YWx1ZSwgaW5kZXgsIGFuZCBjb21wbGV0ZSBhcnJheSBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmICdvYmonIGlzIGFuIE9iamVjdCBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBwYXNzaW5nXG4gKiB0aGUgdmFsdWUsIGtleSwgYW5kIGNvbXBsZXRlIG9iamVjdCBmb3IgZWFjaCBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdHxBcnJheX0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGNhbGxiYWNrIHRvIGludm9rZSBmb3IgZWFjaCBpdGVtXG4gKi9cbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmbikge1xuICAvLyBEb24ndCBib3RoZXIgaWYgbm8gdmFsdWUgcHJvdmlkZWRcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEZvcmNlIGFuIGFycmF5IGlmIG5vdCBhbHJlYWR5IHNvbWV0aGluZyBpdGVyYWJsZVxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgJiYgIWlzQXJyYXkob2JqKSkge1xuICAgIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICAgIG9iaiA9IFtvYmpdO1xuICB9XG5cbiAgaWYgKGlzQXJyYXkob2JqKSkge1xuICAgIC8vIEl0ZXJhdGUgb3ZlciBhcnJheSB2YWx1ZXNcbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGZuLmNhbGwobnVsbCwgb2JqW2ldLCBpLCBvYmopO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBJdGVyYXRlIG92ZXIgb2JqZWN0IGtleXNcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICBmbi5jYWxsKG51bGwsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQWNjZXB0cyB2YXJhcmdzIGV4cGVjdGluZyBlYWNoIGFyZ3VtZW50IHRvIGJlIGFuIG9iamVjdCwgdGhlblxuICogaW1tdXRhYmx5IG1lcmdlcyB0aGUgcHJvcGVydGllcyBvZiBlYWNoIG9iamVjdCBhbmQgcmV0dXJucyByZXN1bHQuXG4gKlxuICogV2hlbiBtdWx0aXBsZSBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUga2V5IHRoZSBsYXRlciBvYmplY3QgaW5cbiAqIHRoZSBhcmd1bWVudHMgbGlzdCB3aWxsIHRha2UgcHJlY2VkZW5jZS5cbiAqXG4gKiBFeGFtcGxlOlxuICpcbiAqIGBgYGpzXG4gKiB2YXIgcmVzdWx0ID0gbWVyZ2Uoe2ZvbzogMTIzfSwge2ZvbzogNDU2fSk7XG4gKiBjb25zb2xlLmxvZyhyZXN1bHQuZm9vKTsgLy8gb3V0cHV0cyA0NTZcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmoxIE9iamVjdCB0byBtZXJnZVxuICogQHJldHVybnMge09iamVjdH0gUmVzdWx0IG9mIGFsbCBtZXJnZSBwcm9wZXJ0aWVzXG4gKi9cbmZ1bmN0aW9uIG1lcmdlKC8qIG9iajEsIG9iajIsIG9iajMsIC4uLiAqLykge1xuICB2YXIgcmVzdWx0ID0ge307XG4gIGZ1bmN0aW9uIGFzc2lnblZhbHVlKHZhbCwga2V5KSB7XG4gICAgaWYgKHR5cGVvZiByZXN1bHRba2V5XSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gbWVyZ2UocmVzdWx0W2tleV0sIHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsO1xuICAgIH1cbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwLCBsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgIGZvckVhY2goYXJndW1lbnRzW2ldLCBhc3NpZ25WYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBFeHRlbmRzIG9iamVjdCBhIGJ5IG11dGFibHkgYWRkaW5nIHRvIGl0IHRoZSBwcm9wZXJ0aWVzIG9mIG9iamVjdCBiLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBhIFRoZSBvYmplY3QgdG8gYmUgZXh0ZW5kZWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBiIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7T2JqZWN0fSB0aGlzQXJnIFRoZSBvYmplY3QgdG8gYmluZCBmdW5jdGlvbiB0b1xuICogQHJldHVybiB7T2JqZWN0fSBUaGUgcmVzdWx0aW5nIHZhbHVlIG9mIG9iamVjdCBhXG4gKi9cbmZ1bmN0aW9uIGV4dGVuZChhLCBiLCB0aGlzQXJnKSB7XG4gIGZvckVhY2goYiwgZnVuY3Rpb24gYXNzaWduVmFsdWUodmFsLCBrZXkpIHtcbiAgICBpZiAodGhpc0FyZyAmJiB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBhW2tleV0gPSBiaW5kKHZhbCwgdGhpc0FyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFba2V5XSA9IHZhbDtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gYTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlzQXJyYXk6IGlzQXJyYXksXG4gIGlzQXJyYXlCdWZmZXI6IGlzQXJyYXlCdWZmZXIsXG4gIGlzQnVmZmVyOiBpc0J1ZmZlcixcbiAgaXNGb3JtRGF0YTogaXNGb3JtRGF0YSxcbiAgaXNBcnJheUJ1ZmZlclZpZXc6IGlzQXJyYXlCdWZmZXJWaWV3LFxuICBpc1N0cmluZzogaXNTdHJpbmcsXG4gIGlzTnVtYmVyOiBpc051bWJlcixcbiAgaXNPYmplY3Q6IGlzT2JqZWN0LFxuICBpc1VuZGVmaW5lZDogaXNVbmRlZmluZWQsXG4gIGlzRGF0ZTogaXNEYXRlLFxuICBpc0ZpbGU6IGlzRmlsZSxcbiAgaXNCbG9iOiBpc0Jsb2IsXG4gIGlzRnVuY3Rpb246IGlzRnVuY3Rpb24sXG4gIGlzU3RyZWFtOiBpc1N0cmVhbSxcbiAgaXNVUkxTZWFyY2hQYXJhbXM6IGlzVVJMU2VhcmNoUGFyYW1zLFxuICBpc1N0YW5kYXJkQnJvd3NlckVudjogaXNTdGFuZGFyZEJyb3dzZXJFbnYsXG4gIGZvckVhY2g6IGZvckVhY2gsXG4gIG1lcmdlOiBtZXJnZSxcbiAgZXh0ZW5kOiBleHRlbmQsXG4gIHRyaW06IHRyaW1cbn07XG4iLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBGdXNlIC0gTGlnaHR3ZWlnaHQgZnV6enktc2VhcmNoXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEyLTIwMTYgS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPi5cbiAqIEFsbCBSaWdodHMgUmVzZXJ2ZWQuIEFwYWNoZSBTb2Z0d2FyZSBMaWNlbnNlIDIuMFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIilcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbjsoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAndXNlIHN0cmljdCdcblxuICAvKiogQHR5cGUge2Z1bmN0aW9uKC4uLiopfSAqL1xuICBmdW5jdGlvbiBsb2cgKCkge1xuICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cylcbiAgfVxuXG4gIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyBUaGUgbmFtZSBvZiB0aGUgaWRlbnRpZmllciBwcm9wZXJ0eS4gSWYgc3BlY2lmaWVkLCB0aGUgcmV0dXJuZWQgcmVzdWx0IHdpbGwgYmUgYSBsaXN0XG4gICAgLy8gb2YgdGhlIGl0ZW1zJyBkZW50aWZpZXJzLCBvdGhlcndpc2UgaXQgd2lsbCBiZSBhIGxpc3Qgb2YgdGhlIGl0ZW1zLlxuICAgIGlkOiBudWxsLFxuXG4gICAgLy8gSW5kaWNhdGVzIHdoZXRoZXIgY29tcGFyaXNvbnMgc2hvdWxkIGJlIGNhc2Ugc2Vuc2l0aXZlLlxuXG4gICAgY2FzZVNlbnNpdGl2ZTogZmFsc2UsXG5cbiAgICAvLyBBbiBhcnJheSBvZiB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgZnJvbSB0aGUgc2VhcmNoZXIncyBvdXRwdXQuIFdoZW4gdGhpcyBhcnJheVxuICAgIC8vIGNvbnRhaW5zIGVsZW1lbnRzLCBlYWNoIHJlc3VsdCBpbiB0aGUgbGlzdCB3aWxsIGJlIG9mIHRoZSBmb3JtIGB7IGl0ZW06IC4uLiwgaW5jbHVkZTE6IC4uLiwgaW5jbHVkZTI6IC4uLiB9YC5cbiAgICAvLyBWYWx1ZXMgeW91IGNhbiBpbmNsdWRlIGFyZSBgc2NvcmVgLCBgbWF0Y2hlZExvY2F0aW9uc2BcbiAgICBpbmNsdWRlOiBbXSxcblxuICAgIC8vIFdoZXRoZXIgdG8gc29ydCB0aGUgcmVzdWx0IGxpc3QsIGJ5IHNjb3JlXG4gICAgc2hvdWxkU29ydDogdHJ1ZSxcblxuICAgIC8vIFRoZSBzZWFyY2ggZnVuY3Rpb24gdG8gdXNlXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IHNlYXJjaCBmdW5jdGlvbiAoW1tGdW5jdGlvbl1dKSBtdXN0IGNvbmZvcm0gdG8gdGhlIGZvbGxvd2luZyBBUEk6XG4gICAgLy9cbiAgICAvLyAgQHBhcmFtIHBhdHRlcm4gVGhlIHBhdHRlcm4gc3RyaW5nIHRvIHNlYXJjaFxuICAgIC8vICBAcGFyYW0gb3B0aW9ucyBUaGUgc2VhcmNoIG9wdGlvblxuICAgIC8vICBbW0Z1bmN0aW9uXV0uY29uc3RydWN0b3IgPSBmdW5jdGlvbihwYXR0ZXJuLCBvcHRpb25zKVxuICAgIC8vXG4gICAgLy8gIEBwYXJhbSB0ZXh0OiB0aGUgc3RyaW5nIHRvIHNlYXJjaCBpbiBmb3IgdGhlIHBhdHRlcm5cbiAgICAvLyAgQHJldHVybiBPYmplY3QgaW4gdGhlIGZvcm0gb2Y6XG4gICAgLy8gICAgLSBpc01hdGNoOiBib29sZWFuXG4gICAgLy8gICAgLSBzY29yZTogSW50XG4gICAgLy8gIFtbRnVuY3Rpb25dXS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24odGV4dClcbiAgICBzZWFyY2hGbjogQml0YXBTZWFyY2hlcixcblxuICAgIC8vIERlZmF1bHQgc29ydCBmdW5jdGlvblxuICAgIHNvcnRGbjogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBhLnNjb3JlIC0gYi5zY29yZVxuICAgIH0sXG5cbiAgICAvLyBUaGUgZ2V0IGZ1bmN0aW9uIHRvIHVzZSB3aGVuIGZldGNoaW5nIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuXG4gICAgLy8gVGhlIGRlZmF1bHQgd2lsbCBzZWFyY2ggbmVzdGVkIHBhdGhzICppZSBmb28uYmFyLmJheipcbiAgICBnZXRGbjogZGVlcFZhbHVlLFxuXG4gICAgLy8gTGlzdCBvZiBwcm9wZXJ0aWVzIHRoYXQgd2lsbCBiZSBzZWFyY2hlZC4gVGhpcyBhbHNvIHN1cHBvcnRzIG5lc3RlZCBwcm9wZXJ0aWVzLlxuICAgIGtleXM6IFtdLFxuXG4gICAgLy8gV2lsbCBwcmludCB0byB0aGUgY29uc29sZS4gVXNlZnVsIGZvciBkZWJ1Z2dpbmcuXG4gICAgdmVyYm9zZTogZmFsc2UsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBzZWFyY2ggYWxnb3JpdGhtIHdpbGwgc2VhcmNoIGluZGl2aWR1YWwgd29yZHMgKiphbmQqKiB0aGUgZnVsbCBzdHJpbmcsXG4gICAgLy8gY29tcHV0aW5nIHRoZSBmaW5hbCBzY29yZSBhcyBhIGZ1bmN0aW9uIG9mIGJvdGguIE5vdGUgdGhhdCB3aGVuIGB0b2tlbml6ZWAgaXMgYHRydWVgLFxuICAgIC8vIHRoZSBgdGhyZXNob2xkYCwgYGRpc3RhbmNlYCwgYW5kIGBsb2NhdGlvbmAgYXJlIGluY29uc2VxdWVudGlhbCBmb3IgaW5kaXZpZHVhbCB0b2tlbnMuXG4gICAgdG9rZW5pemU6IGZhbHNlLFxuXG4gICAgLy8gV2hlbiB0cnVlLCB0aGUgcmVzdWx0IHNldCB3aWxsIG9ubHkgaW5jbHVkZSByZWNvcmRzIHRoYXQgbWF0Y2ggYWxsIHRva2Vucy4gV2lsbCBvbmx5IHdvcmtcbiAgICAvLyBpZiBgdG9rZW5pemVgIGlzIGFsc28gdHJ1ZS5cbiAgICBtYXRjaEFsbFRva2VuczogZmFsc2UsXG5cbiAgICAvLyBSZWdleCB1c2VkIHRvIHNlcGFyYXRlIHdvcmRzIHdoZW4gc2VhcmNoaW5nLiBPbmx5IGFwcGxpY2FibGUgd2hlbiBgdG9rZW5pemVgIGlzIGB0cnVlYC5cbiAgICB0b2tlblNlcGFyYXRvcjogLyArL2csXG5cbiAgICAvLyBNaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgbXVzdCBiZSBtYXRjaGVkIGJlZm9yZSBhIHJlc3VsdCBpcyBjb25zaWRlcmVkIGEgbWF0Y2hcbiAgICBtaW5NYXRjaENoYXJMZW5ndGg6IDEsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBhbGdvcml0aG0gY29udGludWVzIHNlYXJjaGluZyB0byB0aGUgZW5kIG9mIHRoZSBpbnB1dCBldmVuIGlmIGEgcGVyZmVjdFxuICAgIC8vIG1hdGNoIGlzIGZvdW5kIGJlZm9yZSB0aGUgZW5kIG9mIHRoZSBzYW1lIGlucHV0LlxuICAgIGZpbmRBbGxNYXRjaGVzOiBmYWxzZVxuICB9XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gb3B0aW9uc1xuICAgKi9cbiAgZnVuY3Rpb24gRnVzZSAobGlzdCwgb3B0aW9ucykge1xuICAgIHZhciBrZXlcblxuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuXG4gICAgZm9yIChrZXkgaW4gZGVmYXVsdE9wdGlvbnMpIHtcbiAgICAgIGlmICghZGVmYXVsdE9wdGlvbnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIC8vIEFkZCBib29sZWFuIHR5cGUgb3B0aW9uc1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0T3B0aW9uc1trZXldID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSBrZXkgaW4gb3B0aW9ucyA/IG9wdGlvbnNba2V5XSA6IGRlZmF1bHRPcHRpb25zW2tleV07XG4gICAgICAvLyBBZGQgYWxsIG90aGVyIG9wdGlvbnNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub3B0aW9uc1trZXldID0gb3B0aW9uc1trZXldIHx8IGRlZmF1bHRPcHRpb25zW2tleV1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLlZFUlNJT04gPSAnMi43LjMnXG5cbiAgLyoqXG4gICAqIFNldHMgYSBuZXcgbGlzdCBmb3IgRnVzZSB0byBtYXRjaCBhZ2FpbnN0LlxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcmV0dXJuIHshQXJyYXl9IFRoZSBuZXdseSBzZXQgbGlzdFxuICAgKiBAcHVibGljXG4gICAqL1xuICBGdXNlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobGlzdCkge1xuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICByZXR1cm4gbGlzdFxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLnZlcmJvc2UpIGxvZygnXFxuU2VhcmNoIHRlcm06JywgcGF0dGVybiwgJ1xcbicpXG5cbiAgICB0aGlzLnBhdHRlcm4gPSBwYXR0ZXJuXG4gICAgdGhpcy5yZXN1bHRzID0gW11cbiAgICB0aGlzLnJlc3VsdE1hcCA9IHt9XG4gICAgdGhpcy5fa2V5TWFwID0gbnVsbFxuXG4gICAgdGhpcy5fcHJlcGFyZVNlYXJjaGVycygpXG4gICAgdGhpcy5fc3RhcnRTZWFyY2goKVxuICAgIHRoaXMuX2NvbXB1dGVTY29yZSgpXG4gICAgdGhpcy5fc29ydCgpXG5cbiAgICB2YXIgb3V0cHV0ID0gdGhpcy5fZm9ybWF0KClcbiAgICByZXR1cm4gb3V0cHV0XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fcHJlcGFyZVNlYXJjaGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBwYXR0ZXJuID0gdGhpcy5wYXR0ZXJuXG4gICAgdmFyIHNlYXJjaEZuID0gb3B0aW9ucy5zZWFyY2hGblxuICAgIHZhciB0b2tlbnMgPSBwYXR0ZXJuLnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG4gICAgdmFyIGkgPSAwXG4gICAgdmFyIGxlbiA9IHRva2Vucy5sZW5ndGhcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudG9rZW5pemUpIHtcbiAgICAgIHRoaXMudG9rZW5TZWFyY2hlcnMgPSBbXVxuICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLnRva2VuU2VhcmNoZXJzLnB1c2gobmV3IHNlYXJjaEZuKHRva2Vuc1tpXSwgb3B0aW9ucykpXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZnVsbFNlYWNoZXIgPSBuZXcgc2VhcmNoRm4ocGF0dGVybiwgb3B0aW9ucylcbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9zdGFydFNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBnZXRGbiA9IG9wdGlvbnMuZ2V0Rm5cbiAgICB2YXIgbGlzdCA9IHRoaXMubGlzdFxuICAgIHZhciBsaXN0TGVuID0gbGlzdC5sZW5ndGhcbiAgICB2YXIga2V5cyA9IHRoaXMub3B0aW9ucy5rZXlzXG4gICAgdmFyIGtleXNMZW4gPSBrZXlzLmxlbmd0aFxuICAgIHZhciBrZXlcbiAgICB2YXIgd2VpZ2h0XG4gICAgdmFyIGl0ZW0gPSBudWxsXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGxpc3QsIGlmIGl0J3MgYSBzdHJpbmcsIHRoZW4gd2UgYXNzdW1lXG4gICAgLy8gdGhhdCBldmVyeSBpdGVtIGluIHRoZSBsaXN0IGlzIGFsc28gYSBzdHJpbmcsIGFuZCB0aHVzIGl0J3MgYSBmbGF0dGVuZWQgYXJyYXkuXG4gICAgaWYgKHR5cGVvZiBsaXN0WzBdID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5fYW5hbHl6ZSgnJywgbGlzdFtpXSwgaSwgaSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fa2V5TWFwID0ge31cbiAgICAgIC8vIE90aGVyd2lzZSwgdGhlIGZpcnN0IGl0ZW0gaXMgYW4gT2JqZWN0IChob3BlZnVsbHkpLCBhbmQgdGh1cyB0aGUgc2VhcmNoaW5nXG4gICAgICAvLyBpcyBkb25lIG9uIHRoZSB2YWx1ZXMgb2YgdGhlIGtleXMgb2YgZWFjaCBpdGVtLlxuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgaXRlbSA9IGxpc3RbaV1cbiAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGtleVxuICAgICAgICBmb3IgKGogPSAwOyBqIDwga2V5c0xlbjsgaisrKSB7XG4gICAgICAgICAga2V5ID0ga2V5c1tqXVxuICAgICAgICAgIGlmICh0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgd2VpZ2h0ID0gKDEgLSBrZXkud2VpZ2h0KSB8fCAxXG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICB3ZWlnaHQ6IHdlaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGtleS53ZWlnaHQgPD0gMCB8fCBrZXkud2VpZ2h0ID4gMSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tleSB3ZWlnaHQgaGFzIHRvIGJlID4gMCBhbmQgPD0gMScpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXkgPSBrZXkubmFtZVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5XSA9IHtcbiAgICAgICAgICAgICAgd2VpZ2h0OiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2FuYWx5emUoa2V5LCBnZXRGbihpdGVtLCBrZXksIFtdKSwgaXRlbSwgaSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9hbmFseXplID0gZnVuY3Rpb24gKGtleSwgdGV4dCwgZW50aXR5LCBpbmRleCkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgdmFyIHdvcmRzXG4gICAgdmFyIHNjb3Jlc1xuICAgIHZhciBleGlzdHMgPSBmYWxzZVxuICAgIHZhciBleGlzdGluZ1Jlc3VsdFxuICAgIHZhciBhdmVyYWdlU2NvcmVcbiAgICB2YXIgZmluYWxTY29yZVxuICAgIHZhciBzY29yZXNMZW5cbiAgICB2YXIgbWFpblNlYXJjaFJlc3VsdFxuICAgIHZhciB0b2tlblNlYXJjaGVyXG4gICAgdmFyIHRlcm1TY29yZXNcbiAgICB2YXIgd29yZFxuICAgIHZhciB0b2tlblNlYXJjaFJlc3VsdFxuICAgIHZhciBoYXNNYXRjaEluVGV4dFxuICAgIHZhciBjaGVja1RleHRNYXRjaGVzXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHRleHQgY2FuIGJlIHNlYXJjaGVkXG4gICAgaWYgKHRleHQgPT09IHVuZGVmaW5lZCB8fCB0ZXh0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzY29yZXMgPSBbXVxuXG4gICAgdmFyIG51bVRleHRNYXRjaGVzID0gMFxuXG4gICAgaWYgKHR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJykge1xuICAgICAgd29yZHMgPSB0ZXh0LnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG5cbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnLS0tLS0tLS0tXFxuS2V5OicsIGtleSlcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbml6ZSkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50b2tlblNlYXJjaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRva2VuU2VhcmNoZXIgPSB0aGlzLnRva2VuU2VhcmNoZXJzW2ldXG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1BhdHRlcm46JywgdG9rZW5TZWFyY2hlci5wYXR0ZXJuKVxuXG4gICAgICAgICAgdGVybVNjb3JlcyA9IFtdXG4gICAgICAgICAgaGFzTWF0Y2hJblRleHQgPSBmYWxzZVxuXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdvcmRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB3b3JkID0gd29yZHNbal1cbiAgICAgICAgICAgIHRva2VuU2VhcmNoUmVzdWx0ID0gdG9rZW5TZWFyY2hlci5zZWFyY2god29yZClcbiAgICAgICAgICAgIHZhciBvYmogPSB7fVxuICAgICAgICAgICAgaWYgKHRva2VuU2VhcmNoUmVzdWx0LmlzTWF0Y2gpIHtcbiAgICAgICAgICAgICAgb2JqW3dvcmRdID0gdG9rZW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgICAgICAgICAgZXhpc3RzID0gdHJ1ZVxuICAgICAgICAgICAgICBoYXNNYXRjaEluVGV4dCA9IHRydWVcbiAgICAgICAgICAgICAgc2NvcmVzLnB1c2godG9rZW5TZWFyY2hSZXN1bHQuc2NvcmUpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBvYmpbd29yZF0gPSAxXG4gICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSB7XG4gICAgICAgICAgICAgICAgc2NvcmVzLnB1c2goMSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGVybVNjb3Jlcy5wdXNoKG9iailcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaGFzTWF0Y2hJblRleHQpIHtcbiAgICAgICAgICAgIG51bVRleHRNYXRjaGVzKytcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Rva2VuIHNjb3JlczonLCB0ZXJtU2NvcmVzKVxuICAgICAgICB9XG5cbiAgICAgICAgYXZlcmFnZVNjb3JlID0gc2NvcmVzWzBdXG4gICAgICAgIHNjb3Jlc0xlbiA9IHNjb3Jlcy5sZW5ndGhcbiAgICAgICAgZm9yIChpID0gMTsgaSA8IHNjb3Jlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgYXZlcmFnZVNjb3JlICs9IHNjb3Jlc1tpXVxuICAgICAgICB9XG4gICAgICAgIGF2ZXJhZ2VTY29yZSA9IGF2ZXJhZ2VTY29yZSAvIHNjb3Jlc0xlblxuXG4gICAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnVG9rZW4gc2NvcmUgYXZlcmFnZTonLCBhdmVyYWdlU2NvcmUpXG4gICAgICB9XG5cbiAgICAgIG1haW5TZWFyY2hSZXN1bHQgPSB0aGlzLmZ1bGxTZWFjaGVyLnNlYXJjaCh0ZXh0KVxuICAgICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdGdWxsIHRleHQgc2NvcmU6JywgbWFpblNlYXJjaFJlc3VsdC5zY29yZSlcblxuICAgICAgZmluYWxTY29yZSA9IG1haW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgIGlmIChhdmVyYWdlU2NvcmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBmaW5hbFNjb3JlID0gKGZpbmFsU2NvcmUgKyBhdmVyYWdlU2NvcmUpIC8gMlxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Njb3JlIGF2ZXJhZ2U6JywgZmluYWxTY29yZSlcblxuICAgICAgY2hlY2tUZXh0TWF0Y2hlcyA9ICh0aGlzLm9wdGlvbnMudG9rZW5pemUgJiYgdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSA/IG51bVRleHRNYXRjaGVzID49IHRoaXMudG9rZW5TZWFyY2hlcnMubGVuZ3RoIDogdHJ1ZVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ0NoZWNrIE1hdGNoZXMnLCBjaGVja1RleHRNYXRjaGVzKVxuXG4gICAgICAvLyBJZiBhIG1hdGNoIGlzIGZvdW5kLCBhZGQgdGhlIGl0ZW0gdG8gPHJhd1Jlc3VsdHM+LCBpbmNsdWRpbmcgaXRzIHNjb3JlXG4gICAgICBpZiAoKGV4aXN0cyB8fCBtYWluU2VhcmNoUmVzdWx0LmlzTWF0Y2gpICYmIGNoZWNrVGV4dE1hdGNoZXMpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGl0ZW0gYWxyZWFkeSBleGlzdHMgaW4gb3VyIHJlc3VsdHNcbiAgICAgICAgZXhpc3RpbmdSZXN1bHQgPSB0aGlzLnJlc3VsdE1hcFtpbmRleF1cblxuICAgICAgICBpZiAoZXhpc3RpbmdSZXN1bHQpIHtcbiAgICAgICAgICAvLyBVc2UgdGhlIGxvd2VzdCBzY29yZVxuICAgICAgICAgIC8vIGV4aXN0aW5nUmVzdWx0LnNjb3JlLCBiaXRhcFJlc3VsdC5zY29yZVxuICAgICAgICAgIGV4aXN0aW5nUmVzdWx0Lm91dHB1dC5wdXNoKHtcbiAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgc2NvcmU6IGZpbmFsU2NvcmUsXG4gICAgICAgICAgICBtYXRjaGVkSW5kaWNlczogbWFpblNlYXJjaFJlc3VsdC5tYXRjaGVkSW5kaWNlc1xuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSByYXcgcmVzdWx0IGxpc3RcbiAgICAgICAgICB0aGlzLnJlc3VsdE1hcFtpbmRleF0gPSB7XG4gICAgICAgICAgICBpdGVtOiBlbnRpdHksXG4gICAgICAgICAgICBvdXRwdXQ6IFt7XG4gICAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgICAgbWF0Y2hlZEluZGljZXM6IG1haW5TZWFyY2hSZXN1bHQubWF0Y2hlZEluZGljZXNcbiAgICAgICAgICAgIH1dXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5yZXN1bHRzLnB1c2godGhpcy5yZXN1bHRNYXBbaW5kZXhdKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHRleHQpKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9hbmFseXplKGtleSwgdGV4dFtpXSwgZW50aXR5LCBpbmRleClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fY29tcHV0ZVNjb3JlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpXG4gICAgdmFyIGpcbiAgICB2YXIga2V5TWFwID0gdGhpcy5fa2V5TWFwXG4gICAgdmFyIHRvdGFsU2NvcmVcbiAgICB2YXIgb3V0cHV0XG4gICAgdmFyIHNjb3JlTGVuXG4gICAgdmFyIHNjb3JlXG4gICAgdmFyIHdlaWdodFxuICAgIHZhciByZXN1bHRzID0gdGhpcy5yZXN1bHRzXG4gICAgdmFyIGJlc3RTY29yZVxuICAgIHZhciBuU2NvcmVcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5Db21wdXRpbmcgc2NvcmU6XFxuJylcblxuICAgIGZvciAoaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3RhbFNjb3JlID0gMFxuICAgICAgb3V0cHV0ID0gcmVzdWx0c1tpXS5vdXRwdXRcbiAgICAgIHNjb3JlTGVuID0gb3V0cHV0Lmxlbmd0aFxuXG4gICAgICBiZXN0U2NvcmUgPSAxXG5cbiAgICAgIGZvciAoaiA9IDA7IGogPCBzY29yZUxlbjsgaisrKSB7XG4gICAgICAgIHNjb3JlID0gb3V0cHV0W2pdLnNjb3JlXG4gICAgICAgIHdlaWdodCA9IGtleU1hcCA/IGtleU1hcFtvdXRwdXRbal0ua2V5XS53ZWlnaHQgOiAxXG5cbiAgICAgICAgblNjb3JlID0gc2NvcmUgKiB3ZWlnaHRcblxuICAgICAgICBpZiAod2VpZ2h0ICE9PSAxKSB7XG4gICAgICAgICAgYmVzdFNjb3JlID0gTWF0aC5taW4oYmVzdFNjb3JlLCBuU2NvcmUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG90YWxTY29yZSArPSBuU2NvcmVcbiAgICAgICAgICBvdXRwdXRbal0ublNjb3JlID0gblNjb3JlXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGJlc3RTY29yZSA9PT0gMSkge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gdG90YWxTY29yZSAvIHNjb3JlTGVuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gYmVzdFNjb3JlXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKHJlc3VsdHNbaV0pXG4gICAgfVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX3NvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICBpZiAob3B0aW9ucy5zaG91bGRTb3J0KSB7XG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1xcblxcblNvcnRpbmcuLi4uJylcbiAgICAgIHRoaXMucmVzdWx0cy5zb3J0KG9wdGlvbnMuc29ydEZuKVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9mb3JtYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgZ2V0Rm4gPSBvcHRpb25zLmdldEZuXG4gICAgdmFyIGZpbmFsT3V0cHV0ID0gW11cbiAgICB2YXIgaVxuICAgIHZhciBsZW5cbiAgICB2YXIgcmVzdWx0cyA9IHRoaXMucmVzdWx0c1xuICAgIHZhciByZXBsYWNlVmFsdWVcbiAgICB2YXIgZ2V0SXRlbUF0SW5kZXhcbiAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMuaW5jbHVkZVxuXG4gICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5PdXRwdXQ6XFxuXFxuJywgcmVzdWx0cylcblxuICAgIC8vIEhlbHBlciBmdW5jdGlvbiwgaGVyZSBmb3Igc3BlZWQtdXAsIHdoaWNoIHJlcGxhY2VzIHRoZSBpdGVtIHdpdGggaXRzIHZhbHVlLFxuICAgIC8vIGlmIHRoZSBvcHRpb25zIHNwZWNpZmllcyBpdCxcbiAgICByZXBsYWNlVmFsdWUgPSBvcHRpb25zLmlkID8gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICByZXN1bHRzW2luZGV4XS5pdGVtID0gZ2V0Rm4ocmVzdWx0c1tpbmRleF0uaXRlbSwgb3B0aW9ucy5pZCwgW10pWzBdXG4gICAgfSA6IGZ1bmN0aW9uICgpIHt9XG5cbiAgICBnZXRJdGVtQXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgdmFyIHJlY29yZCA9IHJlc3VsdHNbaW5kZXhdXG4gICAgICB2YXIgZGF0YVxuICAgICAgdmFyIGpcbiAgICAgIHZhciBvdXRwdXRcbiAgICAgIHZhciBfaXRlbVxuICAgICAgdmFyIF9yZXN1bHRcblxuICAgICAgLy8gSWYgYGluY2x1ZGVgIGhhcyB2YWx1ZXMsIHB1dCB0aGUgaXRlbSBpbiB0aGUgcmVzdWx0XG4gICAgICBpZiAoaW5jbHVkZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgaXRlbTogcmVjb3JkLml0ZW1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5jbHVkZS5pbmRleE9mKCdtYXRjaGVzJykgIT09IC0xKSB7XG4gICAgICAgICAgb3V0cHV0ID0gcmVjb3JkLm91dHB1dFxuICAgICAgICAgIGRhdGEubWF0Y2hlcyA9IFtdXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IG91dHB1dC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgX2l0ZW0gPSBvdXRwdXRbal1cbiAgICAgICAgICAgIF9yZXN1bHQgPSB7XG4gICAgICAgICAgICAgIGluZGljZXM6IF9pdGVtLm1hdGNoZWRJbmRpY2VzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX2l0ZW0ua2V5KSB7XG4gICAgICAgICAgICAgIF9yZXN1bHQua2V5ID0gX2l0ZW0ua2V5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLm1hdGNoZXMucHVzaChfcmVzdWx0KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmNsdWRlLmluZGV4T2YoJ3Njb3JlJykgIT09IC0xKSB7XG4gICAgICAgICAgZGF0YS5zY29yZSA9IHJlc3VsdHNbaW5kZXhdLnNjb3JlXG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YSA9IHJlY29yZC5pdGVtXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfVxuXG4gICAgLy8gRnJvbSB0aGUgcmVzdWx0cywgcHVzaCBpbnRvIGEgbmV3IGFycmF5IG9ubHkgdGhlIGl0ZW0gaWRlbnRpZmllciAoaWYgc3BlY2lmaWVkKVxuICAgIC8vIG9mIHRoZSBlbnRpcmUgaXRlbS4gIFRoaXMgaXMgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHJldHVybiB0aGUgPHJlc3VsdHM+LFxuICAgIC8vIHNpbmNlIGl0IGNvbnRhaW5zIG90aGVyIG1ldGFkYXRhXG4gICAgZm9yIChpID0gMCwgbGVuID0gcmVzdWx0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgcmVwbGFjZVZhbHVlKGkpXG4gICAgICBmaW5hbE91dHB1dC5wdXNoKGdldEl0ZW1BdEluZGV4KGkpKVxuICAgIH1cblxuICAgIHJldHVybiBmaW5hbE91dHB1dFxuICB9XG5cbiAgLy8gSGVscGVyc1xuXG4gIGZ1bmN0aW9uIGRlZXBWYWx1ZSAob2JqLCBwYXRoLCBsaXN0KSB7XG4gICAgdmFyIGZpcnN0U2VnbWVudFxuICAgIHZhciByZW1haW5pbmdcbiAgICB2YXIgZG90SW5kZXhcbiAgICB2YXIgdmFsdWVcbiAgICB2YXIgaVxuICAgIHZhciBsZW5cblxuICAgIGlmICghcGF0aCkge1xuICAgICAgLy8gSWYgdGhlcmUncyBubyBwYXRoIGxlZnQsIHdlJ3ZlIGdvdHRlbiB0byB0aGUgb2JqZWN0IHdlIGNhcmUgYWJvdXQuXG4gICAgICBsaXN0LnB1c2gob2JqKVxuICAgIH0gZWxzZSB7XG4gICAgICBkb3RJbmRleCA9IHBhdGguaW5kZXhPZignLicpXG5cbiAgICAgIGlmIChkb3RJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZmlyc3RTZWdtZW50ID0gcGF0aC5zbGljZSgwLCBkb3RJbmRleClcbiAgICAgICAgcmVtYWluaW5nID0gcGF0aC5zbGljZShkb3RJbmRleCArIDEpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaXJzdFNlZ21lbnQgPSBwYXRoXG4gICAgICB9XG5cbiAgICAgIHZhbHVlID0gb2JqW2ZpcnN0U2VnbWVudF1cbiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghcmVtYWluaW5nICYmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpKSB7XG4gICAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgLy8gU2VhcmNoIGVhY2ggaXRlbSBpbiB0aGUgYXJyYXkuXG4gICAgICAgICAgZm9yIChpID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGRlZXBWYWx1ZSh2YWx1ZVtpXSwgcmVtYWluaW5nLCBsaXN0KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyZW1haW5pbmcpIHtcbiAgICAgICAgICAvLyBBbiBvYmplY3QuIFJlY3Vyc2UgZnVydGhlci5cbiAgICAgICAgICBkZWVwVmFsdWUodmFsdWUsIHJlbWFpbmluZywgbGlzdClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaXN0XG4gIH1cblxuICBmdW5jdGlvbiBpc0FycmF5IChvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSdcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGFwdGVkIGZyb20gXCJEaWZmLCBNYXRjaCBhbmQgUGF0Y2hcIiwgYnkgR29vZ2xlXG4gICAqXG4gICAqICAgaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2dvb2dsZS1kaWZmLW1hdGNoLXBhdGNoL1xuICAgKlxuICAgKiBNb2RpZmllZCBieTogS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPlxuICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgKiBEZXRhaWxzOiB0aGUgYWxnb3JpdGhtIGFuZCBzdHJ1Y3R1cmUgd2FzIG1vZGlmaWVkIHRvIGFsbG93IHRoZSBjcmVhdGlvbiBvZlxuICAgKiA8U2VhcmNoZXI+IGluc3RhbmNlcyB3aXRoIGEgPHNlYXJjaD4gbWV0aG9kIHdoaWNoIGRvZXMgdGhlIGFjdHVhbFxuICAgKiBiaXRhcCBzZWFyY2guIFRoZSA8cGF0dGVybj4gKHRoZSBzdHJpbmcgdGhhdCBpcyBzZWFyY2hlZCBmb3IpIGlzIG9ubHkgZGVmaW5lZFxuICAgKiBvbmNlIHBlciBpbnN0YW5jZSBhbmQgdGh1cyBpdCBlbGltaW5hdGVzIHJlZHVuZGFudCByZS1jcmVhdGlvbiB3aGVuIHNlYXJjaGluZ1xuICAgKiBvdmVyIGEgbGlzdCBvZiBzdHJpbmdzLlxuICAgKlxuICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpXG4gICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBmdW5jdGlvbiBCaXRhcFNlYXJjaGVyIChwYXR0ZXJuLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zLmxvY2F0aW9uID0gb3B0aW9ucy5sb2NhdGlvbiB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLmxvY2F0aW9uXG4gICAgdGhpcy5vcHRpb25zLmRpc3RhbmNlID0gJ2Rpc3RhbmNlJyBpbiBvcHRpb25zID8gb3B0aW9ucy5kaXN0YW5jZSA6IEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMuZGlzdGFuY2VcbiAgICB0aGlzLm9wdGlvbnMudGhyZXNob2xkID0gJ3RocmVzaG9sZCcgaW4gb3B0aW9ucyA/IG9wdGlvbnMudGhyZXNob2xkIDogQml0YXBTZWFyY2hlci5kZWZhdWx0T3B0aW9ucy50aHJlc2hvbGRcbiAgICB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCA9IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLm1heFBhdHRlcm5MZW5ndGhcblxuICAgIHRoaXMucGF0dGVybiA9IG9wdGlvbnMuY2FzZVNlbnNpdGl2ZSA/IHBhdHRlcm4gOiBwYXR0ZXJuLnRvTG93ZXJDYXNlKClcbiAgICB0aGlzLnBhdHRlcm5MZW4gPSBwYXR0ZXJuLmxlbmd0aFxuXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA8PSB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgdGhpcy5tYXRjaG1hc2sgPSAxIDw8ICh0aGlzLnBhdHRlcm5MZW4gLSAxKVxuICAgICAgdGhpcy5wYXR0ZXJuQWxwaGFiZXQgPSB0aGlzLl9jYWxjdWxhdGVQYXR0ZXJuQWxwaGFiZXQoKVxuICAgIH1cbiAgfVxuXG4gIEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgLy8gQXBwcm94aW1hdGVseSB3aGVyZSBpbiB0aGUgdGV4dCBpcyB0aGUgcGF0dGVybiBleHBlY3RlZCB0byBiZSBmb3VuZD9cbiAgICBsb2NhdGlvbjogMCxcblxuICAgIC8vIERldGVybWluZXMgaG93IGNsb3NlIHRoZSBtYXRjaCBtdXN0IGJlIHRvIHRoZSBmdXp6eSBsb2NhdGlvbiAoc3BlY2lmaWVkIGFib3ZlKS5cbiAgICAvLyBBbiBleGFjdCBsZXR0ZXIgbWF0Y2ggd2hpY2ggaXMgJ2Rpc3RhbmNlJyBjaGFyYWN0ZXJzIGF3YXkgZnJvbSB0aGUgZnV6enkgbG9jYXRpb25cbiAgICAvLyB3b3VsZCBzY29yZSBhcyBhIGNvbXBsZXRlIG1pc21hdGNoLiBBIGRpc3RhbmNlIG9mICcwJyByZXF1aXJlcyB0aGUgbWF0Y2ggYmUgYXRcbiAgICAvLyB0aGUgZXhhY3QgbG9jYXRpb24gc3BlY2lmaWVkLCBhIHRocmVzaG9sZCBvZiAnMTAwMCcgd291bGQgcmVxdWlyZSBhIHBlcmZlY3QgbWF0Y2hcbiAgICAvLyB0byBiZSB3aXRoaW4gODAwIGNoYXJhY3RlcnMgb2YgdGhlIGZ1enp5IGxvY2F0aW9uIHRvIGJlIGZvdW5kIHVzaW5nIGEgMC44IHRocmVzaG9sZC5cbiAgICBkaXN0YW5jZTogMTAwLFxuXG4gICAgLy8gQXQgd2hhdCBwb2ludCBkb2VzIHRoZSBtYXRjaCBhbGdvcml0aG0gZ2l2ZSB1cC4gQSB0aHJlc2hvbGQgb2YgJzAuMCcgcmVxdWlyZXMgYSBwZXJmZWN0IG1hdGNoXG4gICAgLy8gKG9mIGJvdGggbGV0dGVycyBhbmQgbG9jYXRpb24pLCBhIHRocmVzaG9sZCBvZiAnMS4wJyB3b3VsZCBtYXRjaCBhbnl0aGluZy5cbiAgICB0aHJlc2hvbGQ6IDAuNixcblxuICAgIC8vIE1hY2hpbmUgd29yZCBzaXplXG4gICAgbWF4UGF0dGVybkxlbmd0aDogMzJcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBhbHBoYWJldCBmb3IgdGhlIEJpdGFwIGFsZ29yaXRobS5cbiAgICogQHJldHVybiB7T2JqZWN0fSBIYXNoIG9mIGNoYXJhY3RlciBsb2NhdGlvbnMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fY2FsY3VsYXRlUGF0dGVybkFscGhhYmV0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXNrID0ge30sXG4gICAgICBpID0gMFxuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMucGF0dGVybkxlbjsgaSsrKSB7XG4gICAgICBtYXNrW3RoaXMucGF0dGVybi5jaGFyQXQoaSldID0gMFxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgbWFza1t0aGlzLnBhdHRlcm4uY2hhckF0KGkpXSB8PSAxIDw8ICh0aGlzLnBhdHRlcm4ubGVuZ3RoIC0gaSAtIDEpXG4gICAgfVxuXG4gICAgcmV0dXJuIG1hc2tcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlIGFuZCByZXR1cm4gdGhlIHNjb3JlIGZvciBhIG1hdGNoIHdpdGggYGVgIGVycm9ycyBhbmQgYHhgIGxvY2F0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gZXJyb3JzIE51bWJlciBvZiBlcnJvcnMgaW4gbWF0Y2guXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsb2NhdGlvbiBMb2NhdGlvbiBvZiBtYXRjaC5cbiAgICogQHJldHVybiB7bnVtYmVyfSBPdmVyYWxsIHNjb3JlIGZvciBtYXRjaCAoMC4wID0gZ29vZCwgMS4wID0gYmFkKS5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLl9iaXRhcFNjb3JlID0gZnVuY3Rpb24gKGVycm9ycywgbG9jYXRpb24pIHtcbiAgICB2YXIgYWNjdXJhY3kgPSBlcnJvcnMgLyB0aGlzLnBhdHRlcm5MZW4sXG4gICAgICBwcm94aW1pdHkgPSBNYXRoLmFicyh0aGlzLm9wdGlvbnMubG9jYXRpb24gLSBsb2NhdGlvbilcblxuICAgIGlmICghdGhpcy5vcHRpb25zLmRpc3RhbmNlKSB7XG4gICAgICAvLyBEb2RnZSBkaXZpZGUgYnkgemVybyBlcnJvci5cbiAgICAgIHJldHVybiBwcm94aW1pdHkgPyAxLjAgOiBhY2N1cmFjeVxuICAgIH1cbiAgICByZXR1cm4gYWNjdXJhY3kgKyAocHJveGltaXR5IC8gdGhpcy5vcHRpb25zLmRpc3RhbmNlKVxuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGUgYW5kIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBzZWFyY2hcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgVGhlIHRleHQgdG8gc2VhcmNoIGluXG4gICAqIEByZXR1cm4ge3tpc01hdGNoOiBib29sZWFuLCBzY29yZTogbnVtYmVyfX0gTGl0ZXJhbCBjb250YWluaW5nOlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNYXRjaCAtIFdoZXRoZXIgdGhlIHRleHQgaXMgYSBtYXRjaCBvciBub3RcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlIC0gT3ZlcmFsbCBzY29yZSBmb3IgdGhlIG1hdGNoXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgaVxuICAgIHZhciBqXG4gICAgdmFyIHRleHRMZW5cbiAgICB2YXIgZmluZEFsbE1hdGNoZXNcbiAgICB2YXIgbG9jYXRpb25cbiAgICB2YXIgdGhyZXNob2xkXG4gICAgdmFyIGJlc3RMb2NcbiAgICB2YXIgYmluTWluXG4gICAgdmFyIGJpbk1pZFxuICAgIHZhciBiaW5NYXhcbiAgICB2YXIgc3RhcnQsIGZpbmlzaFxuICAgIHZhciBiaXRBcnJcbiAgICB2YXIgbGFzdEJpdEFyclxuICAgIHZhciBjaGFyTWF0Y2hcbiAgICB2YXIgc2NvcmVcbiAgICB2YXIgbG9jYXRpb25zXG4gICAgdmFyIG1hdGNoZXNcbiAgICB2YXIgaXNNYXRjaGVkXG4gICAgdmFyIG1hdGNoTWFza1xuICAgIHZhciBtYXRjaGVkSW5kaWNlc1xuICAgIHZhciBtYXRjaGVzTGVuXG4gICAgdmFyIG1hdGNoXG5cbiAgICB0ZXh0ID0gb3B0aW9ucy5jYXNlU2Vuc2l0aXZlID8gdGV4dCA6IHRleHQudG9Mb3dlckNhc2UoKVxuXG4gICAgaWYgKHRoaXMucGF0dGVybiA9PT0gdGV4dCkge1xuICAgICAgLy8gRXhhY3QgbWF0Y2hcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzTWF0Y2g6IHRydWUsXG4gICAgICAgIHNjb3JlOiAwLFxuICAgICAgICBtYXRjaGVkSW5kaWNlczogW1swLCB0ZXh0Lmxlbmd0aCAtIDFdXVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdoZW4gcGF0dGVybiBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIHRoZSBtYWNoaW5lIHdvcmQgbGVuZ3RoLCBqdXN0IGRvIGEgYSByZWdleCBjb21wYXJpc29uXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA+IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgbWF0Y2hlcyA9IHRleHQubWF0Y2gobmV3IFJlZ0V4cCh0aGlzLnBhdHRlcm4ucmVwbGFjZShvcHRpb25zLnRva2VuU2VwYXJhdG9yLCAnfCcpKSlcbiAgICAgIGlzTWF0Y2hlZCA9ICEhbWF0Y2hlc1xuXG4gICAgICBpZiAoaXNNYXRjaGVkKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICAgICAgZm9yIChpID0gMCwgbWF0Y2hlc0xlbiA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgbWF0Y2hlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzW2ldXG4gICAgICAgICAgbWF0Y2hlZEluZGljZXMucHVzaChbdGV4dC5pbmRleE9mKG1hdGNoKSwgbWF0Y2gubGVuZ3RoIC0gMV0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNNYXRjaDogaXNNYXRjaGVkLFxuICAgICAgICAvLyBUT0RPOiByZXZpc2l0IHRoaXMgc2NvcmVcbiAgICAgICAgc2NvcmU6IGlzTWF0Y2hlZCA/IDAuNSA6IDEsXG4gICAgICAgIG1hdGNoZWRJbmRpY2VzOiBtYXRjaGVkSW5kaWNlc1xuICAgICAgfVxuICAgIH1cblxuICAgIGZpbmRBbGxNYXRjaGVzID0gb3B0aW9ucy5maW5kQWxsTWF0Y2hlc1xuXG4gICAgbG9jYXRpb24gPSBvcHRpb25zLmxvY2F0aW9uXG4gICAgLy8gU2V0IHN0YXJ0aW5nIGxvY2F0aW9uIGF0IGJlZ2lubmluZyB0ZXh0IGFuZCBpbml0aWFsaXplIHRoZSBhbHBoYWJldC5cbiAgICB0ZXh0TGVuID0gdGV4dC5sZW5ndGhcbiAgICAvLyBIaWdoZXN0IHNjb3JlIGJleW9uZCB3aGljaCB3ZSBnaXZlIHVwLlxuICAgIHRocmVzaG9sZCA9IG9wdGlvbnMudGhyZXNob2xkXG4gICAgLy8gSXMgdGhlcmUgYSBuZWFyYnkgZXhhY3QgbWF0Y2g/IChzcGVlZHVwKVxuICAgIGJlc3RMb2MgPSB0ZXh0LmluZGV4T2YodGhpcy5wYXR0ZXJuLCBsb2NhdGlvbilcblxuICAgIC8vIGEgbWFzayBvZiB0aGUgbWF0Y2hlc1xuICAgIG1hdGNoTWFzayA9IFtdXG4gICAgZm9yIChpID0gMDsgaSA8IHRleHRMZW47IGkrKykge1xuICAgICAgbWF0Y2hNYXNrW2ldID0gMFxuICAgIH1cblxuICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICB0aHJlc2hvbGQgPSBNYXRoLm1pbih0aGlzLl9iaXRhcFNjb3JlKDAsIGJlc3RMb2MpLCB0aHJlc2hvbGQpXG4gICAgICAvLyBXaGF0IGFib3V0IGluIHRoZSBvdGhlciBkaXJlY3Rpb24/IChzcGVlZCB1cClcbiAgICAgIGJlc3RMb2MgPSB0ZXh0Lmxhc3RJbmRleE9mKHRoaXMucGF0dGVybiwgbG9jYXRpb24gKyB0aGlzLnBhdHRlcm5MZW4pXG5cbiAgICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICAgIHRocmVzaG9sZCA9IE1hdGgubWluKHRoaXMuX2JpdGFwU2NvcmUoMCwgYmVzdExvYyksIHRocmVzaG9sZClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBiZXN0TG9jID0gLTFcbiAgICBzY29yZSA9IDFcbiAgICBsb2NhdGlvbnMgPSBbXVxuICAgIGJpbk1heCA9IHRoaXMucGF0dGVybkxlbiArIHRleHRMZW5cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgLy8gU2NhbiBmb3IgdGhlIGJlc3QgbWF0Y2g7IGVhY2ggaXRlcmF0aW9uIGFsbG93cyBmb3Igb25lIG1vcmUgZXJyb3IuXG4gICAgICAvLyBSdW4gYSBiaW5hcnkgc2VhcmNoIHRvIGRldGVybWluZSBob3cgZmFyIGZyb20gdGhlIG1hdGNoIGxvY2F0aW9uIHdlIGNhbiBzdHJheVxuICAgICAgLy8gYXQgdGhpcyBlcnJvciBsZXZlbC5cbiAgICAgIGJpbk1pbiA9IDBcbiAgICAgIGJpbk1pZCA9IGJpbk1heFxuICAgICAgd2hpbGUgKGJpbk1pbiA8IGJpbk1pZCkge1xuICAgICAgICBpZiAodGhpcy5fYml0YXBTY29yZShpLCBsb2NhdGlvbiArIGJpbk1pZCkgPD0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgYmluTWluID0gYmluTWlkXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICAgIH1cbiAgICAgICAgYmluTWlkID0gTWF0aC5mbG9vcigoYmluTWF4IC0gYmluTWluKSAvIDIgKyBiaW5NaW4pXG4gICAgICB9XG5cbiAgICAgIC8vIFVzZSB0aGUgcmVzdWx0IGZyb20gdGhpcyBpdGVyYXRpb24gYXMgdGhlIG1heGltdW0gZm9yIHRoZSBuZXh0LlxuICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICBzdGFydCA9IE1hdGgubWF4KDEsIGxvY2F0aW9uIC0gYmluTWlkICsgMSlcbiAgICAgIGlmIChmaW5kQWxsTWF0Y2hlcykge1xuICAgICAgICBmaW5pc2ggPSB0ZXh0TGVuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmluaXNoID0gTWF0aC5taW4obG9jYXRpb24gKyBiaW5NaWQsIHRleHRMZW4pICsgdGhpcy5wYXR0ZXJuTGVuXG4gICAgICB9XG5cbiAgICAgIC8vIEluaXRpYWxpemUgdGhlIGJpdCBhcnJheVxuICAgICAgYml0QXJyID0gQXJyYXkoZmluaXNoICsgMilcblxuICAgICAgYml0QXJyW2ZpbmlzaCArIDFdID0gKDEgPDwgaSkgLSAxXG5cbiAgICAgIGZvciAoaiA9IGZpbmlzaDsgaiA+PSBzdGFydDsgai0tKSB7XG4gICAgICAgIGNoYXJNYXRjaCA9IHRoaXMucGF0dGVybkFscGhhYmV0W3RleHQuY2hhckF0KGogLSAxKV1cblxuICAgICAgICBpZiAoY2hhck1hdGNoKSB7XG4gICAgICAgICAgbWF0Y2hNYXNrW2ogLSAxXSA9IDFcbiAgICAgICAgfVxuXG4gICAgICAgIGJpdEFycltqXSA9ICgoYml0QXJyW2ogKyAxXSA8PCAxKSB8IDEpICYgY2hhck1hdGNoXG5cbiAgICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgICAvLyBTdWJzZXF1ZW50IHBhc3NlczogZnV6enkgbWF0Y2guXG4gICAgICAgICAgYml0QXJyW2pdIHw9ICgoKGxhc3RCaXRBcnJbaiArIDFdIHwgbGFzdEJpdEFycltqXSkgPDwgMSkgfCAxKSB8IGxhc3RCaXRBcnJbaiArIDFdXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpdEFycltqXSAmIHRoaXMubWF0Y2htYXNrKSB7XG4gICAgICAgICAgc2NvcmUgPSB0aGlzLl9iaXRhcFNjb3JlKGksIGogLSAxKVxuXG4gICAgICAgICAgLy8gVGhpcyBtYXRjaCB3aWxsIGFsbW9zdCBjZXJ0YWlubHkgYmUgYmV0dGVyIHRoYW4gYW55IGV4aXN0aW5nIG1hdGNoLlxuICAgICAgICAgIC8vIEJ1dCBjaGVjayBhbnl3YXkuXG4gICAgICAgICAgaWYgKHNjb3JlIDw9IHRocmVzaG9sZCkge1xuICAgICAgICAgICAgLy8gSW5kZWVkIGl0IGlzXG4gICAgICAgICAgICB0aHJlc2hvbGQgPSBzY29yZVxuICAgICAgICAgICAgYmVzdExvYyA9IGogLSAxXG4gICAgICAgICAgICBsb2NhdGlvbnMucHVzaChiZXN0TG9jKVxuXG4gICAgICAgICAgICAvLyBBbHJlYWR5IHBhc3NlZCBsb2MsIGRvd25oaWxsIGZyb20gaGVyZSBvbiBpbi5cbiAgICAgICAgICAgIGlmIChiZXN0TG9jIDw9IGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdoZW4gcGFzc2luZyBsb2MsIGRvbid0IGV4Y2VlZCBvdXIgY3VycmVudCBkaXN0YW5jZSBmcm9tIGxvYy5cbiAgICAgICAgICAgIHN0YXJ0ID0gTWF0aC5tYXgoMSwgMiAqIGxvY2F0aW9uIC0gYmVzdExvYylcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTm8gaG9wZSBmb3IgYSAoYmV0dGVyKSBtYXRjaCBhdCBncmVhdGVyIGVycm9yIGxldmVscy5cbiAgICAgIGlmICh0aGlzLl9iaXRhcFNjb3JlKGkgKyAxLCBsb2NhdGlvbikgPiB0aHJlc2hvbGQpIHtcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGxhc3RCaXRBcnIgPSBiaXRBcnJcbiAgICB9XG5cbiAgICBtYXRjaGVkSW5kaWNlcyA9IHRoaXMuX2dldE1hdGNoZWRJbmRpY2VzKG1hdGNoTWFzaylcblxuICAgIC8vIENvdW50IGV4YWN0IG1hdGNoZXMgKHRob3NlIHdpdGggYSBzY29yZSBvZiAwKSB0byBiZSBcImFsbW9zdFwiIGV4YWN0XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2g6IGJlc3RMb2MgPj0gMCxcbiAgICAgIHNjb3JlOiBzY29yZSA9PT0gMCA/IDAuMDAxIDogc2NvcmUsXG4gICAgICBtYXRjaGVkSW5kaWNlczogbWF0Y2hlZEluZGljZXNcbiAgICB9XG4gIH1cblxuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fZ2V0TWF0Y2hlZEluZGljZXMgPSBmdW5jdGlvbiAobWF0Y2hNYXNrKSB7XG4gICAgdmFyIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICB2YXIgc3RhcnQgPSAtMVxuICAgIHZhciBlbmQgPSAtMVxuICAgIHZhciBpID0gMFxuICAgIHZhciBtYXRjaFxuICAgIHZhciBsZW4gPSBtYXRjaE1hc2subGVuZ3RoXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgbWF0Y2ggPSBtYXRjaE1hc2tbaV1cbiAgICAgIGlmIChtYXRjaCAmJiBzdGFydCA9PT0gLTEpIHtcbiAgICAgICAgc3RhcnQgPSBpXG4gICAgICB9IGVsc2UgaWYgKCFtYXRjaCAmJiBzdGFydCAhPT0gLTEpIHtcbiAgICAgICAgZW5kID0gaSAtIDFcbiAgICAgICAgaWYgKChlbmQgLSBzdGFydCkgKyAxID49IHRoaXMub3B0aW9ucy5taW5NYXRjaENoYXJMZW5ndGgpIHtcbiAgICAgICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBlbmRdKVxuICAgICAgICB9XG4gICAgICAgIHN0YXJ0ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1hdGNoTWFza1tpIC0gMV0pIHtcbiAgICAgIGlmICgoaS0xIC0gc3RhcnQpICsgMSA+PSB0aGlzLm9wdGlvbnMubWluTWF0Y2hDaGFyTGVuZ3RoKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBpIC0gMV0pXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXRjaGVkSW5kaWNlc1xuICB9XG5cbiAgLy8gRXhwb3J0IHRvIENvbW1vbiBKUyBMb2FkZXJcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgIC8vIGxpa2UgTm9kZS5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IEZ1c2VcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBGdXNlXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgIGdsb2JhbC5GdXNlID0gRnVzZVxuICB9XG5cbn0pKHRoaXMpO1xuIiwiLyohXG4gKiBEZXRlcm1pbmUgaWYgYW4gb2JqZWN0IGlzIGEgQnVmZmVyXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGZlcm9zc0BmZXJvc3Mub3JnPiA8aHR0cDovL2Zlcm9zcy5vcmc+XG4gKiBAbGljZW5zZSAgTUlUXG4gKi9cblxuLy8gVGhlIF9pc0J1ZmZlciBjaGVjayBpcyBmb3IgU2FmYXJpIDUtNyBzdXBwb3J0LCBiZWNhdXNlIGl0J3MgbWlzc2luZ1xuLy8gT2JqZWN0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvci4gUmVtb3ZlIHRoaXMgZXZlbnR1YWxseVxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAob2JqKSB7XG4gIHJldHVybiBvYmogIT0gbnVsbCAmJiAoaXNCdWZmZXIob2JqKSB8fCBpc1Nsb3dCdWZmZXIob2JqKSB8fCAhIW9iai5faXNCdWZmZXIpXG59XG5cbmZ1bmN0aW9uIGlzQnVmZmVyIChvYmopIHtcbiAgcmV0dXJuICEhb2JqLmNvbnN0cnVjdG9yICYmIHR5cGVvZiBvYmouY29uc3RydWN0b3IuaXNCdWZmZXIgPT09ICdmdW5jdGlvbicgJiYgb2JqLmNvbnN0cnVjdG9yLmlzQnVmZmVyKG9iailcbn1cblxuLy8gRm9yIE5vZGUgdjAuMTAgc3VwcG9ydC4gUmVtb3ZlIHRoaXMgZXZlbnR1YWxseS5cbmZ1bmN0aW9uIGlzU2xvd0J1ZmZlciAob2JqKSB7XG4gIHJldHVybiB0eXBlb2Ygb2JqLnJlYWRGbG9hdExFID09PSAnZnVuY3Rpb24nICYmIHR5cGVvZiBvYmouc2xpY2UgPT09ICdmdW5jdGlvbicgJiYgaXNCdWZmZXIob2JqLnNsaWNlKDAsIDApKVxufVxuIiwiLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcbiJdfQ==
