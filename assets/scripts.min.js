!function e(t,n,r){function o(i,a){if(!n[i]){if(!t[i]){var u="function"==typeof require&&require;if(!a&&u)return u(i,!0);if(s)return s(i,!0);var c=new Error("Cannot find module '"+i+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[i]={exports:{}};t[i][0].call(l.exports,function(e){var n=t[i][1][e];return o(n?n:e)},l,l.exports,e,t,n,r)}return n[i].exports}for(var s="function"==typeof require&&require,i=0;i<r.length;i++)o(r[i]);return o}({1:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(e){var t=(0,m.groupBy)(e,"artist");return t}function s(e,t){var n=e.filter(function(e){return e.artist.toString().charAt(0)===t});return n}function i(e,t){v=new h["default"](e,g);var n=v.search(t);return n}function a(e){return d["default"].publish("searchStart",{searchTerm:e}),l["default"].get("search_data.json").then(function(t){return i(t.data,e)}).then(y).then(o)["catch"](function(e){console.error(e)})}function u(e){return d["default"].publish("searchStart",{letter:e}),l["default"].get("search_data.json").then(function(t){return s(t.data,e)}).then(y).then(o)["catch"](function(e){console.error(e)})}Object.defineProperty(n,"__esModule",{value:!0}),n.searchByName=a,n.findArtistsByLetter=u;var c=e("axios"),l=r(c),f=e("fuse.js"),h=r(f),p=e("./pubsub"),d=r(p),m=e("./helpers/underscore"),v=void 0,g={shouldSort:!0,threshold:.1,location:0,distance:100,maxPatternLength:32,minMatchCharLength:1,keys:["artist","title"]},y=function(e){var t=e.sort(function(e,t){var n=e.artist.toLowerCase(),r=t.artist.toLowerCase();return n>r?1:n<r?-1:0});return t}},{"./helpers/underscore":5,"./pubsub":7,axios:10,"fuse.js":35}],2:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function s(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}function i(e){y.classList.remove("u-hidden"),b.value=e.artist,w.value=e.title}function a(e){var t,n,r;t=e.target,r=t.parentNode.parentNode,n=r.previousSibling,console.log(t.innerHTML),console.log(n.innerHTML);var o=new L(t.innerHTML,n.innerHTML);console.log(o),i(o)}function u(e){var t=e||window.event;if(t.preventDefault(),""!==b.value&&""!==w.value){var n=Object.assign({name:_.value,phone:S.value,artist:b.value,song:w.value});return console.log(n),!1}y.previousSibling.innerHTML="Please fill out all of the fields"}function c(e){var t=e||window.event;t.preventDefault();var n=this.dataset.letter;m.findArtistsByLetter(n).then(function(e){p["default"].publish("searchComplete",{songList:e,searchTerm:n})})}function l(){var e="qwertyuiopasdfghjklzxcvbnm",t=e.toUpperCase(),n=[].concat(s(t)),r=n.sort(),o=r.map(function(e){return'<li class="o-list-inline__item c-az__item"><a class="c-az__letter" data-letter="'+e+'">'+e+"</a></li>"}).join("");return'<ul class="o-list-inline c-az">'+o+"</ul>"}var f=e("./helpers/events"),h=e("./pubsub"),p=o(h),d=e("./api"),m=r(d),v=document.querySelector(".az-search"),g=document.getElementById("js-search_results"),y=document.getElementById("sign-up"),b=document.getElementById("js-artist__input"),w=document.getElementById("js-song__input"),_=document.getElementById("js-name__input"),S=document.getElementById("js-phone__input"),x=document.querySelector("#js-songpick"),L=function(e,t){this.title=e,this.artist=t};v.innerHTML=l(),(0,f.delegateEventListener)(v,"click","a",c),(0,f.delegateEventListener)(g,"click","a",a),x.addEventListener("submit",u)},{"./api":1,"./helpers/events":4,"./pubsub":7}],3:[function(e,t,n){"use strict";function r(e,t){return e.classList?e.classList.contains(t):new RegExp("(^| )"+t+"( |$)","gi").test(e.className)}Object.defineProperty(n,"__esModule",{value:!0}),n.hasClass=r;var o=n.addClass=function(e,t){var n=e;n.classList?n.classList.add(t):n.className+=" "+t},s=n.removeClass=function(e,t){var n=e;n.classList?n.classList.remove(t):n.className=n.className.replace(new RegExp("(^|\\b)"+t.split(" ").join("|")+"(\\b|$)","gi")," ")};n.toggleClass=function(e,t){var n=e;r(n,t)?s(n,t):o(n,t)},n.setStyle=function(e,t){var n=t;Object.assign(e.style,n)},n.findParentByTagName=function(e,t){for(var n=e;null!==n&&n.tagName!==t.toUpperCase();)n=n.parentNode;return n}},{}],4:[function(e,t,n){"use strict";function r(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0;window.CustomEvent?r=new CustomEvent(t,{detail:n}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,n)),e.dispatchEvent(r)}function o(e,t,n,r){var o=e;o.addEventListener(t,function(t){for(var s=o.querySelectorAll(n),i=t.target,a=0,u=s.length;a<u;a++)for(var c=i,l=s[a];c&&c!==e;){if(c===l)return r.call(l,t);c=c.parentNode}return!1})}Object.defineProperty(n,"__esModule",{value:!0}),n.trigger=r,n.delegateEventListener=o},{}],5:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=Object.prototype.toString,o=function(e){return"[object Function]"===r.call(e)};n.groupBy=function(e,t){return e.reduce(function(e,n){var r=o(t)?t.apply(void 0,[n]):n[t];return e[r]=e[r]||[],e[r].push(n),e},{})}},{}],6:[function(e,t,n){"use strict";e("./az-search"),e("./search"),e("./results")},{"./az-search":2,"./results":8,"./search":9}],7:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=function(){var e={},t=function(t,n){e[t]=e[t]||[],e[t].push(n)},n=function(t,n){if(e[t])for(var r=0,o=e[t].length;r<o;r++)if(e[t][r]===n){e[t].splice(r,1);break}},r=function(t,n){e[t]&&e[t].forEach(function(e){e(n)})};return{subscribe:t,unsubscribe:n,publish:r}}();n["default"]=r},{}],8:[function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function o(){c.innerHTML="",(0,i.removeClass)(l,"u-hidden")}function s(e){var t=e.songList,n=e.searchTerm,r="";r='<h2 class="c-search__heading">Search Results: <span c-search__term>'+n+'</span></h2><section class="c-search__list">',Object.keys(t).forEach(function(e){r+='<p class="c-search__artist">'+e+"</p><ul>",t[e].forEach(function(e){r+='<li class="c-search__title"><a href="#sign-up">'+e.title+"</a></li>"}),r+="</ul>"}),r+="</section>",(0,i.addClass)(l,"u-hidden"),c.innerHTML=r}var i=e("./helpers/dom-elements"),a=e("./pubsub"),u=r(a),c=document.querySelector("#js-search_results"),l=document.querySelector(".loader");u["default"].subscribe("searchStart",o),u["default"].subscribe("searchComplete",s)},{"./helpers/dom-elements":3,"./pubsub":7}],9:[function(e,t,n){"use strict";function r(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t["default"]=e,t}function o(e){return e&&e.__esModule?e:{"default":e}}function s(){p.value=""}function i(e){var t=e||window.event;t.preventDefault();var n=p.value;""!==n&&f.searchByName(n).then(function(e){c["default"].publish("searchComplete",{songList:e,searchTerm:n})})}function a(e){var t=e;t.letter&&s()}var u=e("./pubsub"),c=o(u),l=e("./api"),f=r(l),h=document.querySelector("#js-songsearch"),p=h.querySelector("#js-songsearch__input");h.addEventListener("submit",i),c["default"].subscribe("searchStart",a)},{"./api":1,"./pubsub":7}],10:[function(e,t,n){t.exports=e("./lib/axios")},{"./lib/axios":12}],11:[function(e,t,n){(function(n){"use strict";var r=e("./../utils"),o=e("./../core/settle"),s=e("./../helpers/buildURL"),i=e("./../helpers/parseHeaders"),a=e("./../helpers/isURLSameOrigin"),u=e("../core/createError"),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||e("./../helpers/btoa");t.exports=function(t){return new Promise(function(l,f){var h=t.data,p=t.headers;r.isFormData(h)&&delete p["Content-Type"];var d=new XMLHttpRequest,m="onreadystatechange",v=!1;if("test"===n.env.NODE_ENV||"undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||a(t.url)||(d=new window.XDomainRequest,m="onload",v=!0,d.onprogress=function(){},d.ontimeout=function(){}),t.auth){var g=t.auth.username||"",y=t.auth.password||"";p.Authorization="Basic "+c(g+":"+y)}if(d.open(t.method.toUpperCase(),s(t.url,t.params,t.paramsSerializer),!0),d.timeout=t.timeout,d[m]=function(){if(d&&(4===d.readyState||v)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var e="getAllResponseHeaders"in d?i(d.getAllResponseHeaders()):null,n=t.responseType&&"text"!==t.responseType?d.response:d.responseText,r={data:n,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:e,config:t,request:d};o(l,f,r),d=null}},d.onerror=function(){f(u("Network Error",t,null,d)),d=null},d.ontimeout=function(){f(u("timeout of "+t.timeout+"ms exceeded",t,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var b=e("./../helpers/cookies"),w=(t.withCredentials||a(t.url))&&t.xsrfCookieName?b.read(t.xsrfCookieName):void 0;w&&(p[t.xsrfHeaderName]=w)}if("setRequestHeader"in d&&r.forEach(p,function(e,t){"undefined"==typeof h&&"content-type"===t.toLowerCase()?delete p[t]:d.setRequestHeader(t,e)}),t.withCredentials&&(d.withCredentials=!0),t.responseType)try{d.responseType=t.responseType}catch(_){if("json"!==t.responseType)throw _}"function"==typeof t.onDownloadProgress&&d.addEventListener("progress",t.onDownloadProgress),"function"==typeof t.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",t.onUploadProgress),t.cancelToken&&t.cancelToken.promise.then(function(e){d&&(d.abort(),f(e),d=null)}),void 0===h&&(h=null),d.send(h)})}}).call(this,e("_process"))},{"../core/createError":18,"./../core/settle":21,"./../helpers/btoa":25,"./../helpers/buildURL":26,"./../helpers/cookies":28,"./../helpers/isURLSameOrigin":30,"./../helpers/parseHeaders":32,"./../utils":34,_process:37}],12:[function(e,t,n){"use strict";function r(e){var t=new i(e),n=s(i.prototype.request,t);return o.extend(n,i.prototype,t),o.extend(n,t),n}var o=e("./utils"),s=e("./helpers/bind"),i=e("./core/Axios"),a=e("./defaults"),u=r(a);u.Axios=i,u.create=function(e){return r(o.merge(a,e))},u.Cancel=e("./cancel/Cancel"),u.CancelToken=e("./cancel/CancelToken"),u.isCancel=e("./cancel/isCancel"),u.all=function(e){return Promise.all(e)},u.spread=e("./helpers/spread"),t.exports=u,t.exports["default"]=u},{"./cancel/Cancel":13,"./cancel/CancelToken":14,"./cancel/isCancel":15,"./core/Axios":16,"./defaults":23,"./helpers/bind":24,"./helpers/spread":33,"./utils":34}],13:[function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,t.exports=r},{}],14:[function(e,t,n){"use strict";function r(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new o(e),t(n.reason))})}var o=e("./Cancel");r.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},r.source=function(){var e,t=new r(function(t){e=t});return{token:t,cancel:e}},t.exports=r},{"./Cancel":13}],15:[function(e,t,n){"use strict";t.exports=function(e){return!(!e||!e.__CANCEL__)}},{}],16:[function(e,t,n){"use strict";function r(e){this.defaults=e,this.interceptors={request:new i,response:new i}}var o=e("./../defaults"),s=e("./../utils"),i=e("./InterceptorManager"),a=e("./dispatchRequest"),u=e("./../helpers/isAbsoluteURL"),c=e("./../helpers/combineURLs");r.prototype.request=function(e){"string"==typeof e&&(e=s.merge({url:arguments[0]},arguments[1])),e=s.merge(o,this.defaults,{method:"get"},e),e.method=e.method.toLowerCase(),e.baseURL&&!u(e.url)&&(e.url=c(e.baseURL,e.url));var t=[a,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},s.forEach(["delete","get","head","options"],function(e){r.prototype[e]=function(t,n){return this.request(s.merge(n||{},{method:e,url:t}))}}),s.forEach(["post","put","patch"],function(e){r.prototype[e]=function(t,n,r){return this.request(s.merge(r||{},{method:e,url:t,data:n}))}}),t.exports=r},{"./../defaults":23,"./../helpers/combineURLs":27,"./../helpers/isAbsoluteURL":29,"./../utils":34,"./InterceptorManager":17,"./dispatchRequest":19}],17:[function(e,t,n){"use strict";function r(){this.handlers=[]}var o=e("./../utils");r.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},r.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},r.prototype.forEach=function(e){o.forEach(this.handlers,function(t){null!==t&&e(t)})},t.exports=r},{"./../utils":34}],18:[function(e,t,n){"use strict";var r=e("./enhanceError");t.exports=function(e,t,n,o,s){var i=new Error(e);return r(i,t,n,o,s)}},{"./enhanceError":20}],19:[function(e,t,n){"use strict";function r(e){e.cancelToken&&e.cancelToken.throwIfRequested()}var o=e("./../utils"),s=e("./transformData"),i=e("../cancel/isCancel"),a=e("../defaults");t.exports=function(e){r(e),e.headers=e.headers||{},e.data=s(e.data,e.headers,e.transformRequest),e.headers=o.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),o.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]});var t=e.adapter||a.adapter;return t(e).then(function(t){return r(e),t.data=s(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(r(e),t&&t.response&&(t.response.data=s(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},{"../cancel/isCancel":15,"../defaults":23,"./../utils":34,"./transformData":22}],20:[function(e,t,n){"use strict";t.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},{}],21:[function(e,t,n){"use strict";var r=e("./createError");t.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},{"./createError":18}],22:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},{"./../utils":34}],23:[function(e,t,n){(function(n){"use strict";function r(e,t){!s.isUndefined(e)&&s.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}function o(){var t;return"undefined"!=typeof XMLHttpRequest?t=e("./adapters/xhr"):"undefined"!=typeof n&&(t=e("./adapters/http")),t}var s=e("./utils"),i=e("./helpers/normalizeHeaderName"),a={"Content-Type":"application/x-www-form-urlencoded"},u={adapter:o(),transformRequest:[function(e,t){return i(t,"Content-Type"),s.isFormData(e)||s.isArrayBuffer(e)||s.isBuffer(e)||s.isStream(e)||s.isFile(e)||s.isBlob(e)?e:s.isArrayBufferView(e)?e.buffer:s.isURLSearchParams(e)?(r(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):s.isObject(e)?(r(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(t){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300}};u.headers={common:{Accept:"application/json, text/plain, */*"}},s.forEach(["delete","get","head"],function(e){u.headers[e]={}}),s.forEach(["post","put","patch"],function(e){u.headers[e]=s.merge(a)}),t.exports=u}).call(this,e("_process"))},{"./adapters/http":11,"./adapters/xhr":11,"./helpers/normalizeHeaderName":31,"./utils":34,_process:37}],24:[function(e,t,n){"use strict";t.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},{}],25:[function(e,t,n){"use strict";function r(){this.message="String contains an invalid character"}function o(e){for(var t,n,o=String(e),i="",a=0,u=s;o.charAt(0|a)||(u="=",a%1);i+=u.charAt(63&t>>8-a%1*8)){if(n=o.charCodeAt(a+=.75),n>255)throw new r;t=t<<8|n}return i}var s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.code=5,r.prototype.name="InvalidCharacterError",t.exports=o},{}],26:[function(e,t,n){"use strict";function r(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}var o=e("./../utils");t.exports=function(e,t,n){if(!t)return e;var s;if(n)s=n(t);else if(o.isURLSearchParams(t))s=t.toString();else{var i=[];o.forEach(t,function(e,t){null!==e&&"undefined"!=typeof e&&(o.isArray(e)&&(t+="[]"),o.isArray(e)||(e=[e]),o.forEach(e,function(e){o.isDate(e)?e=e.toISOString():o.isObject(e)&&(e=JSON.stringify(e)),i.push(r(t)+"="+r(e))}))}),s=i.join("&")}return s&&(e+=(e.indexOf("?")===-1?"?":"&")+s),e}},{"./../utils":34}],27:[function(e,t,n){"use strict";t.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},{}],28:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?function(){return{write:function(e,t,n,o,s,i){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(s)&&a.push("domain="+s),i===!0&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}}():function(){return{write:function(){},read:function(){return null},remove:function(){}}}()},{"./../utils":34}],29:[function(e,t,n){"use strict";t.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},{}],30:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=r.isStandardBrowserEnv()?function(){function e(e){var t=e;return n&&(o.setAttribute("href",t),t=o.href),o.setAttribute("href",t),{href:o.href,protocol:o.protocol?o.protocol.replace(/:$/,""):"",host:o.host,search:o.search?o.search.replace(/^\?/,""):"",hash:o.hash?o.hash.replace(/^#/,""):"",hostname:o.hostname,port:o.port,pathname:"/"===o.pathname.charAt(0)?o.pathname:"/"+o.pathname}}var t,n=/(msie|trident)/i.test(navigator.userAgent),o=document.createElement("a");return t=e(window.location.href),function(n){var o=r.isString(n)?e(n):n;return o.protocol===t.protocol&&o.host===t.host}}():function(){return function(){return!0}}()},{"./../utils":34}],31:[function(e,t,n){"use strict";var r=e("../utils");t.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},{"../utils":34}],32:[function(e,t,n){"use strict";var r=e("./../utils");t.exports=function(e){var t,n,o,s={};return e?(r.forEach(e.split("\n"),function(e){o=e.indexOf(":"),t=r.trim(e.substr(0,o)).toLowerCase(),n=r.trim(e.substr(o+1)),t&&(s[t]=s[t]?s[t]+", "+n:n)}),s):s}},{"./../utils":34}],33:[function(e,t,n){"use strict";t.exports=function(e){return function(t){return e.apply(null,t)}}},{}],34:[function(e,t,n){"use strict";function r(e){return"[object Array]"===L.call(e)}function o(e){return"[object ArrayBuffer]"===L.call(e)}function s(e){return"undefined"!=typeof FormData&&e instanceof FormData}function i(e){var t;return t="undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer}function a(e){return"string"==typeof e}function u(e){return"number"==typeof e}function c(e){return"undefined"==typeof e}function l(e){return null!==e&&"object"==typeof e}function f(e){return"[object Date]"===L.call(e)}function h(e){return"[object File]"===L.call(e)}function p(e){return"[object Blob]"===L.call(e)}function d(e){return"[object Function]"===L.call(e)}function m(e){return l(e)&&d(e.pipe)}function v(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams}function g(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}function y(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)}function b(e,t){if(null!==e&&"undefined"!=typeof e)if("object"==typeof e||r(e)||(e=[e]),r(e))for(var n=0,o=e.length;n<o;n++)t.call(null,e[n],n,e);else for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.call(null,e[s],s,e)}function w(){function e(e,n){"object"==typeof t[n]&&"object"==typeof e?t[n]=w(t[n],e):t[n]=e}for(var t={},n=0,r=arguments.length;n<r;n++)b(arguments[n],e);return t}function _(e,t,n){return b(t,function(t,r){n&&"function"==typeof t?e[r]=S(t,n):e[r]=t}),e}var S=e("./helpers/bind"),x=e("is-buffer"),L=Object.prototype.toString;t.exports={isArray:r,isArrayBuffer:o,isBuffer:x,isFormData:s,isArrayBufferView:i,isString:a,isNumber:u,isObject:l,isUndefined:c,isDate:f,isFile:h,isBlob:p,isFunction:d,isStream:m,isURLSearchParams:v,isStandardBrowserEnv:y,forEach:b,merge:w,extend:_,trim:g}},{"./helpers/bind":24,"is-buffer":36}],35:[function(e,t,n){!function(e){"use strict";function r(){console.log.apply(console,arguments)}function o(e,t){var n;this.list=e,this.options=t=t||{};for(n in u)u.hasOwnProperty(n)&&("boolean"==typeof u[n]?this.options[n]=n in t?t[n]:u[n]:this.options[n]=t[n]||u[n])}function s(e,t,n){var r,o,a,u,c,l;if(t){if(a=t.indexOf("."),a!==-1?(r=t.slice(0,a),o=t.slice(a+1)):r=t,u=e[r],null!==u&&void 0!==u)if(o||"string"!=typeof u&&"number"!=typeof u)if(i(u))for(c=0,l=u.length;c<l;c++)s(u[c],o,n);else o&&s(u,o,n);else n.push(u)}else n.push(e);return n}function i(e){return"[object Array]"===Object.prototype.toString.call(e)}function a(e,t){t=t||{},this.options=t,this.options.location=t.location||a.defaultOptions.location,this.options.distance="distance"in t?t.distance:a.defaultOptions.distance,this.options.threshold="threshold"in t?t.threshold:a.defaultOptions.threshold,this.options.maxPatternLength=t.maxPatternLength||a.defaultOptions.maxPatternLength,this.pattern=t.caseSensitive?e:e.toLowerCase(),this.patternLen=e.length,this.patternLen<=this.options.maxPatternLength&&(this.matchmask=1<<this.patternLen-1,this.patternAlphabet=this._calculatePatternAlphabet())}var u={id:null,caseSensitive:!1,include:[],shouldSort:!0,searchFn:a,sortFn:function(e,t){return e.score-t.score},getFn:s,keys:[],verbose:!1,tokenize:!1,matchAllTokens:!1,tokenSeparator:/ +/g,minMatchCharLength:1,findAllMatches:!1};o.VERSION="2.7.3",o.prototype.set=function(e){return this.list=e,e},o.prototype.search=function(e){this.options.verbose&&r("\nSearch term:",e,"\n"),this.pattern=e,this.results=[],this.resultMap={},this._keyMap=null,this._prepareSearchers(),this._startSearch(),this._computeScore(),this._sort();var t=this._format();return t},o.prototype._prepareSearchers=function(){var e=this.options,t=this.pattern,n=e.searchFn,r=t.split(e.tokenSeparator),o=0,s=r.length;if(this.options.tokenize)for(this.tokenSearchers=[];o<s;o++)this.tokenSearchers.push(new n(r[o],e));this.fullSeacher=new n(t,e)},o.prototype._startSearch=function(){var e,t,n,r,o=this.options,s=o.getFn,i=this.list,a=i.length,u=this.options.keys,c=u.length,l=null;if("string"==typeof i[0])for(n=0;n<a;n++)this._analyze("",i[n],n,n);else for(this._keyMap={},n=0;n<a;n++)for(l=i[n],r=0;r<c;r++){if(e=u[r],"string"!=typeof e){if(t=1-e.weight||1,this._keyMap[e.name]={weight:t},e.weight<=0||e.weight>1)throw new Error("Key weight has to be > 0 and <= 1");e=e.name}else this._keyMap[e]={weight:1};this._analyze(e,s(l,e,[]),l,n)}},o.prototype._analyze=function(e,t,n,o){var s,a,u,c,l,f,h,p,d,m,v,g,y,b,w,_=this.options,S=!1;if(void 0!==t&&null!==t){a=[];var x=0;if("string"==typeof t){if(s=t.split(_.tokenSeparator),_.verbose&&r("---------\nKey:",e),this.options.tokenize){for(b=0;b<this.tokenSearchers.length;b++){for(p=this.tokenSearchers[b],_.verbose&&r("Pattern:",p.pattern),d=[],g=!1,w=0;w<s.length;w++){m=s[w],v=p.search(m);var L={};v.isMatch?(L[m]=v.score,S=!0,g=!0,a.push(v.score)):(L[m]=1,this.options.matchAllTokens||a.push(1)),d.push(L)}g&&x++,_.verbose&&r("Token scores:",d)}for(c=a[0],f=a.length,b=1;b<f;b++)c+=a[b];c/=f,_.verbose&&r("Token score average:",c)}h=this.fullSeacher.search(t),_.verbose&&r("Full text score:",h.score),l=h.score,void 0!==c&&(l=(l+c)/2),_.verbose&&r("Score average:",l),y=!this.options.tokenize||!this.options.matchAllTokens||x>=this.tokenSearchers.length,_.verbose&&r("Check Matches",y),(S||h.isMatch)&&y&&(u=this.resultMap[o],u?u.output.push({key:e,score:l,matchedIndices:h.matchedIndices}):(this.resultMap[o]={item:n,output:[{key:e,score:l,matchedIndices:h.matchedIndices}]},this.results.push(this.resultMap[o])))}else if(i(t))for(b=0;b<t.length;b++)this._analyze(e,t[b],n,o)}},o.prototype._computeScore=function(){var e,t,n,o,s,i,a,u,c,l=this._keyMap,f=this.results;for(this.options.verbose&&r("\n\nComputing score:\n"),e=0;e<f.length;e++){for(n=0,o=f[e].output,s=o.length,u=1,t=0;t<s;t++)i=o[t].score,a=l?l[o[t].key].weight:1,c=i*a,1!==a?u=Math.min(u,c):(n+=c,o[t].nScore=c);1===u?f[e].score=n/s:f[e].score=u,this.options.verbose&&r(f[e])}},o.prototype._sort=function(){var e=this.options;e.shouldSort&&(e.verbose&&r("\n\nSorting...."),this.results.sort(e.sortFn))},o.prototype._format=function(){var e,t,n,o,s=this.options,i=s.getFn,a=[],u=this.results,c=s.include;for(s.verbose&&r("\n\nOutput:\n\n",u),n=s.id?function(e){u[e].item=i(u[e].item,s.id,[])[0]}:function(){},o=function(e){var t,n,r,o,s,i=u[e];if(c.length>0){if(t={item:i.item},c.indexOf("matches")!==-1)for(r=i.output,t.matches=[],n=0;n<r.length;n++)o=r[n],s={indices:o.matchedIndices},o.key&&(s.key=o.key),t.matches.push(s);c.indexOf("score")!==-1&&(t.score=u[e].score)}else t=i.item;return t},e=0,t=u.length;e<t;e++)n(e),a.push(o(e));return a},a.defaultOptions={location:0,distance:100,threshold:.6,maxPatternLength:32},a.prototype._calculatePatternAlphabet=function(){var e={},t=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]=0;for(t=0;t<this.patternLen;t++)e[this.pattern.charAt(t)]|=1<<this.pattern.length-t-1;return e},a.prototype._bitapScore=function(e,t){var n=e/this.patternLen,r=Math.abs(this.options.location-t);return this.options.distance?n+r/this.options.distance:r?1:n},a.prototype.search=function(e){var t,n,r,o,s,i,a,u,c,l,f,h,p,d,m,v,g,y,b,w,_,S,x,L=this.options;if(e=L.caseSensitive?e:e.toLowerCase(),this.pattern===e)return{isMatch:!0,score:0,matchedIndices:[[0,e.length-1]]};if(this.patternLen>L.maxPatternLength){if(y=e.match(new RegExp(this.pattern.replace(L.tokenSeparator,"|"))),b=!!y)for(_=[],t=0,S=y.length;t<S;t++)x=y[t],_.push([e.indexOf(x),x.length-1]);return{isMatch:b,score:b?.5:1,matchedIndices:_}}for(o=L.findAllMatches,s=L.location,r=e.length,i=L.threshold,a=e.indexOf(this.pattern,s),w=[],t=0;t<r;t++)w[t]=0;for(a!=-1&&(i=Math.min(this._bitapScore(0,a),i),a=e.lastIndexOf(this.pattern,s+this.patternLen),a!=-1&&(i=Math.min(this._bitapScore(0,a),i))),a=-1,v=1,g=[],l=this.patternLen+r,t=0;t<this.patternLen;t++){for(u=0,c=l;u<c;)this._bitapScore(t,s+c)<=i?u=c:l=c,c=Math.floor((l-u)/2+u);for(l=c,f=Math.max(1,s-c+1),h=o?r:Math.min(s+c,r)+this.patternLen,p=Array(h+2),p[h+1]=(1<<t)-1,n=h;n>=f;n--)if(m=this.patternAlphabet[e.charAt(n-1)],m&&(w[n-1]=1),p[n]=(p[n+1]<<1|1)&m,0!==t&&(p[n]|=(d[n+1]|d[n])<<1|1|d[n+1]),p[n]&this.matchmask&&(v=this._bitapScore(t,n-1),v<=i)){if(i=v,a=n-1,g.push(a),a<=s)break;f=Math.max(1,2*s-a)}if(this._bitapScore(t+1,s)>i)break;d=p}return _=this._getMatchedIndices(w),{isMatch:a>=0,score:0===v?.001:v,matchedIndices:_}},a.prototype._getMatchedIndices=function(e){for(var t,n=[],r=-1,o=-1,s=0,i=e.length;s<i;s++)t=e[s],t&&r===-1?r=s:t||r===-1||(o=s-1,o-r+1>=this.options.minMatchCharLength&&n.push([r,o]),r=-1);return e[s-1]&&s-1-r+1>=this.options.minMatchCharLength&&n.push([r,s-1]),n},"object"==typeof n?t.exports=o:"function"==typeof define&&define.amd?define(function(){return o}):e.Fuse=o}(this)},{}],36:[function(e,t,n){function r(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function o(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&r(e.slice(0,0))}t.exports=function(e){return null!=e&&(r(e)||o(e)||!!e._isBuffer)}},{}],37:[function(e,t,n){function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(f===setTimeout)return setTimeout(e,0);if((f===r||!f)&&setTimeout)return f=setTimeout,setTimeout(e,0);try{return f(e,0)}catch(t){try{return f.call(null,e,0)}catch(t){return f.call(this,e,0)}}}function i(e){if(h===clearTimeout)return clearTimeout(e);if((h===o||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(e);try{return h(e)}catch(t){try{return h.call(null,e)}catch(t){return h.call(this,e)}}}function a(){v&&d&&(v=!1,d.length?m=d.concat(m):g=-1,m.length&&u())}function u(){if(!v){var e=s(a);v=!0;for(var t=m.length;t;){for(d=m,m=[];++g<t;)d&&d[g].run();g=-1,t=m.length}d=null,v=!1,i(e)}}function c(e,t){this.fun=e,this.array=t}function l(){}var f,h,p=t.exports={};!function(){try{f="function"==typeof setTimeout?setTimeout:r}catch(e){f=r}try{h="function"==typeof clearTimeout?clearTimeout:o}catch(e){h=o}}();var d,m=[],v=!1,g=-1;p.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];m.push(new c(e,t)),1!==m.length||v||s(u)},c.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(e){return[]},p.binding=function(e){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(e){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},{}]},{},[6]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzY3JpcHRzLm1pbi5qcyIsIl9hc3NldHMvc2NyaXB0cy9hcGkuanMiLCJfYXNzZXRzL3NjcmlwdHMvYXotc2VhcmNoLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvZG9tLWVsZW1lbnRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvZXZlbnRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL2hlbHBlcnMvdW5kZXJzY29yZS5qcyIsIl9hc3NldHMvc2NyaXB0cy9tYWluLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL3B1YnN1Yi5qcyIsIl9hc3NldHMvc2NyaXB0cy9yZXN1bHRzLmpzIiwiX2Fzc2V0cy9zY3JpcHRzL3NlYXJjaC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9pbmRleC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvYWRhcHRlcnMveGhyLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9heGlvcy5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL0NhbmNlbC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY2FuY2VsL0NhbmNlbFRva2VuLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jYW5jZWwvaXNDYW5jZWwuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvQXhpb3MuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvSW50ZXJjZXB0b3JNYW5hZ2VyLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2NyZWF0ZUVycm9yLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL2Rpc3BhdGNoUmVxdWVzdC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvY29yZS9lbmhhbmNlRXJyb3IuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2NvcmUvc2V0dGxlLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9jb3JlL3RyYW5zZm9ybURhdGEuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2RlZmF1bHRzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2JpbmQuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvYnRvYS5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9idWlsZFVSTC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9jb21iaW5lVVJMcy5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvaGVscGVycy9jb29raWVzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL2lzQWJzb2x1dGVVUkwuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUuanMiLCJub2RlX21vZHVsZXMvYXhpb3MvbGliL2hlbHBlcnMvcGFyc2VIZWFkZXJzLmpzIiwibm9kZV9tb2R1bGVzL2F4aW9zL2xpYi9oZWxwZXJzL3NwcmVhZC5qcyIsIm5vZGVfbW9kdWxlcy9heGlvcy9saWIvdXRpbHMuanMiLCJub2RlX21vZHVsZXMvZnVzZS5qcy9zcmMvZnVzZS5qcyIsIm5vZGVfbW9kdWxlcy9pcy1idWZmZXIvaW5kZXguanMiLCJub2RlX21vZHVsZXMvcHJvY2Vzcy9icm93c2VyLmpzIl0sIm5hbWVzIjpbImUiLCJ0IiwibiIsInIiLCJzIiwibyIsInUiLCJhIiwicmVxdWlyZSIsImkiLCJmIiwiRXJyb3IiLCJjb2RlIiwibCIsImV4cG9ydHMiLCJjYWxsIiwibGVuZ3RoIiwiMSIsIm1vZHVsZSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJvYmoiLCJfX2VzTW9kdWxlIiwiZGVmYXVsdCIsImdyb3VwU29uZ3MiLCJzb25nTGlzdCIsImdyb3VwZWQiLCJfdW5kZXJzY29yZSIsImdyb3VwQnkiLCJmaWx0ZXJCeUxldHRlciIsImxldHRlciIsImZpbHQiLCJmaWx0ZXIiLCJpdGVtIiwiYXJ0aXN0IiwidG9TdHJpbmciLCJjaGFyQXQiLCJmaWx0ZXJCeVRlcm0iLCJzZWFyY2hUZXJtIiwiZnVzZSIsIl9mdXNlMiIsImZ1c2VPcHRpb25zIiwiZnVzZVJlc3VsdHMiLCJzZWFyY2giLCJzZWFyY2hCeU5hbWUiLCJfcHVic3ViMiIsInB1Ymxpc2giLCJfYXhpb3MyIiwiZ2V0IiwidGhlbiIsInJlc3VsdHMiLCJkYXRhIiwic29ydFNvbmdzIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluZEFydGlzdHNCeUxldHRlciIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwidmFsdWUiLCJfYXhpb3MiLCJfZnVzZSIsIl9wdWJzdWIiLCJzaG91bGRTb3J0IiwidGhyZXNob2xkIiwibG9jYXRpb24iLCJkaXN0YW5jZSIsIm1heFBhdHRlcm5MZW5ndGgiLCJtaW5NYXRjaENoYXJMZW5ndGgiLCJrZXlzIiwic29ydGVkIiwic29ydCIsImIiLCJhbGMiLCJ0b0xvd2VyQ2FzZSIsImJsYyIsIi4vaGVscGVycy91bmRlcnNjb3JlIiwiLi9wdWJzdWIiLCJheGlvcyIsImZ1c2UuanMiLCIyIiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJuZXdPYmoiLCJrZXkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsIl90b0NvbnN1bWFibGVBcnJheSIsImFyciIsIkFycmF5IiwiaXNBcnJheSIsImFycjIiLCJmcm9tIiwiZmlsbEZvcm0iLCJmb3JtIiwiY2xhc3NMaXN0IiwicmVtb3ZlIiwic2VsZWN0ZWRBcnRpc3QiLCJzZWxlY3RlZFNvbmciLCJ0aXRsZSIsImdldERhdGEiLCJhcnRpc3RTb25ncyIsInRhcmdldCIsInBhcmVudE5vZGUiLCJwcmV2aW91c1NpYmxpbmciLCJsb2ciLCJpbm5lckhUTUwiLCJzZWxlY3Rpb24iLCJzdWJtaXRSZXF1ZXN0IiwiZXZ0Iiwid2luZG93IiwiZXZlbnQiLCJwcmV2ZW50RGVmYXVsdCIsInJlcXVlc3QiLCJhc3NpZ24iLCJuYW1lIiwicGhvbmUiLCJzb25nIiwibGV0dGVyQ2xpY2tIYW5kbGVyIiwidGhlTGV0dGVyIiwidGhpcyIsImRhdGFzZXQiLCJhcGkiLCJpbml0TGV0dGVyTWVudSIsImxldHRlcnMiLCJ1cHBlcmNhc2VMZXR0ZXJzIiwidG9VcHBlckNhc2UiLCJsZXR0ZXJMaXN0IiwiY29uY2F0Iiwic29ydGVkTGlzdCIsImh0bWxMaXN0IiwibWFwIiwiam9pbiIsIl9ldmVudHMiLCJfYXBpIiwibGV0dGVyTWVudUNvbnRhaW5lciIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsInNvbmdUaXRsZXMiLCJnZXRFbGVtZW50QnlJZCIsInJlcXVlc3RGb3JtIiwiZGVsZWdhdGVFdmVudExpc3RlbmVyIiwiYWRkRXZlbnRMaXN0ZW5lciIsIi4vYXBpIiwiLi9oZWxwZXJzL2V2ZW50cyIsIjMiLCJoYXNDbGFzcyIsImVsIiwiY2xhc3NOYW1lIiwiY29udGFpbnMiLCJSZWdFeHAiLCJ0ZXN0IiwiYWRkQ2xhc3MiLCJlbGVtZW50IiwiYWRkIiwicmVtb3ZlQ2xhc3MiLCJyZXBsYWNlIiwic3BsaXQiLCJ0b2dnbGVDbGFzcyIsInNldFN0eWxlIiwicHJvcGVydHlPYmplY3QiLCJzdHlsZXMiLCJzdHlsZSIsImZpbmRQYXJlbnRCeVRhZ05hbWUiLCJ0YWdOYW1lIiwicGFyZW50IiwiNCIsInRyaWdnZXIiLCJldmVudG5hbWUiLCJhcmd1bWVudHMiLCJ1bmRlZmluZWQiLCJDdXN0b21FdmVudCIsImRldGFpbCIsImNyZWF0ZUV2ZW50IiwiaW5pdEN1c3RvbUV2ZW50IiwiZGlzcGF0Y2hFdmVudCIsInNlbGVjdG9yIiwiaGFuZGxlciIsInBvc3NpYmxlVGFyZ2V0cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJwIiwiNSIsImlzRnVuY3Rpb24iLCJsaXN0IiwicHJvcCIsInJlZHVjZSIsImFwcGx5IiwicHVzaCIsIjYiLCIuL2F6LXNlYXJjaCIsIi4vcmVzdWx0cyIsIi4vc2VhcmNoIiwiNyIsInB1YnN1YiIsInRvcGljcyIsInN1YnNjcmliZSIsImV2ZW50TmFtZSIsImNhbGxiYWNrIiwidW5zdWJzY3JpYmUiLCJsZW4iLCJzcGxpY2UiLCJmb3JFYWNoIiwiOCIsImNsZWFyUmVzdWx0cyIsInBsYWNlaG9sZGVyIiwiX2RvbUVsZW1lbnRzIiwibG9hZHIiLCJyZW5kZXIiLCJwdWJvYmoiLCJodG1sU3R1ZmYiLCIuL2hlbHBlcnMvZG9tLWVsZW1lbnRzIiwiOSIsImNsZWFyU2VhcmNoIiwic2VhcmNoSW5wdXQiLCJzZWFyY2hIYW5kbGVyIiwib25TZWFyY2hTdGFydCIsInBzIiwicHVic3ViT2JqZWN0Iiwic2VhcmNoRm9ybSIsIjEwIiwiLi9saWIvYXhpb3MiLCIxMSIsInByb2Nlc3MiLCJ1dGlscyIsInNldHRsZSIsImJ1aWxkVVJMIiwicGFyc2VIZWFkZXJzIiwiaXNVUkxTYW1lT3JpZ2luIiwiY3JlYXRlRXJyb3IiLCJidG9hIiwiYmluZCIsImNvbmZpZyIsIlByb21pc2UiLCJyZXNvbHZlIiwicmVqZWN0IiwicmVxdWVzdERhdGEiLCJyZXF1ZXN0SGVhZGVycyIsImhlYWRlcnMiLCJpc0Zvcm1EYXRhIiwiWE1MSHR0cFJlcXVlc3QiLCJsb2FkRXZlbnQiLCJ4RG9tYWluIiwiZW52IiwiTk9ERV9FTlYiLCJYRG9tYWluUmVxdWVzdCIsInVybCIsIm9ucHJvZ3Jlc3MiLCJvbnRpbWVvdXQiLCJhdXRoIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsIkF1dGhvcml6YXRpb24iLCJvcGVuIiwibWV0aG9kIiwicGFyYW1zIiwicGFyYW1zU2VyaWFsaXplciIsInRpbWVvdXQiLCJyZWFkeVN0YXRlIiwic3RhdHVzIiwicmVzcG9uc2VVUkwiLCJpbmRleE9mIiwicmVzcG9uc2VIZWFkZXJzIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwicmVzcG9uc2VEYXRhIiwicmVzcG9uc2VUeXBlIiwicmVzcG9uc2UiLCJyZXNwb25zZVRleHQiLCJzdGF0dXNUZXh0Iiwib25lcnJvciIsImlzU3RhbmRhcmRCcm93c2VyRW52IiwiY29va2llcyIsInhzcmZWYWx1ZSIsIndpdGhDcmVkZW50aWFscyIsInhzcmZDb29raWVOYW1lIiwicmVhZCIsInhzcmZIZWFkZXJOYW1lIiwidmFsIiwic2V0UmVxdWVzdEhlYWRlciIsIm9uRG93bmxvYWRQcm9ncmVzcyIsIm9uVXBsb2FkUHJvZ3Jlc3MiLCJ1cGxvYWQiLCJjYW5jZWxUb2tlbiIsInByb21pc2UiLCJjYW5jZWwiLCJhYm9ydCIsInNlbmQiLCIuLi9jb3JlL2NyZWF0ZUVycm9yIiwiLi8uLi9jb3JlL3NldHRsZSIsIi4vLi4vaGVscGVycy9idG9hIiwiLi8uLi9oZWxwZXJzL2J1aWxkVVJMIiwiLi8uLi9oZWxwZXJzL2Nvb2tpZXMiLCIuLy4uL2hlbHBlcnMvaXNVUkxTYW1lT3JpZ2luIiwiLi8uLi9oZWxwZXJzL3BhcnNlSGVhZGVycyIsIi4vLi4vdXRpbHMiLCJfcHJvY2VzcyIsIjEyIiwiY3JlYXRlSW5zdGFuY2UiLCJkZWZhdWx0Q29uZmlnIiwiY29udGV4dCIsIkF4aW9zIiwiaW5zdGFuY2UiLCJleHRlbmQiLCJkZWZhdWx0cyIsImNyZWF0ZSIsImluc3RhbmNlQ29uZmlnIiwibWVyZ2UiLCJDYW5jZWwiLCJDYW5jZWxUb2tlbiIsImlzQ2FuY2VsIiwiYWxsIiwicHJvbWlzZXMiLCJzcHJlYWQiLCIuL2NhbmNlbC9DYW5jZWwiLCIuL2NhbmNlbC9DYW5jZWxUb2tlbiIsIi4vY2FuY2VsL2lzQ2FuY2VsIiwiLi9jb3JlL0F4aW9zIiwiLi9kZWZhdWx0cyIsIi4vaGVscGVycy9iaW5kIiwiLi9oZWxwZXJzL3NwcmVhZCIsIi4vdXRpbHMiLCIxMyIsIm1lc3NhZ2UiLCJfX0NBTkNFTF9fIiwiMTQiLCJleGVjdXRvciIsIlR5cGVFcnJvciIsInJlc29sdmVQcm9taXNlIiwidG9rZW4iLCJyZWFzb24iLCJ0aHJvd0lmUmVxdWVzdGVkIiwic291cmNlIiwiYyIsIi4vQ2FuY2VsIiwiMTUiLCIxNiIsImludGVyY2VwdG9ycyIsIkludGVyY2VwdG9yTWFuYWdlciIsImRpc3BhdGNoUmVxdWVzdCIsImlzQWJzb2x1dGVVUkwiLCJjb21iaW5lVVJMcyIsImJhc2VVUkwiLCJjaGFpbiIsImludGVyY2VwdG9yIiwidW5zaGlmdCIsImZ1bGZpbGxlZCIsInJlamVjdGVkIiwic2hpZnQiLCIuLy4uL2RlZmF1bHRzIiwiLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzIiwiLi8uLi9oZWxwZXJzL2lzQWJzb2x1dGVVUkwiLCIuL0ludGVyY2VwdG9yTWFuYWdlciIsIi4vZGlzcGF0Y2hSZXF1ZXN0IiwiMTciLCJoYW5kbGVycyIsInVzZSIsImVqZWN0IiwiaWQiLCJmbiIsImgiLCIxOCIsImVuaGFuY2VFcnJvciIsIi4vZW5oYW5jZUVycm9yIiwiMTkiLCJ0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkIiwidHJhbnNmb3JtRGF0YSIsInRyYW5zZm9ybVJlcXVlc3QiLCJjb21tb24iLCJhZGFwdGVyIiwidHJhbnNmb3JtUmVzcG9uc2UiLCIuLi9jYW5jZWwvaXNDYW5jZWwiLCIuLi9kZWZhdWx0cyIsIi4vdHJhbnNmb3JtRGF0YSIsIjIwIiwiMjEiLCJ2YWxpZGF0ZVN0YXR1cyIsIi4vY3JlYXRlRXJyb3IiLCIyMiIsImZucyIsIjIzIiwic2V0Q29udGVudFR5cGVJZlVuc2V0IiwiaXNVbmRlZmluZWQiLCJnZXREZWZhdWx0QWRhcHRlciIsIm5vcm1hbGl6ZUhlYWRlck5hbWUiLCJERUZBVUxUX0NPTlRFTlRfVFlQRSIsIkNvbnRlbnQtVHlwZSIsImlzQXJyYXlCdWZmZXIiLCJpc0J1ZmZlciIsImlzU3RyZWFtIiwiaXNGaWxlIiwiaXNCbG9iIiwiaXNBcnJheUJ1ZmZlclZpZXciLCJidWZmZXIiLCJpc1VSTFNlYXJjaFBhcmFtcyIsImlzT2JqZWN0IiwiSlNPTiIsInN0cmluZ2lmeSIsInBhcnNlIiwibWF4Q29udGVudExlbmd0aCIsIkFjY2VwdCIsIi4vYWRhcHRlcnMvaHR0cCIsIi4vYWRhcHRlcnMveGhyIiwiLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUiLCIyNCIsInRoaXNBcmciLCJhcmdzIiwiMjUiLCJFIiwiaW5wdXQiLCJibG9jayIsImNoYXJDb2RlIiwic3RyIiwiU3RyaW5nIiwib3V0cHV0IiwiaWR4IiwiY2hhcnMiLCJjaGFyQ29kZUF0IiwiMjYiLCJlbmNvZGUiLCJlbmNvZGVVUklDb21wb25lbnQiLCJzZXJpYWxpemVkUGFyYW1zIiwicGFydHMiLCJ2IiwiaXNEYXRlIiwidG9JU09TdHJpbmciLCIyNyIsInJlbGF0aXZlVVJMIiwiMjgiLCJ3cml0ZSIsImV4cGlyZXMiLCJwYXRoIiwiZG9tYWluIiwic2VjdXJlIiwiY29va2llIiwiaXNOdW1iZXIiLCJEYXRlIiwidG9HTVRTdHJpbmciLCJpc1N0cmluZyIsIm1hdGNoIiwiZGVjb2RlVVJJQ29tcG9uZW50Iiwibm93IiwiMjkiLCIzMCIsInJlc29sdmVVUkwiLCJocmVmIiwibXNpZSIsInVybFBhcnNpbmdOb2RlIiwic2V0QXR0cmlidXRlIiwicHJvdG9jb2wiLCJob3N0IiwiaGFzaCIsImhvc3RuYW1lIiwicG9ydCIsInBhdGhuYW1lIiwib3JpZ2luVVJMIiwibmF2aWdhdG9yIiwidXNlckFnZW50IiwiY3JlYXRlRWxlbWVudCIsInJlcXVlc3RVUkwiLCJwYXJzZWQiLCIzMSIsIm5vcm1hbGl6ZWROYW1lIiwiLi4vdXRpbHMiLCIzMiIsImxpbmUiLCJ0cmltIiwic3Vic3RyIiwiMzMiLCIzNCIsIkZvcm1EYXRhIiwicmVzdWx0IiwiQXJyYXlCdWZmZXIiLCJpc1ZpZXciLCJwaXBlIiwiVVJMU2VhcmNoUGFyYW1zIiwicHJvZHVjdCIsImFzc2lnblZhbHVlIiwiaXMtYnVmZmVyIiwiMzUiLCJnbG9iYWwiLCJGdXNlIiwib3B0aW9ucyIsImRlZmF1bHRPcHRpb25zIiwiZGVlcFZhbHVlIiwiZmlyc3RTZWdtZW50IiwicmVtYWluaW5nIiwiZG90SW5kZXgiLCJzbGljZSIsIkJpdGFwU2VhcmNoZXIiLCJwYXR0ZXJuIiwiY2FzZVNlbnNpdGl2ZSIsInBhdHRlcm5MZW4iLCJtYXRjaG1hc2siLCJwYXR0ZXJuQWxwaGFiZXQiLCJfY2FsY3VsYXRlUGF0dGVybkFscGhhYmV0IiwiaW5jbHVkZSIsInNlYXJjaEZuIiwic29ydEZuIiwic2NvcmUiLCJnZXRGbiIsInZlcmJvc2UiLCJ0b2tlbml6ZSIsIm1hdGNoQWxsVG9rZW5zIiwidG9rZW5TZXBhcmF0b3IiLCJmaW5kQWxsTWF0Y2hlcyIsIlZFUlNJT04iLCJzZXQiLCJyZXN1bHRNYXAiLCJfa2V5TWFwIiwiX3ByZXBhcmVTZWFyY2hlcnMiLCJfc3RhcnRTZWFyY2giLCJfY29tcHV0ZVNjb3JlIiwiX3NvcnQiLCJfZm9ybWF0IiwidG9rZW5zIiwidG9rZW5TZWFyY2hlcnMiLCJmdWxsU2VhY2hlciIsIndlaWdodCIsImoiLCJsaXN0TGVuIiwia2V5c0xlbiIsIl9hbmFseXplIiwidGV4dCIsImVudGl0eSIsImluZGV4Iiwid29yZHMiLCJzY29yZXMiLCJleGlzdGluZ1Jlc3VsdCIsImF2ZXJhZ2VTY29yZSIsImZpbmFsU2NvcmUiLCJzY29yZXNMZW4iLCJtYWluU2VhcmNoUmVzdWx0IiwidG9rZW5TZWFyY2hlciIsInRlcm1TY29yZXMiLCJ3b3JkIiwidG9rZW5TZWFyY2hSZXN1bHQiLCJoYXNNYXRjaEluVGV4dCIsImNoZWNrVGV4dE1hdGNoZXMiLCJleGlzdHMiLCJudW1UZXh0TWF0Y2hlcyIsImlzTWF0Y2giLCJtYXRjaGVkSW5kaWNlcyIsInRvdGFsU2NvcmUiLCJzY29yZUxlbiIsImJlc3RTY29yZSIsIm5TY29yZSIsImtleU1hcCIsIk1hdGgiLCJtaW4iLCJyZXBsYWNlVmFsdWUiLCJnZXRJdGVtQXRJbmRleCIsImZpbmFsT3V0cHV0IiwiX2l0ZW0iLCJfcmVzdWx0IiwicmVjb3JkIiwibWF0Y2hlcyIsImluZGljZXMiLCJtYXNrIiwiX2JpdGFwU2NvcmUiLCJlcnJvcnMiLCJhY2N1cmFjeSIsInByb3hpbWl0eSIsImFicyIsInRleHRMZW4iLCJiZXN0TG9jIiwiYmluTWluIiwiYmluTWlkIiwiYmluTWF4Iiwic3RhcnQiLCJmaW5pc2giLCJiaXRBcnIiLCJsYXN0Qml0QXJyIiwiY2hhck1hdGNoIiwibG9jYXRpb25zIiwiaXNNYXRjaGVkIiwibWF0Y2hNYXNrIiwibWF0Y2hlc0xlbiIsImxhc3RJbmRleE9mIiwiZmxvb3IiLCJtYXgiLCJfZ2V0TWF0Y2hlZEluZGljZXMiLCJlbmQiLCJkZWZpbmUiLCJhbWQiLCIzNiIsImNvbnN0cnVjdG9yIiwiaXNTbG93QnVmZmVyIiwicmVhZEZsb2F0TEUiLCJfaXNCdWZmZXIiLCIzNyIsImRlZmF1bHRTZXRUaW1vdXQiLCJkZWZhdWx0Q2xlYXJUaW1lb3V0IiwicnVuVGltZW91dCIsImZ1biIsImNhY2hlZFNldFRpbWVvdXQiLCJzZXRUaW1lb3V0IiwicnVuQ2xlYXJUaW1lb3V0IiwibWFya2VyIiwiY2FjaGVkQ2xlYXJUaW1lb3V0IiwiY2xlYXJUaW1lb3V0IiwiY2xlYW5VcE5leHRUaWNrIiwiZHJhaW5pbmciLCJjdXJyZW50UXVldWUiLCJxdWV1ZSIsInF1ZXVlSW5kZXgiLCJkcmFpblF1ZXVlIiwicnVuIiwiSXRlbSIsImFycmF5Iiwibm9vcCIsIm5leHRUaWNrIiwiYnJvd3NlciIsImFyZ3YiLCJ2ZXJzaW9uIiwidmVyc2lvbnMiLCJvbiIsImFkZExpc3RlbmVyIiwib25jZSIsIm9mZiIsInJlbW92ZUxpc3RlbmVyIiwicmVtb3ZlQWxsTGlzdGVuZXJzIiwiZW1pdCIsInByZXBlbmRMaXN0ZW5lciIsInByZXBlbmRPbmNlTGlzdGVuZXIiLCJsaXN0ZW5lcnMiLCJiaW5kaW5nIiwiY3dkIiwiY2hkaXIiLCJkaXIiLCJ1bWFzayJdLCJtYXBwaW5ncyI6IkNBQUEsUUFBQUEsR0FBQUMsRUFBQUMsRUFBQUMsR0FBQSxRQUFBQyxHQUFBQyxFQUFBQyxHQUFBLElBQUFKLEVBQUFHLEdBQUEsQ0FBQSxJQUFBSixFQUFBSSxHQUFBLENBQUEsR0FBQUUsR0FBQSxrQkFBQUMsVUFBQUEsT0FBQSxLQUFBRixHQUFBQyxFQUFBLE1BQUFBLEdBQUFGLEdBQUEsRUFBQSxJQUFBSSxFQUFBLE1BQUFBLEdBQUFKLEdBQUEsRUFBQSxJQUFBSyxH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QUFBcVksUUFDQXJZLEVBQUFzWSxRQUFBLEdBQ0F0WSxFQUFBdVksWUFJQXZZLEVBQUF3WSxHQUFBTixFQUNBbFksRUFBQXlZLFlBQUFQLEVBQ0FsWSxFQUFBMFksS0FBQVIsRUFDQWxZLEVBQUEyWSxJQUFBVCxFQUNBbFksRUFBQTRZLGVBQUFWLEVBQ0FsWSxFQUFBNlksbUJBQUFYLEVBQ0FsWSxFQUFBOFksS0FBQVosRUFDQWxZLEVBQUErWSxnQkFBQWIsRUFDQWxZLEVBQUFnWixvQkFBQWQsRUFFQWxZLEVBQUFpWixVQUFBLFNBQUE1ZixHQUFBLFVBRUEyRyxFQUFBa1osUUFBQSxTQUFBN2YsR0FDQSxLQUFBLElBQUFyRyxPQUFBLHFDQUdBZ04sRUFBQW1aLElBQUEsV0FBQSxNQUFBLEtBQ0FuWixFQUFBb1osTUFBQSxTQUFBQyxHQUNBLEtBQUEsSUFBQXJtQixPQUFBLG1DQUVBZ04sRUFBQXNaLE1BQUEsV0FBQSxNQUFBLGNyQzJ4RlciLCJmaWxlIjoic2NyaXB0cy5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pKHsxOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuc2VhcmNoQnlOYW1lID0gc2VhcmNoQnlOYW1lO1xuZXhwb3J0cy5maW5kQXJ0aXN0c0J5TGV0dGVyID0gZmluZEFydGlzdHNCeUxldHRlcjtcblxudmFyIF9heGlvcyA9IHJlcXVpcmUoJ2F4aW9zJyk7XG5cbnZhciBfYXhpb3MyID0gX2ludGVyb3BSZXF1aXJlRGVmYXVsdChfYXhpb3MpO1xuXG52YXIgX2Z1c2UgPSByZXF1aXJlKCdmdXNlLmpzJyk7XG5cbnZhciBfZnVzZTIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9mdXNlKTtcblxudmFyIF9wdWJzdWIgPSByZXF1aXJlKCcuL3B1YnN1YicpO1xuXG52YXIgX3B1YnN1YjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wdWJzdWIpO1xuXG52YXIgX3VuZGVyc2NvcmUgPSByZXF1aXJlKCcuL2hlbHBlcnMvdW5kZXJzY29yZScpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgZnVzZSA9IHZvaWQgMDtcblxuLy8gSW5pdGlhbGl6ZSBmdXNlLmpzIG9wdGlvbnNcbnZhciBmdXNlT3B0aW9ucyA9IHtcbiAgc2hvdWxkU29ydDogdHJ1ZSxcbiAgdGhyZXNob2xkOiAwLjEsXG4gIGxvY2F0aW9uOiAwLFxuICBkaXN0YW5jZTogMTAwLFxuICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMixcbiAgbWluTWF0Y2hDaGFyTGVuZ3RoOiAxLFxuICBrZXlzOiBbJ2FydGlzdCcsICd0aXRsZSddXG59O1xuXG4vLyBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy82NzEyMDM0L3NvcnQtYXJyYXktYnktZmlyc3RuYW1lLWFscGhhYmV0aWNhbGx5LWluLWphdmFzY3JpcHRcbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzU0MjEyNTMvc29ydC1qYXZhc2NyaXB0LWFycmF5LW9mLW9iamVjdHMtYmFzZWQtb24tb25lLW9mLXRoZS1vYmplY3RzLXByb3BlcnRpZXNcbnZhciBzb3J0U29uZ3MgPSBmdW5jdGlvbiBzb3J0U29uZ3Moc29uZ0xpc3QpIHtcbiAgdmFyIHNvcnRlZCA9IHNvbmdMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcbiAgICB2YXIgYWxjID0gYS5hcnRpc3QudG9Mb3dlckNhc2UoKTtcbiAgICB2YXIgYmxjID0gYi5hcnRpc3QudG9Mb3dlckNhc2UoKTtcbiAgICBpZiAoYWxjID4gYmxjKSB7XG4gICAgICByZXR1cm4gMTtcbiAgICB9IGVsc2UgaWYgKGFsYyA8IGJsYykge1xuICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICByZXR1cm4gMDtcbiAgfSk7XG4gIHJldHVybiBzb3J0ZWQ7XG59O1xuXG5mdW5jdGlvbiBncm91cFNvbmdzKHNvbmdMaXN0KSB7XG4gIHZhciBncm91cGVkID0gKDAsIF91bmRlcnNjb3JlLmdyb3VwQnkpKHNvbmdMaXN0LCAnYXJ0aXN0Jyk7XG4gIHJldHVybiBncm91cGVkO1xufVxuXG5mdW5jdGlvbiBmaWx0ZXJCeUxldHRlcihzb25nTGlzdCwgbGV0dGVyKSB7XG4gIHZhciBmaWx0ID0gc29uZ0xpc3QuZmlsdGVyKGZ1bmN0aW9uIChpdGVtKSB7XG4gICAgcmV0dXJuIGl0ZW0uYXJ0aXN0LnRvU3RyaW5nKCkuY2hhckF0KDApID09PSBsZXR0ZXI7XG4gIH0pO1xuICByZXR1cm4gZmlsdDtcbn1cblxuZnVuY3Rpb24gZmlsdGVyQnlUZXJtKHNvbmdMaXN0LCBzZWFyY2hUZXJtKSB7XG4gIGZ1c2UgPSBuZXcgX2Z1c2UyLmRlZmF1bHQoc29uZ0xpc3QsIGZ1c2VPcHRpb25zKTtcbiAgdmFyIGZ1c2VSZXN1bHRzID0gZnVzZS5zZWFyY2goc2VhcmNoVGVybSk7XG4gIHJldHVybiBmdXNlUmVzdWx0cztcbn1cblxuZnVuY3Rpb24gc2VhcmNoQnlOYW1lKHNlYXJjaFRlcm0pIHtcbiAgX3B1YnN1YjIuZGVmYXVsdC5wdWJsaXNoKCdzZWFyY2hTdGFydCcsIHsgc2VhcmNoVGVybTogc2VhcmNoVGVybSB9KTtcbiAgcmV0dXJuIF9heGlvczIuZGVmYXVsdC5nZXQoJ3NlYXJjaF9kYXRhLmpzb24nKS50aGVuKGZ1bmN0aW9uIChyZXN1bHRzKSB7XG4gICAgcmV0dXJuIGZpbHRlckJ5VGVybShyZXN1bHRzLmRhdGEsIHNlYXJjaFRlcm0pO1xuICB9KS50aGVuKHNvcnRTb25ncykudGhlbihncm91cFNvbmdzKS5jYXRjaChmdW5jdGlvbiAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGZpbmRBcnRpc3RzQnlMZXR0ZXIobGV0dGVyKSB7XG4gIF9wdWJzdWIyLmRlZmF1bHQucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IGxldHRlcjogbGV0dGVyIH0pO1xuICByZXR1cm4gX2F4aW9zMi5kZWZhdWx0LmdldCgnc2VhcmNoX2RhdGEuanNvbicpLnRoZW4oZnVuY3Rpb24gKHJlc3VsdHMpIHtcbiAgICByZXR1cm4gZmlsdGVyQnlMZXR0ZXIocmVzdWx0cy5kYXRhLCBsZXR0ZXIpO1xuICB9KS50aGVuKHNvcnRTb25ncykudGhlbihncm91cFNvbmdzKVxuICAvLyAudGhlbihyZXN1bHRzID0+IHNvcnRTb25ncyhyZXN1bHRzLCBsZXR0ZXIpKVxuICAuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gIH0pO1xufVxuLypcbmZ1bmN0aW9uIHNlYXJjaCgpIHtcbiAgYXhpb3MuZ2V0KCdzZWFyY2hfZGF0YS5qc29uJylcbiAgLnRoZW4oKHJlc3BvbnNlKSA9PiB7XG4gICAgbG9hZHIuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICBjb25zdCBmaWx0ID0gZGF0YS5maWx0ZXIoaXRlbSA9PiBpdGVtLmFydGlzdC50b1N0cmluZygpLmNoYXJBdCgwKSA9PT0gdGhpcy5kYXRhc2V0LmxldHRlcik7XG5cbiAgICBQdWJTdWIucHVibGlzaCgndXBkYXRlTGlzdCcsIHsgbGlzdDogZmlsdCB9KTtcblxuICAgIGRpc3BsYXlTZWFyY2hSZXN1bHRzKGZpbHQpO1xuICB9KVxuICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgY29uc29sZS5sb2coZXJyb3IpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gc29ydFNvbmdzKHJlc3VsdHMsIGxldHRlcikge1xuICBjb25zb2xlLmxvZygnc29ydFNvbmdzJyk7XG4gIGNvbnN0IGFsbFNvbmdzID0gcmVzdWx0cy5kYXRhO1xuICBjb25zdCBmaWx0ZXJlZFNvbmdzID0gYWxsU29uZ3MuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IGxldHRlcik7XG5cbiAgY29uc3Qgc29uZ2xpc3RTb3J0ZWQgPSBmaWx0ZXJlZFNvbmdzLnNvcnQoKGEsIGIpID0+IGIuYXJ0aXN0IC0gYS5hcnRpc3QpO1xuICBjb25zdCBzb25nbGlzdEdyb3VwZWQgPSBncm91cEJ5KHNvbmdsaXN0U29ydGVkLCAnYXJ0aXN0Jyk7XG5cbiAgcmV0dXJuIHNvbmdsaXN0R3JvdXBlZDtcbn1cblxuKi9cblxufSx7XCIuL2hlbHBlcnMvdW5kZXJzY29yZVwiOjUsXCIuL3B1YnN1YlwiOjcsXCJheGlvc1wiOjEwLFwiZnVzZS5qc1wiOjM1fV0sMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBfZXZlbnRzID0gcmVxdWlyZSgnLi9oZWxwZXJzL2V2ZW50cycpO1xuXG52YXIgX3B1YnN1YiA9IHJlcXVpcmUoJy4vcHVic3ViJyk7XG5cbnZhciBfcHVic3ViMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3B1YnN1Yik7XG5cbnZhciBfYXBpID0gcmVxdWlyZSgnLi9hcGknKTtcblxudmFyIGFwaSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hcGkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG5mdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7IGlmIChBcnJheS5pc0FycmF5KGFycikpIHsgZm9yICh2YXIgaSA9IDAsIGFycjIgPSBBcnJheShhcnIubGVuZ3RoKTsgaSA8IGFyci5sZW5ndGg7IGkrKykgeyBhcnIyW2ldID0gYXJyW2ldOyB9IHJldHVybiBhcnIyOyB9IGVsc2UgeyByZXR1cm4gQXJyYXkuZnJvbShhcnIpOyB9IH1cblxudmFyIGxldHRlck1lbnVDb250YWluZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuYXotc2VhcmNoJyk7XG52YXIgc29uZ1RpdGxlcyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdqcy1zZWFyY2hfcmVzdWx0cycpO1xudmFyIGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lnbi11cCcpO1xudmFyIHNlbGVjdGVkQXJ0aXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLWFydGlzdF9faW5wdXQnKTtcbnZhciBzZWxlY3RlZFNvbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtc29uZ19faW5wdXQnKTtcbnZhciBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLW5hbWVfX2lucHV0Jyk7XG52YXIgcGhvbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtcGhvbmVfX2lucHV0Jyk7XG5cbi8vIENvZGUgZm9yIFNvbmcgUmVxdWVzdCBTdWJtaXRcbnZhciByZXF1ZXN0Rm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNqcy1zb25ncGljaycpO1xuXG5mdW5jdGlvbiBnZXRTb25nKGUpIHtcbiAgcmV0dXJuIGUudGFyZ2V0O1xufVxuXG52YXIgc2VsZWN0aW9uID0gZnVuY3Rpb24gc2VsZWN0aW9uKHRpdGxlLCBhcnRpc3QpIHtcbiAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICB0aGlzLmFydGlzdCA9IGFydGlzdDtcbn07XG5mdW5jdGlvbiBmaWxsRm9ybShvYmopIHtcbiAgZm9ybS5jbGFzc0xpc3QucmVtb3ZlKCd1LWhpZGRlbicpO1xuICBzZWxlY3RlZEFydGlzdC52YWx1ZSA9IG9iai5hcnRpc3Q7XG4gIHNlbGVjdGVkU29uZy52YWx1ZSA9IG9iai50aXRsZTtcbn1cblxuZnVuY3Rpb24gZ2V0RGF0YShlKSB7XG4gIHZhciB0aXRsZSwgYXJ0aXN0LCBhcnRpc3RTb25ncztcbiAgdGl0bGUgPSBlLnRhcmdldDtcbiAgYXJ0aXN0U29uZ3MgPSB0aXRsZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gIGFydGlzdCA9IGFydGlzdFNvbmdzLnByZXZpb3VzU2libGluZztcbiAgY29uc29sZS5sb2codGl0bGUuaW5uZXJIVE1MKTtcbiAgY29uc29sZS5sb2coYXJ0aXN0LmlubmVySFRNTCk7XG4gIHZhciBkYXRhID0gbmV3IHNlbGVjdGlvbih0aXRsZS5pbm5lckhUTUwsIGFydGlzdC5pbm5lckhUTUwpO1xuICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgZmlsbEZvcm0oZGF0YSk7XG59XG5cbmZ1bmN0aW9uIHN1Ym1pdFJlcXVlc3QoZXZ0KSB7XG4gIHZhciBlID0gZXZ0IHx8IHdpbmRvdy5ldmVudDtcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gIGlmIChzZWxlY3RlZEFydGlzdC52YWx1ZSA9PT0gXCJcIiB8fCBzZWxlY3RlZFNvbmcudmFsdWUgPT09IFwiXCIpIHtcbiAgICBmb3JtLnByZXZpb3VzU2libGluZy5pbm5lckhUTUwgPSBcIlBsZWFzZSBmaWxsIG91dCBhbGwgb2YgdGhlIGZpZWxkc1wiO1xuICB9IGVsc2Uge1xuICAgIHZhciByZXF1ZXN0ID0gT2JqZWN0LmFzc2lnbih7XG4gICAgICBuYW1lOiBuYW1lLnZhbHVlLFxuICAgICAgcGhvbmU6IHBob25lLnZhbHVlLFxuICAgICAgYXJ0aXN0OiBzZWxlY3RlZEFydGlzdC52YWx1ZSxcbiAgICAgIHNvbmc6IHNlbGVjdGVkU29uZy52YWx1ZVxuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKHJlcXVlc3QpO1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufTtcblxuZnVuY3Rpb24gbGV0dGVyQ2xpY2tIYW5kbGVyKGV2dCkge1xuICB2YXIgZSA9IGV2dCB8fCB3aW5kb3cuZXZlbnQ7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICB2YXIgdGhlTGV0dGVyID0gdGhpcy5kYXRhc2V0LmxldHRlcjtcblxuICBhcGkuZmluZEFydGlzdHNCeUxldHRlcih0aGVMZXR0ZXIpLnRoZW4oZnVuY3Rpb24gKHNvbmdMaXN0KSB7XG4gICAgX3B1YnN1YjIuZGVmYXVsdC5wdWJsaXNoKCdzZWFyY2hDb21wbGV0ZScsIHsgc29uZ0xpc3Q6IHNvbmdMaXN0LCBzZWFyY2hUZXJtOiB0aGVMZXR0ZXIgfSk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBpbml0TGV0dGVyTWVudSgpIHtcbiAgdmFyIGxldHRlcnMgPSAncXdlcnR5dWlvcGFzZGZnaGprbHp4Y3Zibm0nO1xuICB2YXIgdXBwZXJjYXNlTGV0dGVycyA9IGxldHRlcnMudG9VcHBlckNhc2UoKTtcbiAgdmFyIGxldHRlckxpc3QgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHVwcGVyY2FzZUxldHRlcnMpKTtcbiAgdmFyIHNvcnRlZExpc3QgPSBsZXR0ZXJMaXN0LnNvcnQoKTtcbiAgdmFyIGh0bWxMaXN0ID0gc29ydGVkTGlzdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHtcbiAgICByZXR1cm4gJzxsaSBjbGFzcz1cIm8tbGlzdC1pbmxpbmVfX2l0ZW0gYy1hel9faXRlbVwiPjxhIGNsYXNzPVwiYy1hel9fbGV0dGVyXCIgZGF0YS1sZXR0ZXI9XCInICsgaXRlbSArICdcIj4nICsgaXRlbSArICc8L2E+PC9saT4nO1xuICB9KS5qb2luKCcnKTtcbiAgLy8gY29udGFpbmVyLmlubmVySFRNTCA9IGA8dWwgY2xhc3M9XCJvLWxpc3QtaW5saW5lIGMtYXpcIj4ke2h0bWxMaXN0fTwvdWw+YDtcbiAgLy8gY29uc3QgbGV0dGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxldHRlcicpO1xuXG4gIC8vIGxldHRlci5mb3JFYWNoKGxldHQgPT4gbGV0dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxldHRlckNsaWNrSGFuZGxlcikpO1xuICByZXR1cm4gJzx1bCBjbGFzcz1cIm8tbGlzdC1pbmxpbmUgYy1helwiPicgKyBodG1sTGlzdCArICc8L3VsPic7XG59XG5cbmxldHRlck1lbnVDb250YWluZXIuaW5uZXJIVE1MID0gaW5pdExldHRlck1lbnUoKTtcbigwLCBfZXZlbnRzLmRlbGVnYXRlRXZlbnRMaXN0ZW5lcikobGV0dGVyTWVudUNvbnRhaW5lciwgJ2NsaWNrJywgJ2EnLCBsZXR0ZXJDbGlja0hhbmRsZXIpO1xuKDAsIF9ldmVudHMuZGVsZWdhdGVFdmVudExpc3RlbmVyKShzb25nVGl0bGVzLCAnY2xpY2snLCAnYScsIGdldERhdGEpO1xucmVxdWVzdEZvcm0uYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0Jywgc3VibWl0UmVxdWVzdCk7XG5cbn0se1wiLi9hcGlcIjoxLFwiLi9oZWxwZXJzL2V2ZW50c1wiOjQsXCIuL3B1YnN1YlwiOjd9XSwzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMuaGFzQ2xhc3MgPSBoYXNDbGFzcztcbi8qXG4gKiBhZGFwdGVkIGZyb20gaHR0cHM6Ly9jb2RlcGVuLmlvL2RpdnN3aXRoY2xhc3MvcGVuL0pvUldkd1xuICogZnJvbSBhIHNpbmdsZSBlbGVtZW50IChpLmUuIHF1ZXJ5U2VsZWN0b3Igb3IgZ2V0RWxlbWVudEJ5TmFtZSlcbiAqIHlvdSBjYW4gYWRkLCByZW1vdmUsIG9yIHRvZ2dsZSBhIGNsYXNzXG4gKlxuICogQHBhcmFtIHtET00gRWxlbWVudH0gZWwgLSBUaGUgZWxlbWVudCB0byBhbHRlclxuICogQHBhcmFtIHtTdHJpbmd9IGNsYXNzTmFtZSAtIHRoZSBjbGFzcyBuYW1lIHRvIGFkZCwgcmVtb3ZlLCB0b2dnbGVcbiAqL1xuXG52YXIgYWRkQ2xhc3MgPSBleHBvcnRzLmFkZENsYXNzID0gZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gIHZhciBlbCA9IGVsZW1lbnQ7XG5cbiAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbC5jbGFzc05hbWUgKz0gJyAnICsgY2xhc3NOYW1lO1xuICB9XG59O1xuXG52YXIgcmVtb3ZlQ2xhc3MgPSBleHBvcnRzLnJlbW92ZUNsYXNzID0gZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWxlbWVudCwgY2xhc3NOYW1lKSB7XG4gIHZhciBlbCA9IGVsZW1lbnQ7XG5cbiAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgIGVsLmNsYXNzTGlzdC5yZW1vdmUoY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbC5jbGFzc05hbWUgPSBlbC5jbGFzc05hbWUucmVwbGFjZShuZXcgUmVnRXhwKCcoXnxcXFxcYiknICsgY2xhc3NOYW1lLnNwbGl0KCcgJykuam9pbignfCcpICsgJyhcXFxcYnwkKScsICdnaScpLCAnICcpO1xuICB9XG59O1xuXG5mdW5jdGlvbiBoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSB7XG4gIGlmIChlbC5jbGFzc0xpc3QpIHtcbiAgICByZXR1cm4gZWwuY2xhc3NMaXN0LmNvbnRhaW5zKGNsYXNzTmFtZSk7XG4gIH1cbiAgcmV0dXJuIG5ldyBSZWdFeHAoJyhefCApJyArIGNsYXNzTmFtZSArICcoIHwkKScsICdnaScpLnRlc3QoZWwuY2xhc3NOYW1lKTtcbn1cblxudmFyIHRvZ2dsZUNsYXNzID0gZXhwb3J0cy50b2dnbGVDbGFzcyA9IGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsZW1lbnQsIGNsYXNzTmFtZSkge1xuICB2YXIgZWwgPSBlbGVtZW50O1xuXG4gIGlmIChoYXNDbGFzcyhlbCwgY2xhc3NOYW1lKSkge1xuICAgIHJlbW92ZUNsYXNzKGVsLCBjbGFzc05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGFkZENsYXNzKGVsLCBjbGFzc05hbWUpO1xuICB9XG59O1xuXG52YXIgc2V0U3R5bGUgPSBleHBvcnRzLnNldFN0eWxlID0gZnVuY3Rpb24gc2V0U3R5bGUoZWxlbWVudCwgcHJvcGVydHlPYmplY3QpIHtcbiAgdmFyIHN0eWxlcyA9IHByb3BlcnR5T2JqZWN0O1xuXG4gIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGVzKTtcbn07XG5cbnZhciBmaW5kUGFyZW50QnlUYWdOYW1lID0gZXhwb3J0cy5maW5kUGFyZW50QnlUYWdOYW1lID0gZnVuY3Rpb24gZmluZFBhcmVudEJ5VGFnTmFtZShlbGVtZW50LCB0YWdOYW1lKSB7XG4gIHZhciBwYXJlbnQgPSBlbGVtZW50O1xuXG4gIHdoaWxlIChwYXJlbnQgIT09IG51bGwgJiYgcGFyZW50LnRhZ05hbWUgIT09IHRhZ05hbWUudG9VcHBlckNhc2UoKSkge1xuICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnROb2RlO1xuICB9XG4gIHJldHVybiBwYXJlbnQ7XG59O1xuXG59LHt9XSw0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbmV4cG9ydHMudHJpZ2dlciA9IHRyaWdnZXI7XG5leHBvcnRzLmRlbGVnYXRlRXZlbnRMaXN0ZW5lciA9IGRlbGVnYXRlRXZlbnRMaXN0ZW5lcjtcbi8qKlxuICogQ3VzdG9tIGphdmFzY3JpcHQgZXZlbnRzIG9mIGpRdWVyeSBmdW5jdGlvbnNcbiAqL1xuLyoqXG4gKiBDdXN0b20gZXZlbnQgZGlzcGF0Y2hlciAobWltaWNzIGpxdWVyeSB0cmlnZ2VyKVxuICogQHBhcmFtICB7ZWxlbWVudH0gZWxlbWVudCAgIEVsZW1lbnQgdG8gdHJpZ2dlciBvblxuICogQHBhcmFtICB7c3RyaW5nfSBldmVudG5hbWUgQ3VzdG9tIGV2ZW50IG5hbWVcbiAqIEBwYXJhbSAge09iamVjdH0gW29iaj17fV0gIEN1c3RvbSBwYXJhbWV0ZXJzIHRvIHBhc3MgYWxvbmcgKGZpbmQgaW4gZXZlbnQuZGV0YWlsKVxuICogQHJldHVybiB7bnVsbH0gICAgICAgICAgIE5vIHJldHVybiB2YWx1ZVxuICovXG5mdW5jdGlvbiB0cmlnZ2VyKGVsZW1lbnQsIGV2ZW50bmFtZSkge1xuICB2YXIgb2JqID0gYXJndW1lbnRzLmxlbmd0aCA+IDIgJiYgYXJndW1lbnRzWzJdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbMl0gOiB7fTtcblxuICB2YXIgZXZlbnQgPSB2b2lkIDA7XG5cbiAgaWYgKHdpbmRvdy5DdXN0b21FdmVudCkge1xuICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50bmFtZSwgeyBkZXRhaWw6IG9iaiB9KTtcbiAgfSBlbHNlIHtcbiAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGV2ZW50LmluaXRDdXN0b21FdmVudChldmVudG5hbWUsIHRydWUsIHRydWUsIG9iaik7XG4gIH1cblxuICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG4vKipcbiAqIERlbGVnYXRlIGV2ZW50IGxpc3RlbmVyIHRvIGNoaWxkcmVuIChtaW1pY3MganF1ZXJ5IGJlaGF2aW9yKVxuICogKHNvdXJjZTogaHR0cDovL2JkYWRhbS5jb20vYmxvZy9wbGFpbi1qYXZhc2NyaXB0LWV2ZW50LWRlbGVnYXRpb24uaHRtbClcbiAqIEBwYXJhbSAge2VsZW1lbnR9IGVsZW1lbnQgIERPTSBwYXJlbnQgZWxlbWVudFxuICogQHBhcmFtICB7c3RyaW5nfSBldnQgICAgICBFdmVudCB0byBsaXN0ZW4gdG9cbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgU2VsZWN0b3IgdG8gbWF0Y2ggY2hpbGRyZW4gYnlcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBoYW5kbGVyICBGdW5jdGlvbiB0byBydW4gYXMgZXZlbnQgaGFuZGxlclxuICogQHJldHVybiB7bnVsbH0gICAgICAgICAgTm8gUmV0dXJuXG4gKi9cbmZ1bmN0aW9uIGRlbGVnYXRlRXZlbnRMaXN0ZW5lcihlbGVtZW50LCBldnQsIHNlbGVjdG9yLCBoYW5kbGVyKSB7XG4gIHZhciBlbCA9IGVsZW1lbnQ7XG4gIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCBmdW5jdGlvbiAoZXZlbnQpIHtcbiAgICB2YXIgcG9zc2libGVUYXJnZXRzID0gZWwucXVlcnlTZWxlY3RvckFsbChzZWxlY3Rvcik7XG4gICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldDtcblxuICAgIGZvciAodmFyIGkgPSAwLCBsID0gcG9zc2libGVUYXJnZXRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgdmFyIHQgPSB0YXJnZXQ7XG4gICAgICB2YXIgcCA9IHBvc3NpYmxlVGFyZ2V0c1tpXTtcblxuICAgICAgd2hpbGUgKHQgJiYgdCAhPT0gZWxlbWVudCkge1xuICAgICAgICBpZiAodCA9PT0gcCkge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVyLmNhbGwocCwgZXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbiAgLyogZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2dCwgZnVuY3Rpb24gY2FsbGJhY2soZXZlbnQpIHtcbiAgICBjb25zdCBlID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xuICAgICBsZXQgdCA9IGUudGFyZ2V0O1xuICAgICB3aGlsZSAodCAmJiB0ICE9PSB0aGlzKSB7XG4gICAgICBjb25zb2xlLmxvZyhgd2hpbGUgdDogJHt0fWApO1xuICAgICAgaWYgKHQubWF0Y2hlcyhzZWxlY3RvcikpIHtcbiAgICAgICAgY29uc29sZS5sb2coYG1hdGNoIHQ6ICR7dH1gKTtcbiAgICAgICAgaGFuZGxlci5jYWxsKHQsIGV2ZW50KTtcbiAgICAgIH1cbiAgICAgIGNvbnNvbGUubG9nKGBvdXRzaWRlIHQ6ICR7dH1gKTtcbiAgICAgIHQgPSB0LnBhcmVudE5vZGU7XG4gICAgfVxuICB9KTtcbiAgKi9cbn1cblxufSx7fV0sNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbk9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBcIl9fZXNNb2R1bGVcIiwge1xuICB2YWx1ZTogdHJ1ZVxufSk7XG4vKlxuICogR3JvdXBCeSBmcm9tIGh0dHA6Ly93d3cuZGF0Y2hsZXkubmFtZS9nZXR0aW5nLWZ1bmN0aW9uYWwtd2l0aC1qYXZhc2NyaXB0LXBhcnQtMi9cbiAqL1xuXG52YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xudmFyIGlzRnVuY3Rpb24gPSBmdW5jdGlvbiBpc0Z1bmN0aW9uKG8pIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwobykgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59O1xuXG4vKiBlc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246IFtcImVycm9yXCIsIHsgXCJwcm9wc1wiOiBmYWxzZSB9XSovXG52YXIgZ3JvdXBCeSA9IGV4cG9ydHMuZ3JvdXBCeSA9IGZ1bmN0aW9uIGdyb3VwQnkobGlzdCwgcHJvcCkge1xuICByZXR1cm4gbGlzdC5yZWR1Y2UoZnVuY3Rpb24gKGdyb3VwZWQsIGl0ZW0pIHtcbiAgICB2YXIga2V5ID0gaXNGdW5jdGlvbihwcm9wKSA/IHByb3AuYXBwbHkodW5kZWZpbmVkLCBbaXRlbV0pIDogaXRlbVtwcm9wXTtcbiAgICBncm91cGVkW2tleV0gPSBncm91cGVkW2tleV0gfHwgW107XG4gICAgZ3JvdXBlZFtrZXldLnB1c2goaXRlbSk7XG4gICAgcmV0dXJuIGdyb3VwZWQ7XG4gIH0sIHt9KTtcbn07XG5cbn0se31dLDY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5yZXF1aXJlKCcuL2F6LXNlYXJjaCcpO1xuXG5yZXF1aXJlKCcuL3NlYXJjaCcpO1xuXG5yZXF1aXJlKCcuL3Jlc3VsdHMnKTtcblxufSx7XCIuL2F6LXNlYXJjaFwiOjIsXCIuL3Jlc3VsdHNcIjo4LFwiLi9zZWFyY2hcIjo5fV0sNzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5cInVzZSBzdHJpY3RcIjtcblxuT2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFwiX19lc01vZHVsZVwiLCB7XG4gIHZhbHVlOiB0cnVlXG59KTtcbnZhciBwdWJzdWIgPSBmdW5jdGlvbiAoKSB7XG4gIHZhciB0b3BpY3MgPSB7fTtcblxuICB2YXIgc3Vic2NyaWJlID0gZnVuY3Rpb24gc3Vic2NyaWJlKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICB0b3BpY3NbZXZlbnROYW1lXSA9IHRvcGljc1tldmVudE5hbWVdIHx8IFtdO1xuICAgIHRvcGljc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICB9O1xuXG4gIHZhciB1bnN1YnNjcmliZSA9IGZ1bmN0aW9uIHVuc3Vic2NyaWJlKGV2ZW50TmFtZSwgY2FsbGJhY2spIHtcbiAgICBpZiAodG9waWNzW2V2ZW50TmFtZV0pIHtcbiAgICAgIGZvciAodmFyIGkgPSAwLCBsZW4gPSB0b3BpY3NbZXZlbnROYW1lXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAodG9waWNzW2V2ZW50TmFtZV1baV0gPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgdG9waWNzW2V2ZW50TmFtZV0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIHZhciBwdWJsaXNoID0gZnVuY3Rpb24gcHVibGlzaChldmVudE5hbWUsIGRhdGEpIHtcbiAgICBpZiAodG9waWNzW2V2ZW50TmFtZV0pIHtcbiAgICAgIHRvcGljc1tldmVudE5hbWVdLmZvckVhY2goZnVuY3Rpb24gKGNhbGxiYWNrKSB7XG4gICAgICAgIGNhbGxiYWNrKGRhdGEpO1xuICAgICAgfSk7XG4gICAgfVxuICB9O1xuXG4gIHJldHVybiB7XG4gICAgc3Vic2NyaWJlOiBzdWJzY3JpYmUsXG4gICAgdW5zdWJzY3JpYmU6IHVuc3Vic2NyaWJlLFxuICAgIHB1Ymxpc2g6IHB1Ymxpc2hcbiAgfTtcbn0oKTtcblxuZXhwb3J0cy5kZWZhdWx0ID0gcHVic3ViO1xuXG59LHt9XSw4OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIF9kb21FbGVtZW50cyA9IHJlcXVpcmUoJy4vaGVscGVycy9kb20tZWxlbWVudHMnKTtcblxudmFyIF9wdWJzdWIgPSByZXF1aXJlKCcuL3B1YnN1YicpO1xuXG52YXIgX3B1YnN1YjIgPSBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KF9wdWJzdWIpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtc2VhcmNoX3Jlc3VsdHMnKTtcbnZhciBsb2FkciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5sb2FkZXInKTtcblxuZnVuY3Rpb24gY2xlYXJSZXN1bHRzKCkge1xuICBwbGFjZWhvbGRlci5pbm5lckhUTUwgPSAnJztcbiAgKDAsIF9kb21FbGVtZW50cy5yZW1vdmVDbGFzcykobG9hZHIsICd1LWhpZGRlbicpO1xufVxuXG5mdW5jdGlvbiByZW5kZXIocHVib2JqKSB7XG4gIHZhciBzb25nTGlzdCA9IHB1Ym9iai5zb25nTGlzdDtcbiAgdmFyIHNlYXJjaFRlcm0gPSBwdWJvYmouc2VhcmNoVGVybTtcblxuICB2YXIgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9ICc8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzOiA8c3BhbiBjLXNlYXJjaF9fdGVybT4nICsgc2VhcmNoVGVybSArICc8L3NwYW4+PC9oMj48c2VjdGlvbiBjbGFzcz1cImMtc2VhcmNoX19saXN0XCI+JztcbiAgT2JqZWN0LmtleXMoc29uZ0xpc3QpLmZvckVhY2goZnVuY3Rpb24gKGtleSkge1xuICAgIGh0bWxTdHVmZiArPSAnPHAgY2xhc3M9XCJjLXNlYXJjaF9fYXJ0aXN0XCI+JyArIGtleSArICc8L3A+PHVsPic7XG4gICAgc29uZ0xpc3Rba2V5XS5mb3JFYWNoKGZ1bmN0aW9uICh2YWx1ZSkge1xuICAgICAgaHRtbFN0dWZmICs9ICc8bGkgY2xhc3M9XCJjLXNlYXJjaF9fdGl0bGVcIj48YSBocmVmPVwiI3NpZ24tdXBcIj4nICsgdmFsdWUudGl0bGUgKyAnPC9hPjwvbGk+JztcbiAgICB9KTtcbiAgICBodG1sU3R1ZmYgKz0gJzwvdWw+JztcbiAgfSk7XG4gIGh0bWxTdHVmZiArPSAnPC9zZWN0aW9uPic7XG4gICgwLCBfZG9tRWxlbWVudHMuYWRkQ2xhc3MpKGxvYWRyLCAndS1oaWRkZW4nKTtcbiAgcGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gaHRtbFN0dWZmO1xufVxuXG5fcHVic3ViMi5kZWZhdWx0LnN1YnNjcmliZSgnc2VhcmNoU3RhcnQnLCBjbGVhclJlc3VsdHMpO1xuX3B1YnN1YjIuZGVmYXVsdC5zdWJzY3JpYmUoJ3NlYXJjaENvbXBsZXRlJywgcmVuZGVyKTtcblxufSx7XCIuL2hlbHBlcnMvZG9tLWVsZW1lbnRzXCI6MyxcIi4vcHVic3ViXCI6N31dLDk6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgX3B1YnN1YiA9IHJlcXVpcmUoJy4vcHVic3ViJyk7XG5cbnZhciBfcHVic3ViMiA9IF9pbnRlcm9wUmVxdWlyZURlZmF1bHQoX3B1YnN1Yik7XG5cbnZhciBfYXBpID0gcmVxdWlyZSgnLi9hcGknKTtcblxudmFyIGFwaSA9IF9pbnRlcm9wUmVxdWlyZVdpbGRjYXJkKF9hcGkpO1xuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZChvYmopIHsgaWYgKG9iaiAmJiBvYmouX19lc01vZHVsZSkgeyByZXR1cm4gb2JqOyB9IGVsc2UgeyB2YXIgbmV3T2JqID0ge307IGlmIChvYmogIT0gbnVsbCkgeyBmb3IgKHZhciBrZXkgaW4gb2JqKSB7IGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSBuZXdPYmpba2V5XSA9IG9ialtrZXldOyB9IH0gbmV3T2JqLmRlZmF1bHQgPSBvYmo7IHJldHVybiBuZXdPYmo7IH0gfVxuXG5mdW5jdGlvbiBfaW50ZXJvcFJlcXVpcmVEZWZhdWx0KG9iaikgeyByZXR1cm4gb2JqICYmIG9iai5fX2VzTW9kdWxlID8gb2JqIDogeyBkZWZhdWx0OiBvYmogfTsgfVxuXG52YXIgc2VhcmNoRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJyNqcy1zb25nc2VhcmNoJyk7XG52YXIgc2VhcmNoSW5wdXQgPSBzZWFyY2hGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNqcy1zb25nc2VhcmNoX19pbnB1dCcpO1xuXG5mdW5jdGlvbiBjbGVhclNlYXJjaCgpIHtcbiAgc2VhcmNoSW5wdXQudmFsdWUgPSAnJztcbn1cblxuZnVuY3Rpb24gc2VhcmNoSGFuZGxlcihldnQpIHtcbiAgdmFyIGUgPSBldnQgfHwgd2luZG93LmV2ZW50O1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgdmFyIHNlYXJjaFRlcm0gPSBzZWFyY2hJbnB1dC52YWx1ZTtcbiAgaWYgKHNlYXJjaFRlcm0gIT09ICcnKSB7XG4gICAgYXBpLnNlYXJjaEJ5TmFtZShzZWFyY2hUZXJtKS50aGVuKGZ1bmN0aW9uIChzb25nTGlzdCkge1xuICAgICAgX3B1YnN1YjIuZGVmYXVsdC5wdWJsaXNoKCdzZWFyY2hDb21wbGV0ZScsIHsgc29uZ0xpc3Q6IHNvbmdMaXN0LCBzZWFyY2hUZXJtOiBzZWFyY2hUZXJtIH0pO1xuICAgIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIG9uU2VhcmNoU3RhcnQocHMpIHtcbiAgdmFyIHB1YnN1Yk9iamVjdCA9IHBzO1xuXG4gIGlmIChwdWJzdWJPYmplY3QubGV0dGVyKSB7XG4gICAgY2xlYXJTZWFyY2goKTtcbiAgfVxufVxuXG5zZWFyY2hGb3JtLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIHNlYXJjaEhhbmRsZXIpO1xuX3B1YnN1YjIuZGVmYXVsdC5zdWJzY3JpYmUoJ3NlYXJjaFN0YXJ0Jywgb25TZWFyY2hTdGFydCk7XG5cbi8qXG5cblxuZnVuY3Rpb24gc3VjY2Vzc0hhbmRsZXIoZGF0YSkge1xuICBjb25zdCBpID0gXyhkYXRhKS50b0FycmF5KCk7XG5cbiAgZnVzZSA9IG5ldyBGdXNlanMoaSwgb3B0aW9ucyk7IC8vIFwibGlzdFwiIGlzIHRoZSBpdGVtIGFycmF5XG59XG5cbi8vIEdldCB0aGUgZ2VuZXJhdGVkIHNlYXJjaF9kYXRhLmpzb24gZmlsZSBzbyBsdW5yLmpzIGNhbiBzZWFyY2ggaXQgbG9jYWxseS5cbmNvbnN0IHNlYXJjaERhdGEgPSAkLmFqYXgoe1xuICB1cmw6ICcuL3NlYXJjaF9kYXRhLmpzb24nLFxuICB0eXBlOiAnR0VUJywgLy8gZGVmYXVsdCBpcyBHRVQgYnV0IHlvdSBjYW4gdXNlIG90aGVyIHZlcmJzIGJhc2VkIG9uIHlvdXIgbmVlZHMuXG4gIGRhdGFUeXBlOiAnanNvbicsIC8vIHNwZWNpZnkgdGhlIGRhdGFUeXBlIGZvciBmdXR1cmUgcmVmZXJlbmNlXG59KTtcbnNlYXJjaERhdGEuZG9uZShzdWNjZXNzSGFuZGxlcik7XG5cbmZ1bmN0aW9uIGRpc3BsYXlTZWFyY2hSZXN1bHRzKHJlc3VsdHMpIHtcbiAgY29uc29sZS5sb2coJ3N1Y2Nlc3MnKTtcbiAgY29uc29sZS5sb2cocmVzdWx0cyk7XG5cbiAgY29uc3QgJHBsYWNlaG9sZGVyID0gJCgnI2pzLXNlYXJjaF9yZXN1bHRzJyk7XG4gIGNvbnN0IHRlc3RzID0gXy5zb3J0QnkocmVzdWx0cywgJ2FydGlzdCcpO1xuICBjb25zdCB0ZXN0ZyA9IF8uZ3JvdXBCeSh0ZXN0cywgJ2FydGlzdCcpO1xuICBsZXQgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9ICc8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzPC9oMj48c2VjdGlvbiBjbGFzcz1cImMtc2VhcmNoX19saXN0XCI+JztcbiAgJC5lYWNoKHRlc3RnLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGAke2tleX06IGApO1xuICAgIGNvbnNvbGUubG9nKGB2YWx1ZSA9ICR7dmFsdWV9YCk7XG4gICAgaHRtbFN0dWZmICs9IGA8cCBjbGFzcz1cImMtc2VhcmNoX19hcnRpc3RcIj4ke2tleX08L3A+PHVsPmA7XG4gICAgY29uc3QgdmFsID0gXy5zb3J0QnkodmFsdWUsICd0aXRsZScpO1xuICAgICQuZWFjaCh2YWwsIChrLCB2KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgJHtrfTo6OiR7di50aXRsZX1gKTtcblxuICAgICAgaHRtbFN0dWZmICs9IGA8bGkgY2xhc3M9XCJjLXNlYXJjaF9fdGl0bGVcIj4ke3YudGl0bGV9PC9saT5gO1xuICAgIH0pO1xuICAgIGh0bWxTdHVmZiArPSAnPC91bD4nO1xuICB9KTtcbiAgaHRtbFN0dWZmICs9ICc8L3NlY3Rpb24+JztcbiAgJHBsYWNlaG9sZGVyLmVtcHR5KCkuYXBwZW5kKGh0bWxTdHVmZik7XG59XG5cbiQoKCkgPT4ge1xuICAvLyBFdmVudCB3aGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZFxuICAkKCcjanMtc29uZ3NlYXJjaCcpLnN1Ym1pdCgoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0ICRxdWVyeSA9ICQoJyNqcy1zb25nc2VhcmNoX2lucHV0JykudmFsKCk7IC8vIEdldCB0aGUgdmFsdWUgZm9yIHRoZSB0ZXh0IGZpZWxkXG4gICAgY29uc3QgZnVzZVJlc3VsdHMgPSBmdXNlLnNlYXJjaCgkcXVlcnkpOyAvLyBHZXQgZnVzZS5qcyB0byBwZXJmb3JtIGEgc2VhcmNoXG5cbiAgICBkaXNwbGF5U2VhcmNoUmVzdWx0cyhmdXNlUmVzdWx0cyk7IC8vIEhhbmQgdGhlIHJlc3VsdHMgb2ZmIHRvIGJlIGRpc3BsYXllZFxuICB9KTtcbn0pO1xuKi9cblxufSx7XCIuL2FwaVwiOjEsXCIuL3B1YnN1YlwiOjd9XSwxMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG5tb2R1bGUuZXhwb3J0cyA9IHJlcXVpcmUoJy4vbGliL2F4aW9zJyk7XG59LHtcIi4vbGliL2F4aW9zXCI6MTJ9XSwxMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4oZnVuY3Rpb24gKHByb2Nlc3Mpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgc2V0dGxlID0gcmVxdWlyZSgnLi8uLi9jb3JlL3NldHRsZScpO1xudmFyIGJ1aWxkVVJMID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2J1aWxkVVJMJyk7XG52YXIgcGFyc2VIZWFkZXJzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL3BhcnNlSGVhZGVycycpO1xudmFyIGlzVVJMU2FtZU9yaWdpbiA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9pc1VSTFNhbWVPcmlnaW4nKTtcbnZhciBjcmVhdGVFcnJvciA9IHJlcXVpcmUoJy4uL2NvcmUvY3JlYXRlRXJyb3InKTtcbnZhciBidG9hID0gKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmIHdpbmRvdy5idG9hICYmIHdpbmRvdy5idG9hLmJpbmQod2luZG93KSkgfHwgcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2J0b2EnKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB4aHJBZGFwdGVyKGNvbmZpZykge1xuICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gZGlzcGF0Y2hYaHJSZXF1ZXN0KHJlc29sdmUsIHJlamVjdCkge1xuICAgIHZhciByZXF1ZXN0RGF0YSA9IGNvbmZpZy5kYXRhO1xuICAgIHZhciByZXF1ZXN0SGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzO1xuXG4gICAgaWYgKHV0aWxzLmlzRm9ybURhdGEocmVxdWVzdERhdGEpKSB7XG4gICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddOyAvLyBMZXQgdGhlIGJyb3dzZXIgc2V0IGl0XG4gICAgfVxuXG4gICAgdmFyIHJlcXVlc3QgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB2YXIgbG9hZEV2ZW50ID0gJ29ucmVhZHlzdGF0ZWNoYW5nZSc7XG4gICAgdmFyIHhEb21haW4gPSBmYWxzZTtcblxuICAgIC8vIEZvciBJRSA4LzkgQ09SUyBzdXBwb3J0XG4gICAgLy8gT25seSBzdXBwb3J0cyBQT1NUIGFuZCBHRVQgY2FsbHMgYW5kIGRvZXNuJ3QgcmV0dXJucyB0aGUgcmVzcG9uc2UgaGVhZGVycy5cbiAgICAvLyBET04nVCBkbyB0aGlzIGZvciB0ZXN0aW5nIGIvYyBYTUxIdHRwUmVxdWVzdCBpcyBtb2NrZWQsIG5vdCBYRG9tYWluUmVxdWVzdC5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09ICd0ZXN0JyAmJlxuICAgICAgICB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyAmJlxuICAgICAgICB3aW5kb3cuWERvbWFpblJlcXVlc3QgJiYgISgnd2l0aENyZWRlbnRpYWxzJyBpbiByZXF1ZXN0KSAmJlxuICAgICAgICAhaXNVUkxTYW1lT3JpZ2luKGNvbmZpZy51cmwpKSB7XG4gICAgICByZXF1ZXN0ID0gbmV3IHdpbmRvdy5YRG9tYWluUmVxdWVzdCgpO1xuICAgICAgbG9hZEV2ZW50ID0gJ29ubG9hZCc7XG4gICAgICB4RG9tYWluID0gdHJ1ZTtcbiAgICAgIHJlcXVlc3Qub25wcm9ncmVzcyA9IGZ1bmN0aW9uIGhhbmRsZVByb2dyZXNzKCkge307XG4gICAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7fTtcbiAgICB9XG5cbiAgICAvLyBIVFRQIGJhc2ljIGF1dGhlbnRpY2F0aW9uXG4gICAgaWYgKGNvbmZpZy5hdXRoKSB7XG4gICAgICB2YXIgdXNlcm5hbWUgPSBjb25maWcuYXV0aC51c2VybmFtZSB8fCAnJztcbiAgICAgIHZhciBwYXNzd29yZCA9IGNvbmZpZy5hdXRoLnBhc3N3b3JkIHx8ICcnO1xuICAgICAgcmVxdWVzdEhlYWRlcnMuQXV0aG9yaXphdGlvbiA9ICdCYXNpYyAnICsgYnRvYSh1c2VybmFtZSArICc6JyArIHBhc3N3b3JkKTtcbiAgICB9XG5cbiAgICByZXF1ZXN0Lm9wZW4oY29uZmlnLm1ldGhvZC50b1VwcGVyQ2FzZSgpLCBidWlsZFVSTChjb25maWcudXJsLCBjb25maWcucGFyYW1zLCBjb25maWcucGFyYW1zU2VyaWFsaXplciksIHRydWUpO1xuXG4gICAgLy8gU2V0IHRoZSByZXF1ZXN0IHRpbWVvdXQgaW4gTVNcbiAgICByZXF1ZXN0LnRpbWVvdXQgPSBjb25maWcudGltZW91dDtcblxuICAgIC8vIExpc3RlbiBmb3IgcmVhZHkgc3RhdGVcbiAgICByZXF1ZXN0W2xvYWRFdmVudF0gPSBmdW5jdGlvbiBoYW5kbGVMb2FkKCkge1xuICAgICAgaWYgKCFyZXF1ZXN0IHx8IChyZXF1ZXN0LnJlYWR5U3RhdGUgIT09IDQgJiYgIXhEb21haW4pKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gVGhlIHJlcXVlc3QgZXJyb3JlZCBvdXQgYW5kIHdlIGRpZG4ndCBnZXQgYSByZXNwb25zZSwgdGhpcyB3aWxsIGJlXG4gICAgICAvLyBoYW5kbGVkIGJ5IG9uZXJyb3IgaW5zdGVhZFxuICAgICAgLy8gV2l0aCBvbmUgZXhjZXB0aW9uOiByZXF1ZXN0IHRoYXQgdXNpbmcgZmlsZTogcHJvdG9jb2wsIG1vc3QgYnJvd3NlcnNcbiAgICAgIC8vIHdpbGwgcmV0dXJuIHN0YXR1cyBhcyAwIGV2ZW4gdGhvdWdoIGl0J3MgYSBzdWNjZXNzZnVsIHJlcXVlc3RcbiAgICAgIGlmIChyZXF1ZXN0LnN0YXR1cyA9PT0gMCAmJiAhKHJlcXVlc3QucmVzcG9uc2VVUkwgJiYgcmVxdWVzdC5yZXNwb25zZVVSTC5pbmRleE9mKCdmaWxlOicpID09PSAwKSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIC8vIFByZXBhcmUgdGhlIHJlc3BvbnNlXG4gICAgICB2YXIgcmVzcG9uc2VIZWFkZXJzID0gJ2dldEFsbFJlc3BvbnNlSGVhZGVycycgaW4gcmVxdWVzdCA/IHBhcnNlSGVhZGVycyhyZXF1ZXN0LmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSA6IG51bGw7XG4gICAgICB2YXIgcmVzcG9uc2VEYXRhID0gIWNvbmZpZy5yZXNwb25zZVR5cGUgfHwgY29uZmlnLnJlc3BvbnNlVHlwZSA9PT0gJ3RleHQnID8gcmVxdWVzdC5yZXNwb25zZVRleHQgOiByZXF1ZXN0LnJlc3BvbnNlO1xuICAgICAgdmFyIHJlc3BvbnNlID0ge1xuICAgICAgICBkYXRhOiByZXNwb25zZURhdGEsXG4gICAgICAgIC8vIElFIHNlbmRzIDEyMjMgaW5zdGVhZCBvZiAyMDQgKGh0dHBzOi8vZ2l0aHViLmNvbS9temFicmlza2llL2F4aW9zL2lzc3Vlcy8yMDEpXG4gICAgICAgIHN0YXR1czogcmVxdWVzdC5zdGF0dXMgPT09IDEyMjMgPyAyMDQgOiByZXF1ZXN0LnN0YXR1cyxcbiAgICAgICAgc3RhdHVzVGV4dDogcmVxdWVzdC5zdGF0dXMgPT09IDEyMjMgPyAnTm8gQ29udGVudCcgOiByZXF1ZXN0LnN0YXR1c1RleHQsXG4gICAgICAgIGhlYWRlcnM6IHJlc3BvbnNlSGVhZGVycyxcbiAgICAgICAgY29uZmlnOiBjb25maWcsXG4gICAgICAgIHJlcXVlc3Q6IHJlcXVlc3RcbiAgICAgIH07XG5cbiAgICAgIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHJlc3BvbnNlKTtcblxuICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSBsb3cgbGV2ZWwgbmV0d29yayBlcnJvcnNcbiAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbiBoYW5kbGVFcnJvcigpIHtcbiAgICAgIC8vIFJlYWwgZXJyb3JzIGFyZSBoaWRkZW4gZnJvbSB1cyBieSB0aGUgYnJvd3NlclxuICAgICAgLy8gb25lcnJvciBzaG91bGQgb25seSBmaXJlIGlmIGl0J3MgYSBuZXR3b3JrIGVycm9yXG4gICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ05ldHdvcmsgRXJyb3InLCBjb25maWcsIG51bGwsIHJlcXVlc3QpKTtcblxuICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8vIEhhbmRsZSB0aW1lb3V0XG4gICAgcmVxdWVzdC5vbnRpbWVvdXQgPSBmdW5jdGlvbiBoYW5kbGVUaW1lb3V0KCkge1xuICAgICAgcmVqZWN0KGNyZWF0ZUVycm9yKCd0aW1lb3V0IG9mICcgKyBjb25maWcudGltZW91dCArICdtcyBleGNlZWRlZCcsIGNvbmZpZywgJ0VDT05OQUJPUlRFRCcsXG4gICAgICAgIHJlcXVlc3QpKTtcblxuICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgcmVxdWVzdCA9IG51bGw7XG4gICAgfTtcblxuICAgIC8vIEFkZCB4c3JmIGhlYWRlclxuICAgIC8vIFRoaXMgaXMgb25seSBkb25lIGlmIHJ1bm5pbmcgaW4gYSBzdGFuZGFyZCBicm93c2VyIGVudmlyb25tZW50LlxuICAgIC8vIFNwZWNpZmljYWxseSBub3QgaWYgd2UncmUgaW4gYSB3ZWIgd29ya2VyLCBvciByZWFjdC1uYXRpdmUuXG4gICAgaWYgKHV0aWxzLmlzU3RhbmRhcmRCcm93c2VyRW52KCkpIHtcbiAgICAgIHZhciBjb29raWVzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2Nvb2tpZXMnKTtcblxuICAgICAgLy8gQWRkIHhzcmYgaGVhZGVyXG4gICAgICB2YXIgeHNyZlZhbHVlID0gKGNvbmZpZy53aXRoQ3JlZGVudGlhbHMgfHwgaXNVUkxTYW1lT3JpZ2luKGNvbmZpZy51cmwpKSAmJiBjb25maWcueHNyZkNvb2tpZU5hbWUgP1xuICAgICAgICAgIGNvb2tpZXMucmVhZChjb25maWcueHNyZkNvb2tpZU5hbWUpIDpcbiAgICAgICAgICB1bmRlZmluZWQ7XG5cbiAgICAgIGlmICh4c3JmVmFsdWUpIHtcbiAgICAgICAgcmVxdWVzdEhlYWRlcnNbY29uZmlnLnhzcmZIZWFkZXJOYW1lXSA9IHhzcmZWYWx1ZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBBZGQgaGVhZGVycyB0byB0aGUgcmVxdWVzdFxuICAgIGlmICgnc2V0UmVxdWVzdEhlYWRlcicgaW4gcmVxdWVzdCkge1xuICAgICAgdXRpbHMuZm9yRWFjaChyZXF1ZXN0SGVhZGVycywgZnVuY3Rpb24gc2V0UmVxdWVzdEhlYWRlcih2YWwsIGtleSkge1xuICAgICAgICBpZiAodHlwZW9mIHJlcXVlc3REYXRhID09PSAndW5kZWZpbmVkJyAmJiBrZXkudG9Mb3dlckNhc2UoKSA9PT0gJ2NvbnRlbnQtdHlwZScpIHtcbiAgICAgICAgICAvLyBSZW1vdmUgQ29udGVudC1UeXBlIGlmIGRhdGEgaXMgdW5kZWZpbmVkXG4gICAgICAgICAgZGVsZXRlIHJlcXVlc3RIZWFkZXJzW2tleV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gT3RoZXJ3aXNlIGFkZCBoZWFkZXIgdG8gdGhlIHJlcXVlc3RcbiAgICAgICAgICByZXF1ZXN0LnNldFJlcXVlc3RIZWFkZXIoa2V5LCB2YWwpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBBZGQgd2l0aENyZWRlbnRpYWxzIHRvIHJlcXVlc3QgaWYgbmVlZGVkXG4gICAgaWYgKGNvbmZpZy53aXRoQ3JlZGVudGlhbHMpIHtcbiAgICAgIHJlcXVlc3Qud2l0aENyZWRlbnRpYWxzID0gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBBZGQgcmVzcG9uc2VUeXBlIHRvIHJlcXVlc3QgaWYgbmVlZGVkXG4gICAgaWYgKGNvbmZpZy5yZXNwb25zZVR5cGUpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIHJlcXVlc3QucmVzcG9uc2VUeXBlID0gY29uZmlnLnJlc3BvbnNlVHlwZTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgLy8gRXhwZWN0ZWQgRE9NRXhjZXB0aW9uIHRocm93biBieSBicm93c2VycyBub3QgY29tcGF0aWJsZSBYTUxIdHRwUmVxdWVzdCBMZXZlbCAyLlxuICAgICAgICAvLyBCdXQsIHRoaXMgY2FuIGJlIHN1cHByZXNzZWQgZm9yICdqc29uJyB0eXBlIGFzIGl0IGNhbiBiZSBwYXJzZWQgYnkgZGVmYXVsdCAndHJhbnNmb3JtUmVzcG9uc2UnIGZ1bmN0aW9uLlxuICAgICAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSAhPT0gJ2pzb24nKSB7XG4gICAgICAgICAgdGhyb3cgZTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEhhbmRsZSBwcm9ncmVzcyBpZiBuZWVkZWRcbiAgICBpZiAodHlwZW9mIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIHJlcXVlc3QuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25Eb3dubG9hZFByb2dyZXNzKTtcbiAgICB9XG5cbiAgICAvLyBOb3QgYWxsIGJyb3dzZXJzIHN1cHBvcnQgdXBsb2FkIGV2ZW50c1xuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uVXBsb2FkUHJvZ3Jlc3MgPT09ICdmdW5jdGlvbicgJiYgcmVxdWVzdC51cGxvYWQpIHtcbiAgICAgIHJlcXVlc3QudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoJ3Byb2dyZXNzJywgY29uZmlnLm9uVXBsb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIGlmIChjb25maWcuY2FuY2VsVG9rZW4pIHtcbiAgICAgIC8vIEhhbmRsZSBjYW5jZWxsYXRpb25cbiAgICAgIGNvbmZpZy5jYW5jZWxUb2tlbi5wcm9taXNlLnRoZW4oZnVuY3Rpb24gb25DYW5jZWxlZChjYW5jZWwpIHtcbiAgICAgICAgaWYgKCFyZXF1ZXN0KSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgcmVxdWVzdC5hYm9ydCgpO1xuICAgICAgICByZWplY3QoY2FuY2VsKTtcbiAgICAgICAgLy8gQ2xlYW4gdXAgcmVxdWVzdFxuICAgICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChyZXF1ZXN0RGF0YSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXF1ZXN0RGF0YSA9IG51bGw7XG4gICAgfVxuXG4gICAgLy8gU2VuZCB0aGUgcmVxdWVzdFxuICAgIHJlcXVlc3Quc2VuZChyZXF1ZXN0RGF0YSk7XG4gIH0pO1xufTtcblxufSkuY2FsbCh0aGlzLHJlcXVpcmUoJ19wcm9jZXNzJykpXG5cbn0se1wiLi4vY29yZS9jcmVhdGVFcnJvclwiOjE4LFwiLi8uLi9jb3JlL3NldHRsZVwiOjIxLFwiLi8uLi9oZWxwZXJzL2J0b2FcIjoyNSxcIi4vLi4vaGVscGVycy9idWlsZFVSTFwiOjI2LFwiLi8uLi9oZWxwZXJzL2Nvb2tpZXNcIjoyOCxcIi4vLi4vaGVscGVycy9pc1VSTFNhbWVPcmlnaW5cIjozMCxcIi4vLi4vaGVscGVycy9wYXJzZUhlYWRlcnNcIjozMixcIi4vLi4vdXRpbHNcIjozNCxcIl9wcm9jZXNzXCI6Mzd9XSwxMjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcbnZhciBBeGlvcyA9IHJlcXVpcmUoJy4vY29yZS9BeGlvcycpO1xudmFyIGRlZmF1bHRzID0gcmVxdWlyZSgnLi9kZWZhdWx0cycpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBpbnN0YW5jZSBvZiBBeGlvc1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBkZWZhdWx0Q29uZmlnIFRoZSBkZWZhdWx0IGNvbmZpZyBmb3IgdGhlIGluc3RhbmNlXG4gKiBAcmV0dXJuIHtBeGlvc30gQSBuZXcgaW5zdGFuY2Ugb2YgQXhpb3NcbiAqL1xuZnVuY3Rpb24gY3JlYXRlSW5zdGFuY2UoZGVmYXVsdENvbmZpZykge1xuICB2YXIgY29udGV4dCA9IG5ldyBBeGlvcyhkZWZhdWx0Q29uZmlnKTtcbiAgdmFyIGluc3RhbmNlID0gYmluZChBeGlvcy5wcm90b3R5cGUucmVxdWVzdCwgY29udGV4dCk7XG5cbiAgLy8gQ29weSBheGlvcy5wcm90b3R5cGUgdG8gaW5zdGFuY2VcbiAgdXRpbHMuZXh0ZW5kKGluc3RhbmNlLCBBeGlvcy5wcm90b3R5cGUsIGNvbnRleHQpO1xuXG4gIC8vIENvcHkgY29udGV4dCB0byBpbnN0YW5jZVxuICB1dGlscy5leHRlbmQoaW5zdGFuY2UsIGNvbnRleHQpO1xuXG4gIHJldHVybiBpbnN0YW5jZTtcbn1cblxuLy8gQ3JlYXRlIHRoZSBkZWZhdWx0IGluc3RhbmNlIHRvIGJlIGV4cG9ydGVkXG52YXIgYXhpb3MgPSBjcmVhdGVJbnN0YW5jZShkZWZhdWx0cyk7XG5cbi8vIEV4cG9zZSBBeGlvcyBjbGFzcyB0byBhbGxvdyBjbGFzcyBpbmhlcml0YW5jZVxuYXhpb3MuQXhpb3MgPSBBeGlvcztcblxuLy8gRmFjdG9yeSBmb3IgY3JlYXRpbmcgbmV3IGluc3RhbmNlc1xuYXhpb3MuY3JlYXRlID0gZnVuY3Rpb24gY3JlYXRlKGluc3RhbmNlQ29uZmlnKSB7XG4gIHJldHVybiBjcmVhdGVJbnN0YW5jZSh1dGlscy5tZXJnZShkZWZhdWx0cywgaW5zdGFuY2VDb25maWcpKTtcbn07XG5cbi8vIEV4cG9zZSBDYW5jZWwgJiBDYW5jZWxUb2tlblxuYXhpb3MuQ2FuY2VsID0gcmVxdWlyZSgnLi9jYW5jZWwvQ2FuY2VsJyk7XG5heGlvcy5DYW5jZWxUb2tlbiA9IHJlcXVpcmUoJy4vY2FuY2VsL0NhbmNlbFRva2VuJyk7XG5heGlvcy5pc0NhbmNlbCA9IHJlcXVpcmUoJy4vY2FuY2VsL2lzQ2FuY2VsJyk7XG5cbi8vIEV4cG9zZSBhbGwvc3ByZWFkXG5heGlvcy5hbGwgPSBmdW5jdGlvbiBhbGwocHJvbWlzZXMpIHtcbiAgcmV0dXJuIFByb21pc2UuYWxsKHByb21pc2VzKTtcbn07XG5heGlvcy5zcHJlYWQgPSByZXF1aXJlKCcuL2hlbHBlcnMvc3ByZWFkJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gYXhpb3M7XG5cbi8vIEFsbG93IHVzZSBvZiBkZWZhdWx0IGltcG9ydCBzeW50YXggaW4gVHlwZVNjcmlwdFxubW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IGF4aW9zO1xuXG59LHtcIi4vY2FuY2VsL0NhbmNlbFwiOjEzLFwiLi9jYW5jZWwvQ2FuY2VsVG9rZW5cIjoxNCxcIi4vY2FuY2VsL2lzQ2FuY2VsXCI6MTUsXCIuL2NvcmUvQXhpb3NcIjoxNixcIi4vZGVmYXVsdHNcIjoyMyxcIi4vaGVscGVycy9iaW5kXCI6MjQsXCIuL2hlbHBlcnMvc3ByZWFkXCI6MzMsXCIuL3V0aWxzXCI6MzR9XSwxMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogQSBgQ2FuY2VsYCBpcyBhbiBvYmplY3QgdGhhdCBpcyB0aHJvd24gd2hlbiBhbiBvcGVyYXRpb24gaXMgY2FuY2VsZWQuXG4gKlxuICogQGNsYXNzXG4gKiBAcGFyYW0ge3N0cmluZz19IG1lc3NhZ2UgVGhlIG1lc3NhZ2UuXG4gKi9cbmZ1bmN0aW9uIENhbmNlbChtZXNzYWdlKSB7XG4gIHRoaXMubWVzc2FnZSA9IG1lc3NhZ2U7XG59XG5cbkNhbmNlbC5wcm90b3R5cGUudG9TdHJpbmcgPSBmdW5jdGlvbiB0b1N0cmluZygpIHtcbiAgcmV0dXJuICdDYW5jZWwnICsgKHRoaXMubWVzc2FnZSA/ICc6ICcgKyB0aGlzLm1lc3NhZ2UgOiAnJyk7XG59O1xuXG5DYW5jZWwucHJvdG90eXBlLl9fQ0FOQ0VMX18gPSB0cnVlO1xuXG5tb2R1bGUuZXhwb3J0cyA9IENhbmNlbDtcblxufSx7fV0sMTQ6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgQ2FuY2VsID0gcmVxdWlyZSgnLi9DYW5jZWwnKTtcblxuLyoqXG4gKiBBIGBDYW5jZWxUb2tlbmAgaXMgYW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gcmVxdWVzdCBjYW5jZWxsYXRpb24gb2YgYW4gb3BlcmF0aW9uLlxuICpcbiAqIEBjbGFzc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gZXhlY3V0b3IgVGhlIGV4ZWN1dG9yIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBDYW5jZWxUb2tlbihleGVjdXRvcikge1xuICBpZiAodHlwZW9mIGV4ZWN1dG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO1xuICB9XG5cbiAgdmFyIHJlc29sdmVQcm9taXNlO1xuICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlRXhlY3V0b3IocmVzb2x2ZSkge1xuICAgIHJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcbiAgfSk7XG5cbiAgdmFyIHRva2VuID0gdGhpcztcbiAgZXhlY3V0b3IoZnVuY3Rpb24gY2FuY2VsKG1lc3NhZ2UpIHtcbiAgICBpZiAodG9rZW4ucmVhc29uKSB7XG4gICAgICAvLyBDYW5jZWxsYXRpb24gaGFzIGFscmVhZHkgYmVlbiByZXF1ZXN0ZWRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0b2tlbi5yZWFzb24gPSBuZXcgQ2FuY2VsKG1lc3NhZ2UpO1xuICAgIHJlc29sdmVQcm9taXNlKHRva2VuLnJlYXNvbik7XG4gIH0pO1xufVxuXG4vKipcbiAqIFRocm93cyBhIGBDYW5jZWxgIGlmIGNhbmNlbGxhdGlvbiBoYXMgYmVlbiByZXF1ZXN0ZWQuXG4gKi9cbkNhbmNlbFRva2VuLnByb3RvdHlwZS50aHJvd0lmUmVxdWVzdGVkID0gZnVuY3Rpb24gdGhyb3dJZlJlcXVlc3RlZCgpIHtcbiAgaWYgKHRoaXMucmVhc29uKSB7XG4gICAgdGhyb3cgdGhpcy5yZWFzb247XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhIG5ldyBgQ2FuY2VsVG9rZW5gIGFuZCBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLFxuICogY2FuY2VscyB0aGUgYENhbmNlbFRva2VuYC5cbiAqL1xuQ2FuY2VsVG9rZW4uc291cmNlID0gZnVuY3Rpb24gc291cmNlKCkge1xuICB2YXIgY2FuY2VsO1xuICB2YXIgdG9rZW4gPSBuZXcgQ2FuY2VsVG9rZW4oZnVuY3Rpb24gZXhlY3V0b3IoYykge1xuICAgIGNhbmNlbCA9IGM7XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIHRva2VuOiB0b2tlbixcbiAgICBjYW5jZWw6IGNhbmNlbFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYW5jZWxUb2tlbjtcblxufSx7XCIuL0NhbmNlbFwiOjEzfV0sMTU6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGlzQ2FuY2VsKHZhbHVlKSB7XG4gIHJldHVybiAhISh2YWx1ZSAmJiB2YWx1ZS5fX0NBTkNFTF9fKTtcbn07XG5cbn0se31dLDE2OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIGRlZmF1bHRzID0gcmVxdWlyZSgnLi8uLi9kZWZhdWx0cycpO1xudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xudmFyIEludGVyY2VwdG9yTWFuYWdlciA9IHJlcXVpcmUoJy4vSW50ZXJjZXB0b3JNYW5hZ2VyJyk7XG52YXIgZGlzcGF0Y2hSZXF1ZXN0ID0gcmVxdWlyZSgnLi9kaXNwYXRjaFJlcXVlc3QnKTtcbnZhciBpc0Fic29sdXRlVVJMID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2lzQWJzb2x1dGVVUkwnKTtcbnZhciBjb21iaW5lVVJMcyA9IHJlcXVpcmUoJy4vLi4vaGVscGVycy9jb21iaW5lVVJMcycpO1xuXG4vKipcbiAqIENyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBBeGlvc1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBpbnN0YW5jZUNvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICovXG5mdW5jdGlvbiBBeGlvcyhpbnN0YW5jZUNvbmZpZykge1xuICB0aGlzLmRlZmF1bHRzID0gaW5zdGFuY2VDb25maWc7XG4gIHRoaXMuaW50ZXJjZXB0b3JzID0ge1xuICAgIHJlcXVlc3Q6IG5ldyBJbnRlcmNlcHRvck1hbmFnZXIoKSxcbiAgICByZXNwb25zZTogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpXG4gIH07XG59XG5cbi8qKlxuICogRGlzcGF0Y2ggYSByZXF1ZXN0XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHNwZWNpZmljIGZvciB0aGlzIHJlcXVlc3QgKG1lcmdlZCB3aXRoIHRoaXMuZGVmYXVsdHMpXG4gKi9cbkF4aW9zLnByb3RvdHlwZS5yZXF1ZXN0ID0gZnVuY3Rpb24gcmVxdWVzdChjb25maWcpIHtcbiAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gIC8vIEFsbG93IGZvciBheGlvcygnZXhhbXBsZS91cmwnWywgY29uZmlnXSkgYSBsYSBmZXRjaCBBUElcbiAgaWYgKHR5cGVvZiBjb25maWcgPT09ICdzdHJpbmcnKSB7XG4gICAgY29uZmlnID0gdXRpbHMubWVyZ2Uoe1xuICAgICAgdXJsOiBhcmd1bWVudHNbMF1cbiAgICB9LCBhcmd1bWVudHNbMV0pO1xuICB9XG5cbiAgY29uZmlnID0gdXRpbHMubWVyZ2UoZGVmYXVsdHMsIHRoaXMuZGVmYXVsdHMsIHsgbWV0aG9kOiAnZ2V0JyB9LCBjb25maWcpO1xuICBjb25maWcubWV0aG9kID0gY29uZmlnLm1ldGhvZC50b0xvd2VyQ2FzZSgpO1xuXG4gIC8vIFN1cHBvcnQgYmFzZVVSTCBjb25maWdcbiAgaWYgKGNvbmZpZy5iYXNlVVJMICYmICFpc0Fic29sdXRlVVJMKGNvbmZpZy51cmwpKSB7XG4gICAgY29uZmlnLnVybCA9IGNvbWJpbmVVUkxzKGNvbmZpZy5iYXNlVVJMLCBjb25maWcudXJsKTtcbiAgfVxuXG4gIC8vIEhvb2sgdXAgaW50ZXJjZXB0b3JzIG1pZGRsZXdhcmVcbiAgdmFyIGNoYWluID0gW2Rpc3BhdGNoUmVxdWVzdCwgdW5kZWZpbmVkXTtcbiAgdmFyIHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoY29uZmlnKTtcblxuICB0aGlzLmludGVyY2VwdG9ycy5yZXF1ZXN0LmZvckVhY2goZnVuY3Rpb24gdW5zaGlmdFJlcXVlc3RJbnRlcmNlcHRvcnMoaW50ZXJjZXB0b3IpIHtcbiAgICBjaGFpbi51bnNoaWZ0KGludGVyY2VwdG9yLmZ1bGZpbGxlZCwgaW50ZXJjZXB0b3IucmVqZWN0ZWQpO1xuICB9KTtcblxuICB0aGlzLmludGVyY2VwdG9ycy5yZXNwb25zZS5mb3JFYWNoKGZ1bmN0aW9uIHB1c2hSZXNwb25zZUludGVyY2VwdG9ycyhpbnRlcmNlcHRvcikge1xuICAgIGNoYWluLnB1c2goaW50ZXJjZXB0b3IuZnVsZmlsbGVkLCBpbnRlcmNlcHRvci5yZWplY3RlZCk7XG4gIH0pO1xuXG4gIHdoaWxlIChjaGFpbi5sZW5ndGgpIHtcbiAgICBwcm9taXNlID0gcHJvbWlzZS50aGVuKGNoYWluLnNoaWZ0KCksIGNoYWluLnNoaWZ0KCkpO1xuICB9XG5cbiAgcmV0dXJuIHByb21pc2U7XG59O1xuXG4vLyBQcm92aWRlIGFsaWFzZXMgZm9yIHN1cHBvcnRlZCByZXF1ZXN0IG1ldGhvZHNcbnV0aWxzLmZvckVhY2goWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAnb3B0aW9ucyddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kTm9EYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1dGlscy5tZXJnZShjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmxcbiAgICB9KSk7XG4gIH07XG59KTtcblxudXRpbHMuZm9yRWFjaChbJ3Bvc3QnLCAncHV0JywgJ3BhdGNoJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2RXaXRoRGF0YShtZXRob2QpIHtcbiAgLyplc2xpbnQgZnVuYy1uYW1lczowKi9cbiAgQXhpb3MucHJvdG90eXBlW21ldGhvZF0gPSBmdW5jdGlvbih1cmwsIGRhdGEsIGNvbmZpZykge1xuICAgIHJldHVybiB0aGlzLnJlcXVlc3QodXRpbHMubWVyZ2UoY29uZmlnIHx8IHt9LCB7XG4gICAgICBtZXRob2Q6IG1ldGhvZCxcbiAgICAgIHVybDogdXJsLFxuICAgICAgZGF0YTogZGF0YVxuICAgIH0pKTtcbiAgfTtcbn0pO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEF4aW9zO1xuXG59LHtcIi4vLi4vZGVmYXVsdHNcIjoyMyxcIi4vLi4vaGVscGVycy9jb21iaW5lVVJMc1wiOjI3LFwiLi8uLi9oZWxwZXJzL2lzQWJzb2x1dGVVUkxcIjoyOSxcIi4vLi4vdXRpbHNcIjozNCxcIi4vSW50ZXJjZXB0b3JNYW5hZ2VyXCI6MTcsXCIuL2Rpc3BhdGNoUmVxdWVzdFwiOjE5fV0sMTc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbmZ1bmN0aW9uIEludGVyY2VwdG9yTWFuYWdlcigpIHtcbiAgdGhpcy5oYW5kbGVycyA9IFtdO1xufVxuXG4vKipcbiAqIEFkZCBhIG5ldyBpbnRlcmNlcHRvciB0byB0aGUgc3RhY2tcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmdWxmaWxsZWQgVGhlIGZ1bmN0aW9uIHRvIGhhbmRsZSBgdGhlbmAgZm9yIGEgYFByb21pc2VgXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWplY3RlZCBUaGUgZnVuY3Rpb24gdG8gaGFuZGxlIGByZWplY3RgIGZvciBhIGBQcm9taXNlYFxuICpcbiAqIEByZXR1cm4ge051bWJlcn0gQW4gSUQgdXNlZCB0byByZW1vdmUgaW50ZXJjZXB0b3IgbGF0ZXJcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS51c2UgPSBmdW5jdGlvbiB1c2UoZnVsZmlsbGVkLCByZWplY3RlZCkge1xuICB0aGlzLmhhbmRsZXJzLnB1c2goe1xuICAgIGZ1bGZpbGxlZDogZnVsZmlsbGVkLFxuICAgIHJlamVjdGVkOiByZWplY3RlZFxuICB9KTtcbiAgcmV0dXJuIHRoaXMuaGFuZGxlcnMubGVuZ3RoIC0gMTtcbn07XG5cbi8qKlxuICogUmVtb3ZlIGFuIGludGVyY2VwdG9yIGZyb20gdGhlIHN0YWNrXG4gKlxuICogQHBhcmFtIHtOdW1iZXJ9IGlkIFRoZSBJRCB0aGF0IHdhcyByZXR1cm5lZCBieSBgdXNlYFxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLmVqZWN0ID0gZnVuY3Rpb24gZWplY3QoaWQpIHtcbiAgaWYgKHRoaXMuaGFuZGxlcnNbaWRdKSB7XG4gICAgdGhpcy5oYW5kbGVyc1tpZF0gPSBudWxsO1xuICB9XG59O1xuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbGwgdGhlIHJlZ2lzdGVyZWQgaW50ZXJjZXB0b3JzXG4gKlxuICogVGhpcyBtZXRob2QgaXMgcGFydGljdWxhcmx5IHVzZWZ1bCBmb3Igc2tpcHBpbmcgb3ZlciBhbnlcbiAqIGludGVyY2VwdG9ycyB0aGF0IG1heSBoYXZlIGJlY29tZSBgbnVsbGAgY2FsbGluZyBgZWplY3RgLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBjYWxsIGZvciBlYWNoIGludGVyY2VwdG9yXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUuZm9yRWFjaCA9IGZ1bmN0aW9uIGZvckVhY2goZm4pIHtcbiAgdXRpbHMuZm9yRWFjaCh0aGlzLmhhbmRsZXJzLCBmdW5jdGlvbiBmb3JFYWNoSGFuZGxlcihoKSB7XG4gICAgaWYgKGggIT09IG51bGwpIHtcbiAgICAgIGZuKGgpO1xuICAgIH1cbiAgfSk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEludGVyY2VwdG9yTWFuYWdlcjtcblxufSx7XCIuLy4uL3V0aWxzXCI6MzR9XSwxODpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBlbmhhbmNlRXJyb3IgPSByZXF1aXJlKCcuL2VuaGFuY2VFcnJvcicpO1xuXG4vKipcbiAqIENyZWF0ZSBhbiBFcnJvciB3aXRoIHRoZSBzcGVjaWZpZWQgbWVzc2FnZSwgY29uZmlnLCBlcnJvciBjb2RlLCByZXF1ZXN0IGFuZCByZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0ge3N0cmluZ30gbWVzc2FnZSBUaGUgZXJyb3IgbWVzc2FnZS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBbY29kZV0gVGhlIGVycm9yIGNvZGUgKGZvciBleGFtcGxlLCAnRUNPTk5BQk9SVEVEJykuXG4gKiBAcGFyYW0ge09iamVjdH0gW3JlcXVlc3RdIFRoZSByZXF1ZXN0LlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXNwb25zZV0gVGhlIHJlc3BvbnNlLlxuICogQHJldHVybnMge0Vycm9yfSBUaGUgY3JlYXRlZCBlcnJvci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBjcmVhdGVFcnJvcihtZXNzYWdlLCBjb25maWcsIGNvZGUsIHJlcXVlc3QsIHJlc3BvbnNlKSB7XG4gIHZhciBlcnJvciA9IG5ldyBFcnJvcihtZXNzYWdlKTtcbiAgcmV0dXJuIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSk7XG59O1xuXG59LHtcIi4vZW5oYW5jZUVycm9yXCI6MjB9XSwxOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciB0cmFuc2Zvcm1EYXRhID0gcmVxdWlyZSgnLi90cmFuc2Zvcm1EYXRhJyk7XG52YXIgaXNDYW5jZWwgPSByZXF1aXJlKCcuLi9jYW5jZWwvaXNDYW5jZWwnKTtcbnZhciBkZWZhdWx0cyA9IHJlcXVpcmUoJy4uL2RlZmF1bHRzJyk7XG5cbi8qKlxuICogVGhyb3dzIGEgYENhbmNlbGAgaWYgY2FuY2VsbGF0aW9uIGhhcyBiZWVuIHJlcXVlc3RlZC5cbiAqL1xuZnVuY3Rpb24gdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpIHtcbiAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgIGNvbmZpZy5jYW5jZWxUb2tlbi50aHJvd0lmUmVxdWVzdGVkKCk7XG4gIH1cbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3QgdG8gdGhlIHNlcnZlciB1c2luZyB0aGUgY29uZmlndXJlZCBhZGFwdGVyLlxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBjb25maWcgVGhlIGNvbmZpZyB0aGF0IGlzIHRvIGJlIHVzZWQgZm9yIHRoZSByZXF1ZXN0XG4gKiBAcmV0dXJucyB7UHJvbWlzZX0gVGhlIFByb21pc2UgdG8gYmUgZnVsZmlsbGVkXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gZGlzcGF0Y2hSZXF1ZXN0KGNvbmZpZykge1xuICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgLy8gRW5zdXJlIGhlYWRlcnMgZXhpc3RcbiAgY29uZmlnLmhlYWRlcnMgPSBjb25maWcuaGVhZGVycyB8fCB7fTtcblxuICAvLyBUcmFuc2Zvcm0gcmVxdWVzdCBkYXRhXG4gIGNvbmZpZy5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICBjb25maWcuZGF0YSxcbiAgICBjb25maWcuaGVhZGVycyxcbiAgICBjb25maWcudHJhbnNmb3JtUmVxdWVzdFxuICApO1xuXG4gIC8vIEZsYXR0ZW4gaGVhZGVyc1xuICBjb25maWcuaGVhZGVycyA9IHV0aWxzLm1lcmdlKFxuICAgIGNvbmZpZy5oZWFkZXJzLmNvbW1vbiB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVyc1tjb25maWcubWV0aG9kXSB8fCB7fSxcbiAgICBjb25maWcuaGVhZGVycyB8fCB7fVxuICApO1xuXG4gIHV0aWxzLmZvckVhY2goXG4gICAgWydkZWxldGUnLCAnZ2V0JywgJ2hlYWQnLCAncG9zdCcsICdwdXQnLCAncGF0Y2gnLCAnY29tbW9uJ10sXG4gICAgZnVuY3Rpb24gY2xlYW5IZWFkZXJDb25maWcobWV0aG9kKSB7XG4gICAgICBkZWxldGUgY29uZmlnLmhlYWRlcnNbbWV0aG9kXTtcbiAgICB9XG4gICk7XG5cbiAgdmFyIGFkYXB0ZXIgPSBjb25maWcuYWRhcHRlciB8fCBkZWZhdWx0cy5hZGFwdGVyO1xuXG4gIHJldHVybiBhZGFwdGVyKGNvbmZpZykudGhlbihmdW5jdGlvbiBvbkFkYXB0ZXJSZXNvbHV0aW9uKHJlc3BvbnNlKSB7XG4gICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgLy8gVHJhbnNmb3JtIHJlc3BvbnNlIGRhdGFcbiAgICByZXNwb25zZS5kYXRhID0gdHJhbnNmb3JtRGF0YShcbiAgICAgIHJlc3BvbnNlLmRhdGEsXG4gICAgICByZXNwb25zZS5oZWFkZXJzLFxuICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgKTtcblxuICAgIHJldHVybiByZXNwb25zZTtcbiAgfSwgZnVuY3Rpb24gb25BZGFwdGVyUmVqZWN0aW9uKHJlYXNvbikge1xuICAgIGlmICghaXNDYW5jZWwocmVhc29uKSkge1xuICAgICAgdGhyb3dJZkNhbmNlbGxhdGlvblJlcXVlc3RlZChjb25maWcpO1xuXG4gICAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgICAgaWYgKHJlYXNvbiAmJiByZWFzb24ucmVzcG9uc2UpIHtcbiAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5kYXRhLFxuICAgICAgICAgIHJlYXNvbi5yZXNwb25zZS5oZWFkZXJzLFxuICAgICAgICAgIGNvbmZpZy50cmFuc2Zvcm1SZXNwb25zZVxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBQcm9taXNlLnJlamVjdChyZWFzb24pO1xuICB9KTtcbn07XG5cbn0se1wiLi4vY2FuY2VsL2lzQ2FuY2VsXCI6MTUsXCIuLi9kZWZhdWx0c1wiOjIzLFwiLi8uLi91dGlsc1wiOjM0LFwiLi90cmFuc2Zvcm1EYXRhXCI6MjJ9XSwyMDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogVXBkYXRlIGFuIEVycm9yIHdpdGggdGhlIHNwZWNpZmllZCBjb25maWcsIGVycm9yIGNvZGUsIGFuZCByZXNwb25zZS5cbiAqXG4gKiBAcGFyYW0ge0Vycm9yfSBlcnJvciBUaGUgZXJyb3IgdG8gdXBkYXRlLlxuICogQHBhcmFtIHtPYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnLlxuICogQHBhcmFtIHtzdHJpbmd9IFtjb2RlXSBUaGUgZXJyb3IgY29kZSAoZm9yIGV4YW1wbGUsICdFQ09OTkFCT1JURUQnKS5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVxdWVzdF0gVGhlIHJlcXVlc3QuXG4gKiBAcGFyYW0ge09iamVjdH0gW3Jlc3BvbnNlXSBUaGUgcmVzcG9uc2UuXG4gKiBAcmV0dXJucyB7RXJyb3J9IFRoZSBlcnJvci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBlbmhhbmNlRXJyb3IoZXJyb3IsIGNvbmZpZywgY29kZSwgcmVxdWVzdCwgcmVzcG9uc2UpIHtcbiAgZXJyb3IuY29uZmlnID0gY29uZmlnO1xuICBpZiAoY29kZSkge1xuICAgIGVycm9yLmNvZGUgPSBjb2RlO1xuICB9XG4gIGVycm9yLnJlcXVlc3QgPSByZXF1ZXN0O1xuICBlcnJvci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICByZXR1cm4gZXJyb3I7XG59O1xuXG59LHt9XSwyMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciBjcmVhdGVFcnJvciA9IHJlcXVpcmUoJy4vY3JlYXRlRXJyb3InKTtcblxuLyoqXG4gKiBSZXNvbHZlIG9yIHJlamVjdCBhIFByb21pc2UgYmFzZWQgb24gcmVzcG9uc2Ugc3RhdHVzLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmUgQSBmdW5jdGlvbiB0aGF0IHJlc29sdmVzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0IEEgZnVuY3Rpb24gdGhhdCByZWplY3RzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIFRoZSByZXNwb25zZS5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCByZXNwb25zZSkge1xuICB2YXIgdmFsaWRhdGVTdGF0dXMgPSByZXNwb25zZS5jb25maWcudmFsaWRhdGVTdGF0dXM7XG4gIC8vIE5vdGU6IHN0YXR1cyBpcyBub3QgZXhwb3NlZCBieSBYRG9tYWluUmVxdWVzdFxuICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCAhdmFsaWRhdGVTdGF0dXMgfHwgdmFsaWRhdGVTdGF0dXMocmVzcG9uc2Uuc3RhdHVzKSkge1xuICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICB9IGVsc2Uge1xuICAgIHJlamVjdChjcmVhdGVFcnJvcihcbiAgICAgICdSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlICcgKyByZXNwb25zZS5zdGF0dXMsXG4gICAgICByZXNwb25zZS5jb25maWcsXG4gICAgICBudWxsLFxuICAgICAgcmVzcG9uc2UucmVxdWVzdCxcbiAgICAgIHJlc3BvbnNlXG4gICAgKSk7XG4gIH1cbn07XG5cbn0se1wiLi9jcmVhdGVFcnJvclwiOjE4fV0sMjI6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbi8qKlxuICogVHJhbnNmb3JtIHRoZSBkYXRhIGZvciBhIHJlcXVlc3Qgb3IgYSByZXNwb25zZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fFN0cmluZ30gZGF0YSBUaGUgZGF0YSB0byBiZSB0cmFuc2Zvcm1lZFxuICogQHBhcmFtIHtBcnJheX0gaGVhZGVycyBUaGUgaGVhZGVycyBmb3IgdGhlIHJlcXVlc3Qgb3IgcmVzcG9uc2VcbiAqIEBwYXJhbSB7QXJyYXl8RnVuY3Rpb259IGZucyBBIHNpbmdsZSBmdW5jdGlvbiBvciBBcnJheSBvZiBmdW5jdGlvbnNcbiAqIEByZXR1cm5zIHsqfSBUaGUgcmVzdWx0aW5nIHRyYW5zZm9ybWVkIGRhdGFcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiB0cmFuc2Zvcm1EYXRhKGRhdGEsIGhlYWRlcnMsIGZucykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgdXRpbHMuZm9yRWFjaChmbnMsIGZ1bmN0aW9uIHRyYW5zZm9ybShmbikge1xuICAgIGRhdGEgPSBmbihkYXRhLCBoZWFkZXJzKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGRhdGE7XG59O1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDIzOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbihmdW5jdGlvbiAocHJvY2Vzcyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbnZhciBub3JtYWxpemVIZWFkZXJOYW1lID0gcmVxdWlyZSgnLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUnKTtcblxudmFyIERFRkFVTFRfQ09OVEVOVF9UWVBFID0ge1xuICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbn07XG5cbmZ1bmN0aW9uIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCB2YWx1ZSkge1xuICBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnMpICYmIHV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddKSkge1xuICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gdmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdEFkYXB0ZXIoKSB7XG4gIHZhciBhZGFwdGVyO1xuICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIEZvciBicm93c2VycyB1c2UgWEhSIGFkYXB0ZXJcbiAgICBhZGFwdGVyID0gcmVxdWlyZSgnLi9hZGFwdGVycy94aHInKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBGb3Igbm9kZSB1c2UgSFRUUCBhZGFwdGVyXG4gICAgYWRhcHRlciA9IHJlcXVpcmUoJy4vYWRhcHRlcnMvaHR0cCcpO1xuICB9XG4gIHJldHVybiBhZGFwdGVyO1xufVxuXG52YXIgZGVmYXVsdHMgPSB7XG4gIGFkYXB0ZXI6IGdldERlZmF1bHRBZGFwdGVyKCksXG5cbiAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uIHRyYW5zZm9ybVJlcXVlc3QoZGF0YSwgaGVhZGVycykge1xuICAgIG5vcm1hbGl6ZUhlYWRlck5hbWUoaGVhZGVycywgJ0NvbnRlbnQtVHlwZScpO1xuICAgIGlmICh1dGlscy5pc0Zvcm1EYXRhKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0FycmF5QnVmZmVyKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0J1ZmZlcihkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNTdHJlYW0oZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzRmlsZShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNCbG9iKGRhdGEpXG4gICAgKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzQXJyYXlCdWZmZXJWaWV3KGRhdGEpKSB7XG4gICAgICByZXR1cm4gZGF0YS5idWZmZXI7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc1VSTFNlYXJjaFBhcmFtcyhkYXRhKSkge1xuICAgICAgc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIGRhdGEudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfV0sXG5cbiAgdHJhbnNmb3JtUmVzcG9uc2U6IFtmdW5jdGlvbiB0cmFuc2Zvcm1SZXNwb25zZShkYXRhKSB7XG4gICAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICB9IGNhdGNoIChlKSB7IC8qIElnbm9yZSAqLyB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XSxcblxuICB0aW1lb3V0OiAwLFxuXG4gIHhzcmZDb29raWVOYW1lOiAnWFNSRi1UT0tFTicsXG4gIHhzcmZIZWFkZXJOYW1lOiAnWC1YU1JGLVRPS0VOJyxcblxuICBtYXhDb250ZW50TGVuZ3RoOiAtMSxcblxuICB2YWxpZGF0ZVN0YXR1czogZnVuY3Rpb24gdmFsaWRhdGVTdGF0dXMoc3RhdHVzKSB7XG4gICAgcmV0dXJuIHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwO1xuICB9XG59O1xuXG5kZWZhdWx0cy5oZWFkZXJzID0ge1xuICBjb21tb246IHtcbiAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKidcbiAgfVxufTtcblxudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kTm9EYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB7fTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB1dGlscy5tZXJnZShERUZBVUxUX0NPTlRFTlRfVFlQRSk7XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBkZWZhdWx0cztcblxufSkuY2FsbCh0aGlzLHJlcXVpcmUoJ19wcm9jZXNzJykpXG5cbn0se1wiLi9hZGFwdGVycy9odHRwXCI6MTEsXCIuL2FkYXB0ZXJzL3hoclwiOjExLFwiLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWVcIjozMSxcIi4vdXRpbHNcIjozNCxcIl9wcm9jZXNzXCI6Mzd9XSwyNDpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYmluZChmbiwgdGhpc0FyZykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcCgpIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoKTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIGFyZ3NbaV0gPSBhcmd1bWVudHNbaV07XG4gICAgfVxuICAgIHJldHVybiBmbi5hcHBseSh0aGlzQXJnLCBhcmdzKTtcbiAgfTtcbn07XG5cbn0se31dLDI1OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLy8gYnRvYSBwb2x5ZmlsbCBmb3IgSUU8MTAgY291cnRlc3kgaHR0cHM6Ly9naXRodWIuY29tL2RhdmlkY2hhbWJlcnMvQmFzZTY0LmpzXG5cbnZhciBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG5cbmZ1bmN0aW9uIEUoKSB7XG4gIHRoaXMubWVzc2FnZSA9ICdTdHJpbmcgY29udGFpbnMgYW4gaW52YWxpZCBjaGFyYWN0ZXInO1xufVxuRS5wcm90b3R5cGUgPSBuZXcgRXJyb3I7XG5FLnByb3RvdHlwZS5jb2RlID0gNTtcbkUucHJvdG90eXBlLm5hbWUgPSAnSW52YWxpZENoYXJhY3RlckVycm9yJztcblxuZnVuY3Rpb24gYnRvYShpbnB1dCkge1xuICB2YXIgc3RyID0gU3RyaW5nKGlucHV0KTtcbiAgdmFyIG91dHB1dCA9ICcnO1xuICBmb3IgKFxuICAgIC8vIGluaXRpYWxpemUgcmVzdWx0IGFuZCBjb3VudGVyXG4gICAgdmFyIGJsb2NrLCBjaGFyQ29kZSwgaWR4ID0gMCwgbWFwID0gY2hhcnM7XG4gICAgLy8gaWYgdGhlIG5leHQgc3RyIGluZGV4IGRvZXMgbm90IGV4aXN0OlxuICAgIC8vICAgY2hhbmdlIHRoZSBtYXBwaW5nIHRhYmxlIHRvIFwiPVwiXG4gICAgLy8gICBjaGVjayBpZiBkIGhhcyBubyBmcmFjdGlvbmFsIGRpZ2l0c1xuICAgIHN0ci5jaGFyQXQoaWR4IHwgMCkgfHwgKG1hcCA9ICc9JywgaWR4ICUgMSk7XG4gICAgLy8gXCI4IC0gaWR4ICUgMSAqIDhcIiBnZW5lcmF0ZXMgdGhlIHNlcXVlbmNlIDIsIDQsIDYsIDhcbiAgICBvdXRwdXQgKz0gbWFwLmNoYXJBdCg2MyAmIGJsb2NrID4+IDggLSBpZHggJSAxICogOClcbiAgKSB7XG4gICAgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpZHggKz0gMyAvIDQpO1xuICAgIGlmIChjaGFyQ29kZSA+IDB4RkYpIHtcbiAgICAgIHRocm93IG5ldyBFKCk7XG4gICAgfVxuICAgIGJsb2NrID0gYmxvY2sgPDwgOCB8IGNoYXJDb2RlO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnRvYTtcblxufSx7fV0sMjY6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbmZ1bmN0aW9uIGVuY29kZSh2YWwpIHtcbiAgcmV0dXJuIGVuY29kZVVSSUNvbXBvbmVudCh2YWwpLlxuICAgIHJlcGxhY2UoLyU0MC9naSwgJ0AnKS5cbiAgICByZXBsYWNlKC8lM0EvZ2ksICc6JykuXG4gICAgcmVwbGFjZSgvJTI0L2csICckJykuXG4gICAgcmVwbGFjZSgvJTJDL2dpLCAnLCcpLlxuICAgIHJlcGxhY2UoLyUyMC9nLCAnKycpLlxuICAgIHJlcGxhY2UoLyU1Qi9naSwgJ1snKS5cbiAgICByZXBsYWNlKC8lNUQvZ2ksICddJyk7XG59XG5cbi8qKlxuICogQnVpbGQgYSBVUkwgYnkgYXBwZW5kaW5nIHBhcmFtcyB0byB0aGUgZW5kXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgYmFzZSBvZiB0aGUgdXJsIChlLmcuLCBodHRwOi8vd3d3Lmdvb2dsZS5jb20pXG4gKiBAcGFyYW0ge29iamVjdH0gW3BhcmFtc10gVGhlIHBhcmFtcyB0byBiZSBhcHBlbmRlZFxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGZvcm1hdHRlZCB1cmxcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBidWlsZFVSTCh1cmwsIHBhcmFtcywgcGFyYW1zU2VyaWFsaXplcikge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgaWYgKCFwYXJhbXMpIHtcbiAgICByZXR1cm4gdXJsO1xuICB9XG5cbiAgdmFyIHNlcmlhbGl6ZWRQYXJhbXM7XG4gIGlmIChwYXJhbXNTZXJpYWxpemVyKSB7XG4gICAgc2VyaWFsaXplZFBhcmFtcyA9IHBhcmFtc1NlcmlhbGl6ZXIocGFyYW1zKTtcbiAgfSBlbHNlIGlmICh1dGlscy5pc1VSTFNlYXJjaFBhcmFtcyhwYXJhbXMpKSB7XG4gICAgc2VyaWFsaXplZFBhcmFtcyA9IHBhcmFtcy50b1N0cmluZygpO1xuICB9IGVsc2Uge1xuICAgIHZhciBwYXJ0cyA9IFtdO1xuXG4gICAgdXRpbHMuZm9yRWFjaChwYXJhbXMsIGZ1bmN0aW9uIHNlcmlhbGl6ZSh2YWwsIGtleSkge1xuICAgICAgaWYgKHZhbCA9PT0gbnVsbCB8fCB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJykge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG5cbiAgICAgIGlmICh1dGlscy5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAga2V5ID0ga2V5ICsgJ1tdJztcbiAgICAgIH1cblxuICAgICAgaWYgKCF1dGlscy5pc0FycmF5KHZhbCkpIHtcbiAgICAgICAgdmFsID0gW3ZhbF07XG4gICAgICB9XG5cbiAgICAgIHV0aWxzLmZvckVhY2godmFsLCBmdW5jdGlvbiBwYXJzZVZhbHVlKHYpIHtcbiAgICAgICAgaWYgKHV0aWxzLmlzRGF0ZSh2KSkge1xuICAgICAgICAgIHYgPSB2LnRvSVNPU3RyaW5nKCk7XG4gICAgICAgIH0gZWxzZSBpZiAodXRpbHMuaXNPYmplY3QodikpIHtcbiAgICAgICAgICB2ID0gSlNPTi5zdHJpbmdpZnkodik7XG4gICAgICAgIH1cbiAgICAgICAgcGFydHMucHVzaChlbmNvZGUoa2V5KSArICc9JyArIGVuY29kZSh2KSk7XG4gICAgICB9KTtcbiAgICB9KTtcblxuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJ0cy5qb2luKCcmJyk7XG4gIH1cblxuICBpZiAoc2VyaWFsaXplZFBhcmFtcykge1xuICAgIHVybCArPSAodXJsLmluZGV4T2YoJz8nKSA9PT0gLTEgPyAnPycgOiAnJicpICsgc2VyaWFsaXplZFBhcmFtcztcbiAgfVxuXG4gIHJldHVybiB1cmw7XG59O1xuXG59LHtcIi4vLi4vdXRpbHNcIjozNH1dLDI3OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFVSTCBieSBjb21iaW5pbmcgdGhlIHNwZWNpZmllZCBVUkxzXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJhc2VVUkwgVGhlIGJhc2UgVVJMXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVUkwgVGhlIHJlbGF0aXZlIFVSTFxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNvbWJpbmVkIFVSTFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNvbWJpbmVVUkxzKGJhc2VVUkwsIHJlbGF0aXZlVVJMKSB7XG4gIHJldHVybiByZWxhdGl2ZVVSTFxuICAgID8gYmFzZVVSTC5yZXBsYWNlKC9cXC8rJC8sICcnKSArICcvJyArIHJlbGF0aXZlVVJMLnJlcGxhY2UoL15cXC8rLywgJycpXG4gICAgOiBiYXNlVVJMO1xufTtcblxufSx7fV0sMjg6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gKFxuICB1dGlscy5pc1N0YW5kYXJkQnJvd3NlckVudigpID9cblxuICAvLyBTdGFuZGFyZCBicm93c2VyIGVudnMgc3VwcG9ydCBkb2N1bWVudC5jb29raWVcbiAgKGZ1bmN0aW9uIHN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgd3JpdGU6IGZ1bmN0aW9uIHdyaXRlKG5hbWUsIHZhbHVlLCBleHBpcmVzLCBwYXRoLCBkb21haW4sIHNlY3VyZSkge1xuICAgICAgICB2YXIgY29va2llID0gW107XG4gICAgICAgIGNvb2tpZS5wdXNoKG5hbWUgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQodmFsdWUpKTtcblxuICAgICAgICBpZiAodXRpbHMuaXNOdW1iZXIoZXhwaXJlcykpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgnZXhwaXJlcz0nICsgbmV3IERhdGUoZXhwaXJlcykudG9HTVRTdHJpbmcoKSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXRpbHMuaXNTdHJpbmcocGF0aCkpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgncGF0aD0nICsgcGF0aCk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAodXRpbHMuaXNTdHJpbmcoZG9tYWluKSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdkb21haW49JyArIGRvbWFpbik7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc2VjdXJlID09PSB0cnVlKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ3NlY3VyZScpO1xuICAgICAgICB9XG5cbiAgICAgICAgZG9jdW1lbnQuY29va2llID0gY29va2llLmpvaW4oJzsgJyk7XG4gICAgICB9LFxuXG4gICAgICByZWFkOiBmdW5jdGlvbiByZWFkKG5hbWUpIHtcbiAgICAgICAgdmFyIG1hdGNoID0gZG9jdW1lbnQuY29va2llLm1hdGNoKG5ldyBSZWdFeHAoJyhefDtcXFxccyopKCcgKyBuYW1lICsgJyk9KFteO10qKScpKTtcbiAgICAgICAgcmV0dXJuIChtYXRjaCA/IGRlY29kZVVSSUNvbXBvbmVudChtYXRjaFszXSkgOiBudWxsKTtcbiAgICAgIH0sXG5cbiAgICAgIHJlbW92ZTogZnVuY3Rpb24gcmVtb3ZlKG5hbWUpIHtcbiAgICAgICAgdGhpcy53cml0ZShuYW1lLCAnJywgRGF0ZS5ub3coKSAtIDg2NDAwMDAwKTtcbiAgICAgIH1cbiAgICB9O1xuICB9KSgpIDpcblxuICAvLyBOb24gc3RhbmRhcmQgYnJvd3NlciBlbnYgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gIChmdW5jdGlvbiBub25TdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZSgpIHt9LFxuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZCgpIHsgcmV0dXJuIG51bGw7IH0sXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZSgpIHt9XG4gICAgfTtcbiAgfSkoKVxuKTtcblxufSx7XCIuLy4uL3V0aWxzXCI6MzR9XSwyOTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0Fic29sdXRlVVJMKHVybCkge1xuICAvLyBBIFVSTCBpcyBjb25zaWRlcmVkIGFic29sdXRlIGlmIGl0IGJlZ2lucyB3aXRoIFwiPHNjaGVtZT46Ly9cIiBvciBcIi8vXCIgKHByb3RvY29sLXJlbGF0aXZlIFVSTCkuXG4gIC8vIFJGQyAzOTg2IGRlZmluZXMgc2NoZW1lIG5hbWUgYXMgYSBzZXF1ZW5jZSBvZiBjaGFyYWN0ZXJzIGJlZ2lubmluZyB3aXRoIGEgbGV0dGVyIGFuZCBmb2xsb3dlZFxuICAvLyBieSBhbnkgY29tYmluYXRpb24gb2YgbGV0dGVycywgZGlnaXRzLCBwbHVzLCBwZXJpb2QsIG9yIGh5cGhlbi5cbiAgcmV0dXJuIC9eKFthLXpdW2EtelxcZFxcK1xcLVxcLl0qOik/XFwvXFwvL2kudGVzdCh1cmwpO1xufTtcblxufSx7fV0sMzA6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gKFxuICB1dGlscy5pc1N0YW5kYXJkQnJvd3NlckVudigpID9cblxuICAvLyBTdGFuZGFyZCBicm93c2VyIGVudnMgaGF2ZSBmdWxsIHN1cHBvcnQgb2YgdGhlIEFQSXMgbmVlZGVkIHRvIHRlc3RcbiAgLy8gd2hldGhlciB0aGUgcmVxdWVzdCBVUkwgaXMgb2YgdGhlIHNhbWUgb3JpZ2luIGFzIGN1cnJlbnQgbG9jYXRpb24uXG4gIChmdW5jdGlvbiBzdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgdmFyIG1zaWUgPSAvKG1zaWV8dHJpZGVudCkvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO1xuICAgIHZhciB1cmxQYXJzaW5nTm9kZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcbiAgICB2YXIgb3JpZ2luVVJMO1xuXG4gICAgLyoqXG4gICAgKiBQYXJzZSBhIFVSTCB0byBkaXNjb3ZlciBpdCdzIGNvbXBvbmVudHNcbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gdXJsIFRoZSBVUkwgdG8gYmUgcGFyc2VkXG4gICAgKiBAcmV0dXJucyB7T2JqZWN0fVxuICAgICovXG4gICAgZnVuY3Rpb24gcmVzb2x2ZVVSTCh1cmwpIHtcbiAgICAgIHZhciBocmVmID0gdXJsO1xuXG4gICAgICBpZiAobXNpZSkge1xuICAgICAgICAvLyBJRSBuZWVkcyBhdHRyaWJ1dGUgc2V0IHR3aWNlIHRvIG5vcm1hbGl6ZSBwcm9wZXJ0aWVzXG4gICAgICAgIHVybFBhcnNpbmdOb2RlLnNldEF0dHJpYnV0ZSgnaHJlZicsIGhyZWYpO1xuICAgICAgICBocmVmID0gdXJsUGFyc2luZ05vZGUuaHJlZjtcbiAgICAgIH1cblxuICAgICAgdXJsUGFyc2luZ05vZGUuc2V0QXR0cmlidXRlKCdocmVmJywgaHJlZik7XG5cbiAgICAgIC8vIHVybFBhcnNpbmdOb2RlIHByb3ZpZGVzIHRoZSBVcmxVdGlscyBpbnRlcmZhY2UgLSBodHRwOi8vdXJsLnNwZWMud2hhdHdnLm9yZy8jdXJsdXRpbHNcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGhyZWY6IHVybFBhcnNpbmdOb2RlLmhyZWYsXG4gICAgICAgIHByb3RvY29sOiB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbCA/IHVybFBhcnNpbmdOb2RlLnByb3RvY29sLnJlcGxhY2UoLzokLywgJycpIDogJycsXG4gICAgICAgIGhvc3Q6IHVybFBhcnNpbmdOb2RlLmhvc3QsXG4gICAgICAgIHNlYXJjaDogdXJsUGFyc2luZ05vZGUuc2VhcmNoID8gdXJsUGFyc2luZ05vZGUuc2VhcmNoLnJlcGxhY2UoL15cXD8vLCAnJykgOiAnJyxcbiAgICAgICAgaGFzaDogdXJsUGFyc2luZ05vZGUuaGFzaCA/IHVybFBhcnNpbmdOb2RlLmhhc2gucmVwbGFjZSgvXiMvLCAnJykgOiAnJyxcbiAgICAgICAgaG9zdG5hbWU6IHVybFBhcnNpbmdOb2RlLmhvc3RuYW1lLFxuICAgICAgICBwb3J0OiB1cmxQYXJzaW5nTm9kZS5wb3J0LFxuICAgICAgICBwYXRobmFtZTogKHVybFBhcnNpbmdOb2RlLnBhdGhuYW1lLmNoYXJBdCgwKSA9PT0gJy8nKSA/XG4gICAgICAgICAgICAgICAgICB1cmxQYXJzaW5nTm9kZS5wYXRobmFtZSA6XG4gICAgICAgICAgICAgICAgICAnLycgKyB1cmxQYXJzaW5nTm9kZS5wYXRobmFtZVxuICAgICAgfTtcbiAgICB9XG5cbiAgICBvcmlnaW5VUkwgPSByZXNvbHZlVVJMKHdpbmRvdy5sb2NhdGlvbi5ocmVmKTtcblxuICAgIC8qKlxuICAgICogRGV0ZXJtaW5lIGlmIGEgVVJMIHNoYXJlcyB0aGUgc2FtZSBvcmlnaW4gYXMgdGhlIGN1cnJlbnQgbG9jYXRpb25cbiAgICAqXG4gICAgKiBAcGFyYW0ge1N0cmluZ30gcmVxdWVzdFVSTCBUaGUgVVJMIHRvIHRlc3RcbiAgICAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIFVSTCBzaGFyZXMgdGhlIHNhbWUgb3JpZ2luLCBvdGhlcndpc2UgZmFsc2VcbiAgICAqL1xuICAgIHJldHVybiBmdW5jdGlvbiBpc1VSTFNhbWVPcmlnaW4ocmVxdWVzdFVSTCkge1xuICAgICAgdmFyIHBhcnNlZCA9ICh1dGlscy5pc1N0cmluZyhyZXF1ZXN0VVJMKSkgPyByZXNvbHZlVVJMKHJlcXVlc3RVUkwpIDogcmVxdWVzdFVSTDtcbiAgICAgIHJldHVybiAocGFyc2VkLnByb3RvY29sID09PSBvcmlnaW5VUkwucHJvdG9jb2wgJiZcbiAgICAgICAgICAgIHBhcnNlZC5ob3N0ID09PSBvcmlnaW5VUkwuaG9zdCk7XG4gICAgfTtcbiAgfSkoKSA6XG5cbiAgLy8gTm9uIHN0YW5kYXJkIGJyb3dzZXIgZW52cyAod2ViIHdvcmtlcnMsIHJlYWN0LW5hdGl2ZSkgbGFjayBuZWVkZWQgc3VwcG9ydC5cbiAgKGZ1bmN0aW9uIG5vblN0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgICByZXR1cm4gZnVuY3Rpb24gaXNVUkxTYW1lT3JpZ2luKCkge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgfSkoKVxuKTtcblxufSx7XCIuLy4uL3V0aWxzXCI6MzR9XSwzMTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbm9ybWFsaXplSGVhZGVyTmFtZShoZWFkZXJzLCBub3JtYWxpemVkTmFtZSkge1xuICB1dGlscy5mb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIHByb2Nlc3NIZWFkZXIodmFsdWUsIG5hbWUpIHtcbiAgICBpZiAobmFtZSAhPT0gbm9ybWFsaXplZE5hbWUgJiYgbmFtZS50b1VwcGVyQ2FzZSgpID09PSBub3JtYWxpemVkTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICBoZWFkZXJzW25vcm1hbGl6ZWROYW1lXSA9IHZhbHVlO1xuICAgICAgZGVsZXRlIGhlYWRlcnNbbmFtZV07XG4gICAgfVxuICB9KTtcbn07XG5cbn0se1wiLi4vdXRpbHNcIjozNH1dLDMyOltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG4vKipcbiAqIFBhcnNlIGhlYWRlcnMgaW50byBhbiBvYmplY3RcbiAqXG4gKiBgYGBcbiAqIERhdGU6IFdlZCwgMjcgQXVnIDIwMTQgMDg6NTg6NDkgR01UXG4gKiBDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb25cbiAqIENvbm5lY3Rpb246IGtlZXAtYWxpdmVcbiAqIFRyYW5zZmVyLUVuY29kaW5nOiBjaHVua2VkXG4gKiBgYGBcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gaGVhZGVycyBIZWFkZXJzIG5lZWRpbmcgdG8gYmUgcGFyc2VkXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBIZWFkZXJzIHBhcnNlZCBpbnRvIGFuIG9iamVjdFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHBhcnNlSGVhZGVycyhoZWFkZXJzKSB7XG4gIHZhciBwYXJzZWQgPSB7fTtcbiAgdmFyIGtleTtcbiAgdmFyIHZhbDtcbiAgdmFyIGk7XG5cbiAgaWYgKCFoZWFkZXJzKSB7IHJldHVybiBwYXJzZWQ7IH1cblxuICB1dGlscy5mb3JFYWNoKGhlYWRlcnMuc3BsaXQoJ1xcbicpLCBmdW5jdGlvbiBwYXJzZXIobGluZSkge1xuICAgIGkgPSBsaW5lLmluZGV4T2YoJzonKTtcbiAgICBrZXkgPSB1dGlscy50cmltKGxpbmUuc3Vic3RyKDAsIGkpKS50b0xvd2VyQ2FzZSgpO1xuICAgIHZhbCA9IHV0aWxzLnRyaW0obGluZS5zdWJzdHIoaSArIDEpKTtcblxuICAgIGlmIChrZXkpIHtcbiAgICAgIHBhcnNlZFtrZXldID0gcGFyc2VkW2tleV0gPyBwYXJzZWRba2V5XSArICcsICcgKyB2YWwgOiB2YWw7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcGFyc2VkO1xufTtcblxufSx7XCIuLy4uL3V0aWxzXCI6MzR9XSwzMzpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4ndXNlIHN0cmljdCc7XG5cbi8qKlxuICogU3ludGFjdGljIHN1Z2FyIGZvciBpbnZva2luZyBhIGZ1bmN0aW9uIGFuZCBleHBhbmRpbmcgYW4gYXJyYXkgZm9yIGFyZ3VtZW50cy5cbiAqXG4gKiBDb21tb24gdXNlIGNhc2Ugd291bGQgYmUgdG8gdXNlIGBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHlgLlxuICpcbiAqICBgYGBqc1xuICogIGZ1bmN0aW9uIGYoeCwgeSwgeikge31cbiAqICB2YXIgYXJncyA9IFsxLCAyLCAzXTtcbiAqICBmLmFwcGx5KG51bGwsIGFyZ3MpO1xuICogIGBgYFxuICpcbiAqIFdpdGggYHNwcmVhZGAgdGhpcyBleGFtcGxlIGNhbiBiZSByZS13cml0dGVuLlxuICpcbiAqICBgYGBqc1xuICogIHNwcmVhZChmdW5jdGlvbih4LCB5LCB6KSB7fSkoWzEsIDIsIDNdKTtcbiAqICBgYGBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHJldHVybnMge0Z1bmN0aW9ufVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNwcmVhZChjYWxsYmFjaykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcChhcnIpIHtcbiAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkobnVsbCwgYXJyKTtcbiAgfTtcbn07XG5cbn0se31dLDM0OltmdW5jdGlvbihyZXF1aXJlLG1vZHVsZSxleHBvcnRzKXtcbid1c2Ugc3RyaWN0JztcblxudmFyIGJpbmQgPSByZXF1aXJlKCcuL2hlbHBlcnMvYmluZCcpO1xudmFyIGlzQnVmZmVyID0gcmVxdWlyZSgnaXMtYnVmZmVyJyk7XG5cbi8qZ2xvYmFsIHRvU3RyaW5nOnRydWUqL1xuXG4vLyB1dGlscyBpcyBhIGxpYnJhcnkgb2YgZ2VuZXJpYyBoZWxwZXIgZnVuY3Rpb25zIG5vbi1zcGVjaWZpYyB0byBheGlvc1xuXG52YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGFuIEFycmF5XG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gQXJyYXksIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0FycmF5KHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBBcnJheV0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGFuIEFycmF5QnVmZmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gQXJyYXlCdWZmZXIsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0FycmF5QnVmZmVyKHZhbCkge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbCh2YWwpID09PSAnW29iamVjdCBBcnJheUJ1ZmZlcl0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRm9ybURhdGFcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBGb3JtRGF0YSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRm9ybURhdGEodmFsKSB7XG4gIHJldHVybiAodHlwZW9mIEZvcm1EYXRhICE9PSAndW5kZWZpbmVkJykgJiYgKHZhbCBpbnN0YW5jZW9mIEZvcm1EYXRhKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIHZpZXcgb24gYW4gQXJyYXlCdWZmZXJcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIHZpZXcgb24gYW4gQXJyYXlCdWZmZXIsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0FycmF5QnVmZmVyVmlldyh2YWwpIHtcbiAgdmFyIHJlc3VsdDtcbiAgaWYgKCh0eXBlb2YgQXJyYXlCdWZmZXIgIT09ICd1bmRlZmluZWQnKSAmJiAoQXJyYXlCdWZmZXIuaXNWaWV3KSkge1xuICAgIHJlc3VsdCA9IEFycmF5QnVmZmVyLmlzVmlldyh2YWwpO1xuICB9IGVsc2Uge1xuICAgIHJlc3VsdCA9ICh2YWwpICYmICh2YWwuYnVmZmVyKSAmJiAodmFsLmJ1ZmZlciBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgU3RyaW5nXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBTdHJpbmcsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1N0cmluZyh2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICdzdHJpbmcnO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgTnVtYmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBOdW1iZXIsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc051bWJlcih2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICdudW1iZXInO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIHVuZGVmaW5lZFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSB2YWx1ZSBpcyB1bmRlZmluZWQsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1VuZGVmaW5lZCh2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGFuIE9iamVjdFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIE9iamVjdCwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzT2JqZWN0KHZhbCkge1xuICByZXR1cm4gdmFsICE9PSBudWxsICYmIHR5cGVvZiB2YWwgPT09ICdvYmplY3QnO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRGF0ZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgRGF0ZSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRGF0ZSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRGF0ZV0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRmlsZVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgRmlsZSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRmlsZSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRmlsZV0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgQmxvYlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgQmxvYiwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzQmxvYih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQmxvYl0nO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgRnVuY3Rpb25cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEZ1bmN0aW9uLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNGdW5jdGlvbih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFN0cmVhbVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgU3RyZWFtLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTdHJlYW0odmFsKSB7XG4gIHJldHVybiBpc09iamVjdCh2YWwpICYmIGlzRnVuY3Rpb24odmFsLnBpcGUpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiBhIHZhbHVlIGlzIGEgVVJMU2VhcmNoUGFyYW1zIG9iamVjdFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgVVJMU2VhcmNoUGFyYW1zIG9iamVjdCwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzVVJMU2VhcmNoUGFyYW1zKHZhbCkge1xuICByZXR1cm4gdHlwZW9mIFVSTFNlYXJjaFBhcmFtcyAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsIGluc3RhbmNlb2YgVVJMU2VhcmNoUGFyYW1zO1xufVxuXG4vKipcbiAqIFRyaW0gZXhjZXNzIHdoaXRlc3BhY2Ugb2ZmIHRoZSBiZWdpbm5pbmcgYW5kIGVuZCBvZiBhIHN0cmluZ1xuICpcbiAqIEBwYXJhbSB7U3RyaW5nfSBzdHIgVGhlIFN0cmluZyB0byB0cmltXG4gKiBAcmV0dXJucyB7U3RyaW5nfSBUaGUgU3RyaW5nIGZyZWVkIG9mIGV4Y2VzcyB3aGl0ZXNwYWNlXG4gKi9cbmZ1bmN0aW9uIHRyaW0oc3RyKSB7XG4gIHJldHVybiBzdHIucmVwbGFjZSgvXlxccyovLCAnJykucmVwbGFjZSgvXFxzKiQvLCAnJyk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIHdlJ3JlIHJ1bm5pbmcgaW4gYSBzdGFuZGFyZCBicm93c2VyIGVudmlyb25tZW50XG4gKlxuICogVGhpcyBhbGxvd3MgYXhpb3MgdG8gcnVuIGluIGEgd2ViIHdvcmtlciwgYW5kIHJlYWN0LW5hdGl2ZS5cbiAqIEJvdGggZW52aXJvbm1lbnRzIHN1cHBvcnQgWE1MSHR0cFJlcXVlc3QsIGJ1dCBub3QgZnVsbHkgc3RhbmRhcmQgZ2xvYmFscy5cbiAqXG4gKiB3ZWIgd29ya2VyczpcbiAqICB0eXBlb2Ygd2luZG93IC0+IHVuZGVmaW5lZFxuICogIHR5cGVvZiBkb2N1bWVudCAtPiB1bmRlZmluZWRcbiAqXG4gKiByZWFjdC1uYXRpdmU6XG4gKiAgbmF2aWdhdG9yLnByb2R1Y3QgLT4gJ1JlYWN0TmF0aXZlJ1xuICovXG5mdW5jdGlvbiBpc1N0YW5kYXJkQnJvd3NlckVudigpIHtcbiAgaWYgKHR5cGVvZiBuYXZpZ2F0b3IgIT09ICd1bmRlZmluZWQnICYmIG5hdmlnYXRvci5wcm9kdWN0ID09PSAnUmVhY3ROYXRpdmUnKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiAoXG4gICAgdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiZcbiAgICB0eXBlb2YgZG9jdW1lbnQgIT09ICd1bmRlZmluZWQnXG4gICk7XG59XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFuIEFycmF5IG9yIGFuIE9iamVjdCBpbnZva2luZyBhIGZ1bmN0aW9uIGZvciBlYWNoIGl0ZW0uXG4gKlxuICogSWYgYG9iamAgaXMgYW4gQXJyYXkgY2FsbGJhY2sgd2lsbCBiZSBjYWxsZWQgcGFzc2luZ1xuICogdGhlIHZhbHVlLCBpbmRleCwgYW5kIGNvbXBsZXRlIGFycmF5IGZvciBlYWNoIGl0ZW0uXG4gKlxuICogSWYgJ29iaicgaXMgYW4gT2JqZWN0IGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIHBhc3NpbmdcbiAqIHRoZSB2YWx1ZSwga2V5LCBhbmQgY29tcGxldGUgb2JqZWN0IGZvciBlYWNoIHByb3BlcnR5LlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fEFycmF5fSBvYmogVGhlIG9iamVjdCB0byBpdGVyYXRlXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBmbiBUaGUgY2FsbGJhY2sgdG8gaW52b2tlIGZvciBlYWNoIGl0ZW1cbiAqL1xuZnVuY3Rpb24gZm9yRWFjaChvYmosIGZuKSB7XG4gIC8vIERvbid0IGJvdGhlciBpZiBubyB2YWx1ZSBwcm92aWRlZFxuICBpZiAob2JqID09PSBudWxsIHx8IHR5cGVvZiBvYmogPT09ICd1bmRlZmluZWQnKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgLy8gRm9yY2UgYW4gYXJyYXkgaWYgbm90IGFscmVhZHkgc29tZXRoaW5nIGl0ZXJhYmxlXG4gIGlmICh0eXBlb2Ygb2JqICE9PSAnb2JqZWN0JyAmJiAhaXNBcnJheShvYmopKSB7XG4gICAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gICAgb2JqID0gW29ial07XG4gIH1cblxuICBpZiAoaXNBcnJheShvYmopKSB7XG4gICAgLy8gSXRlcmF0ZSBvdmVyIGFycmF5IHZhbHVlc1xuICAgIGZvciAodmFyIGkgPSAwLCBsID0gb2JqLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgICAgZm4uY2FsbChudWxsLCBvYmpbaV0sIGksIG9iaik7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIEl0ZXJhdGUgb3ZlciBvYmplY3Qga2V5c1xuICAgIGZvciAodmFyIGtleSBpbiBvYmopIHtcbiAgICAgIGlmIChPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqLCBrZXkpKSB7XG4gICAgICAgIGZuLmNhbGwobnVsbCwgb2JqW2tleV0sIGtleSwgb2JqKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBBY2NlcHRzIHZhcmFyZ3MgZXhwZWN0aW5nIGVhY2ggYXJndW1lbnQgdG8gYmUgYW4gb2JqZWN0LCB0aGVuXG4gKiBpbW11dGFibHkgbWVyZ2VzIHRoZSBwcm9wZXJ0aWVzIG9mIGVhY2ggb2JqZWN0IGFuZCByZXR1cm5zIHJlc3VsdC5cbiAqXG4gKiBXaGVuIG11bHRpcGxlIG9iamVjdHMgY29udGFpbiB0aGUgc2FtZSBrZXkgdGhlIGxhdGVyIG9iamVjdCBpblxuICogdGhlIGFyZ3VtZW50cyBsaXN0IHdpbGwgdGFrZSBwcmVjZWRlbmNlLlxuICpcbiAqIEV4YW1wbGU6XG4gKlxuICogYGBganNcbiAqIHZhciByZXN1bHQgPSBtZXJnZSh7Zm9vOiAxMjN9LCB7Zm9vOiA0NTZ9KTtcbiAqIGNvbnNvbGUubG9nKHJlc3VsdC5mb28pOyAvLyBvdXRwdXRzIDQ1NlxuICogYGBgXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IG9iajEgT2JqZWN0IHRvIG1lcmdlXG4gKiBAcmV0dXJucyB7T2JqZWN0fSBSZXN1bHQgb2YgYWxsIG1lcmdlIHByb3BlcnRpZXNcbiAqL1xuZnVuY3Rpb24gbWVyZ2UoLyogb2JqMSwgb2JqMiwgb2JqMywgLi4uICovKSB7XG4gIHZhciByZXN1bHQgPSB7fTtcbiAgZnVuY3Rpb24gYXNzaWduVmFsdWUodmFsLCBrZXkpIHtcbiAgICBpZiAodHlwZW9mIHJlc3VsdFtrZXldID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jykge1xuICAgICAgcmVzdWx0W2tleV0gPSBtZXJnZShyZXN1bHRba2V5XSwgdmFsKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmVzdWx0W2tleV0gPSB2YWw7XG4gICAgfVxuICB9XG5cbiAgZm9yICh2YXIgaSA9IDAsIGwgPSBhcmd1bWVudHMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG4gICAgZm9yRWFjaChhcmd1bWVudHNbaV0sIGFzc2lnblZhbHVlKTtcbiAgfVxuICByZXR1cm4gcmVzdWx0O1xufVxuXG4vKipcbiAqIEV4dGVuZHMgb2JqZWN0IGEgYnkgbXV0YWJseSBhZGRpbmcgdG8gaXQgdGhlIHByb3BlcnRpZXMgb2Ygb2JqZWN0IGIuXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGEgVGhlIG9iamVjdCB0byBiZSBleHRlbmRlZFxuICogQHBhcmFtIHtPYmplY3R9IGIgVGhlIG9iamVjdCB0byBjb3B5IHByb3BlcnRpZXMgZnJvbVxuICogQHBhcmFtIHtPYmplY3R9IHRoaXNBcmcgVGhlIG9iamVjdCB0byBiaW5kIGZ1bmN0aW9uIHRvXG4gKiBAcmV0dXJuIHtPYmplY3R9IFRoZSByZXN1bHRpbmcgdmFsdWUgb2Ygb2JqZWN0IGFcbiAqL1xuZnVuY3Rpb24gZXh0ZW5kKGEsIGIsIHRoaXNBcmcpIHtcbiAgZm9yRWFjaChiLCBmdW5jdGlvbiBhc3NpZ25WYWx1ZSh2YWwsIGtleSkge1xuICAgIGlmICh0aGlzQXJnICYmIHR5cGVvZiB2YWwgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgIGFba2V5XSA9IGJpbmQodmFsLCB0aGlzQXJnKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYVtrZXldID0gdmFsO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiBhO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaXNBcnJheTogaXNBcnJheSxcbiAgaXNBcnJheUJ1ZmZlcjogaXNBcnJheUJ1ZmZlcixcbiAgaXNCdWZmZXI6IGlzQnVmZmVyLFxuICBpc0Zvcm1EYXRhOiBpc0Zvcm1EYXRhLFxuICBpc0FycmF5QnVmZmVyVmlldzogaXNBcnJheUJ1ZmZlclZpZXcsXG4gIGlzU3RyaW5nOiBpc1N0cmluZyxcbiAgaXNOdW1iZXI6IGlzTnVtYmVyLFxuICBpc09iamVjdDogaXNPYmplY3QsXG4gIGlzVW5kZWZpbmVkOiBpc1VuZGVmaW5lZCxcbiAgaXNEYXRlOiBpc0RhdGUsXG4gIGlzRmlsZTogaXNGaWxlLFxuICBpc0Jsb2I6IGlzQmxvYixcbiAgaXNGdW5jdGlvbjogaXNGdW5jdGlvbixcbiAgaXNTdHJlYW06IGlzU3RyZWFtLFxuICBpc1VSTFNlYXJjaFBhcmFtczogaXNVUkxTZWFyY2hQYXJhbXMsXG4gIGlzU3RhbmRhcmRCcm93c2VyRW52OiBpc1N0YW5kYXJkQnJvd3NlckVudixcbiAgZm9yRWFjaDogZm9yRWFjaCxcbiAgbWVyZ2U6IG1lcmdlLFxuICBleHRlbmQ6IGV4dGVuZCxcbiAgdHJpbTogdHJpbVxufTtcblxufSx7XCIuL2hlbHBlcnMvYmluZFwiOjI0LFwiaXMtYnVmZmVyXCI6MzZ9XSwzNTpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKipcbiAqIEBsaWNlbnNlXG4gKiBGdXNlIC0gTGlnaHR3ZWlnaHQgZnV6enktc2VhcmNoXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEyLTIwMTYgS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPi5cbiAqIEFsbCBSaWdodHMgUmVzZXJ2ZWQuIEFwYWNoZSBTb2Z0d2FyZSBMaWNlbnNlIDIuMFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIilcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbjsoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAndXNlIHN0cmljdCdcblxuICAvKiogQHR5cGUge2Z1bmN0aW9uKC4uLiopfSAqL1xuICBmdW5jdGlvbiBsb2cgKCkge1xuICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cylcbiAgfVxuXG4gIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyBUaGUgbmFtZSBvZiB0aGUgaWRlbnRpZmllciBwcm9wZXJ0eS4gSWYgc3BlY2lmaWVkLCB0aGUgcmV0dXJuZWQgcmVzdWx0IHdpbGwgYmUgYSBsaXN0XG4gICAgLy8gb2YgdGhlIGl0ZW1zJyBkZW50aWZpZXJzLCBvdGhlcndpc2UgaXQgd2lsbCBiZSBhIGxpc3Qgb2YgdGhlIGl0ZW1zLlxuICAgIGlkOiBudWxsLFxuXG4gICAgLy8gSW5kaWNhdGVzIHdoZXRoZXIgY29tcGFyaXNvbnMgc2hvdWxkIGJlIGNhc2Ugc2Vuc2l0aXZlLlxuXG4gICAgY2FzZVNlbnNpdGl2ZTogZmFsc2UsXG5cbiAgICAvLyBBbiBhcnJheSBvZiB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgZnJvbSB0aGUgc2VhcmNoZXIncyBvdXRwdXQuIFdoZW4gdGhpcyBhcnJheVxuICAgIC8vIGNvbnRhaW5zIGVsZW1lbnRzLCBlYWNoIHJlc3VsdCBpbiB0aGUgbGlzdCB3aWxsIGJlIG9mIHRoZSBmb3JtIGB7IGl0ZW06IC4uLiwgaW5jbHVkZTE6IC4uLiwgaW5jbHVkZTI6IC4uLiB9YC5cbiAgICAvLyBWYWx1ZXMgeW91IGNhbiBpbmNsdWRlIGFyZSBgc2NvcmVgLCBgbWF0Y2hlZExvY2F0aW9uc2BcbiAgICBpbmNsdWRlOiBbXSxcblxuICAgIC8vIFdoZXRoZXIgdG8gc29ydCB0aGUgcmVzdWx0IGxpc3QsIGJ5IHNjb3JlXG4gICAgc2hvdWxkU29ydDogdHJ1ZSxcblxuICAgIC8vIFRoZSBzZWFyY2ggZnVuY3Rpb24gdG8gdXNlXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IHNlYXJjaCBmdW5jdGlvbiAoW1tGdW5jdGlvbl1dKSBtdXN0IGNvbmZvcm0gdG8gdGhlIGZvbGxvd2luZyBBUEk6XG4gICAgLy9cbiAgICAvLyAgQHBhcmFtIHBhdHRlcm4gVGhlIHBhdHRlcm4gc3RyaW5nIHRvIHNlYXJjaFxuICAgIC8vICBAcGFyYW0gb3B0aW9ucyBUaGUgc2VhcmNoIG9wdGlvblxuICAgIC8vICBbW0Z1bmN0aW9uXV0uY29uc3RydWN0b3IgPSBmdW5jdGlvbihwYXR0ZXJuLCBvcHRpb25zKVxuICAgIC8vXG4gICAgLy8gIEBwYXJhbSB0ZXh0OiB0aGUgc3RyaW5nIHRvIHNlYXJjaCBpbiBmb3IgdGhlIHBhdHRlcm5cbiAgICAvLyAgQHJldHVybiBPYmplY3QgaW4gdGhlIGZvcm0gb2Y6XG4gICAgLy8gICAgLSBpc01hdGNoOiBib29sZWFuXG4gICAgLy8gICAgLSBzY29yZTogSW50XG4gICAgLy8gIFtbRnVuY3Rpb25dXS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24odGV4dClcbiAgICBzZWFyY2hGbjogQml0YXBTZWFyY2hlcixcblxuICAgIC8vIERlZmF1bHQgc29ydCBmdW5jdGlvblxuICAgIHNvcnRGbjogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBhLnNjb3JlIC0gYi5zY29yZVxuICAgIH0sXG5cbiAgICAvLyBUaGUgZ2V0IGZ1bmN0aW9uIHRvIHVzZSB3aGVuIGZldGNoaW5nIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuXG4gICAgLy8gVGhlIGRlZmF1bHQgd2lsbCBzZWFyY2ggbmVzdGVkIHBhdGhzICppZSBmb28uYmFyLmJheipcbiAgICBnZXRGbjogZGVlcFZhbHVlLFxuXG4gICAgLy8gTGlzdCBvZiBwcm9wZXJ0aWVzIHRoYXQgd2lsbCBiZSBzZWFyY2hlZC4gVGhpcyBhbHNvIHN1cHBvcnRzIG5lc3RlZCBwcm9wZXJ0aWVzLlxuICAgIGtleXM6IFtdLFxuXG4gICAgLy8gV2lsbCBwcmludCB0byB0aGUgY29uc29sZS4gVXNlZnVsIGZvciBkZWJ1Z2dpbmcuXG4gICAgdmVyYm9zZTogZmFsc2UsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBzZWFyY2ggYWxnb3JpdGhtIHdpbGwgc2VhcmNoIGluZGl2aWR1YWwgd29yZHMgKiphbmQqKiB0aGUgZnVsbCBzdHJpbmcsXG4gICAgLy8gY29tcHV0aW5nIHRoZSBmaW5hbCBzY29yZSBhcyBhIGZ1bmN0aW9uIG9mIGJvdGguIE5vdGUgdGhhdCB3aGVuIGB0b2tlbml6ZWAgaXMgYHRydWVgLFxuICAgIC8vIHRoZSBgdGhyZXNob2xkYCwgYGRpc3RhbmNlYCwgYW5kIGBsb2NhdGlvbmAgYXJlIGluY29uc2VxdWVudGlhbCBmb3IgaW5kaXZpZHVhbCB0b2tlbnMuXG4gICAgdG9rZW5pemU6IGZhbHNlLFxuXG4gICAgLy8gV2hlbiB0cnVlLCB0aGUgcmVzdWx0IHNldCB3aWxsIG9ubHkgaW5jbHVkZSByZWNvcmRzIHRoYXQgbWF0Y2ggYWxsIHRva2Vucy4gV2lsbCBvbmx5IHdvcmtcbiAgICAvLyBpZiBgdG9rZW5pemVgIGlzIGFsc28gdHJ1ZS5cbiAgICBtYXRjaEFsbFRva2VuczogZmFsc2UsXG5cbiAgICAvLyBSZWdleCB1c2VkIHRvIHNlcGFyYXRlIHdvcmRzIHdoZW4gc2VhcmNoaW5nLiBPbmx5IGFwcGxpY2FibGUgd2hlbiBgdG9rZW5pemVgIGlzIGB0cnVlYC5cbiAgICB0b2tlblNlcGFyYXRvcjogLyArL2csXG5cbiAgICAvLyBNaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgbXVzdCBiZSBtYXRjaGVkIGJlZm9yZSBhIHJlc3VsdCBpcyBjb25zaWRlcmVkIGEgbWF0Y2hcbiAgICBtaW5NYXRjaENoYXJMZW5ndGg6IDEsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBhbGdvcml0aG0gY29udGludWVzIHNlYXJjaGluZyB0byB0aGUgZW5kIG9mIHRoZSBpbnB1dCBldmVuIGlmIGEgcGVyZmVjdFxuICAgIC8vIG1hdGNoIGlzIGZvdW5kIGJlZm9yZSB0aGUgZW5kIG9mIHRoZSBzYW1lIGlucHV0LlxuICAgIGZpbmRBbGxNYXRjaGVzOiBmYWxzZVxuICB9XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gb3B0aW9uc1xuICAgKi9cbiAgZnVuY3Rpb24gRnVzZSAobGlzdCwgb3B0aW9ucykge1xuICAgIHZhciBrZXlcblxuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuXG4gICAgZm9yIChrZXkgaW4gZGVmYXVsdE9wdGlvbnMpIHtcbiAgICAgIGlmICghZGVmYXVsdE9wdGlvbnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIC8vIEFkZCBib29sZWFuIHR5cGUgb3B0aW9uc1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0T3B0aW9uc1trZXldID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSBrZXkgaW4gb3B0aW9ucyA/IG9wdGlvbnNba2V5XSA6IGRlZmF1bHRPcHRpb25zW2tleV07XG4gICAgICAvLyBBZGQgYWxsIG90aGVyIG9wdGlvbnNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub3B0aW9uc1trZXldID0gb3B0aW9uc1trZXldIHx8IGRlZmF1bHRPcHRpb25zW2tleV1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLlZFUlNJT04gPSAnMi43LjMnXG5cbiAgLyoqXG4gICAqIFNldHMgYSBuZXcgbGlzdCBmb3IgRnVzZSB0byBtYXRjaCBhZ2FpbnN0LlxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcmV0dXJuIHshQXJyYXl9IFRoZSBuZXdseSBzZXQgbGlzdFxuICAgKiBAcHVibGljXG4gICAqL1xuICBGdXNlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobGlzdCkge1xuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICByZXR1cm4gbGlzdFxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLnZlcmJvc2UpIGxvZygnXFxuU2VhcmNoIHRlcm06JywgcGF0dGVybiwgJ1xcbicpXG5cbiAgICB0aGlzLnBhdHRlcm4gPSBwYXR0ZXJuXG4gICAgdGhpcy5yZXN1bHRzID0gW11cbiAgICB0aGlzLnJlc3VsdE1hcCA9IHt9XG4gICAgdGhpcy5fa2V5TWFwID0gbnVsbFxuXG4gICAgdGhpcy5fcHJlcGFyZVNlYXJjaGVycygpXG4gICAgdGhpcy5fc3RhcnRTZWFyY2goKVxuICAgIHRoaXMuX2NvbXB1dGVTY29yZSgpXG4gICAgdGhpcy5fc29ydCgpXG5cbiAgICB2YXIgb3V0cHV0ID0gdGhpcy5fZm9ybWF0KClcbiAgICByZXR1cm4gb3V0cHV0XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fcHJlcGFyZVNlYXJjaGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBwYXR0ZXJuID0gdGhpcy5wYXR0ZXJuXG4gICAgdmFyIHNlYXJjaEZuID0gb3B0aW9ucy5zZWFyY2hGblxuICAgIHZhciB0b2tlbnMgPSBwYXR0ZXJuLnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG4gICAgdmFyIGkgPSAwXG4gICAgdmFyIGxlbiA9IHRva2Vucy5sZW5ndGhcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudG9rZW5pemUpIHtcbiAgICAgIHRoaXMudG9rZW5TZWFyY2hlcnMgPSBbXVxuICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLnRva2VuU2VhcmNoZXJzLnB1c2gobmV3IHNlYXJjaEZuKHRva2Vuc1tpXSwgb3B0aW9ucykpXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZnVsbFNlYWNoZXIgPSBuZXcgc2VhcmNoRm4ocGF0dGVybiwgb3B0aW9ucylcbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9zdGFydFNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBnZXRGbiA9IG9wdGlvbnMuZ2V0Rm5cbiAgICB2YXIgbGlzdCA9IHRoaXMubGlzdFxuICAgIHZhciBsaXN0TGVuID0gbGlzdC5sZW5ndGhcbiAgICB2YXIga2V5cyA9IHRoaXMub3B0aW9ucy5rZXlzXG4gICAgdmFyIGtleXNMZW4gPSBrZXlzLmxlbmd0aFxuICAgIHZhciBrZXlcbiAgICB2YXIgd2VpZ2h0XG4gICAgdmFyIGl0ZW0gPSBudWxsXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGxpc3QsIGlmIGl0J3MgYSBzdHJpbmcsIHRoZW4gd2UgYXNzdW1lXG4gICAgLy8gdGhhdCBldmVyeSBpdGVtIGluIHRoZSBsaXN0IGlzIGFsc28gYSBzdHJpbmcsIGFuZCB0aHVzIGl0J3MgYSBmbGF0dGVuZWQgYXJyYXkuXG4gICAgaWYgKHR5cGVvZiBsaXN0WzBdID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5fYW5hbHl6ZSgnJywgbGlzdFtpXSwgaSwgaSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fa2V5TWFwID0ge31cbiAgICAgIC8vIE90aGVyd2lzZSwgdGhlIGZpcnN0IGl0ZW0gaXMgYW4gT2JqZWN0IChob3BlZnVsbHkpLCBhbmQgdGh1cyB0aGUgc2VhcmNoaW5nXG4gICAgICAvLyBpcyBkb25lIG9uIHRoZSB2YWx1ZXMgb2YgdGhlIGtleXMgb2YgZWFjaCBpdGVtLlxuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgaXRlbSA9IGxpc3RbaV1cbiAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGtleVxuICAgICAgICBmb3IgKGogPSAwOyBqIDwga2V5c0xlbjsgaisrKSB7XG4gICAgICAgICAga2V5ID0ga2V5c1tqXVxuICAgICAgICAgIGlmICh0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgd2VpZ2h0ID0gKDEgLSBrZXkud2VpZ2h0KSB8fCAxXG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICB3ZWlnaHQ6IHdlaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGtleS53ZWlnaHQgPD0gMCB8fCBrZXkud2VpZ2h0ID4gMSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tleSB3ZWlnaHQgaGFzIHRvIGJlID4gMCBhbmQgPD0gMScpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXkgPSBrZXkubmFtZVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5XSA9IHtcbiAgICAgICAgICAgICAgd2VpZ2h0OiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2FuYWx5emUoa2V5LCBnZXRGbihpdGVtLCBrZXksIFtdKSwgaXRlbSwgaSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9hbmFseXplID0gZnVuY3Rpb24gKGtleSwgdGV4dCwgZW50aXR5LCBpbmRleCkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgdmFyIHdvcmRzXG4gICAgdmFyIHNjb3Jlc1xuICAgIHZhciBleGlzdHMgPSBmYWxzZVxuICAgIHZhciBleGlzdGluZ1Jlc3VsdFxuICAgIHZhciBhdmVyYWdlU2NvcmVcbiAgICB2YXIgZmluYWxTY29yZVxuICAgIHZhciBzY29yZXNMZW5cbiAgICB2YXIgbWFpblNlYXJjaFJlc3VsdFxuICAgIHZhciB0b2tlblNlYXJjaGVyXG4gICAgdmFyIHRlcm1TY29yZXNcbiAgICB2YXIgd29yZFxuICAgIHZhciB0b2tlblNlYXJjaFJlc3VsdFxuICAgIHZhciBoYXNNYXRjaEluVGV4dFxuICAgIHZhciBjaGVja1RleHRNYXRjaGVzXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHRleHQgY2FuIGJlIHNlYXJjaGVkXG4gICAgaWYgKHRleHQgPT09IHVuZGVmaW5lZCB8fCB0ZXh0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzY29yZXMgPSBbXVxuXG4gICAgdmFyIG51bVRleHRNYXRjaGVzID0gMFxuXG4gICAgaWYgKHR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJykge1xuICAgICAgd29yZHMgPSB0ZXh0LnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG5cbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnLS0tLS0tLS0tXFxuS2V5OicsIGtleSlcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbml6ZSkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50b2tlblNlYXJjaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRva2VuU2VhcmNoZXIgPSB0aGlzLnRva2VuU2VhcmNoZXJzW2ldXG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1BhdHRlcm46JywgdG9rZW5TZWFyY2hlci5wYXR0ZXJuKVxuXG4gICAgICAgICAgdGVybVNjb3JlcyA9IFtdXG4gICAgICAgICAgaGFzTWF0Y2hJblRleHQgPSBmYWxzZVxuXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdvcmRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB3b3JkID0gd29yZHNbal1cbiAgICAgICAgICAgIHRva2VuU2VhcmNoUmVzdWx0ID0gdG9rZW5TZWFyY2hlci5zZWFyY2god29yZClcbiAgICAgICAgICAgIHZhciBvYmogPSB7fVxuICAgICAgICAgICAgaWYgKHRva2VuU2VhcmNoUmVzdWx0LmlzTWF0Y2gpIHtcbiAgICAgICAgICAgICAgb2JqW3dvcmRdID0gdG9rZW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgICAgICAgICAgZXhpc3RzID0gdHJ1ZVxuICAgICAgICAgICAgICBoYXNNYXRjaEluVGV4dCA9IHRydWVcbiAgICAgICAgICAgICAgc2NvcmVzLnB1c2godG9rZW5TZWFyY2hSZXN1bHQuc2NvcmUpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBvYmpbd29yZF0gPSAxXG4gICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSB7XG4gICAgICAgICAgICAgICAgc2NvcmVzLnB1c2goMSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGVybVNjb3Jlcy5wdXNoKG9iailcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaGFzTWF0Y2hJblRleHQpIHtcbiAgICAgICAgICAgIG51bVRleHRNYXRjaGVzKytcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Rva2VuIHNjb3JlczonLCB0ZXJtU2NvcmVzKVxuICAgICAgICB9XG5cbiAgICAgICAgYXZlcmFnZVNjb3JlID0gc2NvcmVzWzBdXG4gICAgICAgIHNjb3Jlc0xlbiA9IHNjb3Jlcy5sZW5ndGhcbiAgICAgICAgZm9yIChpID0gMTsgaSA8IHNjb3Jlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgYXZlcmFnZVNjb3JlICs9IHNjb3Jlc1tpXVxuICAgICAgICB9XG4gICAgICAgIGF2ZXJhZ2VTY29yZSA9IGF2ZXJhZ2VTY29yZSAvIHNjb3Jlc0xlblxuXG4gICAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnVG9rZW4gc2NvcmUgYXZlcmFnZTonLCBhdmVyYWdlU2NvcmUpXG4gICAgICB9XG5cbiAgICAgIG1haW5TZWFyY2hSZXN1bHQgPSB0aGlzLmZ1bGxTZWFjaGVyLnNlYXJjaCh0ZXh0KVxuICAgICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdGdWxsIHRleHQgc2NvcmU6JywgbWFpblNlYXJjaFJlc3VsdC5zY29yZSlcblxuICAgICAgZmluYWxTY29yZSA9IG1haW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgIGlmIChhdmVyYWdlU2NvcmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBmaW5hbFNjb3JlID0gKGZpbmFsU2NvcmUgKyBhdmVyYWdlU2NvcmUpIC8gMlxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Njb3JlIGF2ZXJhZ2U6JywgZmluYWxTY29yZSlcblxuICAgICAgY2hlY2tUZXh0TWF0Y2hlcyA9ICh0aGlzLm9wdGlvbnMudG9rZW5pemUgJiYgdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSA/IG51bVRleHRNYXRjaGVzID49IHRoaXMudG9rZW5TZWFyY2hlcnMubGVuZ3RoIDogdHJ1ZVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ0NoZWNrIE1hdGNoZXMnLCBjaGVja1RleHRNYXRjaGVzKVxuXG4gICAgICAvLyBJZiBhIG1hdGNoIGlzIGZvdW5kLCBhZGQgdGhlIGl0ZW0gdG8gPHJhd1Jlc3VsdHM+LCBpbmNsdWRpbmcgaXRzIHNjb3JlXG4gICAgICBpZiAoKGV4aXN0cyB8fCBtYWluU2VhcmNoUmVzdWx0LmlzTWF0Y2gpICYmIGNoZWNrVGV4dE1hdGNoZXMpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGl0ZW0gYWxyZWFkeSBleGlzdHMgaW4gb3VyIHJlc3VsdHNcbiAgICAgICAgZXhpc3RpbmdSZXN1bHQgPSB0aGlzLnJlc3VsdE1hcFtpbmRleF1cblxuICAgICAgICBpZiAoZXhpc3RpbmdSZXN1bHQpIHtcbiAgICAgICAgICAvLyBVc2UgdGhlIGxvd2VzdCBzY29yZVxuICAgICAgICAgIC8vIGV4aXN0aW5nUmVzdWx0LnNjb3JlLCBiaXRhcFJlc3VsdC5zY29yZVxuICAgICAgICAgIGV4aXN0aW5nUmVzdWx0Lm91dHB1dC5wdXNoKHtcbiAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgc2NvcmU6IGZpbmFsU2NvcmUsXG4gICAgICAgICAgICBtYXRjaGVkSW5kaWNlczogbWFpblNlYXJjaFJlc3VsdC5tYXRjaGVkSW5kaWNlc1xuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSByYXcgcmVzdWx0IGxpc3RcbiAgICAgICAgICB0aGlzLnJlc3VsdE1hcFtpbmRleF0gPSB7XG4gICAgICAgICAgICBpdGVtOiBlbnRpdHksXG4gICAgICAgICAgICBvdXRwdXQ6IFt7XG4gICAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgICAgbWF0Y2hlZEluZGljZXM6IG1haW5TZWFyY2hSZXN1bHQubWF0Y2hlZEluZGljZXNcbiAgICAgICAgICAgIH1dXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5yZXN1bHRzLnB1c2godGhpcy5yZXN1bHRNYXBbaW5kZXhdKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHRleHQpKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9hbmFseXplKGtleSwgdGV4dFtpXSwgZW50aXR5LCBpbmRleClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fY29tcHV0ZVNjb3JlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpXG4gICAgdmFyIGpcbiAgICB2YXIga2V5TWFwID0gdGhpcy5fa2V5TWFwXG4gICAgdmFyIHRvdGFsU2NvcmVcbiAgICB2YXIgb3V0cHV0XG4gICAgdmFyIHNjb3JlTGVuXG4gICAgdmFyIHNjb3JlXG4gICAgdmFyIHdlaWdodFxuICAgIHZhciByZXN1bHRzID0gdGhpcy5yZXN1bHRzXG4gICAgdmFyIGJlc3RTY29yZVxuICAgIHZhciBuU2NvcmVcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5Db21wdXRpbmcgc2NvcmU6XFxuJylcblxuICAgIGZvciAoaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3RhbFNjb3JlID0gMFxuICAgICAgb3V0cHV0ID0gcmVzdWx0c1tpXS5vdXRwdXRcbiAgICAgIHNjb3JlTGVuID0gb3V0cHV0Lmxlbmd0aFxuXG4gICAgICBiZXN0U2NvcmUgPSAxXG5cbiAgICAgIGZvciAoaiA9IDA7IGogPCBzY29yZUxlbjsgaisrKSB7XG4gICAgICAgIHNjb3JlID0gb3V0cHV0W2pdLnNjb3JlXG4gICAgICAgIHdlaWdodCA9IGtleU1hcCA/IGtleU1hcFtvdXRwdXRbal0ua2V5XS53ZWlnaHQgOiAxXG5cbiAgICAgICAgblNjb3JlID0gc2NvcmUgKiB3ZWlnaHRcblxuICAgICAgICBpZiAod2VpZ2h0ICE9PSAxKSB7XG4gICAgICAgICAgYmVzdFNjb3JlID0gTWF0aC5taW4oYmVzdFNjb3JlLCBuU2NvcmUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG90YWxTY29yZSArPSBuU2NvcmVcbiAgICAgICAgICBvdXRwdXRbal0ublNjb3JlID0gblNjb3JlXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGJlc3RTY29yZSA9PT0gMSkge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gdG90YWxTY29yZSAvIHNjb3JlTGVuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gYmVzdFNjb3JlXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKHJlc3VsdHNbaV0pXG4gICAgfVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX3NvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICBpZiAob3B0aW9ucy5zaG91bGRTb3J0KSB7XG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1xcblxcblNvcnRpbmcuLi4uJylcbiAgICAgIHRoaXMucmVzdWx0cy5zb3J0KG9wdGlvbnMuc29ydEZuKVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9mb3JtYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgZ2V0Rm4gPSBvcHRpb25zLmdldEZuXG4gICAgdmFyIGZpbmFsT3V0cHV0ID0gW11cbiAgICB2YXIgaVxuICAgIHZhciBsZW5cbiAgICB2YXIgcmVzdWx0cyA9IHRoaXMucmVzdWx0c1xuICAgIHZhciByZXBsYWNlVmFsdWVcbiAgICB2YXIgZ2V0SXRlbUF0SW5kZXhcbiAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMuaW5jbHVkZVxuXG4gICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5PdXRwdXQ6XFxuXFxuJywgcmVzdWx0cylcblxuICAgIC8vIEhlbHBlciBmdW5jdGlvbiwgaGVyZSBmb3Igc3BlZWQtdXAsIHdoaWNoIHJlcGxhY2VzIHRoZSBpdGVtIHdpdGggaXRzIHZhbHVlLFxuICAgIC8vIGlmIHRoZSBvcHRpb25zIHNwZWNpZmllcyBpdCxcbiAgICByZXBsYWNlVmFsdWUgPSBvcHRpb25zLmlkID8gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICByZXN1bHRzW2luZGV4XS5pdGVtID0gZ2V0Rm4ocmVzdWx0c1tpbmRleF0uaXRlbSwgb3B0aW9ucy5pZCwgW10pWzBdXG4gICAgfSA6IGZ1bmN0aW9uICgpIHt9XG5cbiAgICBnZXRJdGVtQXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgdmFyIHJlY29yZCA9IHJlc3VsdHNbaW5kZXhdXG4gICAgICB2YXIgZGF0YVxuICAgICAgdmFyIGpcbiAgICAgIHZhciBvdXRwdXRcbiAgICAgIHZhciBfaXRlbVxuICAgICAgdmFyIF9yZXN1bHRcblxuICAgICAgLy8gSWYgYGluY2x1ZGVgIGhhcyB2YWx1ZXMsIHB1dCB0aGUgaXRlbSBpbiB0aGUgcmVzdWx0XG4gICAgICBpZiAoaW5jbHVkZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgaXRlbTogcmVjb3JkLml0ZW1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5jbHVkZS5pbmRleE9mKCdtYXRjaGVzJykgIT09IC0xKSB7XG4gICAgICAgICAgb3V0cHV0ID0gcmVjb3JkLm91dHB1dFxuICAgICAgICAgIGRhdGEubWF0Y2hlcyA9IFtdXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IG91dHB1dC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgX2l0ZW0gPSBvdXRwdXRbal1cbiAgICAgICAgICAgIF9yZXN1bHQgPSB7XG4gICAgICAgICAgICAgIGluZGljZXM6IF9pdGVtLm1hdGNoZWRJbmRpY2VzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX2l0ZW0ua2V5KSB7XG4gICAgICAgICAgICAgIF9yZXN1bHQua2V5ID0gX2l0ZW0ua2V5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLm1hdGNoZXMucHVzaChfcmVzdWx0KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmNsdWRlLmluZGV4T2YoJ3Njb3JlJykgIT09IC0xKSB7XG4gICAgICAgICAgZGF0YS5zY29yZSA9IHJlc3VsdHNbaW5kZXhdLnNjb3JlXG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YSA9IHJlY29yZC5pdGVtXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfVxuXG4gICAgLy8gRnJvbSB0aGUgcmVzdWx0cywgcHVzaCBpbnRvIGEgbmV3IGFycmF5IG9ubHkgdGhlIGl0ZW0gaWRlbnRpZmllciAoaWYgc3BlY2lmaWVkKVxuICAgIC8vIG9mIHRoZSBlbnRpcmUgaXRlbS4gIFRoaXMgaXMgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHJldHVybiB0aGUgPHJlc3VsdHM+LFxuICAgIC8vIHNpbmNlIGl0IGNvbnRhaW5zIG90aGVyIG1ldGFkYXRhXG4gICAgZm9yIChpID0gMCwgbGVuID0gcmVzdWx0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgcmVwbGFjZVZhbHVlKGkpXG4gICAgICBmaW5hbE91dHB1dC5wdXNoKGdldEl0ZW1BdEluZGV4KGkpKVxuICAgIH1cblxuICAgIHJldHVybiBmaW5hbE91dHB1dFxuICB9XG5cbiAgLy8gSGVscGVyc1xuXG4gIGZ1bmN0aW9uIGRlZXBWYWx1ZSAob2JqLCBwYXRoLCBsaXN0KSB7XG4gICAgdmFyIGZpcnN0U2VnbWVudFxuICAgIHZhciByZW1haW5pbmdcbiAgICB2YXIgZG90SW5kZXhcbiAgICB2YXIgdmFsdWVcbiAgICB2YXIgaVxuICAgIHZhciBsZW5cblxuICAgIGlmICghcGF0aCkge1xuICAgICAgLy8gSWYgdGhlcmUncyBubyBwYXRoIGxlZnQsIHdlJ3ZlIGdvdHRlbiB0byB0aGUgb2JqZWN0IHdlIGNhcmUgYWJvdXQuXG4gICAgICBsaXN0LnB1c2gob2JqKVxuICAgIH0gZWxzZSB7XG4gICAgICBkb3RJbmRleCA9IHBhdGguaW5kZXhPZignLicpXG5cbiAgICAgIGlmIChkb3RJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZmlyc3RTZWdtZW50ID0gcGF0aC5zbGljZSgwLCBkb3RJbmRleClcbiAgICAgICAgcmVtYWluaW5nID0gcGF0aC5zbGljZShkb3RJbmRleCArIDEpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaXJzdFNlZ21lbnQgPSBwYXRoXG4gICAgICB9XG5cbiAgICAgIHZhbHVlID0gb2JqW2ZpcnN0U2VnbWVudF1cbiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghcmVtYWluaW5nICYmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpKSB7XG4gICAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgLy8gU2VhcmNoIGVhY2ggaXRlbSBpbiB0aGUgYXJyYXkuXG4gICAgICAgICAgZm9yIChpID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGRlZXBWYWx1ZSh2YWx1ZVtpXSwgcmVtYWluaW5nLCBsaXN0KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyZW1haW5pbmcpIHtcbiAgICAgICAgICAvLyBBbiBvYmplY3QuIFJlY3Vyc2UgZnVydGhlci5cbiAgICAgICAgICBkZWVwVmFsdWUodmFsdWUsIHJlbWFpbmluZywgbGlzdClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaXN0XG4gIH1cblxuICBmdW5jdGlvbiBpc0FycmF5IChvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSdcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGFwdGVkIGZyb20gXCJEaWZmLCBNYXRjaCBhbmQgUGF0Y2hcIiwgYnkgR29vZ2xlXG4gICAqXG4gICAqICAgaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2dvb2dsZS1kaWZmLW1hdGNoLXBhdGNoL1xuICAgKlxuICAgKiBNb2RpZmllZCBieTogS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPlxuICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgKiBEZXRhaWxzOiB0aGUgYWxnb3JpdGhtIGFuZCBzdHJ1Y3R1cmUgd2FzIG1vZGlmaWVkIHRvIGFsbG93IHRoZSBjcmVhdGlvbiBvZlxuICAgKiA8U2VhcmNoZXI+IGluc3RhbmNlcyB3aXRoIGEgPHNlYXJjaD4gbWV0aG9kIHdoaWNoIGRvZXMgdGhlIGFjdHVhbFxuICAgKiBiaXRhcCBzZWFyY2guIFRoZSA8cGF0dGVybj4gKHRoZSBzdHJpbmcgdGhhdCBpcyBzZWFyY2hlZCBmb3IpIGlzIG9ubHkgZGVmaW5lZFxuICAgKiBvbmNlIHBlciBpbnN0YW5jZSBhbmQgdGh1cyBpdCBlbGltaW5hdGVzIHJlZHVuZGFudCByZS1jcmVhdGlvbiB3aGVuIHNlYXJjaGluZ1xuICAgKiBvdmVyIGEgbGlzdCBvZiBzdHJpbmdzLlxuICAgKlxuICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpXG4gICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBmdW5jdGlvbiBCaXRhcFNlYXJjaGVyIChwYXR0ZXJuLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zLmxvY2F0aW9uID0gb3B0aW9ucy5sb2NhdGlvbiB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLmxvY2F0aW9uXG4gICAgdGhpcy5vcHRpb25zLmRpc3RhbmNlID0gJ2Rpc3RhbmNlJyBpbiBvcHRpb25zID8gb3B0aW9ucy5kaXN0YW5jZSA6IEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMuZGlzdGFuY2VcbiAgICB0aGlzLm9wdGlvbnMudGhyZXNob2xkID0gJ3RocmVzaG9sZCcgaW4gb3B0aW9ucyA/IG9wdGlvbnMudGhyZXNob2xkIDogQml0YXBTZWFyY2hlci5kZWZhdWx0T3B0aW9ucy50aHJlc2hvbGRcbiAgICB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCA9IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLm1heFBhdHRlcm5MZW5ndGhcblxuICAgIHRoaXMucGF0dGVybiA9IG9wdGlvbnMuY2FzZVNlbnNpdGl2ZSA/IHBhdHRlcm4gOiBwYXR0ZXJuLnRvTG93ZXJDYXNlKClcbiAgICB0aGlzLnBhdHRlcm5MZW4gPSBwYXR0ZXJuLmxlbmd0aFxuXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA8PSB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgdGhpcy5tYXRjaG1hc2sgPSAxIDw8ICh0aGlzLnBhdHRlcm5MZW4gLSAxKVxuICAgICAgdGhpcy5wYXR0ZXJuQWxwaGFiZXQgPSB0aGlzLl9jYWxjdWxhdGVQYXR0ZXJuQWxwaGFiZXQoKVxuICAgIH1cbiAgfVxuXG4gIEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgLy8gQXBwcm94aW1hdGVseSB3aGVyZSBpbiB0aGUgdGV4dCBpcyB0aGUgcGF0dGVybiBleHBlY3RlZCB0byBiZSBmb3VuZD9cbiAgICBsb2NhdGlvbjogMCxcblxuICAgIC8vIERldGVybWluZXMgaG93IGNsb3NlIHRoZSBtYXRjaCBtdXN0IGJlIHRvIHRoZSBmdXp6eSBsb2NhdGlvbiAoc3BlY2lmaWVkIGFib3ZlKS5cbiAgICAvLyBBbiBleGFjdCBsZXR0ZXIgbWF0Y2ggd2hpY2ggaXMgJ2Rpc3RhbmNlJyBjaGFyYWN0ZXJzIGF3YXkgZnJvbSB0aGUgZnV6enkgbG9jYXRpb25cbiAgICAvLyB3b3VsZCBzY29yZSBhcyBhIGNvbXBsZXRlIG1pc21hdGNoLiBBIGRpc3RhbmNlIG9mICcwJyByZXF1aXJlcyB0aGUgbWF0Y2ggYmUgYXRcbiAgICAvLyB0aGUgZXhhY3QgbG9jYXRpb24gc3BlY2lmaWVkLCBhIHRocmVzaG9sZCBvZiAnMTAwMCcgd291bGQgcmVxdWlyZSBhIHBlcmZlY3QgbWF0Y2hcbiAgICAvLyB0byBiZSB3aXRoaW4gODAwIGNoYXJhY3RlcnMgb2YgdGhlIGZ1enp5IGxvY2F0aW9uIHRvIGJlIGZvdW5kIHVzaW5nIGEgMC44IHRocmVzaG9sZC5cbiAgICBkaXN0YW5jZTogMTAwLFxuXG4gICAgLy8gQXQgd2hhdCBwb2ludCBkb2VzIHRoZSBtYXRjaCBhbGdvcml0aG0gZ2l2ZSB1cC4gQSB0aHJlc2hvbGQgb2YgJzAuMCcgcmVxdWlyZXMgYSBwZXJmZWN0IG1hdGNoXG4gICAgLy8gKG9mIGJvdGggbGV0dGVycyBhbmQgbG9jYXRpb24pLCBhIHRocmVzaG9sZCBvZiAnMS4wJyB3b3VsZCBtYXRjaCBhbnl0aGluZy5cbiAgICB0aHJlc2hvbGQ6IDAuNixcblxuICAgIC8vIE1hY2hpbmUgd29yZCBzaXplXG4gICAgbWF4UGF0dGVybkxlbmd0aDogMzJcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBhbHBoYWJldCBmb3IgdGhlIEJpdGFwIGFsZ29yaXRobS5cbiAgICogQHJldHVybiB7T2JqZWN0fSBIYXNoIG9mIGNoYXJhY3RlciBsb2NhdGlvbnMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fY2FsY3VsYXRlUGF0dGVybkFscGhhYmV0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXNrID0ge30sXG4gICAgICBpID0gMFxuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMucGF0dGVybkxlbjsgaSsrKSB7XG4gICAgICBtYXNrW3RoaXMucGF0dGVybi5jaGFyQXQoaSldID0gMFxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgbWFza1t0aGlzLnBhdHRlcm4uY2hhckF0KGkpXSB8PSAxIDw8ICh0aGlzLnBhdHRlcm4ubGVuZ3RoIC0gaSAtIDEpXG4gICAgfVxuXG4gICAgcmV0dXJuIG1hc2tcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlIGFuZCByZXR1cm4gdGhlIHNjb3JlIGZvciBhIG1hdGNoIHdpdGggYGVgIGVycm9ycyBhbmQgYHhgIGxvY2F0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gZXJyb3JzIE51bWJlciBvZiBlcnJvcnMgaW4gbWF0Y2guXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsb2NhdGlvbiBMb2NhdGlvbiBvZiBtYXRjaC5cbiAgICogQHJldHVybiB7bnVtYmVyfSBPdmVyYWxsIHNjb3JlIGZvciBtYXRjaCAoMC4wID0gZ29vZCwgMS4wID0gYmFkKS5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLl9iaXRhcFNjb3JlID0gZnVuY3Rpb24gKGVycm9ycywgbG9jYXRpb24pIHtcbiAgICB2YXIgYWNjdXJhY3kgPSBlcnJvcnMgLyB0aGlzLnBhdHRlcm5MZW4sXG4gICAgICBwcm94aW1pdHkgPSBNYXRoLmFicyh0aGlzLm9wdGlvbnMubG9jYXRpb24gLSBsb2NhdGlvbilcblxuICAgIGlmICghdGhpcy5vcHRpb25zLmRpc3RhbmNlKSB7XG4gICAgICAvLyBEb2RnZSBkaXZpZGUgYnkgemVybyBlcnJvci5cbiAgICAgIHJldHVybiBwcm94aW1pdHkgPyAxLjAgOiBhY2N1cmFjeVxuICAgIH1cbiAgICByZXR1cm4gYWNjdXJhY3kgKyAocHJveGltaXR5IC8gdGhpcy5vcHRpb25zLmRpc3RhbmNlKVxuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGUgYW5kIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBzZWFyY2hcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgVGhlIHRleHQgdG8gc2VhcmNoIGluXG4gICAqIEByZXR1cm4ge3tpc01hdGNoOiBib29sZWFuLCBzY29yZTogbnVtYmVyfX0gTGl0ZXJhbCBjb250YWluaW5nOlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNYXRjaCAtIFdoZXRoZXIgdGhlIHRleHQgaXMgYSBtYXRjaCBvciBub3RcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlIC0gT3ZlcmFsbCBzY29yZSBmb3IgdGhlIG1hdGNoXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgaVxuICAgIHZhciBqXG4gICAgdmFyIHRleHRMZW5cbiAgICB2YXIgZmluZEFsbE1hdGNoZXNcbiAgICB2YXIgbG9jYXRpb25cbiAgICB2YXIgdGhyZXNob2xkXG4gICAgdmFyIGJlc3RMb2NcbiAgICB2YXIgYmluTWluXG4gICAgdmFyIGJpbk1pZFxuICAgIHZhciBiaW5NYXhcbiAgICB2YXIgc3RhcnQsIGZpbmlzaFxuICAgIHZhciBiaXRBcnJcbiAgICB2YXIgbGFzdEJpdEFyclxuICAgIHZhciBjaGFyTWF0Y2hcbiAgICB2YXIgc2NvcmVcbiAgICB2YXIgbG9jYXRpb25zXG4gICAgdmFyIG1hdGNoZXNcbiAgICB2YXIgaXNNYXRjaGVkXG4gICAgdmFyIG1hdGNoTWFza1xuICAgIHZhciBtYXRjaGVkSW5kaWNlc1xuICAgIHZhciBtYXRjaGVzTGVuXG4gICAgdmFyIG1hdGNoXG5cbiAgICB0ZXh0ID0gb3B0aW9ucy5jYXNlU2Vuc2l0aXZlID8gdGV4dCA6IHRleHQudG9Mb3dlckNhc2UoKVxuXG4gICAgaWYgKHRoaXMucGF0dGVybiA9PT0gdGV4dCkge1xuICAgICAgLy8gRXhhY3QgbWF0Y2hcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzTWF0Y2g6IHRydWUsXG4gICAgICAgIHNjb3JlOiAwLFxuICAgICAgICBtYXRjaGVkSW5kaWNlczogW1swLCB0ZXh0Lmxlbmd0aCAtIDFdXVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdoZW4gcGF0dGVybiBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIHRoZSBtYWNoaW5lIHdvcmQgbGVuZ3RoLCBqdXN0IGRvIGEgYSByZWdleCBjb21wYXJpc29uXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA+IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgbWF0Y2hlcyA9IHRleHQubWF0Y2gobmV3IFJlZ0V4cCh0aGlzLnBhdHRlcm4ucmVwbGFjZShvcHRpb25zLnRva2VuU2VwYXJhdG9yLCAnfCcpKSlcbiAgICAgIGlzTWF0Y2hlZCA9ICEhbWF0Y2hlc1xuXG4gICAgICBpZiAoaXNNYXRjaGVkKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICAgICAgZm9yIChpID0gMCwgbWF0Y2hlc0xlbiA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgbWF0Y2hlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzW2ldXG4gICAgICAgICAgbWF0Y2hlZEluZGljZXMucHVzaChbdGV4dC5pbmRleE9mKG1hdGNoKSwgbWF0Y2gubGVuZ3RoIC0gMV0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNNYXRjaDogaXNNYXRjaGVkLFxuICAgICAgICAvLyBUT0RPOiByZXZpc2l0IHRoaXMgc2NvcmVcbiAgICAgICAgc2NvcmU6IGlzTWF0Y2hlZCA/IDAuNSA6IDEsXG4gICAgICAgIG1hdGNoZWRJbmRpY2VzOiBtYXRjaGVkSW5kaWNlc1xuICAgICAgfVxuICAgIH1cblxuICAgIGZpbmRBbGxNYXRjaGVzID0gb3B0aW9ucy5maW5kQWxsTWF0Y2hlc1xuXG4gICAgbG9jYXRpb24gPSBvcHRpb25zLmxvY2F0aW9uXG4gICAgLy8gU2V0IHN0YXJ0aW5nIGxvY2F0aW9uIGF0IGJlZ2lubmluZyB0ZXh0IGFuZCBpbml0aWFsaXplIHRoZSBhbHBoYWJldC5cbiAgICB0ZXh0TGVuID0gdGV4dC5sZW5ndGhcbiAgICAvLyBIaWdoZXN0IHNjb3JlIGJleW9uZCB3aGljaCB3ZSBnaXZlIHVwLlxuICAgIHRocmVzaG9sZCA9IG9wdGlvbnMudGhyZXNob2xkXG4gICAgLy8gSXMgdGhlcmUgYSBuZWFyYnkgZXhhY3QgbWF0Y2g/IChzcGVlZHVwKVxuICAgIGJlc3RMb2MgPSB0ZXh0LmluZGV4T2YodGhpcy5wYXR0ZXJuLCBsb2NhdGlvbilcblxuICAgIC8vIGEgbWFzayBvZiB0aGUgbWF0Y2hlc1xuICAgIG1hdGNoTWFzayA9IFtdXG4gICAgZm9yIChpID0gMDsgaSA8IHRleHRMZW47IGkrKykge1xuICAgICAgbWF0Y2hNYXNrW2ldID0gMFxuICAgIH1cblxuICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICB0aHJlc2hvbGQgPSBNYXRoLm1pbih0aGlzLl9iaXRhcFNjb3JlKDAsIGJlc3RMb2MpLCB0aHJlc2hvbGQpXG4gICAgICAvLyBXaGF0IGFib3V0IGluIHRoZSBvdGhlciBkaXJlY3Rpb24/IChzcGVlZCB1cClcbiAgICAgIGJlc3RMb2MgPSB0ZXh0Lmxhc3RJbmRleE9mKHRoaXMucGF0dGVybiwgbG9jYXRpb24gKyB0aGlzLnBhdHRlcm5MZW4pXG5cbiAgICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICAgIHRocmVzaG9sZCA9IE1hdGgubWluKHRoaXMuX2JpdGFwU2NvcmUoMCwgYmVzdExvYyksIHRocmVzaG9sZClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBiZXN0TG9jID0gLTFcbiAgICBzY29yZSA9IDFcbiAgICBsb2NhdGlvbnMgPSBbXVxuICAgIGJpbk1heCA9IHRoaXMucGF0dGVybkxlbiArIHRleHRMZW5cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgLy8gU2NhbiBmb3IgdGhlIGJlc3QgbWF0Y2g7IGVhY2ggaXRlcmF0aW9uIGFsbG93cyBmb3Igb25lIG1vcmUgZXJyb3IuXG4gICAgICAvLyBSdW4gYSBiaW5hcnkgc2VhcmNoIHRvIGRldGVybWluZSBob3cgZmFyIGZyb20gdGhlIG1hdGNoIGxvY2F0aW9uIHdlIGNhbiBzdHJheVxuICAgICAgLy8gYXQgdGhpcyBlcnJvciBsZXZlbC5cbiAgICAgIGJpbk1pbiA9IDBcbiAgICAgIGJpbk1pZCA9IGJpbk1heFxuICAgICAgd2hpbGUgKGJpbk1pbiA8IGJpbk1pZCkge1xuICAgICAgICBpZiAodGhpcy5fYml0YXBTY29yZShpLCBsb2NhdGlvbiArIGJpbk1pZCkgPD0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgYmluTWluID0gYmluTWlkXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICAgIH1cbiAgICAgICAgYmluTWlkID0gTWF0aC5mbG9vcigoYmluTWF4IC0gYmluTWluKSAvIDIgKyBiaW5NaW4pXG4gICAgICB9XG5cbiAgICAgIC8vIFVzZSB0aGUgcmVzdWx0IGZyb20gdGhpcyBpdGVyYXRpb24gYXMgdGhlIG1heGltdW0gZm9yIHRoZSBuZXh0LlxuICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICBzdGFydCA9IE1hdGgubWF4KDEsIGxvY2F0aW9uIC0gYmluTWlkICsgMSlcbiAgICAgIGlmIChmaW5kQWxsTWF0Y2hlcykge1xuICAgICAgICBmaW5pc2ggPSB0ZXh0TGVuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmluaXNoID0gTWF0aC5taW4obG9jYXRpb24gKyBiaW5NaWQsIHRleHRMZW4pICsgdGhpcy5wYXR0ZXJuTGVuXG4gICAgICB9XG5cbiAgICAgIC8vIEluaXRpYWxpemUgdGhlIGJpdCBhcnJheVxuICAgICAgYml0QXJyID0gQXJyYXkoZmluaXNoICsgMilcblxuICAgICAgYml0QXJyW2ZpbmlzaCArIDFdID0gKDEgPDwgaSkgLSAxXG5cbiAgICAgIGZvciAoaiA9IGZpbmlzaDsgaiA+PSBzdGFydDsgai0tKSB7XG4gICAgICAgIGNoYXJNYXRjaCA9IHRoaXMucGF0dGVybkFscGhhYmV0W3RleHQuY2hhckF0KGogLSAxKV1cblxuICAgICAgICBpZiAoY2hhck1hdGNoKSB7XG4gICAgICAgICAgbWF0Y2hNYXNrW2ogLSAxXSA9IDFcbiAgICAgICAgfVxuXG4gICAgICAgIGJpdEFycltqXSA9ICgoYml0QXJyW2ogKyAxXSA8PCAxKSB8IDEpICYgY2hhck1hdGNoXG5cbiAgICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgICAvLyBTdWJzZXF1ZW50IHBhc3NlczogZnV6enkgbWF0Y2guXG4gICAgICAgICAgYml0QXJyW2pdIHw9ICgoKGxhc3RCaXRBcnJbaiArIDFdIHwgbGFzdEJpdEFycltqXSkgPDwgMSkgfCAxKSB8IGxhc3RCaXRBcnJbaiArIDFdXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpdEFycltqXSAmIHRoaXMubWF0Y2htYXNrKSB7XG4gICAgICAgICAgc2NvcmUgPSB0aGlzLl9iaXRhcFNjb3JlKGksIGogLSAxKVxuXG4gICAgICAgICAgLy8gVGhpcyBtYXRjaCB3aWxsIGFsbW9zdCBjZXJ0YWlubHkgYmUgYmV0dGVyIHRoYW4gYW55IGV4aXN0aW5nIG1hdGNoLlxuICAgICAgICAgIC8vIEJ1dCBjaGVjayBhbnl3YXkuXG4gICAgICAgICAgaWYgKHNjb3JlIDw9IHRocmVzaG9sZCkge1xuICAgICAgICAgICAgLy8gSW5kZWVkIGl0IGlzXG4gICAgICAgICAgICB0aHJlc2hvbGQgPSBzY29yZVxuICAgICAgICAgICAgYmVzdExvYyA9IGogLSAxXG4gICAgICAgICAgICBsb2NhdGlvbnMucHVzaChiZXN0TG9jKVxuXG4gICAgICAgICAgICAvLyBBbHJlYWR5IHBhc3NlZCBsb2MsIGRvd25oaWxsIGZyb20gaGVyZSBvbiBpbi5cbiAgICAgICAgICAgIGlmIChiZXN0TG9jIDw9IGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdoZW4gcGFzc2luZyBsb2MsIGRvbid0IGV4Y2VlZCBvdXIgY3VycmVudCBkaXN0YW5jZSBmcm9tIGxvYy5cbiAgICAgICAgICAgIHN0YXJ0ID0gTWF0aC5tYXgoMSwgMiAqIGxvY2F0aW9uIC0gYmVzdExvYylcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTm8gaG9wZSBmb3IgYSAoYmV0dGVyKSBtYXRjaCBhdCBncmVhdGVyIGVycm9yIGxldmVscy5cbiAgICAgIGlmICh0aGlzLl9iaXRhcFNjb3JlKGkgKyAxLCBsb2NhdGlvbikgPiB0aHJlc2hvbGQpIHtcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGxhc3RCaXRBcnIgPSBiaXRBcnJcbiAgICB9XG5cbiAgICBtYXRjaGVkSW5kaWNlcyA9IHRoaXMuX2dldE1hdGNoZWRJbmRpY2VzKG1hdGNoTWFzaylcblxuICAgIC8vIENvdW50IGV4YWN0IG1hdGNoZXMgKHRob3NlIHdpdGggYSBzY29yZSBvZiAwKSB0byBiZSBcImFsbW9zdFwiIGV4YWN0XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2g6IGJlc3RMb2MgPj0gMCxcbiAgICAgIHNjb3JlOiBzY29yZSA9PT0gMCA/IDAuMDAxIDogc2NvcmUsXG4gICAgICBtYXRjaGVkSW5kaWNlczogbWF0Y2hlZEluZGljZXNcbiAgICB9XG4gIH1cblxuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fZ2V0TWF0Y2hlZEluZGljZXMgPSBmdW5jdGlvbiAobWF0Y2hNYXNrKSB7XG4gICAgdmFyIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICB2YXIgc3RhcnQgPSAtMVxuICAgIHZhciBlbmQgPSAtMVxuICAgIHZhciBpID0gMFxuICAgIHZhciBtYXRjaFxuICAgIHZhciBsZW4gPSBtYXRjaE1hc2subGVuZ3RoXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgbWF0Y2ggPSBtYXRjaE1hc2tbaV1cbiAgICAgIGlmIChtYXRjaCAmJiBzdGFydCA9PT0gLTEpIHtcbiAgICAgICAgc3RhcnQgPSBpXG4gICAgICB9IGVsc2UgaWYgKCFtYXRjaCAmJiBzdGFydCAhPT0gLTEpIHtcbiAgICAgICAgZW5kID0gaSAtIDFcbiAgICAgICAgaWYgKChlbmQgLSBzdGFydCkgKyAxID49IHRoaXMub3B0aW9ucy5taW5NYXRjaENoYXJMZW5ndGgpIHtcbiAgICAgICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBlbmRdKVxuICAgICAgICB9XG4gICAgICAgIHN0YXJ0ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1hdGNoTWFza1tpIC0gMV0pIHtcbiAgICAgIGlmICgoaS0xIC0gc3RhcnQpICsgMSA+PSB0aGlzLm9wdGlvbnMubWluTWF0Y2hDaGFyTGVuZ3RoKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBpIC0gMV0pXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXRjaGVkSW5kaWNlc1xuICB9XG5cbiAgLy8gRXhwb3J0IHRvIENvbW1vbiBKUyBMb2FkZXJcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgIC8vIGxpa2UgTm9kZS5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IEZ1c2VcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBGdXNlXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgIGdsb2JhbC5GdXNlID0gRnVzZVxuICB9XG5cbn0pKHRoaXMpO1xuXG59LHt9XSwzNjpbZnVuY3Rpb24ocmVxdWlyZSxtb2R1bGUsZXhwb3J0cyl7XG4vKiFcbiAqIERldGVybWluZSBpZiBhbiBvYmplY3QgaXMgYSBCdWZmZXJcbiAqXG4gKiBAYXV0aG9yICAgRmVyb3NzIEFib3VraGFkaWplaCA8aHR0cHM6Ly9mZXJvc3Mub3JnPlxuICogQGxpY2Vuc2UgIE1JVFxuICovXG5cbi8vIFRoZSBfaXNCdWZmZXIgY2hlY2sgaXMgZm9yIFNhZmFyaSA1LTcgc3VwcG9ydCwgYmVjYXVzZSBpdCdzIG1pc3Npbmdcbi8vIE9iamVjdC5wcm90b3R5cGUuY29uc3RydWN0b3IuIFJlbW92ZSB0aGlzIGV2ZW50dWFsbHlcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKG9iaikge1xuICByZXR1cm4gb2JqICE9IG51bGwgJiYgKGlzQnVmZmVyKG9iaikgfHwgaXNTbG93QnVmZmVyKG9iaikgfHwgISFvYmouX2lzQnVmZmVyKVxufVxuXG5mdW5jdGlvbiBpc0J1ZmZlciAob2JqKSB7XG4gIHJldHVybiAhIW9iai5jb25zdHJ1Y3RvciAmJiB0eXBlb2Ygb2JqLmNvbnN0cnVjdG9yLmlzQnVmZmVyID09PSAnZnVuY3Rpb24nICYmIG9iai5jb25zdHJ1Y3Rvci5pc0J1ZmZlcihvYmopXG59XG5cbi8vIEZvciBOb2RlIHYwLjEwIHN1cHBvcnQuIFJlbW92ZSB0aGlzIGV2ZW50dWFsbHkuXG5mdW5jdGlvbiBpc1Nsb3dCdWZmZXIgKG9iaikge1xuICByZXR1cm4gdHlwZW9mIG9iai5yZWFkRmxvYXRMRSA9PT0gJ2Z1bmN0aW9uJyAmJiB0eXBlb2Ygb2JqLnNsaWNlID09PSAnZnVuY3Rpb24nICYmIGlzQnVmZmVyKG9iai5zbGljZSgwLCAwKSlcbn1cblxufSx7fV0sMzc6W2Z1bmN0aW9uKHJlcXVpcmUsbW9kdWxlLGV4cG9ydHMpe1xuLy8gc2hpbSBmb3IgdXNpbmcgcHJvY2VzcyBpbiBicm93c2VyXG52YXIgcHJvY2VzcyA9IG1vZHVsZS5leHBvcnRzID0ge307XG5cbi8vIGNhY2hlZCBmcm9tIHdoYXRldmVyIGdsb2JhbCBpcyBwcmVzZW50IHNvIHRoYXQgdGVzdCBydW5uZXJzIHRoYXQgc3R1YiBpdFxuLy8gZG9uJ3QgYnJlYWsgdGhpbmdzLiAgQnV0IHdlIG5lZWQgdG8gd3JhcCBpdCBpbiBhIHRyeSBjYXRjaCBpbiBjYXNlIGl0IGlzXG4vLyB3cmFwcGVkIGluIHN0cmljdCBtb2RlIGNvZGUgd2hpY2ggZG9lc24ndCBkZWZpbmUgYW55IGdsb2JhbHMuICBJdCdzIGluc2lkZSBhXG4vLyBmdW5jdGlvbiBiZWNhdXNlIHRyeS9jYXRjaGVzIGRlb3B0aW1pemUgaW4gY2VydGFpbiBlbmdpbmVzLlxuXG52YXIgY2FjaGVkU2V0VGltZW91dDtcbnZhciBjYWNoZWRDbGVhclRpbWVvdXQ7XG5cbmZ1bmN0aW9uIGRlZmF1bHRTZXRUaW1vdXQoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdzZXRUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG5mdW5jdGlvbiBkZWZhdWx0Q2xlYXJUaW1lb3V0ICgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2NsZWFyVGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuKGZ1bmN0aW9uICgpIHtcbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIHNldFRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICBpZiAodHlwZW9mIGNsZWFyVGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gZGVmYXVsdENsZWFyVGltZW91dDtcbiAgICB9XG59ICgpKVxuZnVuY3Rpb24gcnVuVGltZW91dChmdW4pIHtcbiAgICBpZiAoY2FjaGVkU2V0VGltZW91dCA9PT0gc2V0VGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgLy8gaWYgc2V0VGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZFNldFRpbWVvdXQgPT09IGRlZmF1bHRTZXRUaW1vdXQgfHwgIWNhY2hlZFNldFRpbWVvdXQpICYmIHNldFRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9IGNhdGNoKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0IHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKG51bGwsIGZ1biwgMCk7XG4gICAgICAgIH0gY2F0Y2goZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvclxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbCh0aGlzLCBmdW4sIDApO1xuICAgICAgICB9XG4gICAgfVxuXG5cbn1cbmZ1bmN0aW9uIHJ1bkNsZWFyVGltZW91dChtYXJrZXIpIHtcbiAgICBpZiAoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgLy8gaWYgY2xlYXJUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkQ2xlYXJUaW1lb3V0ID09PSBkZWZhdWx0Q2xlYXJUaW1lb3V0IHx8ICFjYWNoZWRDbGVhclRpbWVvdXQpICYmIGNsZWFyVGltZW91dCkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIHJldHVybiBjbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfSBjYXRjaCAoZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgIHRydXN0IHRoZSBnbG9iYWwgb2JqZWN0IHdoZW4gY2FsbGVkIG5vcm1hbGx5XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwobnVsbCwgbWFya2VyKTtcbiAgICAgICAgfSBjYXRjaCAoZSl7XG4gICAgICAgICAgICAvLyBzYW1lIGFzIGFib3ZlIGJ1dCB3aGVuIGl0J3MgYSB2ZXJzaW9uIG9mIEkuRS4gdGhhdCBtdXN0IGhhdmUgdGhlIGdsb2JhbCBvYmplY3QgZm9yICd0aGlzJywgaG9wZnVsbHkgb3VyIGNvbnRleHQgY29ycmVjdCBvdGhlcndpc2UgaXQgd2lsbCB0aHJvdyBhIGdsb2JhbCBlcnJvci5cbiAgICAgICAgICAgIC8vIFNvbWUgdmVyc2lvbnMgb2YgSS5FLiBoYXZlIGRpZmZlcmVudCBydWxlcyBmb3IgY2xlYXJUaW1lb3V0IHZzIHNldFRpbWVvdXRcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbCh0aGlzLCBtYXJrZXIpO1xuICAgICAgICB9XG4gICAgfVxuXG5cblxufVxudmFyIHF1ZXVlID0gW107XG52YXIgZHJhaW5pbmcgPSBmYWxzZTtcbnZhciBjdXJyZW50UXVldWU7XG52YXIgcXVldWVJbmRleCA9IC0xO1xuXG5mdW5jdGlvbiBjbGVhblVwTmV4dFRpY2soKSB7XG4gICAgaWYgKCFkcmFpbmluZyB8fCAhY3VycmVudFF1ZXVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBpZiAoY3VycmVudFF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBxdWV1ZSA9IGN1cnJlbnRRdWV1ZS5jb25jYXQocXVldWUpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICB9XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCkge1xuICAgICAgICBkcmFpblF1ZXVlKCk7XG4gICAgfVxufVxuXG5mdW5jdGlvbiBkcmFpblF1ZXVlKCkge1xuICAgIGlmIChkcmFpbmluZykge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhciB0aW1lb3V0ID0gcnVuVGltZW91dChjbGVhblVwTmV4dFRpY2spO1xuICAgIGRyYWluaW5nID0gdHJ1ZTtcblxuICAgIHZhciBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgd2hpbGUobGVuKSB7XG4gICAgICAgIGN1cnJlbnRRdWV1ZSA9IHF1ZXVlO1xuICAgICAgICBxdWV1ZSA9IFtdO1xuICAgICAgICB3aGlsZSAoKytxdWV1ZUluZGV4IDwgbGVuKSB7XG4gICAgICAgICAgICBpZiAoY3VycmVudFF1ZXVlKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFF1ZXVlW3F1ZXVlSW5kZXhdLnJ1bigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHF1ZXVlSW5kZXggPSAtMTtcbiAgICAgICAgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIH1cbiAgICBjdXJyZW50UXVldWUgPSBudWxsO1xuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgcnVuQ2xlYXJUaW1lb3V0KHRpbWVvdXQpO1xufVxuXG5wcm9jZXNzLm5leHRUaWNrID0gZnVuY3Rpb24gKGZ1bikge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGggLSAxKTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgIGFyZ3NbaSAtIDFdID0gYXJndW1lbnRzW2ldO1xuICAgICAgICB9XG4gICAgfVxuICAgIHF1ZXVlLnB1c2gobmV3IEl0ZW0oZnVuLCBhcmdzKSk7XG4gICAgaWYgKHF1ZXVlLmxlbmd0aCA9PT0gMSAmJiAhZHJhaW5pbmcpIHtcbiAgICAgICAgcnVuVGltZW91dChkcmFpblF1ZXVlKTtcbiAgICB9XG59O1xuXG4vLyB2OCBsaWtlcyBwcmVkaWN0aWJsZSBvYmplY3RzXG5mdW5jdGlvbiBJdGVtKGZ1biwgYXJyYXkpIHtcbiAgICB0aGlzLmZ1biA9IGZ1bjtcbiAgICB0aGlzLmFycmF5ID0gYXJyYXk7XG59XG5JdGVtLnByb3RvdHlwZS5ydW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgdGhpcy5mdW4uYXBwbHkobnVsbCwgdGhpcy5hcnJheSk7XG59O1xucHJvY2Vzcy50aXRsZSA9ICdicm93c2VyJztcbnByb2Nlc3MuYnJvd3NlciA9IHRydWU7XG5wcm9jZXNzLmVudiA9IHt9O1xucHJvY2Vzcy5hcmd2ID0gW107XG5wcm9jZXNzLnZlcnNpb24gPSAnJzsgLy8gZW1wdHkgc3RyaW5nIHRvIGF2b2lkIHJlZ2V4cCBpc3N1ZXNcbnByb2Nlc3MudmVyc2lvbnMgPSB7fTtcblxuZnVuY3Rpb24gbm9vcCgpIHt9XG5cbnByb2Nlc3Mub24gPSBub29wO1xucHJvY2Vzcy5hZGRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLm9uY2UgPSBub29wO1xucHJvY2Vzcy5vZmYgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUFsbExpc3RlbmVycyA9IG5vb3A7XG5wcm9jZXNzLmVtaXQgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5wcmVwZW5kT25jZUxpc3RlbmVyID0gbm9vcDtcblxucHJvY2Vzcy5saXN0ZW5lcnMgPSBmdW5jdGlvbiAobmFtZSkgeyByZXR1cm4gW10gfVxuXG5wcm9jZXNzLmJpbmRpbmcgPSBmdW5jdGlvbiAobmFtZSkge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5iaW5kaW5nIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5cbnByb2Nlc3MuY3dkID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gJy8nIH07XG5wcm9jZXNzLmNoZGlyID0gZnVuY3Rpb24gKGRpcikge1xuICAgIHRocm93IG5ldyBFcnJvcigncHJvY2Vzcy5jaGRpciBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xucHJvY2Vzcy51bWFzayA9IGZ1bmN0aW9uKCkgeyByZXR1cm4gMDsgfTtcblxufSx7fV19LHt9LFs2XSlcblxuIiwiaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcbmltcG9ydCBGdXNlanMgZnJvbSAnZnVzZS5qcyc7XG5cbmltcG9ydCBQdWJTdWIgZnJvbSAnLi9wdWJzdWInO1xuaW1wb3J0IHsgZ3JvdXBCeSB9IGZyb20gJy4vaGVscGVycy91bmRlcnNjb3JlJztcblxubGV0IGZ1c2U7XG5cbi8vIEluaXRpYWxpemUgZnVzZS5qcyBvcHRpb25zXG5jb25zdCBmdXNlT3B0aW9ucyA9IHtcbiAgc2hvdWxkU29ydDogdHJ1ZSxcbiAgdGhyZXNob2xkOiAwLjEsXG4gIGxvY2F0aW9uOiAwLFxuICBkaXN0YW5jZTogMTAwLFxuICBtYXhQYXR0ZXJuTGVuZ3RoOiAzMixcbiAgbWluTWF0Y2hDaGFyTGVuZ3RoOiAxLFxuICBrZXlzOiBbXG4gICAgJ2FydGlzdCcsXG4gICAgJ3RpdGxlJyxcbiAgXSxcbn07XG5cbi8vIGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzY3MTIwMzQvc29ydC1hcnJheS1ieS1maXJzdG5hbWUtYWxwaGFiZXRpY2FsbHktaW4tamF2YXNjcmlwdFxuLy8gaHR0cHM6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvNTQyMTI1My9zb3J0LWphdmFzY3JpcHQtYXJyYXktb2Ytb2JqZWN0cy1iYXNlZC1vbi1vbmUtb2YtdGhlLW9iamVjdHMtcHJvcGVydGllc1xuY29uc3Qgc29ydFNvbmdzID0gKHNvbmdMaXN0KSA9PiB7XG4gIGNvbnN0IHNvcnRlZCA9IHNvbmdMaXN0LnNvcnQoKGEsIGIpID0+IHtcbiAgICBjb25zdCBhbGMgPSBhLmFydGlzdC50b0xvd2VyQ2FzZSgpO1xuICAgIGNvbnN0IGJsYyA9IGIuYXJ0aXN0LnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKGFsYyA+IGJsYykge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIGlmIChhbGMgPCBibGMpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9XG4gICAgcmV0dXJuIDA7XG4gIH0pO1xuICByZXR1cm4gc29ydGVkO1xufTtcblxuZnVuY3Rpb24gZ3JvdXBTb25ncyhzb25nTGlzdCkge1xuICBjb25zdCBncm91cGVkID0gZ3JvdXBCeShzb25nTGlzdCwgJ2FydGlzdCcpO1xuICByZXR1cm4gZ3JvdXBlZDtcbn1cblxuZnVuY3Rpb24gZmlsdGVyQnlMZXR0ZXIoc29uZ0xpc3QsIGxldHRlcikge1xuICBjb25zdCBmaWx0ID0gc29uZ0xpc3QuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IGxldHRlcik7XG4gIHJldHVybiBmaWx0O1xufVxuXG5cbmZ1bmN0aW9uIGZpbHRlckJ5VGVybShzb25nTGlzdCwgc2VhcmNoVGVybSkge1xuICBmdXNlID0gbmV3IEZ1c2Vqcyhzb25nTGlzdCwgZnVzZU9wdGlvbnMpO1xuICBjb25zdCBmdXNlUmVzdWx0cyA9IGZ1c2Uuc2VhcmNoKHNlYXJjaFRlcm0pO1xuICByZXR1cm4gZnVzZVJlc3VsdHM7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzZWFyY2hCeU5hbWUoc2VhcmNoVGVybSkge1xuICBQdWJTdWIucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IHNlYXJjaFRlcm0gfSk7XG4gIHJldHVybiBheGlvcy5nZXQoJ3NlYXJjaF9kYXRhLmpzb24nKVxuICAgIC50aGVuKHJlc3VsdHMgPT4gZmlsdGVyQnlUZXJtKHJlc3VsdHMuZGF0YSwgc2VhcmNoVGVybSkpXG4gICAgLnRoZW4oc29ydFNvbmdzKVxuICAgIC50aGVuKGdyb3VwU29uZ3MpXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaW5kQXJ0aXN0c0J5TGV0dGVyKGxldHRlcikge1xuICBQdWJTdWIucHVibGlzaCgnc2VhcmNoU3RhcnQnLCB7IGxldHRlciB9KTtcbiAgcmV0dXJuIGF4aW9zLmdldCgnc2VhcmNoX2RhdGEuanNvbicpXG4gICAgLnRoZW4ocmVzdWx0cyA9PiBmaWx0ZXJCeUxldHRlcihyZXN1bHRzLmRhdGEsIGxldHRlcikpXG4gICAgLnRoZW4oc29ydFNvbmdzKVxuICAgIC50aGVuKGdyb3VwU29uZ3MpXG4gICAgLy8gLnRoZW4ocmVzdWx0cyA9PiBzb3J0U29uZ3MocmVzdWx0cywgbGV0dGVyKSlcbiAgICAuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcbiAgICB9KTtcbn1cbi8qXG5mdW5jdGlvbiBzZWFyY2goKSB7XG4gIGF4aW9zLmdldCgnc2VhcmNoX2RhdGEuanNvbicpXG4gIC50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgIGxvYWRyLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgY29uc3QgZGF0YSA9IHJlc3BvbnNlLmRhdGE7XG4gICAgY29uc3QgZmlsdCA9IGRhdGEuZmlsdGVyKGl0ZW0gPT4gaXRlbS5hcnRpc3QudG9TdHJpbmcoKS5jaGFyQXQoMCkgPT09IHRoaXMuZGF0YXNldC5sZXR0ZXIpO1xuXG4gICAgUHViU3ViLnB1Ymxpc2goJ3VwZGF0ZUxpc3QnLCB7IGxpc3Q6IGZpbHQgfSk7XG5cbiAgICBkaXNwbGF5U2VhcmNoUmVzdWx0cyhmaWx0KTtcbiAgfSlcbiAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgIGNvbnNvbGUubG9nKGVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHNvcnRTb25ncyhyZXN1bHRzLCBsZXR0ZXIpIHtcbiAgY29uc29sZS5sb2coJ3NvcnRTb25ncycpO1xuICBjb25zdCBhbGxTb25ncyA9IHJlc3VsdHMuZGF0YTtcbiAgY29uc3QgZmlsdGVyZWRTb25ncyA9IGFsbFNvbmdzLmZpbHRlcihpdGVtID0+IGl0ZW0uYXJ0aXN0LnRvU3RyaW5nKCkuY2hhckF0KDApID09PSBsZXR0ZXIpO1xuXG4gIGNvbnN0IHNvbmdsaXN0U29ydGVkID0gZmlsdGVyZWRTb25ncy5zb3J0KChhLCBiKSA9PiBiLmFydGlzdCAtIGEuYXJ0aXN0KTtcbiAgY29uc3Qgc29uZ2xpc3RHcm91cGVkID0gZ3JvdXBCeShzb25nbGlzdFNvcnRlZCwgJ2FydGlzdCcpO1xuXG4gIHJldHVybiBzb25nbGlzdEdyb3VwZWQ7XG59XG5cbiovXG4iLCJpbXBvcnQgeyBkZWxlZ2F0ZUV2ZW50TGlzdGVuZXIgfSBmcm9tICcuL2hlbHBlcnMvZXZlbnRzJztcbmltcG9ydCBQdWJTdWIgZnJvbSAnLi9wdWJzdWInO1xuaW1wb3J0ICogYXMgYXBpIGZyb20gJy4vYXBpJztcblxuY29uc3QgbGV0dGVyTWVudUNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5hei1zZWFyY2gnKTtcbmNvbnN0IHNvbmdUaXRsZXMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtc2VhcmNoX3Jlc3VsdHMnKTtcbmNvbnN0IGZvcm0gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnc2lnbi11cCcpO1xudmFyIHNlbGVjdGVkQXJ0aXN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLWFydGlzdF9faW5wdXQnKTtcbnZhciBzZWxlY3RlZFNvbmcgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtc29uZ19faW5wdXQnKTtcbnZhciBuYW1lID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2pzLW5hbWVfX2lucHV0Jyk7XG52YXIgcGhvbmUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnanMtcGhvbmVfX2lucHV0Jyk7XG5cbi8vIENvZGUgZm9yIFNvbmcgUmVxdWVzdCBTdWJtaXRcbmNvbnN0IHJlcXVlc3RGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignI2pzLXNvbmdwaWNrJyk7XG5cbmZ1bmN0aW9uIGdldFNvbmcoZSkge1xuICByZXR1cm4gZS50YXJnZXQ7XG59XG5cbnZhciBzZWxlY3Rpb24gPSBmdW5jdGlvbih0aXRsZSwgYXJ0aXN0KXtcbiAgdGhpcy50aXRsZSA9IHRpdGxlO1xuICB0aGlzLmFydGlzdCA9IGFydGlzdDtcbn1cbmZ1bmN0aW9uIGZpbGxGb3JtKG9iail7XG4gIGZvcm0uY2xhc3NMaXN0LnJlbW92ZSgndS1oaWRkZW4nKTtcbiAgc2VsZWN0ZWRBcnRpc3QudmFsdWUgPSBvYmouYXJ0aXN0O1xuICBzZWxlY3RlZFNvbmcudmFsdWUgPSBvYmoudGl0bGU7XG59XG5cbmZ1bmN0aW9uIGdldERhdGEoZSl7XG4gIHZhciB0aXRsZSwgYXJ0aXN0LCBhcnRpc3RTb25ncztcbiAgdGl0bGUgPSBlLnRhcmdldDtcbiAgYXJ0aXN0U29uZ3MgPSB0aXRsZS5wYXJlbnROb2RlLnBhcmVudE5vZGU7XG4gIGFydGlzdCA9IGFydGlzdFNvbmdzLnByZXZpb3VzU2libGluZztcbiAgY29uc29sZS5sb2codGl0bGUuaW5uZXJIVE1MKTtcbiAgY29uc29sZS5sb2coYXJ0aXN0LmlubmVySFRNTCk7XG4gIHZhciBkYXRhID0gbmV3IHNlbGVjdGlvbih0aXRsZS5pbm5lckhUTUwsIGFydGlzdC5pbm5lckhUTUwpO1xuICBjb25zb2xlLmxvZyhkYXRhKTtcbiAgZmlsbEZvcm0oZGF0YSk7XG59XG5cbmZ1bmN0aW9uIHN1Ym1pdFJlcXVlc3QoZXZ0KSB7XG4gIGNvbnN0IGUgPSBldnQgfHwgd2luZG93LmV2ZW50O1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgaWYgKHNlbGVjdGVkQXJ0aXN0LnZhbHVlID09PSBcIlwiIHx8IHNlbGVjdGVkU29uZy52YWx1ZSA9PT0gXCJcIikge1xuICAgIGZvcm0ucHJldmlvdXNTaWJsaW5nLmlubmVySFRNTCA9IFwiUGxlYXNlIGZpbGwgb3V0IGFsbCBvZiB0aGUgZmllbGRzXCI7XG4gIH0gZWxzZSB7XG4gICAgdmFyIHJlcXVlc3QgPSBPYmplY3QuYXNzaWduKHtcbiAgICAgIG5hbWU6IG5hbWUudmFsdWUsXG4gICAgICBwaG9uZTogcGhvbmUudmFsdWUsXG4gICAgICBhcnRpc3Q6IHNlbGVjdGVkQXJ0aXN0LnZhbHVlLFxuICAgICAgc29uZzogc2VsZWN0ZWRTb25nLnZhbHVlXG4gICAgfSk7XG4gICAgY29uc29sZS5sb2cocmVxdWVzdCk7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuXG5mdW5jdGlvbiBsZXR0ZXJDbGlja0hhbmRsZXIoZXZ0KSB7XG4gIGNvbnN0IGUgPSBldnQgfHwgd2luZG93LmV2ZW50O1xuICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgY29uc3QgdGhlTGV0dGVyID0gdGhpcy5kYXRhc2V0LmxldHRlcjtcblxuXG4gIGFwaS5maW5kQXJ0aXN0c0J5TGV0dGVyKHRoZUxldHRlcilcbiAgICAudGhlbigoc29uZ0xpc3QpID0+IHtcbiAgICAgIFB1YlN1Yi5wdWJsaXNoKCdzZWFyY2hDb21wbGV0ZScsIHsgc29uZ0xpc3QsIHNlYXJjaFRlcm06IHRoZUxldHRlciB9KTtcbiAgICB9KTtcbn1cblxuXG5mdW5jdGlvbiBpbml0TGV0dGVyTWVudSgpIHtcbiAgY29uc3QgbGV0dGVycyA9ICdxd2VydHl1aW9wYXNkZmdoamtsenhjdmJubSc7XG4gIGNvbnN0IHVwcGVyY2FzZUxldHRlcnMgPSBsZXR0ZXJzLnRvVXBwZXJDYXNlKCk7XG4gIGNvbnN0IGxldHRlckxpc3QgPSBbLi4udXBwZXJjYXNlTGV0dGVyc107XG4gIGNvbnN0IHNvcnRlZExpc3QgPSBsZXR0ZXJMaXN0LnNvcnQoKTtcbiAgY29uc3QgaHRtbExpc3QgPSBzb3J0ZWRMaXN0Lm1hcChpdGVtID0+IGA8bGkgY2xhc3M9XCJvLWxpc3QtaW5saW5lX19pdGVtIGMtYXpfX2l0ZW1cIj48YSBjbGFzcz1cImMtYXpfX2xldHRlclwiIGRhdGEtbGV0dGVyPVwiJHtpdGVtfVwiPiR7aXRlbX08L2E+PC9saT5gKS5qb2luKCcnKTtcbiAgLy8gY29udGFpbmVyLmlubmVySFRNTCA9IGA8dWwgY2xhc3M9XCJvLWxpc3QtaW5saW5lIGMtYXpcIj4ke2h0bWxMaXN0fTwvdWw+YDtcbiAgLy8gY29uc3QgbGV0dGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmxldHRlcicpO1xuXG4gIC8vIGxldHRlci5mb3JFYWNoKGxldHQgPT4gbGV0dC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGxldHRlckNsaWNrSGFuZGxlcikpO1xuICByZXR1cm4gYDx1bCBjbGFzcz1cIm8tbGlzdC1pbmxpbmUgYy1helwiPiR7aHRtbExpc3R9PC91bD5gO1xufVxuXG5sZXR0ZXJNZW51Q29udGFpbmVyLmlubmVySFRNTCA9IGluaXRMZXR0ZXJNZW51KCk7XG5kZWxlZ2F0ZUV2ZW50TGlzdGVuZXIobGV0dGVyTWVudUNvbnRhaW5lciwgJ2NsaWNrJywgJ2EnLCBsZXR0ZXJDbGlja0hhbmRsZXIpO1xuZGVsZWdhdGVFdmVudExpc3RlbmVyKHNvbmdUaXRsZXMsICdjbGljaycsICdhJywgZ2V0RGF0YSk7XG5yZXF1ZXN0Rm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzdWJtaXRSZXF1ZXN0KTsiLCIvKlxuICogYWRhcHRlZCBmcm9tIGh0dHBzOi8vY29kZXBlbi5pby9kaXZzd2l0aGNsYXNzL3Blbi9Kb1JXZHdcbiAqIGZyb20gYSBzaW5nbGUgZWxlbWVudCAoaS5lLiBxdWVyeVNlbGVjdG9yIG9yIGdldEVsZW1lbnRCeU5hbWUpXG4gKiB5b3UgY2FuIGFkZCwgcmVtb3ZlLCBvciB0b2dnbGUgYSBjbGFzc1xuICpcbiAqIEBwYXJhbSB7RE9NIEVsZW1lbnR9IGVsIC0gVGhlIGVsZW1lbnQgdG8gYWx0ZXJcbiAqIEBwYXJhbSB7U3RyaW5nfSBjbGFzc05hbWUgLSB0aGUgY2xhc3MgbmFtZSB0byBhZGQsIHJlbW92ZSwgdG9nZ2xlXG4gKi9cblxuZXhwb3J0IGNvbnN0IGFkZENsYXNzID0gKGVsZW1lbnQsIGNsYXNzTmFtZSkgPT4ge1xuICBjb25zdCBlbCA9IGVsZW1lbnQ7XG5cbiAgaWYgKGVsLmNsYXNzTGlzdCkge1xuICAgIGVsLmNsYXNzTGlzdC5hZGQoY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBlbC5jbGFzc05hbWUgKz0gYCAke2NsYXNzTmFtZX1gO1xuICB9XG59O1xuXG5leHBvcnQgY29uc3QgcmVtb3ZlQ2xhc3MgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gIGNvbnN0IGVsID0gZWxlbWVudDtcblxuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgZWwuY2xhc3NMaXN0LnJlbW92ZShjbGFzc05hbWUpO1xuICB9IGVsc2Uge1xuICAgIGVsLmNsYXNzTmFtZSA9IGVsLmNsYXNzTmFtZS5yZXBsYWNlKG5ldyBSZWdFeHAoYChefFxcXFxiKSR7Y2xhc3NOYW1lLnNwbGl0KCcgJykuam9pbignfCcpfShcXFxcYnwkKWAsICdnaScpLCAnICcpO1xuICB9XG59O1xuXG5leHBvcnQgZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICBpZiAoZWwuY2xhc3NMaXN0KSB7XG4gICAgcmV0dXJuIGVsLmNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpO1xuICB9XG4gIHJldHVybiBuZXcgUmVnRXhwKGAoXnwgKSR7Y2xhc3NOYW1lfSggfCQpYCwgJ2dpJykudGVzdChlbC5jbGFzc05hbWUpO1xufVxuXG5leHBvcnQgY29uc3QgdG9nZ2xlQ2xhc3MgPSAoZWxlbWVudCwgY2xhc3NOYW1lKSA9PiB7XG4gIGNvbnN0IGVsID0gZWxlbWVudDtcblxuICBpZiAoaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkpIHtcbiAgICByZW1vdmVDbGFzcyhlbCwgY2xhc3NOYW1lKTtcbiAgfSBlbHNlIHtcbiAgICBhZGRDbGFzcyhlbCwgY2xhc3NOYW1lKTtcbiAgfVxufTtcblxuZXhwb3J0IGNvbnN0IHNldFN0eWxlID0gKGVsZW1lbnQsIHByb3BlcnR5T2JqZWN0KSA9PiB7XG4gIGNvbnN0IHN0eWxlcyA9IHByb3BlcnR5T2JqZWN0O1xuXG4gIE9iamVjdC5hc3NpZ24oZWxlbWVudC5zdHlsZSwgc3R5bGVzKTtcbn07XG5cbmV4cG9ydCBjb25zdCBmaW5kUGFyZW50QnlUYWdOYW1lID0gKGVsZW1lbnQsIHRhZ05hbWUpID0+IHtcbiAgbGV0IHBhcmVudCA9IGVsZW1lbnQ7XG5cbiAgd2hpbGUgKHBhcmVudCAhPT0gbnVsbCAmJiBwYXJlbnQudGFnTmFtZSAhPT0gdGFnTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgcGFyZW50ID0gcGFyZW50LnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIHBhcmVudDtcbn07XG4iLCIvKipcbiAqIEN1c3RvbSBqYXZhc2NyaXB0IGV2ZW50cyBvZiBqUXVlcnkgZnVuY3Rpb25zXG4gKi9cbi8qKlxuICogQ3VzdG9tIGV2ZW50IGRpc3BhdGNoZXIgKG1pbWljcyBqcXVlcnkgdHJpZ2dlcilcbiAqIEBwYXJhbSAge2VsZW1lbnR9IGVsZW1lbnQgICBFbGVtZW50IHRvIHRyaWdnZXIgb25cbiAqIEBwYXJhbSAge3N0cmluZ30gZXZlbnRuYW1lIEN1c3RvbSBldmVudCBuYW1lXG4gKiBAcGFyYW0gIHtPYmplY3R9IFtvYmo9e31dICBDdXN0b20gcGFyYW1ldGVycyB0byBwYXNzIGFsb25nIChmaW5kIGluIGV2ZW50LmRldGFpbClcbiAqIEByZXR1cm4ge251bGx9ICAgICAgICAgICBObyByZXR1cm4gdmFsdWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHRyaWdnZXIoZWxlbWVudCwgZXZlbnRuYW1lLCBvYmogPSB7fSkge1xuICBsZXQgZXZlbnQ7XG5cbiAgaWYgKHdpbmRvdy5DdXN0b21FdmVudCkge1xuICAgIGV2ZW50ID0gbmV3IEN1c3RvbUV2ZW50KGV2ZW50bmFtZSwgeyBkZXRhaWw6IG9iaiB9KTtcbiAgfSBlbHNlIHtcbiAgICBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCdDdXN0b21FdmVudCcpO1xuICAgIGV2ZW50LmluaXRDdXN0b21FdmVudChldmVudG5hbWUsIHRydWUsIHRydWUsIG9iaik7XG4gIH1cblxuICBlbGVtZW50LmRpc3BhdGNoRXZlbnQoZXZlbnQpO1xufVxuXG4vKipcbiAqIERlbGVnYXRlIGV2ZW50IGxpc3RlbmVyIHRvIGNoaWxkcmVuIChtaW1pY3MganF1ZXJ5IGJlaGF2aW9yKVxuICogKHNvdXJjZTogaHR0cDovL2JkYWRhbS5jb20vYmxvZy9wbGFpbi1qYXZhc2NyaXB0LWV2ZW50LWRlbGVnYXRpb24uaHRtbClcbiAqIEBwYXJhbSAge2VsZW1lbnR9IGVsZW1lbnQgIERPTSBwYXJlbnQgZWxlbWVudFxuICogQHBhcmFtICB7c3RyaW5nfSBldnQgICAgICBFdmVudCB0byBsaXN0ZW4gdG9cbiAqIEBwYXJhbSAge3N0cmluZ30gc2VsZWN0b3IgU2VsZWN0b3IgdG8gbWF0Y2ggY2hpbGRyZW4gYnlcbiAqIEBwYXJhbSAge2Z1bmN0aW9ufSBoYW5kbGVyICBGdW5jdGlvbiB0byBydW4gYXMgZXZlbnQgaGFuZGxlclxuICogQHJldHVybiB7bnVsbH0gICAgICAgICAgTm8gUmV0dXJuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBkZWxlZ2F0ZUV2ZW50TGlzdGVuZXIoZWxlbWVudCwgZXZ0LCBzZWxlY3RvciwgaGFuZGxlcikge1xuICBjb25zdCBlbCA9IGVsZW1lbnQ7XG4gIGVsLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LCAoZXZlbnQpID0+IHtcbiAgICBjb25zdCBwb3NzaWJsZVRhcmdldHMgPSBlbC5xdWVyeVNlbGVjdG9yQWxsKHNlbGVjdG9yKTtcbiAgICBjb25zdCB0YXJnZXQgPSBldmVudC50YXJnZXQ7XG5cbiAgICBmb3IgKGxldCBpID0gMCwgbCA9IHBvc3NpYmxlVGFyZ2V0cy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGxldCB0ID0gdGFyZ2V0O1xuICAgICAgY29uc3QgcCA9IHBvc3NpYmxlVGFyZ2V0c1tpXTtcblxuICAgICAgd2hpbGUgKHQgJiYgdCAhPT0gZWxlbWVudCkge1xuICAgICAgICBpZiAodCA9PT0gcCkge1xuICAgICAgICAgIHJldHVybiBoYW5kbGVyLmNhbGwocCwgZXZlbnQpO1xuICAgICAgICB9XG5cbiAgICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9KTtcbiAgLyogZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKGV2dCwgZnVuY3Rpb24gY2FsbGJhY2soZXZlbnQpIHtcbiAgICBjb25zdCBlID0gZXZlbnQgfHwgd2luZG93LmV2ZW50O1xuXG4gICAgbGV0IHQgPSBlLnRhcmdldDtcblxuICAgIHdoaWxlICh0ICYmIHQgIT09IHRoaXMpIHtcbiAgICAgIGNvbnNvbGUubG9nKGB3aGlsZSB0OiAke3R9YCk7XG4gICAgICBpZiAodC5tYXRjaGVzKHNlbGVjdG9yKSkge1xuICAgICAgICBjb25zb2xlLmxvZyhgbWF0Y2ggdDogJHt0fWApO1xuICAgICAgICBoYW5kbGVyLmNhbGwodCwgZXZlbnQpO1xuICAgICAgfVxuICAgICAgY29uc29sZS5sb2coYG91dHNpZGUgdDogJHt0fWApO1xuICAgICAgdCA9IHQucGFyZW50Tm9kZTtcbiAgICB9XG4gIH0pO1xuICAqL1xufVxuIiwiLypcbiAqIEdyb3VwQnkgZnJvbSBodHRwOi8vd3d3LmRhdGNobGV5Lm5hbWUvZ2V0dGluZy1mdW5jdGlvbmFsLXdpdGgtamF2YXNjcmlwdC1wYXJ0LTIvXG4gKi9cblxuY29uc3QgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuY29uc3QgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIGlzRnVuY3Rpb24obykge1xuICByZXR1cm4gdG9TdHJpbmcuY2FsbChvKSA9PT0gJ1tvYmplY3QgRnVuY3Rpb25dJztcbn07XG5cbi8qIGVzbGludCBuby1wYXJhbS1yZWFzc2lnbjogW1wiZXJyb3JcIiwgeyBcInByb3BzXCI6IGZhbHNlIH1dKi9cbmV4cG9ydCBjb25zdCBncm91cEJ5ID0gKGxpc3QsIHByb3ApID0+XG4gIGxpc3QucmVkdWNlKChncm91cGVkLCBpdGVtKSA9PiB7XG4gICAgY29uc3Qga2V5ID0gaXNGdW5jdGlvbihwcm9wKSA/IHByb3AuYXBwbHkodGhpcywgW2l0ZW1dKSA6IGl0ZW1bcHJvcF07XG4gICAgZ3JvdXBlZFtrZXldID0gZ3JvdXBlZFtrZXldIHx8IFtdO1xuICAgIGdyb3VwZWRba2V5XS5wdXNoKGl0ZW0pO1xuICAgIHJldHVybiBncm91cGVkO1xuICB9LCB7fSk7XG4iLCJpbXBvcnQgJy4vYXotc2VhcmNoJztcbmltcG9ydCAnLi9zZWFyY2gnO1xuaW1wb3J0ICcuL3Jlc3VsdHMnO1xuIiwiY29uc3QgcHVic3ViID0gKCgpID0+IHtcbiAgY29uc3QgdG9waWNzID0ge307XG5cbiAgY29uc3Qgc3Vic2NyaWJlID0gKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICB0b3BpY3NbZXZlbnROYW1lXSA9IHRvcGljc1tldmVudE5hbWVdIHx8IFtdO1xuICAgIHRvcGljc1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuICB9O1xuXG4gIGNvbnN0IHVuc3Vic2NyaWJlID0gKGV2ZW50TmFtZSwgY2FsbGJhY2spID0+IHtcbiAgICBpZiAodG9waWNzW2V2ZW50TmFtZV0pIHtcbiAgICAgIGZvciAobGV0IGkgPSAwLCBsZW4gPSB0b3BpY3NbZXZlbnROYW1lXS5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBpZiAodG9waWNzW2V2ZW50TmFtZV1baV0gPT09IGNhbGxiYWNrKSB7XG4gICAgICAgICAgdG9waWNzW2V2ZW50TmFtZV0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuXG4gIGNvbnN0IHB1Ymxpc2ggPSAoZXZlbnROYW1lLCBkYXRhKSA9PiB7XG4gICAgaWYgKHRvcGljc1tldmVudE5hbWVdKSB7XG4gICAgICB0b3BpY3NbZXZlbnROYW1lXS5mb3JFYWNoKChjYWxsYmFjaykgPT4ge1xuICAgICAgICBjYWxsYmFjayhkYXRhKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcblxuICByZXR1cm4ge1xuICAgIHN1YnNjcmliZSxcbiAgICB1bnN1YnNjcmliZSxcbiAgICBwdWJsaXNoLFxuICB9O1xufSkoKTtcblxuZXhwb3J0IGRlZmF1bHQgcHVic3ViO1xuIiwiaW1wb3J0IHsgYWRkQ2xhc3MsIHJlbW92ZUNsYXNzIH0gZnJvbSAnLi9oZWxwZXJzL2RvbS1lbGVtZW50cyc7XG5pbXBvcnQgUHViU3ViIGZyb20gJy4vcHVic3ViJztcblxuY29uc3QgcGxhY2Vob2xkZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtc2VhcmNoX3Jlc3VsdHMnKTtcbmNvbnN0IGxvYWRyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmxvYWRlcicpO1xuXG5mdW5jdGlvbiBjbGVhclJlc3VsdHMoKSB7XG4gIHBsYWNlaG9sZGVyLmlubmVySFRNTCA9ICcnO1xuICByZW1vdmVDbGFzcyhsb2FkciwgJ3UtaGlkZGVuJyk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlcihwdWJvYmopIHtcbiAgY29uc3Qgc29uZ0xpc3QgPSBwdWJvYmouc29uZ0xpc3Q7XG4gIGNvbnN0IHNlYXJjaFRlcm0gPSBwdWJvYmouc2VhcmNoVGVybTtcblxuICBsZXQgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9IGA8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzOiA8c3BhbiBjLXNlYXJjaF9fdGVybT4ke3NlYXJjaFRlcm19PC9zcGFuPjwvaDI+PHNlY3Rpb24gY2xhc3M9XCJjLXNlYXJjaF9fbGlzdFwiPmA7XG4gIE9iamVjdC5rZXlzKHNvbmdMaXN0KS5mb3JFYWNoKChrZXkpID0+IHtcbiAgICBodG1sU3R1ZmYgKz0gYDxwIGNsYXNzPVwiYy1zZWFyY2hfX2FydGlzdFwiPiR7a2V5fTwvcD48dWw+YDtcbiAgICBzb25nTGlzdFtrZXldLmZvckVhY2goKHZhbHVlKSA9PiB7XG4gICAgICBodG1sU3R1ZmYgKz0gYDxsaSBjbGFzcz1cImMtc2VhcmNoX190aXRsZVwiPjxhIGhyZWY9XCIjc2lnbi11cFwiPiR7dmFsdWUudGl0bGV9PC9hPjwvbGk+YDtcbiAgICB9KTtcbiAgICBodG1sU3R1ZmYgKz0gJzwvdWw+JztcbiAgfSk7XG4gIGh0bWxTdHVmZiArPSAnPC9zZWN0aW9uPic7XG4gIGFkZENsYXNzKGxvYWRyLCAndS1oaWRkZW4nKTtcbiAgcGxhY2Vob2xkZXIuaW5uZXJIVE1MID0gaHRtbFN0dWZmO1xufVxuXG5QdWJTdWIuc3Vic2NyaWJlKCdzZWFyY2hTdGFydCcsIGNsZWFyUmVzdWx0cyk7XG5QdWJTdWIuc3Vic2NyaWJlKCdzZWFyY2hDb21wbGV0ZScsIHJlbmRlcik7XG4iLCJpbXBvcnQgUHViU3ViIGZyb20gJy4vcHVic3ViJztcbmltcG9ydCAqIGFzIGFwaSBmcm9tICcuL2FwaSc7XG5cbmNvbnN0IHNlYXJjaEZvcm0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcjanMtc29uZ3NlYXJjaCcpO1xuY29uc3Qgc2VhcmNoSW5wdXQgPSBzZWFyY2hGb3JtLnF1ZXJ5U2VsZWN0b3IoJyNqcy1zb25nc2VhcmNoX19pbnB1dCcpO1xuXG5mdW5jdGlvbiBjbGVhclNlYXJjaCgpIHtcbiAgc2VhcmNoSW5wdXQudmFsdWUgPSAnJztcbn1cblxuZnVuY3Rpb24gc2VhcmNoSGFuZGxlcihldnQpIHtcbiAgY29uc3QgZSA9IGV2dCB8fCB3aW5kb3cuZXZlbnQ7XG4gIGUucHJldmVudERlZmF1bHQoKTtcblxuICBjb25zdCBzZWFyY2hUZXJtID0gc2VhcmNoSW5wdXQudmFsdWU7XG4gIGlmIChzZWFyY2hUZXJtICE9PSAnJykge1xuICAgIGFwaS5zZWFyY2hCeU5hbWUoc2VhcmNoVGVybSlcbiAgICAgIC50aGVuKChzb25nTGlzdCkgPT4ge1xuICAgICAgICBQdWJTdWIucHVibGlzaCgnc2VhcmNoQ29tcGxldGUnLCB7IHNvbmdMaXN0LCBzZWFyY2hUZXJtIH0pO1xuICAgICAgfSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gb25TZWFyY2hTdGFydChwcykge1xuICBjb25zdCBwdWJzdWJPYmplY3QgPSBwcztcblxuICBpZiAocHVic3ViT2JqZWN0LmxldHRlcikge1xuICAgIGNsZWFyU2VhcmNoKCk7XG4gIH1cbn1cblxuc2VhcmNoRm9ybS5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCBzZWFyY2hIYW5kbGVyKTtcblB1YlN1Yi5zdWJzY3JpYmUoJ3NlYXJjaFN0YXJ0Jywgb25TZWFyY2hTdGFydCk7XG5cbi8qXG5cblxuZnVuY3Rpb24gc3VjY2Vzc0hhbmRsZXIoZGF0YSkge1xuICBjb25zdCBpID0gXyhkYXRhKS50b0FycmF5KCk7XG5cbiAgZnVzZSA9IG5ldyBGdXNlanMoaSwgb3B0aW9ucyk7IC8vIFwibGlzdFwiIGlzIHRoZSBpdGVtIGFycmF5XG59XG5cbi8vIEdldCB0aGUgZ2VuZXJhdGVkIHNlYXJjaF9kYXRhLmpzb24gZmlsZSBzbyBsdW5yLmpzIGNhbiBzZWFyY2ggaXQgbG9jYWxseS5cbmNvbnN0IHNlYXJjaERhdGEgPSAkLmFqYXgoe1xuICB1cmw6ICcuL3NlYXJjaF9kYXRhLmpzb24nLFxuICB0eXBlOiAnR0VUJywgLy8gZGVmYXVsdCBpcyBHRVQgYnV0IHlvdSBjYW4gdXNlIG90aGVyIHZlcmJzIGJhc2VkIG9uIHlvdXIgbmVlZHMuXG4gIGRhdGFUeXBlOiAnanNvbicsIC8vIHNwZWNpZnkgdGhlIGRhdGFUeXBlIGZvciBmdXR1cmUgcmVmZXJlbmNlXG59KTtcbnNlYXJjaERhdGEuZG9uZShzdWNjZXNzSGFuZGxlcik7XG5cbmZ1bmN0aW9uIGRpc3BsYXlTZWFyY2hSZXN1bHRzKHJlc3VsdHMpIHtcbiAgY29uc29sZS5sb2coJ3N1Y2Nlc3MnKTtcbiAgY29uc29sZS5sb2cocmVzdWx0cyk7XG5cbiAgY29uc3QgJHBsYWNlaG9sZGVyID0gJCgnI2pzLXNlYXJjaF9yZXN1bHRzJyk7XG4gIGNvbnN0IHRlc3RzID0gXy5zb3J0QnkocmVzdWx0cywgJ2FydGlzdCcpO1xuICBjb25zdCB0ZXN0ZyA9IF8uZ3JvdXBCeSh0ZXN0cywgJ2FydGlzdCcpO1xuICBsZXQgaHRtbFN0dWZmID0gJyc7XG4gIGh0bWxTdHVmZiA9ICc8aDIgY2xhc3M9XCJjLXNlYXJjaF9faGVhZGluZ1wiPlNlYXJjaCBSZXN1bHRzPC9oMj48c2VjdGlvbiBjbGFzcz1cImMtc2VhcmNoX19saXN0XCI+JztcbiAgJC5lYWNoKHRlc3RnLCAoa2V5LCB2YWx1ZSkgPT4ge1xuICAgIGNvbnNvbGUubG9nKGAke2tleX06IGApO1xuICAgIGNvbnNvbGUubG9nKGB2YWx1ZSA9ICR7dmFsdWV9YCk7XG4gICAgaHRtbFN0dWZmICs9IGA8cCBjbGFzcz1cImMtc2VhcmNoX19hcnRpc3RcIj4ke2tleX08L3A+PHVsPmA7XG4gICAgY29uc3QgdmFsID0gXy5zb3J0QnkodmFsdWUsICd0aXRsZScpO1xuICAgICQuZWFjaCh2YWwsIChrLCB2KSA9PiB7XG4gICAgICBjb25zb2xlLmxvZyhgJHtrfTo6OiR7di50aXRsZX1gKTtcblxuICAgICAgaHRtbFN0dWZmICs9IGA8bGkgY2xhc3M9XCJjLXNlYXJjaF9fdGl0bGVcIj4ke3YudGl0bGV9PC9saT5gO1xuICAgIH0pO1xuICAgIGh0bWxTdHVmZiArPSAnPC91bD4nO1xuICB9KTtcbiAgaHRtbFN0dWZmICs9ICc8L3NlY3Rpb24+JztcbiAgJHBsYWNlaG9sZGVyLmVtcHR5KCkuYXBwZW5kKGh0bWxTdHVmZik7XG59XG5cbiQoKCkgPT4ge1xuICAvLyBFdmVudCB3aGVuIHRoZSBmb3JtIGlzIHN1Ym1pdHRlZFxuICAkKCcjanMtc29uZ3NlYXJjaCcpLnN1Ym1pdCgoZXZlbnQpID0+IHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIGNvbnN0ICRxdWVyeSA9ICQoJyNqcy1zb25nc2VhcmNoX2lucHV0JykudmFsKCk7IC8vIEdldCB0aGUgdmFsdWUgZm9yIHRoZSB0ZXh0IGZpZWxkXG4gICAgY29uc3QgZnVzZVJlc3VsdHMgPSBmdXNlLnNlYXJjaCgkcXVlcnkpOyAvLyBHZXQgZnVzZS5qcyB0byBwZXJmb3JtIGEgc2VhcmNoXG5cbiAgICBkaXNwbGF5U2VhcmNoUmVzdWx0cyhmdXNlUmVzdWx0cyk7IC8vIEhhbmQgdGhlIHJlc3VsdHMgb2ZmIHRvIGJlIGRpc3BsYXllZFxuICB9KTtcbn0pO1xuKi9cbiIsIm1vZHVsZS5leHBvcnRzID0gcmVxdWlyZSgnLi9saWIvYXhpb3MnKTsiLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcbnZhciBzZXR0bGUgPSByZXF1aXJlKCcuLy4uL2NvcmUvc2V0dGxlJyk7XG52YXIgYnVpbGRVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnVpbGRVUkwnKTtcbnZhciBwYXJzZUhlYWRlcnMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvcGFyc2VIZWFkZXJzJyk7XG52YXIgaXNVUkxTYW1lT3JpZ2luID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2lzVVJMU2FtZU9yaWdpbicpO1xudmFyIGNyZWF0ZUVycm9yID0gcmVxdWlyZSgnLi4vY29yZS9jcmVhdGVFcnJvcicpO1xudmFyIGJ0b2EgPSAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgd2luZG93LmJ0b2EgJiYgd2luZG93LmJ0b2EuYmluZCh3aW5kb3cpKSB8fCByZXF1aXJlKCcuLy4uL2hlbHBlcnMvYnRvYScpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHhockFkYXB0ZXIoY29uZmlnKSB7XG4gIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiBkaXNwYXRjaFhoclJlcXVlc3QocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgdmFyIHJlcXVlc3REYXRhID0gY29uZmlnLmRhdGE7XG4gICAgdmFyIHJlcXVlc3RIZWFkZXJzID0gY29uZmlnLmhlYWRlcnM7XG5cbiAgICBpZiAodXRpbHMuaXNGb3JtRGF0YShyZXF1ZXN0RGF0YSkpIHtcbiAgICAgIGRlbGV0ZSByZXF1ZXN0SGVhZGVyc1snQ29udGVudC1UeXBlJ107IC8vIExldCB0aGUgYnJvd3NlciBzZXQgaXRcbiAgICB9XG5cbiAgICB2YXIgcmVxdWVzdCA9IG5ldyBYTUxIdHRwUmVxdWVzdCgpO1xuICAgIHZhciBsb2FkRXZlbnQgPSAnb25yZWFkeXN0YXRlY2hhbmdlJztcbiAgICB2YXIgeERvbWFpbiA9IGZhbHNlO1xuXG4gICAgLy8gRm9yIElFIDgvOSBDT1JTIHN1cHBvcnRcbiAgICAvLyBPbmx5IHN1cHBvcnRzIFBPU1QgYW5kIEdFVCBjYWxscyBhbmQgZG9lc24ndCByZXR1cm5zIHRoZSByZXNwb25zZSBoZWFkZXJzLlxuICAgIC8vIERPTidUIGRvIHRoaXMgZm9yIHRlc3RpbmcgYi9jIFhNTEh0dHBSZXF1ZXN0IGlzIG1vY2tlZCwgbm90IFhEb21haW5SZXF1ZXN0LlxuICAgIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Rlc3QnICYmXG4gICAgICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgICAgIHdpbmRvdy5YRG9tYWluUmVxdWVzdCAmJiAhKCd3aXRoQ3JlZGVudGlhbHMnIGluIHJlcXVlc3QpICYmXG4gICAgICAgICFpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpIHtcbiAgICAgIHJlcXVlc3QgPSBuZXcgd2luZG93LlhEb21haW5SZXF1ZXN0KCk7XG4gICAgICBsb2FkRXZlbnQgPSAnb25sb2FkJztcbiAgICAgIHhEb21haW4gPSB0cnVlO1xuICAgICAgcmVxdWVzdC5vbnByb2dyZXNzID0gZnVuY3Rpb24gaGFuZGxlUHJvZ3Jlc3MoKSB7fTtcbiAgICAgIHJlcXVlc3Qub250aW1lb3V0ID0gZnVuY3Rpb24gaGFuZGxlVGltZW91dCgpIHt9O1xuICAgIH1cblxuICAgIC8vIEhUVFAgYmFzaWMgYXV0aGVudGljYXRpb25cbiAgICBpZiAoY29uZmlnLmF1dGgpIHtcbiAgICAgIHZhciB1c2VybmFtZSA9IGNvbmZpZy5hdXRoLnVzZXJuYW1lIHx8ICcnO1xuICAgICAgdmFyIHBhc3N3b3JkID0gY29uZmlnLmF1dGgucGFzc3dvcmQgfHwgJyc7XG4gICAgICByZXF1ZXN0SGVhZGVycy5BdXRob3JpemF0aW9uID0gJ0Jhc2ljICcgKyBidG9hKHVzZXJuYW1lICsgJzonICsgcGFzc3dvcmQpO1xuICAgIH1cblxuICAgIHJlcXVlc3Qub3Blbihjb25maWcubWV0aG9kLnRvVXBwZXJDYXNlKCksIGJ1aWxkVVJMKGNvbmZpZy51cmwsIGNvbmZpZy5wYXJhbXMsIGNvbmZpZy5wYXJhbXNTZXJpYWxpemVyKSwgdHJ1ZSk7XG5cbiAgICAvLyBTZXQgdGhlIHJlcXVlc3QgdGltZW91dCBpbiBNU1xuICAgIHJlcXVlc3QudGltZW91dCA9IGNvbmZpZy50aW1lb3V0O1xuXG4gICAgLy8gTGlzdGVuIGZvciByZWFkeSBzdGF0ZVxuICAgIHJlcXVlc3RbbG9hZEV2ZW50XSA9IGZ1bmN0aW9uIGhhbmRsZUxvYWQoKSB7XG4gICAgICBpZiAoIXJlcXVlc3QgfHwgKHJlcXVlc3QucmVhZHlTdGF0ZSAhPT0gNCAmJiAheERvbWFpbikpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICAvLyBUaGUgcmVxdWVzdCBlcnJvcmVkIG91dCBhbmQgd2UgZGlkbid0IGdldCBhIHJlc3BvbnNlLCB0aGlzIHdpbGwgYmVcbiAgICAgIC8vIGhhbmRsZWQgYnkgb25lcnJvciBpbnN0ZWFkXG4gICAgICAvLyBXaXRoIG9uZSBleGNlcHRpb246IHJlcXVlc3QgdGhhdCB1c2luZyBmaWxlOiBwcm90b2NvbCwgbW9zdCBicm93c2Vyc1xuICAgICAgLy8gd2lsbCByZXR1cm4gc3RhdHVzIGFzIDAgZXZlbiB0aG91Z2ggaXQncyBhIHN1Y2Nlc3NmdWwgcmVxdWVzdFxuICAgICAgaWYgKHJlcXVlc3Quc3RhdHVzID09PSAwICYmICEocmVxdWVzdC5yZXNwb25zZVVSTCAmJiByZXF1ZXN0LnJlc3BvbnNlVVJMLmluZGV4T2YoJ2ZpbGU6JykgPT09IDApKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgLy8gUHJlcGFyZSB0aGUgcmVzcG9uc2VcbiAgICAgIHZhciByZXNwb25zZUhlYWRlcnMgPSAnZ2V0QWxsUmVzcG9uc2VIZWFkZXJzJyBpbiByZXF1ZXN0ID8gcGFyc2VIZWFkZXJzKHJlcXVlc3QuZ2V0QWxsUmVzcG9uc2VIZWFkZXJzKCkpIDogbnVsbDtcbiAgICAgIHZhciByZXNwb25zZURhdGEgPSAhY29uZmlnLnJlc3BvbnNlVHlwZSB8fCBjb25maWcucmVzcG9uc2VUeXBlID09PSAndGV4dCcgPyByZXF1ZXN0LnJlc3BvbnNlVGV4dCA6IHJlcXVlc3QucmVzcG9uc2U7XG4gICAgICB2YXIgcmVzcG9uc2UgPSB7XG4gICAgICAgIGRhdGE6IHJlc3BvbnNlRGF0YSxcbiAgICAgICAgLy8gSUUgc2VuZHMgMTIyMyBpbnN0ZWFkIG9mIDIwNCAoaHR0cHM6Ly9naXRodWIuY29tL216YWJyaXNraWUvYXhpb3MvaXNzdWVzLzIwMSlcbiAgICAgICAgc3RhdHVzOiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/IDIwNCA6IHJlcXVlc3Quc3RhdHVzLFxuICAgICAgICBzdGF0dXNUZXh0OiByZXF1ZXN0LnN0YXR1cyA9PT0gMTIyMyA/ICdObyBDb250ZW50JyA6IHJlcXVlc3Quc3RhdHVzVGV4dCxcbiAgICAgICAgaGVhZGVyczogcmVzcG9uc2VIZWFkZXJzLFxuICAgICAgICBjb25maWc6IGNvbmZpZyxcbiAgICAgICAgcmVxdWVzdDogcmVxdWVzdFxuICAgICAgfTtcblxuICAgICAgc2V0dGxlKHJlc29sdmUsIHJlamVjdCwgcmVzcG9uc2UpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIGxvdyBsZXZlbCBuZXR3b3JrIGVycm9yc1xuICAgIHJlcXVlc3Qub25lcnJvciA9IGZ1bmN0aW9uIGhhbmRsZUVycm9yKCkge1xuICAgICAgLy8gUmVhbCBlcnJvcnMgYXJlIGhpZGRlbiBmcm9tIHVzIGJ5IHRoZSBicm93c2VyXG4gICAgICAvLyBvbmVycm9yIHNob3VsZCBvbmx5IGZpcmUgaWYgaXQncyBhIG5ldHdvcmsgZXJyb3JcbiAgICAgIHJlamVjdChjcmVhdGVFcnJvcignTmV0d29yayBFcnJvcicsIGNvbmZpZywgbnVsbCwgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gSGFuZGxlIHRpbWVvdXRcbiAgICByZXF1ZXN0Lm9udGltZW91dCA9IGZ1bmN0aW9uIGhhbmRsZVRpbWVvdXQoKSB7XG4gICAgICByZWplY3QoY3JlYXRlRXJyb3IoJ3RpbWVvdXQgb2YgJyArIGNvbmZpZy50aW1lb3V0ICsgJ21zIGV4Y2VlZGVkJywgY29uZmlnLCAnRUNPTk5BQk9SVEVEJyxcbiAgICAgICAgcmVxdWVzdCkpO1xuXG4gICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICByZXF1ZXN0ID0gbnVsbDtcbiAgICB9O1xuXG4gICAgLy8gQWRkIHhzcmYgaGVhZGVyXG4gICAgLy8gVGhpcyBpcyBvbmx5IGRvbmUgaWYgcnVubmluZyBpbiBhIHN0YW5kYXJkIGJyb3dzZXIgZW52aXJvbm1lbnQuXG4gICAgLy8gU3BlY2lmaWNhbGx5IG5vdCBpZiB3ZSdyZSBpbiBhIHdlYiB3b3JrZXIsIG9yIHJlYWN0LW5hdGl2ZS5cbiAgICBpZiAodXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSkge1xuICAgICAgdmFyIGNvb2tpZXMgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvY29va2llcycpO1xuXG4gICAgICAvLyBBZGQgeHNyZiBoZWFkZXJcbiAgICAgIHZhciB4c3JmVmFsdWUgPSAoY29uZmlnLndpdGhDcmVkZW50aWFscyB8fCBpc1VSTFNhbWVPcmlnaW4oY29uZmlnLnVybCkpICYmIGNvbmZpZy54c3JmQ29va2llTmFtZSA/XG4gICAgICAgICAgY29va2llcy5yZWFkKGNvbmZpZy54c3JmQ29va2llTmFtZSkgOlxuICAgICAgICAgIHVuZGVmaW5lZDtcblxuICAgICAgaWYgKHhzcmZWYWx1ZSkge1xuICAgICAgICByZXF1ZXN0SGVhZGVyc1tjb25maWcueHNyZkhlYWRlck5hbWVdID0geHNyZlZhbHVlO1xuICAgICAgfVxuICAgIH1cblxuICAgIC8vIEFkZCBoZWFkZXJzIHRvIHRoZSByZXF1ZXN0XG4gICAgaWYgKCdzZXRSZXF1ZXN0SGVhZGVyJyBpbiByZXF1ZXN0KSB7XG4gICAgICB1dGlscy5mb3JFYWNoKHJlcXVlc3RIZWFkZXJzLCBmdW5jdGlvbiBzZXRSZXF1ZXN0SGVhZGVyKHZhbCwga2V5KSB7XG4gICAgICAgIGlmICh0eXBlb2YgcmVxdWVzdERhdGEgPT09ICd1bmRlZmluZWQnICYmIGtleS50b0xvd2VyQ2FzZSgpID09PSAnY29udGVudC10eXBlJykge1xuICAgICAgICAgIC8vIFJlbW92ZSBDb250ZW50LVR5cGUgaWYgZGF0YSBpcyB1bmRlZmluZWRcbiAgICAgICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNba2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAvLyBPdGhlcndpc2UgYWRkIGhlYWRlciB0byB0aGUgcmVxdWVzdFxuICAgICAgICAgIHJlcXVlc3Quc2V0UmVxdWVzdEhlYWRlcihrZXksIHZhbCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIC8vIEFkZCB3aXRoQ3JlZGVudGlhbHMgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLndpdGhDcmVkZW50aWFscykge1xuICAgICAgcmVxdWVzdC53aXRoQ3JlZGVudGlhbHMgPSB0cnVlO1xuICAgIH1cblxuICAgIC8vIEFkZCByZXNwb25zZVR5cGUgdG8gcmVxdWVzdCBpZiBuZWVkZWRcbiAgICBpZiAoY29uZmlnLnJlc3BvbnNlVHlwZSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgcmVxdWVzdC5yZXNwb25zZVR5cGUgPSBjb25maWcucmVzcG9uc2VUeXBlO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAvLyBFeHBlY3RlZCBET01FeGNlcHRpb24gdGhyb3duIGJ5IGJyb3dzZXJzIG5vdCBjb21wYXRpYmxlIFhNTEh0dHBSZXF1ZXN0IExldmVsIDIuXG4gICAgICAgIC8vIEJ1dCwgdGhpcyBjYW4gYmUgc3VwcHJlc3NlZCBmb3IgJ2pzb24nIHR5cGUgYXMgaXQgY2FuIGJlIHBhcnNlZCBieSBkZWZhdWx0ICd0cmFuc2Zvcm1SZXNwb25zZScgZnVuY3Rpb24uXG4gICAgICAgIGlmIChjb25maWcucmVzcG9uc2VUeXBlICE9PSAnanNvbicpIHtcbiAgICAgICAgICB0aHJvdyBlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gSGFuZGxlIHByb2dyZXNzIGlmIG5lZWRlZFxuICAgIGlmICh0eXBlb2YgY29uZmlnLm9uRG93bmxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgcmVxdWVzdC5hZGRFdmVudExpc3RlbmVyKCdwcm9ncmVzcycsIGNvbmZpZy5vbkRvd25sb2FkUHJvZ3Jlc3MpO1xuICAgIH1cblxuICAgIC8vIE5vdCBhbGwgYnJvd3NlcnMgc3VwcG9ydCB1cGxvYWQgZXZlbnRzXG4gICAgaWYgKHR5cGVvZiBjb25maWcub25VcGxvYWRQcm9ncmVzcyA9PT0gJ2Z1bmN0aW9uJyAmJiByZXF1ZXN0LnVwbG9hZCkge1xuICAgICAgcmVxdWVzdC51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBjb25maWcub25VcGxvYWRQcm9ncmVzcyk7XG4gICAgfVxuXG4gICAgaWYgKGNvbmZpZy5jYW5jZWxUb2tlbikge1xuICAgICAgLy8gSGFuZGxlIGNhbmNlbGxhdGlvblxuICAgICAgY29uZmlnLmNhbmNlbFRva2VuLnByb21pc2UudGhlbihmdW5jdGlvbiBvbkNhbmNlbGVkKGNhbmNlbCkge1xuICAgICAgICBpZiAoIXJlcXVlc3QpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICByZXF1ZXN0LmFib3J0KCk7XG4gICAgICAgIHJlamVjdChjYW5jZWwpO1xuICAgICAgICAvLyBDbGVhbiB1cCByZXF1ZXN0XG4gICAgICAgIHJlcXVlc3QgPSBudWxsO1xuICAgICAgfSk7XG4gICAgfVxuXG4gICAgaWYgKHJlcXVlc3REYXRhID09PSB1bmRlZmluZWQpIHtcbiAgICAgIHJlcXVlc3REYXRhID0gbnVsbDtcbiAgICB9XG5cbiAgICAvLyBTZW5kIHRoZSByZXF1ZXN0XG4gICAgcmVxdWVzdC5zZW5kKHJlcXVlc3REYXRhKTtcbiAgfSk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCcuL3V0aWxzJyk7XG52YXIgYmluZCA9IHJlcXVpcmUoJy4vaGVscGVycy9iaW5kJyk7XG52YXIgQXhpb3MgPSByZXF1aXJlKCcuL2NvcmUvQXhpb3MnKTtcbnZhciBkZWZhdWx0cyA9IHJlcXVpcmUoJy4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gaW5zdGFuY2Ugb2YgQXhpb3NcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gZGVmYXVsdENvbmZpZyBUaGUgZGVmYXVsdCBjb25maWcgZm9yIHRoZSBpbnN0YW5jZVxuICogQHJldHVybiB7QXhpb3N9IEEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKi9cbmZ1bmN0aW9uIGNyZWF0ZUluc3RhbmNlKGRlZmF1bHRDb25maWcpIHtcbiAgdmFyIGNvbnRleHQgPSBuZXcgQXhpb3MoZGVmYXVsdENvbmZpZyk7XG4gIHZhciBpbnN0YW5jZSA9IGJpbmQoQXhpb3MucHJvdG90eXBlLnJlcXVlc3QsIGNvbnRleHQpO1xuXG4gIC8vIENvcHkgYXhpb3MucHJvdG90eXBlIHRvIGluc3RhbmNlXG4gIHV0aWxzLmV4dGVuZChpbnN0YW5jZSwgQXhpb3MucHJvdG90eXBlLCBjb250ZXh0KTtcblxuICAvLyBDb3B5IGNvbnRleHQgdG8gaW5zdGFuY2VcbiAgdXRpbHMuZXh0ZW5kKGluc3RhbmNlLCBjb250ZXh0KTtcblxuICByZXR1cm4gaW5zdGFuY2U7XG59XG5cbi8vIENyZWF0ZSB0aGUgZGVmYXVsdCBpbnN0YW5jZSB0byBiZSBleHBvcnRlZFxudmFyIGF4aW9zID0gY3JlYXRlSW5zdGFuY2UoZGVmYXVsdHMpO1xuXG4vLyBFeHBvc2UgQXhpb3MgY2xhc3MgdG8gYWxsb3cgY2xhc3MgaW5oZXJpdGFuY2VcbmF4aW9zLkF4aW9zID0gQXhpb3M7XG5cbi8vIEZhY3RvcnkgZm9yIGNyZWF0aW5nIG5ldyBpbnN0YW5jZXNcbmF4aW9zLmNyZWF0ZSA9IGZ1bmN0aW9uIGNyZWF0ZShpbnN0YW5jZUNvbmZpZykge1xuICByZXR1cm4gY3JlYXRlSW5zdGFuY2UodXRpbHMubWVyZ2UoZGVmYXVsdHMsIGluc3RhbmNlQ29uZmlnKSk7XG59O1xuXG4vLyBFeHBvc2UgQ2FuY2VsICYgQ2FuY2VsVG9rZW5cbmF4aW9zLkNhbmNlbCA9IHJlcXVpcmUoJy4vY2FuY2VsL0NhbmNlbCcpO1xuYXhpb3MuQ2FuY2VsVG9rZW4gPSByZXF1aXJlKCcuL2NhbmNlbC9DYW5jZWxUb2tlbicpO1xuYXhpb3MuaXNDYW5jZWwgPSByZXF1aXJlKCcuL2NhbmNlbC9pc0NhbmNlbCcpO1xuXG4vLyBFeHBvc2UgYWxsL3NwcmVhZFxuYXhpb3MuYWxsID0gZnVuY3Rpb24gYWxsKHByb21pc2VzKSB7XG4gIHJldHVybiBQcm9taXNlLmFsbChwcm9taXNlcyk7XG59O1xuYXhpb3Muc3ByZWFkID0gcmVxdWlyZSgnLi9oZWxwZXJzL3NwcmVhZCcpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IGF4aW9zO1xuXG4vLyBBbGxvdyB1c2Ugb2YgZGVmYXVsdCBpbXBvcnQgc3ludGF4IGluIFR5cGVTY3JpcHRcbm1vZHVsZS5leHBvcnRzLmRlZmF1bHQgPSBheGlvcztcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBBIGBDYW5jZWxgIGlzIGFuIG9iamVjdCB0aGF0IGlzIHRocm93biB3aGVuIGFuIG9wZXJhdGlvbiBpcyBjYW5jZWxlZC5cbiAqXG4gKiBAY2xhc3NcbiAqIEBwYXJhbSB7c3RyaW5nPX0gbWVzc2FnZSBUaGUgbWVzc2FnZS5cbiAqL1xuZnVuY3Rpb24gQ2FuY2VsKG1lc3NhZ2UpIHtcbiAgdGhpcy5tZXNzYWdlID0gbWVzc2FnZTtcbn1cblxuQ2FuY2VsLnByb3RvdHlwZS50b1N0cmluZyA9IGZ1bmN0aW9uIHRvU3RyaW5nKCkge1xuICByZXR1cm4gJ0NhbmNlbCcgKyAodGhpcy5tZXNzYWdlID8gJzogJyArIHRoaXMubWVzc2FnZSA6ICcnKTtcbn07XG5cbkNhbmNlbC5wcm90b3R5cGUuX19DQU5DRUxfXyA9IHRydWU7XG5cbm1vZHVsZS5leHBvcnRzID0gQ2FuY2VsO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgQ2FuY2VsID0gcmVxdWlyZSgnLi9DYW5jZWwnKTtcblxuLyoqXG4gKiBBIGBDYW5jZWxUb2tlbmAgaXMgYW4gb2JqZWN0IHRoYXQgY2FuIGJlIHVzZWQgdG8gcmVxdWVzdCBjYW5jZWxsYXRpb24gb2YgYW4gb3BlcmF0aW9uLlxuICpcbiAqIEBjbGFzc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gZXhlY3V0b3IgVGhlIGV4ZWN1dG9yIGZ1bmN0aW9uLlxuICovXG5mdW5jdGlvbiBDYW5jZWxUb2tlbihleGVjdXRvcikge1xuICBpZiAodHlwZW9mIGV4ZWN1dG9yICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZXhlY3V0b3IgbXVzdCBiZSBhIGZ1bmN0aW9uLicpO1xuICB9XG5cbiAgdmFyIHJlc29sdmVQcm9taXNlO1xuICB0aGlzLnByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbiBwcm9taXNlRXhlY3V0b3IocmVzb2x2ZSkge1xuICAgIHJlc29sdmVQcm9taXNlID0gcmVzb2x2ZTtcbiAgfSk7XG5cbiAgdmFyIHRva2VuID0gdGhpcztcbiAgZXhlY3V0b3IoZnVuY3Rpb24gY2FuY2VsKG1lc3NhZ2UpIHtcbiAgICBpZiAodG9rZW4ucmVhc29uKSB7XG4gICAgICAvLyBDYW5jZWxsYXRpb24gaGFzIGFscmVhZHkgYmVlbiByZXF1ZXN0ZWRcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB0b2tlbi5yZWFzb24gPSBuZXcgQ2FuY2VsKG1lc3NhZ2UpO1xuICAgIHJlc29sdmVQcm9taXNlKHRva2VuLnJlYXNvbik7XG4gIH0pO1xufVxuXG4vKipcbiAqIFRocm93cyBhIGBDYW5jZWxgIGlmIGNhbmNlbGxhdGlvbiBoYXMgYmVlbiByZXF1ZXN0ZWQuXG4gKi9cbkNhbmNlbFRva2VuLnByb3RvdHlwZS50aHJvd0lmUmVxdWVzdGVkID0gZnVuY3Rpb24gdGhyb3dJZlJlcXVlc3RlZCgpIHtcbiAgaWYgKHRoaXMucmVhc29uKSB7XG4gICAgdGhyb3cgdGhpcy5yZWFzb247XG4gIH1cbn07XG5cbi8qKlxuICogUmV0dXJucyBhbiBvYmplY3QgdGhhdCBjb250YWlucyBhIG5ldyBgQ2FuY2VsVG9rZW5gIGFuZCBhIGZ1bmN0aW9uIHRoYXQsIHdoZW4gY2FsbGVkLFxuICogY2FuY2VscyB0aGUgYENhbmNlbFRva2VuYC5cbiAqL1xuQ2FuY2VsVG9rZW4uc291cmNlID0gZnVuY3Rpb24gc291cmNlKCkge1xuICB2YXIgY2FuY2VsO1xuICB2YXIgdG9rZW4gPSBuZXcgQ2FuY2VsVG9rZW4oZnVuY3Rpb24gZXhlY3V0b3IoYykge1xuICAgIGNhbmNlbCA9IGM7XG4gIH0pO1xuICByZXR1cm4ge1xuICAgIHRva2VuOiB0b2tlbixcbiAgICBjYW5jZWw6IGNhbmNlbFxuICB9O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBDYW5jZWxUb2tlbjtcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0NhbmNlbCh2YWx1ZSkge1xuICByZXR1cm4gISEodmFsdWUgJiYgdmFsdWUuX19DQU5DRUxfXyk7XG59O1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZGVmYXVsdHMgPSByZXF1aXJlKCcuLy4uL2RlZmF1bHRzJyk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCcuLy4uL3V0aWxzJyk7XG52YXIgSW50ZXJjZXB0b3JNYW5hZ2VyID0gcmVxdWlyZSgnLi9JbnRlcmNlcHRvck1hbmFnZXInKTtcbnZhciBkaXNwYXRjaFJlcXVlc3QgPSByZXF1aXJlKCcuL2Rpc3BhdGNoUmVxdWVzdCcpO1xudmFyIGlzQWJzb2x1dGVVUkwgPSByZXF1aXJlKCcuLy4uL2hlbHBlcnMvaXNBYnNvbHV0ZVVSTCcpO1xudmFyIGNvbWJpbmVVUkxzID0gcmVxdWlyZSgnLi8uLi9oZWxwZXJzL2NvbWJpbmVVUkxzJyk7XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IGluc3RhbmNlIG9mIEF4aW9zXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IGluc3RhbmNlQ29uZmlnIFRoZSBkZWZhdWx0IGNvbmZpZyBmb3IgdGhlIGluc3RhbmNlXG4gKi9cbmZ1bmN0aW9uIEF4aW9zKGluc3RhbmNlQ29uZmlnKSB7XG4gIHRoaXMuZGVmYXVsdHMgPSBpbnN0YW5jZUNvbmZpZztcbiAgdGhpcy5pbnRlcmNlcHRvcnMgPSB7XG4gICAgcmVxdWVzdDogbmV3IEludGVyY2VwdG9yTWFuYWdlcigpLFxuICAgIHJlc3BvbnNlOiBuZXcgSW50ZXJjZXB0b3JNYW5hZ2VyKClcbiAgfTtcbn1cblxuLyoqXG4gKiBEaXNwYXRjaCBhIHJlcXVlc3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcgc3BlY2lmaWMgZm9yIHRoaXMgcmVxdWVzdCAobWVyZ2VkIHdpdGggdGhpcy5kZWZhdWx0cylcbiAqL1xuQXhpb3MucHJvdG90eXBlLnJlcXVlc3QgPSBmdW5jdGlvbiByZXF1ZXN0KGNvbmZpZykge1xuICAvKmVzbGludCBuby1wYXJhbS1yZWFzc2lnbjowKi9cbiAgLy8gQWxsb3cgZm9yIGF4aW9zKCdleGFtcGxlL3VybCdbLCBjb25maWddKSBhIGxhIGZldGNoIEFQSVxuICBpZiAodHlwZW9mIGNvbmZpZyA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25maWcgPSB1dGlscy5tZXJnZSh7XG4gICAgICB1cmw6IGFyZ3VtZW50c1swXVxuICAgIH0sIGFyZ3VtZW50c1sxXSk7XG4gIH1cblxuICBjb25maWcgPSB1dGlscy5tZXJnZShkZWZhdWx0cywgdGhpcy5kZWZhdWx0cywgeyBtZXRob2Q6ICdnZXQnIH0sIGNvbmZpZyk7XG4gIGNvbmZpZy5tZXRob2QgPSBjb25maWcubWV0aG9kLnRvTG93ZXJDYXNlKCk7XG5cbiAgLy8gU3VwcG9ydCBiYXNlVVJMIGNvbmZpZ1xuICBpZiAoY29uZmlnLmJhc2VVUkwgJiYgIWlzQWJzb2x1dGVVUkwoY29uZmlnLnVybCkpIHtcbiAgICBjb25maWcudXJsID0gY29tYmluZVVSTHMoY29uZmlnLmJhc2VVUkwsIGNvbmZpZy51cmwpO1xuICB9XG5cbiAgLy8gSG9vayB1cCBpbnRlcmNlcHRvcnMgbWlkZGxld2FyZVxuICB2YXIgY2hhaW4gPSBbZGlzcGF0Y2hSZXF1ZXN0LCB1bmRlZmluZWRdO1xuICB2YXIgcHJvbWlzZSA9IFByb21pc2UucmVzb2x2ZShjb25maWcpO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlcXVlc3QuZm9yRWFjaChmdW5jdGlvbiB1bnNoaWZ0UmVxdWVzdEludGVyY2VwdG9ycyhpbnRlcmNlcHRvcikge1xuICAgIGNoYWluLnVuc2hpZnQoaW50ZXJjZXB0b3IuZnVsZmlsbGVkLCBpbnRlcmNlcHRvci5yZWplY3RlZCk7XG4gIH0pO1xuXG4gIHRoaXMuaW50ZXJjZXB0b3JzLnJlc3BvbnNlLmZvckVhY2goZnVuY3Rpb24gcHVzaFJlc3BvbnNlSW50ZXJjZXB0b3JzKGludGVyY2VwdG9yKSB7XG4gICAgY2hhaW4ucHVzaChpbnRlcmNlcHRvci5mdWxmaWxsZWQsIGludGVyY2VwdG9yLnJlamVjdGVkKTtcbiAgfSk7XG5cbiAgd2hpbGUgKGNoYWluLmxlbmd0aCkge1xuICAgIHByb21pc2UgPSBwcm9taXNlLnRoZW4oY2hhaW4uc2hpZnQoKSwgY2hhaW4uc2hpZnQoKSk7XG4gIH1cblxuICByZXR1cm4gcHJvbWlzZTtcbn07XG5cbi8vIFByb3ZpZGUgYWxpYXNlcyBmb3Igc3VwcG9ydGVkIHJlcXVlc3QgbWV0aG9kc1xudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdvcHRpb25zJ10sIGZ1bmN0aW9uIGZvckVhY2hNZXRob2ROb0RhdGEobWV0aG9kKSB7XG4gIC8qZXNsaW50IGZ1bmMtbmFtZXM6MCovXG4gIEF4aW9zLnByb3RvdHlwZVttZXRob2RdID0gZnVuY3Rpb24odXJsLCBjb25maWcpIHtcbiAgICByZXR1cm4gdGhpcy5yZXF1ZXN0KHV0aWxzLm1lcmdlKGNvbmZpZyB8fCB7fSwge1xuICAgICAgbWV0aG9kOiBtZXRob2QsXG4gICAgICB1cmw6IHVybFxuICAgIH0pKTtcbiAgfTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICAvKmVzbGludCBmdW5jLW5hbWVzOjAqL1xuICBBeGlvcy5wcm90b3R5cGVbbWV0aG9kXSA9IGZ1bmN0aW9uKHVybCwgZGF0YSwgY29uZmlnKSB7XG4gICAgcmV0dXJuIHRoaXMucmVxdWVzdCh1dGlscy5tZXJnZShjb25maWcgfHwge30sIHtcbiAgICAgIG1ldGhvZDogbWV0aG9kLFxuICAgICAgdXJsOiB1cmwsXG4gICAgICBkYXRhOiBkYXRhXG4gICAgfSkpO1xuICB9O1xufSk7XG5cbm1vZHVsZS5leHBvcnRzID0gQXhpb3M7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuZnVuY3Rpb24gSW50ZXJjZXB0b3JNYW5hZ2VyKCkge1xuICB0aGlzLmhhbmRsZXJzID0gW107XG59XG5cbi8qKlxuICogQWRkIGEgbmV3IGludGVyY2VwdG9yIHRvIHRoZSBzdGFja1xuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bGZpbGxlZCBUaGUgZnVuY3Rpb24gdG8gaGFuZGxlIGB0aGVuYCBmb3IgYSBgUHJvbWlzZWBcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlamVjdGVkIFRoZSBmdW5jdGlvbiB0byBoYW5kbGUgYHJlamVjdGAgZm9yIGEgYFByb21pc2VgXG4gKlxuICogQHJldHVybiB7TnVtYmVyfSBBbiBJRCB1c2VkIHRvIHJlbW92ZSBpbnRlcmNlcHRvciBsYXRlclxuICovXG5JbnRlcmNlcHRvck1hbmFnZXIucHJvdG90eXBlLnVzZSA9IGZ1bmN0aW9uIHVzZShmdWxmaWxsZWQsIHJlamVjdGVkKSB7XG4gIHRoaXMuaGFuZGxlcnMucHVzaCh7XG4gICAgZnVsZmlsbGVkOiBmdWxmaWxsZWQsXG4gICAgcmVqZWN0ZWQ6IHJlamVjdGVkXG4gIH0pO1xuICByZXR1cm4gdGhpcy5oYW5kbGVycy5sZW5ndGggLSAxO1xufTtcblxuLyoqXG4gKiBSZW1vdmUgYW4gaW50ZXJjZXB0b3IgZnJvbSB0aGUgc3RhY2tcbiAqXG4gKiBAcGFyYW0ge051bWJlcn0gaWQgVGhlIElEIHRoYXQgd2FzIHJldHVybmVkIGJ5IGB1c2VgXG4gKi9cbkludGVyY2VwdG9yTWFuYWdlci5wcm90b3R5cGUuZWplY3QgPSBmdW5jdGlvbiBlamVjdChpZCkge1xuICBpZiAodGhpcy5oYW5kbGVyc1tpZF0pIHtcbiAgICB0aGlzLmhhbmRsZXJzW2lkXSA9IG51bGw7XG4gIH1cbn07XG5cbi8qKlxuICogSXRlcmF0ZSBvdmVyIGFsbCB0aGUgcmVnaXN0ZXJlZCBpbnRlcmNlcHRvcnNcbiAqXG4gKiBUaGlzIG1ldGhvZCBpcyBwYXJ0aWN1bGFybHkgdXNlZnVsIGZvciBza2lwcGluZyBvdmVyIGFueVxuICogaW50ZXJjZXB0b3JzIHRoYXQgbWF5IGhhdmUgYmVjb21lIGBudWxsYCBjYWxsaW5nIGBlamVjdGAuXG4gKlxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGZ1bmN0aW9uIHRvIGNhbGwgZm9yIGVhY2ggaW50ZXJjZXB0b3JcbiAqL1xuSW50ZXJjZXB0b3JNYW5hZ2VyLnByb3RvdHlwZS5mb3JFYWNoID0gZnVuY3Rpb24gZm9yRWFjaChmbikge1xuICB1dGlscy5mb3JFYWNoKHRoaXMuaGFuZGxlcnMsIGZ1bmN0aW9uIGZvckVhY2hIYW5kbGVyKGgpIHtcbiAgICBpZiAoaCAhPT0gbnVsbCkge1xuICAgICAgZm4oaCk7XG4gICAgfVxuICB9KTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW50ZXJjZXB0b3JNYW5hZ2VyO1xuIiwiJ3VzZSBzdHJpY3QnO1xuXG52YXIgZW5oYW5jZUVycm9yID0gcmVxdWlyZSgnLi9lbmhhbmNlRXJyb3InKTtcblxuLyoqXG4gKiBDcmVhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIG1lc3NhZ2UsIGNvbmZpZywgZXJyb3IgY29kZSwgcmVxdWVzdCBhbmQgcmVzcG9uc2UuXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IG1lc3NhZ2UgVGhlIGVycm9yIG1lc3NhZ2UuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGNyZWF0ZWQgZXJyb3IuXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gY3JlYXRlRXJyb3IobWVzc2FnZSwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IobWVzc2FnZSk7XG4gIHJldHVybiBlbmhhbmNlRXJyb3IoZXJyb3IsIGNvbmZpZywgY29kZSwgcmVxdWVzdCwgcmVzcG9uc2UpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xudmFyIHRyYW5zZm9ybURhdGEgPSByZXF1aXJlKCcuL3RyYW5zZm9ybURhdGEnKTtcbnZhciBpc0NhbmNlbCA9IHJlcXVpcmUoJy4uL2NhbmNlbC9pc0NhbmNlbCcpO1xudmFyIGRlZmF1bHRzID0gcmVxdWlyZSgnLi4vZGVmYXVsdHMnKTtcblxuLyoqXG4gKiBUaHJvd3MgYSBgQ2FuY2VsYCBpZiBjYW5jZWxsYXRpb24gaGFzIGJlZW4gcmVxdWVzdGVkLlxuICovXG5mdW5jdGlvbiB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZykge1xuICBpZiAoY29uZmlnLmNhbmNlbFRva2VuKSB7XG4gICAgY29uZmlnLmNhbmNlbFRva2VuLnRocm93SWZSZXF1ZXN0ZWQoKTtcbiAgfVxufVxuXG4vKipcbiAqIERpc3BhdGNoIGEgcmVxdWVzdCB0byB0aGUgc2VydmVyIHVzaW5nIHRoZSBjb25maWd1cmVkIGFkYXB0ZXIuXG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGNvbmZpZyBUaGUgY29uZmlnIHRoYXQgaXMgdG8gYmUgdXNlZCBmb3IgdGhlIHJlcXVlc3RcbiAqIEByZXR1cm5zIHtQcm9taXNlfSBUaGUgUHJvbWlzZSB0byBiZSBmdWxmaWxsZWRcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBkaXNwYXRjaFJlcXVlc3QoY29uZmlnKSB7XG4gIHRocm93SWZDYW5jZWxsYXRpb25SZXF1ZXN0ZWQoY29uZmlnKTtcblxuICAvLyBFbnN1cmUgaGVhZGVycyBleGlzdFxuICBjb25maWcuaGVhZGVycyA9IGNvbmZpZy5oZWFkZXJzIHx8IHt9O1xuXG4gIC8vIFRyYW5zZm9ybSByZXF1ZXN0IGRhdGFcbiAgY29uZmlnLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgIGNvbmZpZy5kYXRhLFxuICAgIGNvbmZpZy5oZWFkZXJzLFxuICAgIGNvbmZpZy50cmFuc2Zvcm1SZXF1ZXN0XG4gICk7XG5cbiAgLy8gRmxhdHRlbiBoZWFkZXJzXG4gIGNvbmZpZy5oZWFkZXJzID0gdXRpbHMubWVyZ2UoXG4gICAgY29uZmlnLmhlYWRlcnMuY29tbW9uIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzW2NvbmZpZy5tZXRob2RdIHx8IHt9LFxuICAgIGNvbmZpZy5oZWFkZXJzIHx8IHt9XG4gICk7XG5cbiAgdXRpbHMuZm9yRWFjaChcbiAgICBbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCcsICdwb3N0JywgJ3B1dCcsICdwYXRjaCcsICdjb21tb24nXSxcbiAgICBmdW5jdGlvbiBjbGVhbkhlYWRlckNvbmZpZyhtZXRob2QpIHtcbiAgICAgIGRlbGV0ZSBjb25maWcuaGVhZGVyc1ttZXRob2RdO1xuICAgIH1cbiAgKTtcblxuICB2YXIgYWRhcHRlciA9IGNvbmZpZy5hZGFwdGVyIHx8IGRlZmF1bHRzLmFkYXB0ZXI7XG5cbiAgcmV0dXJuIGFkYXB0ZXIoY29uZmlnKS50aGVuKGZ1bmN0aW9uIG9uQWRhcHRlclJlc29sdXRpb24ocmVzcG9uc2UpIHtcbiAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAvLyBUcmFuc2Zvcm0gcmVzcG9uc2UgZGF0YVxuICAgIHJlc3BvbnNlLmRhdGEgPSB0cmFuc2Zvcm1EYXRhKFxuICAgICAgcmVzcG9uc2UuZGF0YSxcbiAgICAgIHJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICBjb25maWcudHJhbnNmb3JtUmVzcG9uc2VcbiAgICApO1xuXG4gICAgcmV0dXJuIHJlc3BvbnNlO1xuICB9LCBmdW5jdGlvbiBvbkFkYXB0ZXJSZWplY3Rpb24ocmVhc29uKSB7XG4gICAgaWYgKCFpc0NhbmNlbChyZWFzb24pKSB7XG4gICAgICB0aHJvd0lmQ2FuY2VsbGF0aW9uUmVxdWVzdGVkKGNvbmZpZyk7XG5cbiAgICAgIC8vIFRyYW5zZm9ybSByZXNwb25zZSBkYXRhXG4gICAgICBpZiAocmVhc29uICYmIHJlYXNvbi5yZXNwb25zZSkge1xuICAgICAgICByZWFzb24ucmVzcG9uc2UuZGF0YSA9IHRyYW5zZm9ybURhdGEoXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmRhdGEsXG4gICAgICAgICAgcmVhc29uLnJlc3BvbnNlLmhlYWRlcnMsXG4gICAgICAgICAgY29uZmlnLnRyYW5zZm9ybVJlc3BvbnNlXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIFByb21pc2UucmVqZWN0KHJlYXNvbik7XG4gIH0pO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBVcGRhdGUgYW4gRXJyb3Igd2l0aCB0aGUgc3BlY2lmaWVkIGNvbmZpZywgZXJyb3IgY29kZSwgYW5kIHJlc3BvbnNlLlxuICpcbiAqIEBwYXJhbSB7RXJyb3J9IGVycm9yIFRoZSBlcnJvciB0byB1cGRhdGUuXG4gKiBAcGFyYW0ge09iamVjdH0gY29uZmlnIFRoZSBjb25maWcuXG4gKiBAcGFyYW0ge3N0cmluZ30gW2NvZGVdIFRoZSBlcnJvciBjb2RlIChmb3IgZXhhbXBsZSwgJ0VDT05OQUJPUlRFRCcpLlxuICogQHBhcmFtIHtPYmplY3R9IFtyZXF1ZXN0XSBUaGUgcmVxdWVzdC5cbiAqIEBwYXJhbSB7T2JqZWN0fSBbcmVzcG9uc2VdIFRoZSByZXNwb25zZS5cbiAqIEByZXR1cm5zIHtFcnJvcn0gVGhlIGVycm9yLlxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGVuaGFuY2VFcnJvcihlcnJvciwgY29uZmlnLCBjb2RlLCByZXF1ZXN0LCByZXNwb25zZSkge1xuICBlcnJvci5jb25maWcgPSBjb25maWc7XG4gIGlmIChjb2RlKSB7XG4gICAgZXJyb3IuY29kZSA9IGNvZGU7XG4gIH1cbiAgZXJyb3IucmVxdWVzdCA9IHJlcXVlc3Q7XG4gIGVycm9yLnJlc3BvbnNlID0gcmVzcG9uc2U7XG4gIHJldHVybiBlcnJvcjtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBjcmVhdGVFcnJvciA9IHJlcXVpcmUoJy4vY3JlYXRlRXJyb3InKTtcblxuLyoqXG4gKiBSZXNvbHZlIG9yIHJlamVjdCBhIFByb21pc2UgYmFzZWQgb24gcmVzcG9uc2Ugc3RhdHVzLlxuICpcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHJlc29sdmUgQSBmdW5jdGlvbiB0aGF0IHJlc29sdmVzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtGdW5jdGlvbn0gcmVqZWN0IEEgZnVuY3Rpb24gdGhhdCByZWplY3RzIHRoZSBwcm9taXNlLlxuICogQHBhcmFtIHtvYmplY3R9IHJlc3BvbnNlIFRoZSByZXNwb25zZS5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCByZXNwb25zZSkge1xuICB2YXIgdmFsaWRhdGVTdGF0dXMgPSByZXNwb25zZS5jb25maWcudmFsaWRhdGVTdGF0dXM7XG4gIC8vIE5vdGU6IHN0YXR1cyBpcyBub3QgZXhwb3NlZCBieSBYRG9tYWluUmVxdWVzdFxuICBpZiAoIXJlc3BvbnNlLnN0YXR1cyB8fCAhdmFsaWRhdGVTdGF0dXMgfHwgdmFsaWRhdGVTdGF0dXMocmVzcG9uc2Uuc3RhdHVzKSkge1xuICAgIHJlc29sdmUocmVzcG9uc2UpO1xuICB9IGVsc2Uge1xuICAgIHJlamVjdChjcmVhdGVFcnJvcihcbiAgICAgICdSZXF1ZXN0IGZhaWxlZCB3aXRoIHN0YXR1cyBjb2RlICcgKyByZXNwb25zZS5zdGF0dXMsXG4gICAgICByZXNwb25zZS5jb25maWcsXG4gICAgICBudWxsLFxuICAgICAgcmVzcG9uc2UucmVxdWVzdCxcbiAgICAgIHJlc3BvbnNlXG4gICAgKSk7XG4gIH1cbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuLyoqXG4gKiBUcmFuc2Zvcm0gdGhlIGRhdGEgZm9yIGEgcmVxdWVzdCBvciBhIHJlc3BvbnNlXG4gKlxuICogQHBhcmFtIHtPYmplY3R8U3RyaW5nfSBkYXRhIFRoZSBkYXRhIHRvIGJlIHRyYW5zZm9ybWVkXG4gKiBAcGFyYW0ge0FycmF5fSBoZWFkZXJzIFRoZSBoZWFkZXJzIGZvciB0aGUgcmVxdWVzdCBvciByZXNwb25zZVxuICogQHBhcmFtIHtBcnJheXxGdW5jdGlvbn0gZm5zIEEgc2luZ2xlIGZ1bmN0aW9uIG9yIEFycmF5IG9mIGZ1bmN0aW9uc1xuICogQHJldHVybnMgeyp9IFRoZSByZXN1bHRpbmcgdHJhbnNmb3JtZWQgZGF0YVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHRyYW5zZm9ybURhdGEoZGF0YSwgaGVhZGVycywgZm5zKSB7XG4gIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICB1dGlscy5mb3JFYWNoKGZucywgZnVuY3Rpb24gdHJhbnNmb3JtKGZuKSB7XG4gICAgZGF0YSA9IGZuKGRhdGEsIGhlYWRlcnMpO1xuICB9KTtcblxuICByZXR1cm4gZGF0YTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbnZhciBub3JtYWxpemVIZWFkZXJOYW1lID0gcmVxdWlyZSgnLi9oZWxwZXJzL25vcm1hbGl6ZUhlYWRlck5hbWUnKTtcblxudmFyIERFRkFVTFRfQ09OVEVOVF9UWVBFID0ge1xuICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCdcbn07XG5cbmZ1bmN0aW9uIHNldENvbnRlbnRUeXBlSWZVbnNldChoZWFkZXJzLCB2YWx1ZSkge1xuICBpZiAoIXV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnMpICYmIHV0aWxzLmlzVW5kZWZpbmVkKGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddKSkge1xuICAgIGhlYWRlcnNbJ0NvbnRlbnQtVHlwZSddID0gdmFsdWU7XG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGVmYXVsdEFkYXB0ZXIoKSB7XG4gIHZhciBhZGFwdGVyO1xuICBpZiAodHlwZW9mIFhNTEh0dHBSZXF1ZXN0ICE9PSAndW5kZWZpbmVkJykge1xuICAgIC8vIEZvciBicm93c2VycyB1c2UgWEhSIGFkYXB0ZXJcbiAgICBhZGFwdGVyID0gcmVxdWlyZSgnLi9hZGFwdGVycy94aHInKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAvLyBGb3Igbm9kZSB1c2UgSFRUUCBhZGFwdGVyXG4gICAgYWRhcHRlciA9IHJlcXVpcmUoJy4vYWRhcHRlcnMvaHR0cCcpO1xuICB9XG4gIHJldHVybiBhZGFwdGVyO1xufVxuXG52YXIgZGVmYXVsdHMgPSB7XG4gIGFkYXB0ZXI6IGdldERlZmF1bHRBZGFwdGVyKCksXG5cbiAgdHJhbnNmb3JtUmVxdWVzdDogW2Z1bmN0aW9uIHRyYW5zZm9ybVJlcXVlc3QoZGF0YSwgaGVhZGVycykge1xuICAgIG5vcm1hbGl6ZUhlYWRlck5hbWUoaGVhZGVycywgJ0NvbnRlbnQtVHlwZScpO1xuICAgIGlmICh1dGlscy5pc0Zvcm1EYXRhKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0FycmF5QnVmZmVyKGRhdGEpIHx8XG4gICAgICB1dGlscy5pc0J1ZmZlcihkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNTdHJlYW0oZGF0YSkgfHxcbiAgICAgIHV0aWxzLmlzRmlsZShkYXRhKSB8fFxuICAgICAgdXRpbHMuaXNCbG9iKGRhdGEpXG4gICAgKSB7XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzQXJyYXlCdWZmZXJWaWV3KGRhdGEpKSB7XG4gICAgICByZXR1cm4gZGF0YS5idWZmZXI7XG4gICAgfVxuICAgIGlmICh1dGlscy5pc1VSTFNlYXJjaFBhcmFtcyhkYXRhKSkge1xuICAgICAgc2V0Q29udGVudFR5cGVJZlVuc2V0KGhlYWRlcnMsICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIGRhdGEudG9TdHJpbmcoKTtcbiAgICB9XG4gICAgaWYgKHV0aWxzLmlzT2JqZWN0KGRhdGEpKSB7XG4gICAgICBzZXRDb250ZW50VHlwZUlmVW5zZXQoaGVhZGVycywgJ2FwcGxpY2F0aW9uL2pzb247Y2hhcnNldD11dGYtOCcpO1xuICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KGRhdGEpO1xuICAgIH1cbiAgICByZXR1cm4gZGF0YTtcbiAgfV0sXG5cbiAgdHJhbnNmb3JtUmVzcG9uc2U6IFtmdW5jdGlvbiB0cmFuc2Zvcm1SZXNwb25zZShkYXRhKSB7XG4gICAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gICAgaWYgKHR5cGVvZiBkYXRhID09PSAnc3RyaW5nJykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgZGF0YSA9IEpTT04ucGFyc2UoZGF0YSk7XG4gICAgICB9IGNhdGNoIChlKSB7IC8qIElnbm9yZSAqLyB9XG4gICAgfVxuICAgIHJldHVybiBkYXRhO1xuICB9XSxcblxuICB0aW1lb3V0OiAwLFxuXG4gIHhzcmZDb29raWVOYW1lOiAnWFNSRi1UT0tFTicsXG4gIHhzcmZIZWFkZXJOYW1lOiAnWC1YU1JGLVRPS0VOJyxcblxuICBtYXhDb250ZW50TGVuZ3RoOiAtMSxcblxuICB2YWxpZGF0ZVN0YXR1czogZnVuY3Rpb24gdmFsaWRhdGVTdGF0dXMoc3RhdHVzKSB7XG4gICAgcmV0dXJuIHN0YXR1cyA+PSAyMDAgJiYgc3RhdHVzIDwgMzAwO1xuICB9XG59O1xuXG5kZWZhdWx0cy5oZWFkZXJzID0ge1xuICBjb21tb246IHtcbiAgICAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKidcbiAgfVxufTtcblxudXRpbHMuZm9yRWFjaChbJ2RlbGV0ZScsICdnZXQnLCAnaGVhZCddLCBmdW5jdGlvbiBmb3JFYWNoTWV0aG9kTm9EYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB7fTtcbn0pO1xuXG51dGlscy5mb3JFYWNoKFsncG9zdCcsICdwdXQnLCAncGF0Y2gnXSwgZnVuY3Rpb24gZm9yRWFjaE1ldGhvZFdpdGhEYXRhKG1ldGhvZCkge1xuICBkZWZhdWx0cy5oZWFkZXJzW21ldGhvZF0gPSB1dGlscy5tZXJnZShERUZBVUxUX0NPTlRFTlRfVFlQRSk7XG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBkZWZhdWx0cztcbiIsIid1c2Ugc3RyaWN0JztcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBiaW5kKGZuLCB0aGlzQXJnKSB7XG4gIHJldHVybiBmdW5jdGlvbiB3cmFwKCkge1xuICAgIHZhciBhcmdzID0gbmV3IEFycmF5KGFyZ3VtZW50cy5sZW5ndGgpO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJncy5sZW5ndGg7IGkrKykge1xuICAgICAgYXJnc1tpXSA9IGFyZ3VtZW50c1tpXTtcbiAgICB9XG4gICAgcmV0dXJuIGZuLmFwcGx5KHRoaXNBcmcsIGFyZ3MpO1xuICB9O1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLy8gYnRvYSBwb2x5ZmlsbCBmb3IgSUU8MTAgY291cnRlc3kgaHR0cHM6Ly9naXRodWIuY29tL2RhdmlkY2hhbWJlcnMvQmFzZTY0LmpzXG5cbnZhciBjaGFycyA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG5cbmZ1bmN0aW9uIEUoKSB7XG4gIHRoaXMubWVzc2FnZSA9ICdTdHJpbmcgY29udGFpbnMgYW4gaW52YWxpZCBjaGFyYWN0ZXInO1xufVxuRS5wcm90b3R5cGUgPSBuZXcgRXJyb3I7XG5FLnByb3RvdHlwZS5jb2RlID0gNTtcbkUucHJvdG90eXBlLm5hbWUgPSAnSW52YWxpZENoYXJhY3RlckVycm9yJztcblxuZnVuY3Rpb24gYnRvYShpbnB1dCkge1xuICB2YXIgc3RyID0gU3RyaW5nKGlucHV0KTtcbiAgdmFyIG91dHB1dCA9ICcnO1xuICBmb3IgKFxuICAgIC8vIGluaXRpYWxpemUgcmVzdWx0IGFuZCBjb3VudGVyXG4gICAgdmFyIGJsb2NrLCBjaGFyQ29kZSwgaWR4ID0gMCwgbWFwID0gY2hhcnM7XG4gICAgLy8gaWYgdGhlIG5leHQgc3RyIGluZGV4IGRvZXMgbm90IGV4aXN0OlxuICAgIC8vICAgY2hhbmdlIHRoZSBtYXBwaW5nIHRhYmxlIHRvIFwiPVwiXG4gICAgLy8gICBjaGVjayBpZiBkIGhhcyBubyBmcmFjdGlvbmFsIGRpZ2l0c1xuICAgIHN0ci5jaGFyQXQoaWR4IHwgMCkgfHwgKG1hcCA9ICc9JywgaWR4ICUgMSk7XG4gICAgLy8gXCI4IC0gaWR4ICUgMSAqIDhcIiBnZW5lcmF0ZXMgdGhlIHNlcXVlbmNlIDIsIDQsIDYsIDhcbiAgICBvdXRwdXQgKz0gbWFwLmNoYXJBdCg2MyAmIGJsb2NrID4+IDggLSBpZHggJSAxICogOClcbiAgKSB7XG4gICAgY2hhckNvZGUgPSBzdHIuY2hhckNvZGVBdChpZHggKz0gMyAvIDQpO1xuICAgIGlmIChjaGFyQ29kZSA+IDB4RkYpIHtcbiAgICAgIHRocm93IG5ldyBFKCk7XG4gICAgfVxuICAgIGJsb2NrID0gYmxvY2sgPDwgOCB8IGNoYXJDb2RlO1xuICB9XG4gIHJldHVybiBvdXRwdXQ7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gYnRvYTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5mdW5jdGlvbiBlbmNvZGUodmFsKSB7XG4gIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQodmFsKS5cbiAgICByZXBsYWNlKC8lNDAvZ2ksICdAJykuXG4gICAgcmVwbGFjZSgvJTNBL2dpLCAnOicpLlxuICAgIHJlcGxhY2UoLyUyNC9nLCAnJCcpLlxuICAgIHJlcGxhY2UoLyUyQy9naSwgJywnKS5cbiAgICByZXBsYWNlKC8lMjAvZywgJysnKS5cbiAgICByZXBsYWNlKC8lNUIvZ2ksICdbJykuXG4gICAgcmVwbGFjZSgvJTVEL2dpLCAnXScpO1xufVxuXG4vKipcbiAqIEJ1aWxkIGEgVVJMIGJ5IGFwcGVuZGluZyBwYXJhbXMgdG8gdGhlIGVuZFxuICpcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmwgVGhlIGJhc2Ugb2YgdGhlIHVybCAoZS5nLiwgaHR0cDovL3d3dy5nb29nbGUuY29tKVxuICogQHBhcmFtIHtvYmplY3R9IFtwYXJhbXNdIFRoZSBwYXJhbXMgdG8gYmUgYXBwZW5kZWRcbiAqIEByZXR1cm5zIHtzdHJpbmd9IFRoZSBmb3JtYXR0ZWQgdXJsXG4gKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gYnVpbGRVUkwodXJsLCBwYXJhbXMsIHBhcmFtc1NlcmlhbGl6ZXIpIHtcbiAgLyplc2xpbnQgbm8tcGFyYW0tcmVhc3NpZ246MCovXG4gIGlmICghcGFyYW1zKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxuXG4gIHZhciBzZXJpYWxpemVkUGFyYW1zO1xuICBpZiAocGFyYW1zU2VyaWFsaXplcikge1xuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJhbXNTZXJpYWxpemVyKHBhcmFtcyk7XG4gIH0gZWxzZSBpZiAodXRpbHMuaXNVUkxTZWFyY2hQYXJhbXMocGFyYW1zKSkge1xuICAgIHNlcmlhbGl6ZWRQYXJhbXMgPSBwYXJhbXMudG9TdHJpbmcoKTtcbiAgfSBlbHNlIHtcbiAgICB2YXIgcGFydHMgPSBbXTtcblxuICAgIHV0aWxzLmZvckVhY2gocGFyYW1zLCBmdW5jdGlvbiBzZXJpYWxpemUodmFsLCBrZXkpIHtcbiAgICAgIGlmICh2YWwgPT09IG51bGwgfHwgdHlwZW9mIHZhbCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICBpZiAodXRpbHMuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIGtleSA9IGtleSArICdbXSc7XG4gICAgICB9XG5cbiAgICAgIGlmICghdXRpbHMuaXNBcnJheSh2YWwpKSB7XG4gICAgICAgIHZhbCA9IFt2YWxdO1xuICAgICAgfVxuXG4gICAgICB1dGlscy5mb3JFYWNoKHZhbCwgZnVuY3Rpb24gcGFyc2VWYWx1ZSh2KSB7XG4gICAgICAgIGlmICh1dGlscy5pc0RhdGUodikpIHtcbiAgICAgICAgICB2ID0gdi50b0lTT1N0cmluZygpO1xuICAgICAgICB9IGVsc2UgaWYgKHV0aWxzLmlzT2JqZWN0KHYpKSB7XG4gICAgICAgICAgdiA9IEpTT04uc3RyaW5naWZ5KHYpO1xuICAgICAgICB9XG4gICAgICAgIHBhcnRzLnB1c2goZW5jb2RlKGtleSkgKyAnPScgKyBlbmNvZGUodikpO1xuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBzZXJpYWxpemVkUGFyYW1zID0gcGFydHMuam9pbignJicpO1xuICB9XG5cbiAgaWYgKHNlcmlhbGl6ZWRQYXJhbXMpIHtcbiAgICB1cmwgKz0gKHVybC5pbmRleE9mKCc/JykgPT09IC0xID8gJz8nIDogJyYnKSArIHNlcmlhbGl6ZWRQYXJhbXM7XG4gIH1cblxuICByZXR1cm4gdXJsO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxuLyoqXG4gKiBDcmVhdGVzIGEgbmV3IFVSTCBieSBjb21iaW5pbmcgdGhlIHNwZWNpZmllZCBVUkxzXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IGJhc2VVUkwgVGhlIGJhc2UgVVJMXG4gKiBAcGFyYW0ge3N0cmluZ30gcmVsYXRpdmVVUkwgVGhlIHJlbGF0aXZlIFVSTFxuICogQHJldHVybnMge3N0cmluZ30gVGhlIGNvbWJpbmVkIFVSTFxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIGNvbWJpbmVVUkxzKGJhc2VVUkwsIHJlbGF0aXZlVVJMKSB7XG4gIHJldHVybiByZWxhdGl2ZVVSTFxuICAgID8gYmFzZVVSTC5yZXBsYWNlKC9cXC8rJC8sICcnKSArICcvJyArIHJlbGF0aXZlVVJMLnJlcGxhY2UoL15cXC8rLywgJycpXG4gICAgOiBiYXNlVVJMO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgdXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSA/XG5cbiAgLy8gU3RhbmRhcmQgYnJvd3NlciBlbnZzIHN1cHBvcnQgZG9jdW1lbnQuY29va2llXG4gIChmdW5jdGlvbiBzdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHdyaXRlOiBmdW5jdGlvbiB3cml0ZShuYW1lLCB2YWx1ZSwgZXhwaXJlcywgcGF0aCwgZG9tYWluLCBzZWN1cmUpIHtcbiAgICAgICAgdmFyIGNvb2tpZSA9IFtdO1xuICAgICAgICBjb29raWUucHVzaChuYW1lICsgJz0nICsgZW5jb2RlVVJJQ29tcG9uZW50KHZhbHVlKSk7XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzTnVtYmVyKGV4cGlyZXMpKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ2V4cGlyZXM9JyArIG5ldyBEYXRlKGV4cGlyZXMpLnRvR01UU3RyaW5nKCkpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKHBhdGgpKSB7XG4gICAgICAgICAgY29va2llLnB1c2goJ3BhdGg9JyArIHBhdGgpO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHV0aWxzLmlzU3RyaW5nKGRvbWFpbikpIHtcbiAgICAgICAgICBjb29raWUucHVzaCgnZG9tYWluPScgKyBkb21haW4pO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNlY3VyZSA9PT0gdHJ1ZSkge1xuICAgICAgICAgIGNvb2tpZS5wdXNoKCdzZWN1cmUnKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGRvY3VtZW50LmNvb2tpZSA9IGNvb2tpZS5qb2luKCc7ICcpO1xuICAgICAgfSxcblxuICAgICAgcmVhZDogZnVuY3Rpb24gcmVhZChuYW1lKSB7XG4gICAgICAgIHZhciBtYXRjaCA9IGRvY3VtZW50LmNvb2tpZS5tYXRjaChuZXcgUmVnRXhwKCcoXnw7XFxcXHMqKSgnICsgbmFtZSArICcpPShbXjtdKiknKSk7XG4gICAgICAgIHJldHVybiAobWF0Y2ggPyBkZWNvZGVVUklDb21wb25lbnQobWF0Y2hbM10pIDogbnVsbCk7XG4gICAgICB9LFxuXG4gICAgICByZW1vdmU6IGZ1bmN0aW9uIHJlbW92ZShuYW1lKSB7XG4gICAgICAgIHRoaXMud3JpdGUobmFtZSwgJycsIERhdGUubm93KCkgLSA4NjQwMDAwMCk7XG4gICAgICB9XG4gICAgfTtcbiAgfSkoKSA6XG5cbiAgLy8gTm9uIHN0YW5kYXJkIGJyb3dzZXIgZW52ICh3ZWIgd29ya2VycywgcmVhY3QtbmF0aXZlKSBsYWNrIG5lZWRlZCBzdXBwb3J0LlxuICAoZnVuY3Rpb24gbm9uU3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHJldHVybiB7XG4gICAgICB3cml0ZTogZnVuY3Rpb24gd3JpdGUoKSB7fSxcbiAgICAgIHJlYWQ6IGZ1bmN0aW9uIHJlYWQoKSB7IHJldHVybiBudWxsOyB9LFxuICAgICAgcmVtb3ZlOiBmdW5jdGlvbiByZW1vdmUoKSB7fVxuICAgIH07XG4gIH0pKClcbik7XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogRGV0ZXJtaW5lcyB3aGV0aGVyIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlXG4gKlxuICogQHBhcmFtIHtzdHJpbmd9IHVybCBUaGUgVVJMIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHRoZSBzcGVjaWZpZWQgVVJMIGlzIGFic29sdXRlLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBpc0Fic29sdXRlVVJMKHVybCkge1xuICAvLyBBIFVSTCBpcyBjb25zaWRlcmVkIGFic29sdXRlIGlmIGl0IGJlZ2lucyB3aXRoIFwiPHNjaGVtZT46Ly9cIiBvciBcIi8vXCIgKHByb3RvY29sLXJlbGF0aXZlIFVSTCkuXG4gIC8vIFJGQyAzOTg2IGRlZmluZXMgc2NoZW1lIG5hbWUgYXMgYSBzZXF1ZW5jZSBvZiBjaGFyYWN0ZXJzIGJlZ2lubmluZyB3aXRoIGEgbGV0dGVyIGFuZCBmb2xsb3dlZFxuICAvLyBieSBhbnkgY29tYmluYXRpb24gb2YgbGV0dGVycywgZGlnaXRzLCBwbHVzLCBwZXJpb2QsIG9yIGh5cGhlbi5cbiAgcmV0dXJuIC9eKFthLXpdW2EtelxcZFxcK1xcLVxcLl0qOik/XFwvXFwvL2kudGVzdCh1cmwpO1xufTtcbiIsIid1c2Ugc3RyaWN0JztcblxudmFyIHV0aWxzID0gcmVxdWlyZSgnLi8uLi91dGlscycpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChcbiAgdXRpbHMuaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSA/XG5cbiAgLy8gU3RhbmRhcmQgYnJvd3NlciBlbnZzIGhhdmUgZnVsbCBzdXBwb3J0IG9mIHRoZSBBUElzIG5lZWRlZCB0byB0ZXN0XG4gIC8vIHdoZXRoZXIgdGhlIHJlcXVlc3QgVVJMIGlzIG9mIHRoZSBzYW1lIG9yaWdpbiBhcyBjdXJyZW50IGxvY2F0aW9uLlxuICAoZnVuY3Rpb24gc3RhbmRhcmRCcm93c2VyRW52KCkge1xuICAgIHZhciBtc2llID0gLyhtc2llfHRyaWRlbnQpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTtcbiAgICB2YXIgdXJsUGFyc2luZ05vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdhJyk7XG4gICAgdmFyIG9yaWdpblVSTDtcblxuICAgIC8qKlxuICAgICogUGFyc2UgYSBVUkwgdG8gZGlzY292ZXIgaXQncyBjb21wb25lbnRzXG4gICAgKlxuICAgICogQHBhcmFtIHtTdHJpbmd9IHVybCBUaGUgVVJMIHRvIGJlIHBhcnNlZFxuICAgICogQHJldHVybnMge09iamVjdH1cbiAgICAqL1xuICAgIGZ1bmN0aW9uIHJlc29sdmVVUkwodXJsKSB7XG4gICAgICB2YXIgaHJlZiA9IHVybDtcblxuICAgICAgaWYgKG1zaWUpIHtcbiAgICAgICAgLy8gSUUgbmVlZHMgYXR0cmlidXRlIHNldCB0d2ljZSB0byBub3JtYWxpemUgcHJvcGVydGllc1xuICAgICAgICB1cmxQYXJzaW5nTm9kZS5zZXRBdHRyaWJ1dGUoJ2hyZWYnLCBocmVmKTtcbiAgICAgICAgaHJlZiA9IHVybFBhcnNpbmdOb2RlLmhyZWY7XG4gICAgICB9XG5cbiAgICAgIHVybFBhcnNpbmdOb2RlLnNldEF0dHJpYnV0ZSgnaHJlZicsIGhyZWYpO1xuXG4gICAgICAvLyB1cmxQYXJzaW5nTm9kZSBwcm92aWRlcyB0aGUgVXJsVXRpbHMgaW50ZXJmYWNlIC0gaHR0cDovL3VybC5zcGVjLndoYXR3Zy5vcmcvI3VybHV0aWxzXG4gICAgICByZXR1cm4ge1xuICAgICAgICBocmVmOiB1cmxQYXJzaW5nTm9kZS5ocmVmLFxuICAgICAgICBwcm90b2NvbDogdXJsUGFyc2luZ05vZGUucHJvdG9jb2wgPyB1cmxQYXJzaW5nTm9kZS5wcm90b2NvbC5yZXBsYWNlKC86JC8sICcnKSA6ICcnLFxuICAgICAgICBob3N0OiB1cmxQYXJzaW5nTm9kZS5ob3N0LFxuICAgICAgICBzZWFyY2g6IHVybFBhcnNpbmdOb2RlLnNlYXJjaCA/IHVybFBhcnNpbmdOb2RlLnNlYXJjaC5yZXBsYWNlKC9eXFw/LywgJycpIDogJycsXG4gICAgICAgIGhhc2g6IHVybFBhcnNpbmdOb2RlLmhhc2ggPyB1cmxQYXJzaW5nTm9kZS5oYXNoLnJlcGxhY2UoL14jLywgJycpIDogJycsXG4gICAgICAgIGhvc3RuYW1lOiB1cmxQYXJzaW5nTm9kZS5ob3N0bmFtZSxcbiAgICAgICAgcG9ydDogdXJsUGFyc2luZ05vZGUucG9ydCxcbiAgICAgICAgcGF0aG5hbWU6ICh1cmxQYXJzaW5nTm9kZS5wYXRobmFtZS5jaGFyQXQoMCkgPT09ICcvJykgP1xuICAgICAgICAgICAgICAgICAgdXJsUGFyc2luZ05vZGUucGF0aG5hbWUgOlxuICAgICAgICAgICAgICAgICAgJy8nICsgdXJsUGFyc2luZ05vZGUucGF0aG5hbWVcbiAgICAgIH07XG4gICAgfVxuXG4gICAgb3JpZ2luVVJMID0gcmVzb2x2ZVVSTCh3aW5kb3cubG9jYXRpb24uaHJlZik7XG5cbiAgICAvKipcbiAgICAqIERldGVybWluZSBpZiBhIFVSTCBzaGFyZXMgdGhlIHNhbWUgb3JpZ2luIGFzIHRoZSBjdXJyZW50IGxvY2F0aW9uXG4gICAgKlxuICAgICogQHBhcmFtIHtTdHJpbmd9IHJlcXVlc3RVUkwgVGhlIFVSTCB0byB0ZXN0XG4gICAgKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiBVUkwgc2hhcmVzIHRoZSBzYW1lIG9yaWdpbiwgb3RoZXJ3aXNlIGZhbHNlXG4gICAgKi9cbiAgICByZXR1cm4gZnVuY3Rpb24gaXNVUkxTYW1lT3JpZ2luKHJlcXVlc3RVUkwpIHtcbiAgICAgIHZhciBwYXJzZWQgPSAodXRpbHMuaXNTdHJpbmcocmVxdWVzdFVSTCkpID8gcmVzb2x2ZVVSTChyZXF1ZXN0VVJMKSA6IHJlcXVlc3RVUkw7XG4gICAgICByZXR1cm4gKHBhcnNlZC5wcm90b2NvbCA9PT0gb3JpZ2luVVJMLnByb3RvY29sICYmXG4gICAgICAgICAgICBwYXJzZWQuaG9zdCA9PT0gb3JpZ2luVVJMLmhvc3QpO1xuICAgIH07XG4gIH0pKCkgOlxuXG4gIC8vIE5vbiBzdGFuZGFyZCBicm93c2VyIGVudnMgKHdlYiB3b3JrZXJzLCByZWFjdC1uYXRpdmUpIGxhY2sgbmVlZGVkIHN1cHBvcnQuXG4gIChmdW5jdGlvbiBub25TdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uIGlzVVJMU2FtZU9yaWdpbigpIHtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gIH0pKClcbik7XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4uL3V0aWxzJyk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gbm9ybWFsaXplSGVhZGVyTmFtZShoZWFkZXJzLCBub3JtYWxpemVkTmFtZSkge1xuICB1dGlscy5mb3JFYWNoKGhlYWRlcnMsIGZ1bmN0aW9uIHByb2Nlc3NIZWFkZXIodmFsdWUsIG5hbWUpIHtcbiAgICBpZiAobmFtZSAhPT0gbm9ybWFsaXplZE5hbWUgJiYgbmFtZS50b1VwcGVyQ2FzZSgpID09PSBub3JtYWxpemVkTmFtZS50b1VwcGVyQ2FzZSgpKSB7XG4gICAgICBoZWFkZXJzW25vcm1hbGl6ZWROYW1lXSA9IHZhbHVlO1xuICAgICAgZGVsZXRlIGhlYWRlcnNbbmFtZV07XG4gICAgfVxuICB9KTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoJy4vLi4vdXRpbHMnKTtcblxuLyoqXG4gKiBQYXJzZSBoZWFkZXJzIGludG8gYW4gb2JqZWN0XG4gKlxuICogYGBgXG4gKiBEYXRlOiBXZWQsIDI3IEF1ZyAyMDE0IDA4OjU4OjQ5IEdNVFxuICogQ29udGVudC1UeXBlOiBhcHBsaWNhdGlvbi9qc29uXG4gKiBDb25uZWN0aW9uOiBrZWVwLWFsaXZlXG4gKiBUcmFuc2Zlci1FbmNvZGluZzogY2h1bmtlZFxuICogYGBgXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9IGhlYWRlcnMgSGVhZGVycyBuZWVkaW5nIHRvIGJlIHBhcnNlZFxuICogQHJldHVybnMge09iamVjdH0gSGVhZGVycyBwYXJzZWQgaW50byBhbiBvYmplY3RcbiAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiBwYXJzZUhlYWRlcnMoaGVhZGVycykge1xuICB2YXIgcGFyc2VkID0ge307XG4gIHZhciBrZXk7XG4gIHZhciB2YWw7XG4gIHZhciBpO1xuXG4gIGlmICghaGVhZGVycykgeyByZXR1cm4gcGFyc2VkOyB9XG5cbiAgdXRpbHMuZm9yRWFjaChoZWFkZXJzLnNwbGl0KCdcXG4nKSwgZnVuY3Rpb24gcGFyc2VyKGxpbmUpIHtcbiAgICBpID0gbGluZS5pbmRleE9mKCc6Jyk7XG4gICAga2V5ID0gdXRpbHMudHJpbShsaW5lLnN1YnN0cigwLCBpKSkudG9Mb3dlckNhc2UoKTtcbiAgICB2YWwgPSB1dGlscy50cmltKGxpbmUuc3Vic3RyKGkgKyAxKSk7XG5cbiAgICBpZiAoa2V5KSB7XG4gICAgICBwYXJzZWRba2V5XSA9IHBhcnNlZFtrZXldID8gcGFyc2VkW2tleV0gKyAnLCAnICsgdmFsIDogdmFsO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIHBhcnNlZDtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbi8qKlxuICogU3ludGFjdGljIHN1Z2FyIGZvciBpbnZva2luZyBhIGZ1bmN0aW9uIGFuZCBleHBhbmRpbmcgYW4gYXJyYXkgZm9yIGFyZ3VtZW50cy5cbiAqXG4gKiBDb21tb24gdXNlIGNhc2Ugd291bGQgYmUgdG8gdXNlIGBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHlgLlxuICpcbiAqICBgYGBqc1xuICogIGZ1bmN0aW9uIGYoeCwgeSwgeikge31cbiAqICB2YXIgYXJncyA9IFsxLCAyLCAzXTtcbiAqICBmLmFwcGx5KG51bGwsIGFyZ3MpO1xuICogIGBgYFxuICpcbiAqIFdpdGggYHNwcmVhZGAgdGhpcyBleGFtcGxlIGNhbiBiZSByZS13cml0dGVuLlxuICpcbiAqICBgYGBqc1xuICogIHNwcmVhZChmdW5jdGlvbih4LCB5LCB6KSB7fSkoWzEsIDIsIDNdKTtcbiAqICBgYGBcbiAqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuICogQHJldHVybnMge0Z1bmN0aW9ufVxuICovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIHNwcmVhZChjYWxsYmFjaykge1xuICByZXR1cm4gZnVuY3Rpb24gd3JhcChhcnIpIHtcbiAgICByZXR1cm4gY2FsbGJhY2suYXBwbHkobnVsbCwgYXJyKTtcbiAgfTtcbn07XG4iLCIndXNlIHN0cmljdCc7XG5cbnZhciBiaW5kID0gcmVxdWlyZSgnLi9oZWxwZXJzL2JpbmQnKTtcbnZhciBpc0J1ZmZlciA9IHJlcXVpcmUoJ2lzLWJ1ZmZlcicpO1xuXG4vKmdsb2JhbCB0b1N0cmluZzp0cnVlKi9cblxuLy8gdXRpbHMgaXMgYSBsaWJyYXJ5IG9mIGdlbmVyaWMgaGVscGVyIGZ1bmN0aW9ucyBub24tc3BlY2lmaWMgdG8gYXhpb3NcblxudmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheVxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5LCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheSh2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXldJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBBcnJheUJ1ZmZlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlcih2YWwpIHtcbiAgcmV0dXJuIHRvU3RyaW5nLmNhbGwodmFsKSA9PT0gJ1tvYmplY3QgQXJyYXlCdWZmZXJdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZvcm1EYXRhXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYW4gRm9ybURhdGEsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Zvcm1EYXRhKHZhbCkge1xuICByZXR1cm4gKHR5cGVvZiBGb3JtRGF0YSAhPT0gJ3VuZGVmaW5lZCcpICYmICh2YWwgaW5zdGFuY2VvZiBGb3JtRGF0YSk7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSB2aWV3IG9uIGFuIEFycmF5QnVmZmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNBcnJheUJ1ZmZlclZpZXcodmFsKSB7XG4gIHZhciByZXN1bHQ7XG4gIGlmICgodHlwZW9mIEFycmF5QnVmZmVyICE9PSAndW5kZWZpbmVkJykgJiYgKEFycmF5QnVmZmVyLmlzVmlldykpIHtcbiAgICByZXN1bHQgPSBBcnJheUJ1ZmZlci5pc1ZpZXcodmFsKTtcbiAgfSBlbHNlIHtcbiAgICByZXN1bHQgPSAodmFsKSAmJiAodmFsLmJ1ZmZlcikgJiYgKHZhbC5idWZmZXIgaW5zdGFuY2VvZiBBcnJheUJ1ZmZlcik7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFN0cmluZ1xuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgU3RyaW5nLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNTdHJpbmcodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnc3RyaW5nJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIE51bWJlclxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSB2YWwgVGhlIHZhbHVlIHRvIHRlc3RcbiAqIEByZXR1cm5zIHtib29sZWFufSBUcnVlIGlmIHZhbHVlIGlzIGEgTnVtYmVyLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNOdW1iZXIodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAnbnVtYmVyJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyB1bmRlZmluZWRcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB0aGUgdmFsdWUgaXMgdW5kZWZpbmVkLCBvdGhlcndpc2UgZmFsc2VcbiAqL1xuZnVuY3Rpb24gaXNVbmRlZmluZWQodmFsKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsID09PSAndW5kZWZpbmVkJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhbiBPYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhbiBPYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc09iamVjdCh2YWwpIHtcbiAgcmV0dXJuIHZhbCAhPT0gbnVsbCAmJiB0eXBlb2YgdmFsID09PSAnb2JqZWN0Jztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIERhdGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIERhdGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0RhdGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IERhdGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZpbGVcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEZpbGUsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0ZpbGUodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZpbGVdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEJsb2JcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIEJsb2IsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc0Jsb2IodmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEJsb2JdJztcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIEZ1bmN0aW9uXG4gKlxuICogQHBhcmFtIHtPYmplY3R9IHZhbCBUaGUgdmFsdWUgdG8gdGVzdFxuICogQHJldHVybnMge2Jvb2xlYW59IFRydWUgaWYgdmFsdWUgaXMgYSBGdW5jdGlvbiwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzRnVuY3Rpb24odmFsKSB7XG4gIHJldHVybiB0b1N0cmluZy5jYWxsKHZhbCkgPT09ICdbb2JqZWN0IEZ1bmN0aW9uXSc7XG59XG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGEgdmFsdWUgaXMgYSBTdHJlYW1cbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFN0cmVhbSwgb3RoZXJ3aXNlIGZhbHNlXG4gKi9cbmZ1bmN0aW9uIGlzU3RyZWFtKHZhbCkge1xuICByZXR1cm4gaXNPYmplY3QodmFsKSAmJiBpc0Z1bmN0aW9uKHZhbC5waXBlKTtcbn1cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYSB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3RcbiAqXG4gKiBAcGFyYW0ge09iamVjdH0gdmFsIFRoZSB2YWx1ZSB0byB0ZXN0XG4gKiBAcmV0dXJucyB7Ym9vbGVhbn0gVHJ1ZSBpZiB2YWx1ZSBpcyBhIFVSTFNlYXJjaFBhcmFtcyBvYmplY3QsIG90aGVyd2lzZSBmYWxzZVxuICovXG5mdW5jdGlvbiBpc1VSTFNlYXJjaFBhcmFtcyh2YWwpIHtcbiAgcmV0dXJuIHR5cGVvZiBVUkxTZWFyY2hQYXJhbXMgIT09ICd1bmRlZmluZWQnICYmIHZhbCBpbnN0YW5jZW9mIFVSTFNlYXJjaFBhcmFtcztcbn1cblxuLyoqXG4gKiBUcmltIGV4Y2VzcyB3aGl0ZXNwYWNlIG9mZiB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YgYSBzdHJpbmdcbiAqXG4gKiBAcGFyYW0ge1N0cmluZ30gc3RyIFRoZSBTdHJpbmcgdG8gdHJpbVxuICogQHJldHVybnMge1N0cmluZ30gVGhlIFN0cmluZyBmcmVlZCBvZiBleGNlc3Mgd2hpdGVzcGFjZVxuICovXG5mdW5jdGlvbiB0cmltKHN0cikge1xuICByZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMqLywgJycpLnJlcGxhY2UoL1xccyokLywgJycpO1xufVxuXG4vKipcbiAqIERldGVybWluZSBpZiB3ZSdyZSBydW5uaW5nIGluIGEgc3RhbmRhcmQgYnJvd3NlciBlbnZpcm9ubWVudFxuICpcbiAqIFRoaXMgYWxsb3dzIGF4aW9zIHRvIHJ1biBpbiBhIHdlYiB3b3JrZXIsIGFuZCByZWFjdC1uYXRpdmUuXG4gKiBCb3RoIGVudmlyb25tZW50cyBzdXBwb3J0IFhNTEh0dHBSZXF1ZXN0LCBidXQgbm90IGZ1bGx5IHN0YW5kYXJkIGdsb2JhbHMuXG4gKlxuICogd2ViIHdvcmtlcnM6XG4gKiAgdHlwZW9mIHdpbmRvdyAtPiB1bmRlZmluZWRcbiAqICB0eXBlb2YgZG9jdW1lbnQgLT4gdW5kZWZpbmVkXG4gKlxuICogcmVhY3QtbmF0aXZlOlxuICogIG5hdmlnYXRvci5wcm9kdWN0IC0+ICdSZWFjdE5hdGl2ZSdcbiAqL1xuZnVuY3Rpb24gaXNTdGFuZGFyZEJyb3dzZXJFbnYoKSB7XG4gIGlmICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IucHJvZHVjdCA9PT0gJ1JlYWN0TmF0aXZlJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICByZXR1cm4gKFxuICAgIHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnICYmXG4gICAgdHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJ1xuICApO1xufVxuXG4vKipcbiAqIEl0ZXJhdGUgb3ZlciBhbiBBcnJheSBvciBhbiBPYmplY3QgaW52b2tpbmcgYSBmdW5jdGlvbiBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmIGBvYmpgIGlzIGFuIEFycmF5IGNhbGxiYWNrIHdpbGwgYmUgY2FsbGVkIHBhc3NpbmdcbiAqIHRoZSB2YWx1ZSwgaW5kZXgsIGFuZCBjb21wbGV0ZSBhcnJheSBmb3IgZWFjaCBpdGVtLlxuICpcbiAqIElmICdvYmonIGlzIGFuIE9iamVjdCBjYWxsYmFjayB3aWxsIGJlIGNhbGxlZCBwYXNzaW5nXG4gKiB0aGUgdmFsdWUsIGtleSwgYW5kIGNvbXBsZXRlIG9iamVjdCBmb3IgZWFjaCBwcm9wZXJ0eS5cbiAqXG4gKiBAcGFyYW0ge09iamVjdHxBcnJheX0gb2JqIFRoZSBvYmplY3QgdG8gaXRlcmF0ZVxuICogQHBhcmFtIHtGdW5jdGlvbn0gZm4gVGhlIGNhbGxiYWNrIHRvIGludm9rZSBmb3IgZWFjaCBpdGVtXG4gKi9cbmZ1bmN0aW9uIGZvckVhY2gob2JqLCBmbikge1xuICAvLyBEb24ndCBib3RoZXIgaWYgbm8gdmFsdWUgcHJvdmlkZWRcbiAgaWYgKG9iaiA9PT0gbnVsbCB8fCB0eXBlb2Ygb2JqID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEZvcmNlIGFuIGFycmF5IGlmIG5vdCBhbHJlYWR5IHNvbWV0aGluZyBpdGVyYWJsZVxuICBpZiAodHlwZW9mIG9iaiAhPT0gJ29iamVjdCcgJiYgIWlzQXJyYXkob2JqKSkge1xuICAgIC8qZXNsaW50IG5vLXBhcmFtLXJlYXNzaWduOjAqL1xuICAgIG9iaiA9IFtvYmpdO1xuICB9XG5cbiAgaWYgKGlzQXJyYXkob2JqKSkge1xuICAgIC8vIEl0ZXJhdGUgb3ZlciBhcnJheSB2YWx1ZXNcbiAgICBmb3IgKHZhciBpID0gMCwgbCA9IG9iai5sZW5ndGg7IGkgPCBsOyBpKyspIHtcbiAgICAgIGZuLmNhbGwobnVsbCwgb2JqW2ldLCBpLCBvYmopO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICAvLyBJdGVyYXRlIG92ZXIgb2JqZWN0IGtleXNcbiAgICBmb3IgKHZhciBrZXkgaW4gb2JqKSB7XG4gICAgICBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwga2V5KSkge1xuICAgICAgICBmbi5jYWxsKG51bGwsIG9ialtrZXldLCBrZXksIG9iaik7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8qKlxuICogQWNjZXB0cyB2YXJhcmdzIGV4cGVjdGluZyBlYWNoIGFyZ3VtZW50IHRvIGJlIGFuIG9iamVjdCwgdGhlblxuICogaW1tdXRhYmx5IG1lcmdlcyB0aGUgcHJvcGVydGllcyBvZiBlYWNoIG9iamVjdCBhbmQgcmV0dXJucyByZXN1bHQuXG4gKlxuICogV2hlbiBtdWx0aXBsZSBvYmplY3RzIGNvbnRhaW4gdGhlIHNhbWUga2V5IHRoZSBsYXRlciBvYmplY3QgaW5cbiAqIHRoZSBhcmd1bWVudHMgbGlzdCB3aWxsIHRha2UgcHJlY2VkZW5jZS5cbiAqXG4gKiBFeGFtcGxlOlxuICpcbiAqIGBgYGpzXG4gKiB2YXIgcmVzdWx0ID0gbWVyZ2Uoe2ZvbzogMTIzfSwge2ZvbzogNDU2fSk7XG4gKiBjb25zb2xlLmxvZyhyZXN1bHQuZm9vKTsgLy8gb3V0cHV0cyA0NTZcbiAqIGBgYFxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBvYmoxIE9iamVjdCB0byBtZXJnZVxuICogQHJldHVybnMge09iamVjdH0gUmVzdWx0IG9mIGFsbCBtZXJnZSBwcm9wZXJ0aWVzXG4gKi9cbmZ1bmN0aW9uIG1lcmdlKC8qIG9iajEsIG9iajIsIG9iajMsIC4uLiAqLykge1xuICB2YXIgcmVzdWx0ID0ge307XG4gIGZ1bmN0aW9uIGFzc2lnblZhbHVlKHZhbCwga2V5KSB7XG4gICAgaWYgKHR5cGVvZiByZXN1bHRba2V5XSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHZhbCA9PT0gJ29iamVjdCcpIHtcbiAgICAgIHJlc3VsdFtrZXldID0gbWVyZ2UocmVzdWx0W2tleV0sIHZhbCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJlc3VsdFtrZXldID0gdmFsO1xuICAgIH1cbiAgfVxuXG4gIGZvciAodmFyIGkgPSAwLCBsID0gYXJndW1lbnRzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuICAgIGZvckVhY2goYXJndW1lbnRzW2ldLCBhc3NpZ25WYWx1ZSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cblxuLyoqXG4gKiBFeHRlbmRzIG9iamVjdCBhIGJ5IG11dGFibHkgYWRkaW5nIHRvIGl0IHRoZSBwcm9wZXJ0aWVzIG9mIG9iamVjdCBiLlxuICpcbiAqIEBwYXJhbSB7T2JqZWN0fSBhIFRoZSBvYmplY3QgdG8gYmUgZXh0ZW5kZWRcbiAqIEBwYXJhbSB7T2JqZWN0fSBiIFRoZSBvYmplY3QgdG8gY29weSBwcm9wZXJ0aWVzIGZyb21cbiAqIEBwYXJhbSB7T2JqZWN0fSB0aGlzQXJnIFRoZSBvYmplY3QgdG8gYmluZCBmdW5jdGlvbiB0b1xuICogQHJldHVybiB7T2JqZWN0fSBUaGUgcmVzdWx0aW5nIHZhbHVlIG9mIG9iamVjdCBhXG4gKi9cbmZ1bmN0aW9uIGV4dGVuZChhLCBiLCB0aGlzQXJnKSB7XG4gIGZvckVhY2goYiwgZnVuY3Rpb24gYXNzaWduVmFsdWUodmFsLCBrZXkpIHtcbiAgICBpZiAodGhpc0FyZyAmJiB0eXBlb2YgdmFsID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBhW2tleV0gPSBiaW5kKHZhbCwgdGhpc0FyZyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGFba2V5XSA9IHZhbDtcbiAgICB9XG4gIH0pO1xuICByZXR1cm4gYTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGlzQXJyYXk6IGlzQXJyYXksXG4gIGlzQXJyYXlCdWZmZXI6IGlzQXJyYXlCdWZmZXIsXG4gIGlzQnVmZmVyOiBpc0J1ZmZlcixcbiAgaXNGb3JtRGF0YTogaXNGb3JtRGF0YSxcbiAgaXNBcnJheUJ1ZmZlclZpZXc6IGlzQXJyYXlCdWZmZXJWaWV3LFxuICBpc1N0cmluZzogaXNTdHJpbmcsXG4gIGlzTnVtYmVyOiBpc051bWJlcixcbiAgaXNPYmplY3Q6IGlzT2JqZWN0LFxuICBpc1VuZGVmaW5lZDogaXNVbmRlZmluZWQsXG4gIGlzRGF0ZTogaXNEYXRlLFxuICBpc0ZpbGU6IGlzRmlsZSxcbiAgaXNCbG9iOiBpc0Jsb2IsXG4gIGlzRnVuY3Rpb246IGlzRnVuY3Rpb24sXG4gIGlzU3RyZWFtOiBpc1N0cmVhbSxcbiAgaXNVUkxTZWFyY2hQYXJhbXM6IGlzVVJMU2VhcmNoUGFyYW1zLFxuICBpc1N0YW5kYXJkQnJvd3NlckVudjogaXNTdGFuZGFyZEJyb3dzZXJFbnYsXG4gIGZvckVhY2g6IGZvckVhY2gsXG4gIG1lcmdlOiBtZXJnZSxcbiAgZXh0ZW5kOiBleHRlbmQsXG4gIHRyaW06IHRyaW1cbn07XG4iLCIvKipcbiAqIEBsaWNlbnNlXG4gKiBGdXNlIC0gTGlnaHR3ZWlnaHQgZnV6enktc2VhcmNoXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDEyLTIwMTYgS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPi5cbiAqIEFsbCBSaWdodHMgUmVzZXJ2ZWQuIEFwYWNoZSBTb2Z0d2FyZSBMaWNlbnNlIDIuMFxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIilcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICpcbiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICpcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbjsoZnVuY3Rpb24gKGdsb2JhbCkge1xuICAndXNlIHN0cmljdCdcblxuICAvKiogQHR5cGUge2Z1bmN0aW9uKC4uLiopfSAqL1xuICBmdW5jdGlvbiBsb2cgKCkge1xuICAgIGNvbnNvbGUubG9nLmFwcGx5KGNvbnNvbGUsIGFyZ3VtZW50cylcbiAgfVxuXG4gIHZhciBkZWZhdWx0T3B0aW9ucyA9IHtcbiAgICAvLyBUaGUgbmFtZSBvZiB0aGUgaWRlbnRpZmllciBwcm9wZXJ0eS4gSWYgc3BlY2lmaWVkLCB0aGUgcmV0dXJuZWQgcmVzdWx0IHdpbGwgYmUgYSBsaXN0XG4gICAgLy8gb2YgdGhlIGl0ZW1zJyBkZW50aWZpZXJzLCBvdGhlcndpc2UgaXQgd2lsbCBiZSBhIGxpc3Qgb2YgdGhlIGl0ZW1zLlxuICAgIGlkOiBudWxsLFxuXG4gICAgLy8gSW5kaWNhdGVzIHdoZXRoZXIgY29tcGFyaXNvbnMgc2hvdWxkIGJlIGNhc2Ugc2Vuc2l0aXZlLlxuXG4gICAgY2FzZVNlbnNpdGl2ZTogZmFsc2UsXG5cbiAgICAvLyBBbiBhcnJheSBvZiB2YWx1ZXMgdGhhdCBzaG91bGQgYmUgaW5jbHVkZWQgZnJvbSB0aGUgc2VhcmNoZXIncyBvdXRwdXQuIFdoZW4gdGhpcyBhcnJheVxuICAgIC8vIGNvbnRhaW5zIGVsZW1lbnRzLCBlYWNoIHJlc3VsdCBpbiB0aGUgbGlzdCB3aWxsIGJlIG9mIHRoZSBmb3JtIGB7IGl0ZW06IC4uLiwgaW5jbHVkZTE6IC4uLiwgaW5jbHVkZTI6IC4uLiB9YC5cbiAgICAvLyBWYWx1ZXMgeW91IGNhbiBpbmNsdWRlIGFyZSBgc2NvcmVgLCBgbWF0Y2hlZExvY2F0aW9uc2BcbiAgICBpbmNsdWRlOiBbXSxcblxuICAgIC8vIFdoZXRoZXIgdG8gc29ydCB0aGUgcmVzdWx0IGxpc3QsIGJ5IHNjb3JlXG4gICAgc2hvdWxkU29ydDogdHJ1ZSxcblxuICAgIC8vIFRoZSBzZWFyY2ggZnVuY3Rpb24gdG8gdXNlXG4gICAgLy8gTm90ZSB0aGF0IHRoZSBkZWZhdWx0IHNlYXJjaCBmdW5jdGlvbiAoW1tGdW5jdGlvbl1dKSBtdXN0IGNvbmZvcm0gdG8gdGhlIGZvbGxvd2luZyBBUEk6XG4gICAgLy9cbiAgICAvLyAgQHBhcmFtIHBhdHRlcm4gVGhlIHBhdHRlcm4gc3RyaW5nIHRvIHNlYXJjaFxuICAgIC8vICBAcGFyYW0gb3B0aW9ucyBUaGUgc2VhcmNoIG9wdGlvblxuICAgIC8vICBbW0Z1bmN0aW9uXV0uY29uc3RydWN0b3IgPSBmdW5jdGlvbihwYXR0ZXJuLCBvcHRpb25zKVxuICAgIC8vXG4gICAgLy8gIEBwYXJhbSB0ZXh0OiB0aGUgc3RyaW5nIHRvIHNlYXJjaCBpbiBmb3IgdGhlIHBhdHRlcm5cbiAgICAvLyAgQHJldHVybiBPYmplY3QgaW4gdGhlIGZvcm0gb2Y6XG4gICAgLy8gICAgLSBpc01hdGNoOiBib29sZWFuXG4gICAgLy8gICAgLSBzY29yZTogSW50XG4gICAgLy8gIFtbRnVuY3Rpb25dXS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24odGV4dClcbiAgICBzZWFyY2hGbjogQml0YXBTZWFyY2hlcixcblxuICAgIC8vIERlZmF1bHQgc29ydCBmdW5jdGlvblxuICAgIHNvcnRGbjogZnVuY3Rpb24gKGEsIGIpIHtcbiAgICAgIHJldHVybiBhLnNjb3JlIC0gYi5zY29yZVxuICAgIH0sXG5cbiAgICAvLyBUaGUgZ2V0IGZ1bmN0aW9uIHRvIHVzZSB3aGVuIGZldGNoaW5nIGFuIG9iamVjdCdzIHByb3BlcnRpZXMuXG4gICAgLy8gVGhlIGRlZmF1bHQgd2lsbCBzZWFyY2ggbmVzdGVkIHBhdGhzICppZSBmb28uYmFyLmJheipcbiAgICBnZXRGbjogZGVlcFZhbHVlLFxuXG4gICAgLy8gTGlzdCBvZiBwcm9wZXJ0aWVzIHRoYXQgd2lsbCBiZSBzZWFyY2hlZC4gVGhpcyBhbHNvIHN1cHBvcnRzIG5lc3RlZCBwcm9wZXJ0aWVzLlxuICAgIGtleXM6IFtdLFxuXG4gICAgLy8gV2lsbCBwcmludCB0byB0aGUgY29uc29sZS4gVXNlZnVsIGZvciBkZWJ1Z2dpbmcuXG4gICAgdmVyYm9zZTogZmFsc2UsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBzZWFyY2ggYWxnb3JpdGhtIHdpbGwgc2VhcmNoIGluZGl2aWR1YWwgd29yZHMgKiphbmQqKiB0aGUgZnVsbCBzdHJpbmcsXG4gICAgLy8gY29tcHV0aW5nIHRoZSBmaW5hbCBzY29yZSBhcyBhIGZ1bmN0aW9uIG9mIGJvdGguIE5vdGUgdGhhdCB3aGVuIGB0b2tlbml6ZWAgaXMgYHRydWVgLFxuICAgIC8vIHRoZSBgdGhyZXNob2xkYCwgYGRpc3RhbmNlYCwgYW5kIGBsb2NhdGlvbmAgYXJlIGluY29uc2VxdWVudGlhbCBmb3IgaW5kaXZpZHVhbCB0b2tlbnMuXG4gICAgdG9rZW5pemU6IGZhbHNlLFxuXG4gICAgLy8gV2hlbiB0cnVlLCB0aGUgcmVzdWx0IHNldCB3aWxsIG9ubHkgaW5jbHVkZSByZWNvcmRzIHRoYXQgbWF0Y2ggYWxsIHRva2Vucy4gV2lsbCBvbmx5IHdvcmtcbiAgICAvLyBpZiBgdG9rZW5pemVgIGlzIGFsc28gdHJ1ZS5cbiAgICBtYXRjaEFsbFRva2VuczogZmFsc2UsXG5cbiAgICAvLyBSZWdleCB1c2VkIHRvIHNlcGFyYXRlIHdvcmRzIHdoZW4gc2VhcmNoaW5nLiBPbmx5IGFwcGxpY2FibGUgd2hlbiBgdG9rZW5pemVgIGlzIGB0cnVlYC5cbiAgICB0b2tlblNlcGFyYXRvcjogLyArL2csXG5cbiAgICAvLyBNaW5pbXVtIG51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgbXVzdCBiZSBtYXRjaGVkIGJlZm9yZSBhIHJlc3VsdCBpcyBjb25zaWRlcmVkIGEgbWF0Y2hcbiAgICBtaW5NYXRjaENoYXJMZW5ndGg6IDEsXG5cbiAgICAvLyBXaGVuIHRydWUsIHRoZSBhbGdvcml0aG0gY29udGludWVzIHNlYXJjaGluZyB0byB0aGUgZW5kIG9mIHRoZSBpbnB1dCBldmVuIGlmIGEgcGVyZmVjdFxuICAgIC8vIG1hdGNoIGlzIGZvdW5kIGJlZm9yZSB0aGUgZW5kIG9mIHRoZSBzYW1lIGlucHV0LlxuICAgIGZpbmRBbGxNYXRjaGVzOiBmYWxzZVxuICB9XG5cbiAgLyoqXG4gICAqIEBjb25zdHJ1Y3RvclxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcGFyYW0geyFPYmplY3Q8c3RyaW5nLCAqPn0gb3B0aW9uc1xuICAgKi9cbiAgZnVuY3Rpb24gRnVzZSAobGlzdCwgb3B0aW9ucykge1xuICAgIHZhciBrZXlcblxuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zID0gb3B0aW9ucyB8fCB7fVxuXG4gICAgZm9yIChrZXkgaW4gZGVmYXVsdE9wdGlvbnMpIHtcbiAgICAgIGlmICghZGVmYXVsdE9wdGlvbnMuaGFzT3duUHJvcGVydHkoa2V5KSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIC8vIEFkZCBib29sZWFuIHR5cGUgb3B0aW9uc1xuICAgICAgaWYgKHR5cGVvZiBkZWZhdWx0T3B0aW9uc1trZXldID09PSAnYm9vbGVhbicpIHtcbiAgICAgICAgdGhpcy5vcHRpb25zW2tleV0gPSBrZXkgaW4gb3B0aW9ucyA/IG9wdGlvbnNba2V5XSA6IGRlZmF1bHRPcHRpb25zW2tleV07XG4gICAgICAvLyBBZGQgYWxsIG90aGVyIG9wdGlvbnNcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMub3B0aW9uc1trZXldID0gb3B0aW9uc1trZXldIHx8IGRlZmF1bHRPcHRpb25zW2tleV1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLlZFUlNJT04gPSAnMi43LjMnXG5cbiAgLyoqXG4gICAqIFNldHMgYSBuZXcgbGlzdCBmb3IgRnVzZSB0byBtYXRjaCBhZ2FpbnN0LlxuICAgKiBAcGFyYW0geyFBcnJheX0gbGlzdFxuICAgKiBAcmV0dXJuIHshQXJyYXl9IFRoZSBuZXdseSBzZXQgbGlzdFxuICAgKiBAcHVibGljXG4gICAqL1xuICBGdXNlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAobGlzdCkge1xuICAgIHRoaXMubGlzdCA9IGxpc3RcbiAgICByZXR1cm4gbGlzdFxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24gKHBhdHRlcm4pIHtcbiAgICBpZiAodGhpcy5vcHRpb25zLnZlcmJvc2UpIGxvZygnXFxuU2VhcmNoIHRlcm06JywgcGF0dGVybiwgJ1xcbicpXG5cbiAgICB0aGlzLnBhdHRlcm4gPSBwYXR0ZXJuXG4gICAgdGhpcy5yZXN1bHRzID0gW11cbiAgICB0aGlzLnJlc3VsdE1hcCA9IHt9XG4gICAgdGhpcy5fa2V5TWFwID0gbnVsbFxuXG4gICAgdGhpcy5fcHJlcGFyZVNlYXJjaGVycygpXG4gICAgdGhpcy5fc3RhcnRTZWFyY2goKVxuICAgIHRoaXMuX2NvbXB1dGVTY29yZSgpXG4gICAgdGhpcy5fc29ydCgpXG5cbiAgICB2YXIgb3V0cHV0ID0gdGhpcy5fZm9ybWF0KClcbiAgICByZXR1cm4gb3V0cHV0XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fcHJlcGFyZVNlYXJjaGVycyA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBwYXR0ZXJuID0gdGhpcy5wYXR0ZXJuXG4gICAgdmFyIHNlYXJjaEZuID0gb3B0aW9ucy5zZWFyY2hGblxuICAgIHZhciB0b2tlbnMgPSBwYXR0ZXJuLnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG4gICAgdmFyIGkgPSAwXG4gICAgdmFyIGxlbiA9IHRva2Vucy5sZW5ndGhcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudG9rZW5pemUpIHtcbiAgICAgIHRoaXMudG9rZW5TZWFyY2hlcnMgPSBbXVxuICAgICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICB0aGlzLnRva2VuU2VhcmNoZXJzLnB1c2gobmV3IHNlYXJjaEZuKHRva2Vuc1tpXSwgb3B0aW9ucykpXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMuZnVsbFNlYWNoZXIgPSBuZXcgc2VhcmNoRm4ocGF0dGVybiwgb3B0aW9ucylcbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9zdGFydFNlYXJjaCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb3B0aW9ucyA9IHRoaXMub3B0aW9uc1xuICAgIHZhciBnZXRGbiA9IG9wdGlvbnMuZ2V0Rm5cbiAgICB2YXIgbGlzdCA9IHRoaXMubGlzdFxuICAgIHZhciBsaXN0TGVuID0gbGlzdC5sZW5ndGhcbiAgICB2YXIga2V5cyA9IHRoaXMub3B0aW9ucy5rZXlzXG4gICAgdmFyIGtleXNMZW4gPSBrZXlzLmxlbmd0aFxuICAgIHZhciBrZXlcbiAgICB2YXIgd2VpZ2h0XG4gICAgdmFyIGl0ZW0gPSBudWxsXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgdGhlIGZpcnN0IGl0ZW0gaW4gdGhlIGxpc3QsIGlmIGl0J3MgYSBzdHJpbmcsIHRoZW4gd2UgYXNzdW1lXG4gICAgLy8gdGhhdCBldmVyeSBpdGVtIGluIHRoZSBsaXN0IGlzIGFsc28gYSBzdHJpbmcsIGFuZCB0aHVzIGl0J3MgYSBmbGF0dGVuZWQgYXJyYXkuXG4gICAgaWYgKHR5cGVvZiBsaXN0WzBdID09PSAnc3RyaW5nJykge1xuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgdGhpcy5fYW5hbHl6ZSgnJywgbGlzdFtpXSwgaSwgaSlcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fa2V5TWFwID0ge31cbiAgICAgIC8vIE90aGVyd2lzZSwgdGhlIGZpcnN0IGl0ZW0gaXMgYW4gT2JqZWN0IChob3BlZnVsbHkpLCBhbmQgdGh1cyB0aGUgc2VhcmNoaW5nXG4gICAgICAvLyBpcyBkb25lIG9uIHRoZSB2YWx1ZXMgb2YgdGhlIGtleXMgb2YgZWFjaCBpdGVtLlxuICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGl0ZW1cbiAgICAgIGZvciAoaSA9IDA7IGkgPCBsaXN0TGVuOyBpKyspIHtcbiAgICAgICAgaXRlbSA9IGxpc3RbaV1cbiAgICAgICAgLy8gSXRlcmF0ZSBvdmVyIGV2ZXJ5IGtleVxuICAgICAgICBmb3IgKGogPSAwOyBqIDwga2V5c0xlbjsgaisrKSB7XG4gICAgICAgICAga2V5ID0ga2V5c1tqXVxuICAgICAgICAgIGlmICh0eXBlb2Yga2V5ICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgd2VpZ2h0ID0gKDEgLSBrZXkud2VpZ2h0KSB8fCAxXG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5Lm5hbWVdID0ge1xuICAgICAgICAgICAgICB3ZWlnaHQ6IHdlaWdodFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGtleS53ZWlnaHQgPD0gMCB8fCBrZXkud2VpZ2h0ID4gMSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0tleSB3ZWlnaHQgaGFzIHRvIGJlID4gMCBhbmQgPD0gMScpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBrZXkgPSBrZXkubmFtZVxuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLl9rZXlNYXBba2V5XSA9IHtcbiAgICAgICAgICAgICAgd2VpZ2h0OiAxXG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICAgIHRoaXMuX2FuYWx5emUoa2V5LCBnZXRGbihpdGVtLCBrZXksIFtdKSwgaXRlbSwgaSlcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9hbmFseXplID0gZnVuY3Rpb24gKGtleSwgdGV4dCwgZW50aXR5LCBpbmRleCkge1xuICAgIHZhciBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgdmFyIHdvcmRzXG4gICAgdmFyIHNjb3Jlc1xuICAgIHZhciBleGlzdHMgPSBmYWxzZVxuICAgIHZhciBleGlzdGluZ1Jlc3VsdFxuICAgIHZhciBhdmVyYWdlU2NvcmVcbiAgICB2YXIgZmluYWxTY29yZVxuICAgIHZhciBzY29yZXNMZW5cbiAgICB2YXIgbWFpblNlYXJjaFJlc3VsdFxuICAgIHZhciB0b2tlblNlYXJjaGVyXG4gICAgdmFyIHRlcm1TY29yZXNcbiAgICB2YXIgd29yZFxuICAgIHZhciB0b2tlblNlYXJjaFJlc3VsdFxuICAgIHZhciBoYXNNYXRjaEluVGV4dFxuICAgIHZhciBjaGVja1RleHRNYXRjaGVzXG4gICAgdmFyIGlcbiAgICB2YXIgalxuXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHRleHQgY2FuIGJlIHNlYXJjaGVkXG4gICAgaWYgKHRleHQgPT09IHVuZGVmaW5lZCB8fCB0ZXh0ID09PSBudWxsKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICBzY29yZXMgPSBbXVxuXG4gICAgdmFyIG51bVRleHRNYXRjaGVzID0gMFxuXG4gICAgaWYgKHR5cGVvZiB0ZXh0ID09PSAnc3RyaW5nJykge1xuICAgICAgd29yZHMgPSB0ZXh0LnNwbGl0KG9wdGlvbnMudG9rZW5TZXBhcmF0b3IpXG5cbiAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnLS0tLS0tLS0tXFxuS2V5OicsIGtleSlcblxuICAgICAgaWYgKHRoaXMub3B0aW9ucy50b2tlbml6ZSkge1xuICAgICAgICBmb3IgKGkgPSAwOyBpIDwgdGhpcy50b2tlblNlYXJjaGVycy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgIHRva2VuU2VhcmNoZXIgPSB0aGlzLnRva2VuU2VhcmNoZXJzW2ldXG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1BhdHRlcm46JywgdG9rZW5TZWFyY2hlci5wYXR0ZXJuKVxuXG4gICAgICAgICAgdGVybVNjb3JlcyA9IFtdXG4gICAgICAgICAgaGFzTWF0Y2hJblRleHQgPSBmYWxzZVxuXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IHdvcmRzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICB3b3JkID0gd29yZHNbal1cbiAgICAgICAgICAgIHRva2VuU2VhcmNoUmVzdWx0ID0gdG9rZW5TZWFyY2hlci5zZWFyY2god29yZClcbiAgICAgICAgICAgIHZhciBvYmogPSB7fVxuICAgICAgICAgICAgaWYgKHRva2VuU2VhcmNoUmVzdWx0LmlzTWF0Y2gpIHtcbiAgICAgICAgICAgICAgb2JqW3dvcmRdID0gdG9rZW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgICAgICAgICAgZXhpc3RzID0gdHJ1ZVxuICAgICAgICAgICAgICBoYXNNYXRjaEluVGV4dCA9IHRydWVcbiAgICAgICAgICAgICAgc2NvcmVzLnB1c2godG9rZW5TZWFyY2hSZXN1bHQuc2NvcmUpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICBvYmpbd29yZF0gPSAxXG4gICAgICAgICAgICAgIGlmICghdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSB7XG4gICAgICAgICAgICAgICAgc2NvcmVzLnB1c2goMSlcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGVybVNjb3Jlcy5wdXNoKG9iailcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAoaGFzTWF0Y2hJblRleHQpIHtcbiAgICAgICAgICAgIG51bVRleHRNYXRjaGVzKytcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Rva2VuIHNjb3JlczonLCB0ZXJtU2NvcmVzKVxuICAgICAgICB9XG5cbiAgICAgICAgYXZlcmFnZVNjb3JlID0gc2NvcmVzWzBdXG4gICAgICAgIHNjb3Jlc0xlbiA9IHNjb3Jlcy5sZW5ndGhcbiAgICAgICAgZm9yIChpID0gMTsgaSA8IHNjb3Jlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgYXZlcmFnZVNjb3JlICs9IHNjb3Jlc1tpXVxuICAgICAgICB9XG4gICAgICAgIGF2ZXJhZ2VTY29yZSA9IGF2ZXJhZ2VTY29yZSAvIHNjb3Jlc0xlblxuXG4gICAgICAgIGlmIChvcHRpb25zLnZlcmJvc2UpIGxvZygnVG9rZW4gc2NvcmUgYXZlcmFnZTonLCBhdmVyYWdlU2NvcmUpXG4gICAgICB9XG5cbiAgICAgIG1haW5TZWFyY2hSZXN1bHQgPSB0aGlzLmZ1bGxTZWFjaGVyLnNlYXJjaCh0ZXh0KVxuICAgICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdGdWxsIHRleHQgc2NvcmU6JywgbWFpblNlYXJjaFJlc3VsdC5zY29yZSlcblxuICAgICAgZmluYWxTY29yZSA9IG1haW5TZWFyY2hSZXN1bHQuc2NvcmVcbiAgICAgIGlmIChhdmVyYWdlU2NvcmUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBmaW5hbFNjb3JlID0gKGZpbmFsU2NvcmUgKyBhdmVyYWdlU2NvcmUpIC8gMlxuICAgICAgfVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1Njb3JlIGF2ZXJhZ2U6JywgZmluYWxTY29yZSlcblxuICAgICAgY2hlY2tUZXh0TWF0Y2hlcyA9ICh0aGlzLm9wdGlvbnMudG9rZW5pemUgJiYgdGhpcy5vcHRpb25zLm1hdGNoQWxsVG9rZW5zKSA/IG51bVRleHRNYXRjaGVzID49IHRoaXMudG9rZW5TZWFyY2hlcnMubGVuZ3RoIDogdHJ1ZVxuXG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ0NoZWNrIE1hdGNoZXMnLCBjaGVja1RleHRNYXRjaGVzKVxuXG4gICAgICAvLyBJZiBhIG1hdGNoIGlzIGZvdW5kLCBhZGQgdGhlIGl0ZW0gdG8gPHJhd1Jlc3VsdHM+LCBpbmNsdWRpbmcgaXRzIHNjb3JlXG4gICAgICBpZiAoKGV4aXN0cyB8fCBtYWluU2VhcmNoUmVzdWx0LmlzTWF0Y2gpICYmIGNoZWNrVGV4dE1hdGNoZXMpIHtcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlIGl0ZW0gYWxyZWFkeSBleGlzdHMgaW4gb3VyIHJlc3VsdHNcbiAgICAgICAgZXhpc3RpbmdSZXN1bHQgPSB0aGlzLnJlc3VsdE1hcFtpbmRleF1cblxuICAgICAgICBpZiAoZXhpc3RpbmdSZXN1bHQpIHtcbiAgICAgICAgICAvLyBVc2UgdGhlIGxvd2VzdCBzY29yZVxuICAgICAgICAgIC8vIGV4aXN0aW5nUmVzdWx0LnNjb3JlLCBiaXRhcFJlc3VsdC5zY29yZVxuICAgICAgICAgIGV4aXN0aW5nUmVzdWx0Lm91dHB1dC5wdXNoKHtcbiAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgc2NvcmU6IGZpbmFsU2NvcmUsXG4gICAgICAgICAgICBtYXRjaGVkSW5kaWNlczogbWFpblNlYXJjaFJlc3VsdC5tYXRjaGVkSW5kaWNlc1xuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gQWRkIGl0IHRvIHRoZSByYXcgcmVzdWx0IGxpc3RcbiAgICAgICAgICB0aGlzLnJlc3VsdE1hcFtpbmRleF0gPSB7XG4gICAgICAgICAgICBpdGVtOiBlbnRpdHksXG4gICAgICAgICAgICBvdXRwdXQ6IFt7XG4gICAgICAgICAgICAgIGtleToga2V5LFxuICAgICAgICAgICAgICBzY29yZTogZmluYWxTY29yZSxcbiAgICAgICAgICAgICAgbWF0Y2hlZEluZGljZXM6IG1haW5TZWFyY2hSZXN1bHQubWF0Y2hlZEluZGljZXNcbiAgICAgICAgICAgIH1dXG4gICAgICAgICAgfVxuXG4gICAgICAgICAgdGhpcy5yZXN1bHRzLnB1c2godGhpcy5yZXN1bHRNYXBbaW5kZXhdKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChpc0FycmF5KHRleHQpKSB7XG4gICAgICBmb3IgKGkgPSAwOyBpIDwgdGV4dC5sZW5ndGg7IGkrKykge1xuICAgICAgICB0aGlzLl9hbmFseXplKGtleSwgdGV4dFtpXSwgZW50aXR5LCBpbmRleClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBGdXNlLnByb3RvdHlwZS5fY29tcHV0ZVNjb3JlID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBpXG4gICAgdmFyIGpcbiAgICB2YXIga2V5TWFwID0gdGhpcy5fa2V5TWFwXG4gICAgdmFyIHRvdGFsU2NvcmVcbiAgICB2YXIgb3V0cHV0XG4gICAgdmFyIHNjb3JlTGVuXG4gICAgdmFyIHNjb3JlXG4gICAgdmFyIHdlaWdodFxuICAgIHZhciByZXN1bHRzID0gdGhpcy5yZXN1bHRzXG4gICAgdmFyIGJlc3RTY29yZVxuICAgIHZhciBuU2NvcmVcblxuICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5Db21wdXRpbmcgc2NvcmU6XFxuJylcblxuICAgIGZvciAoaSA9IDA7IGkgPCByZXN1bHRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICB0b3RhbFNjb3JlID0gMFxuICAgICAgb3V0cHV0ID0gcmVzdWx0c1tpXS5vdXRwdXRcbiAgICAgIHNjb3JlTGVuID0gb3V0cHV0Lmxlbmd0aFxuXG4gICAgICBiZXN0U2NvcmUgPSAxXG5cbiAgICAgIGZvciAoaiA9IDA7IGogPCBzY29yZUxlbjsgaisrKSB7XG4gICAgICAgIHNjb3JlID0gb3V0cHV0W2pdLnNjb3JlXG4gICAgICAgIHdlaWdodCA9IGtleU1hcCA/IGtleU1hcFtvdXRwdXRbal0ua2V5XS53ZWlnaHQgOiAxXG5cbiAgICAgICAgblNjb3JlID0gc2NvcmUgKiB3ZWlnaHRcblxuICAgICAgICBpZiAod2VpZ2h0ICE9PSAxKSB7XG4gICAgICAgICAgYmVzdFNjb3JlID0gTWF0aC5taW4oYmVzdFNjb3JlLCBuU2NvcmUpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdG90YWxTY29yZSArPSBuU2NvcmVcbiAgICAgICAgICBvdXRwdXRbal0ublNjb3JlID0gblNjb3JlXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKGJlc3RTY29yZSA9PT0gMSkge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gdG90YWxTY29yZSAvIHNjb3JlTGVuXG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXN1bHRzW2ldLnNjb3JlID0gYmVzdFNjb3JlXG4gICAgICB9XG5cbiAgICAgIGlmICh0aGlzLm9wdGlvbnMudmVyYm9zZSkgbG9nKHJlc3VsdHNbaV0pXG4gICAgfVxuICB9XG5cbiAgRnVzZS5wcm90b3R5cGUuX3NvcnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICBpZiAob3B0aW9ucy5zaG91bGRTb3J0KSB7XG4gICAgICBpZiAob3B0aW9ucy52ZXJib3NlKSBsb2coJ1xcblxcblNvcnRpbmcuLi4uJylcbiAgICAgIHRoaXMucmVzdWx0cy5zb3J0KG9wdGlvbnMuc29ydEZuKVxuICAgIH1cbiAgfVxuXG4gIEZ1c2UucHJvdG90eXBlLl9mb3JtYXQgPSBmdW5jdGlvbiAoKSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgZ2V0Rm4gPSBvcHRpb25zLmdldEZuXG4gICAgdmFyIGZpbmFsT3V0cHV0ID0gW11cbiAgICB2YXIgaVxuICAgIHZhciBsZW5cbiAgICB2YXIgcmVzdWx0cyA9IHRoaXMucmVzdWx0c1xuICAgIHZhciByZXBsYWNlVmFsdWVcbiAgICB2YXIgZ2V0SXRlbUF0SW5kZXhcbiAgICB2YXIgaW5jbHVkZSA9IG9wdGlvbnMuaW5jbHVkZVxuXG4gICAgaWYgKG9wdGlvbnMudmVyYm9zZSkgbG9nKCdcXG5cXG5PdXRwdXQ6XFxuXFxuJywgcmVzdWx0cylcblxuICAgIC8vIEhlbHBlciBmdW5jdGlvbiwgaGVyZSBmb3Igc3BlZWQtdXAsIHdoaWNoIHJlcGxhY2VzIHRoZSBpdGVtIHdpdGggaXRzIHZhbHVlLFxuICAgIC8vIGlmIHRoZSBvcHRpb25zIHNwZWNpZmllcyBpdCxcbiAgICByZXBsYWNlVmFsdWUgPSBvcHRpb25zLmlkID8gZnVuY3Rpb24gKGluZGV4KSB7XG4gICAgICByZXN1bHRzW2luZGV4XS5pdGVtID0gZ2V0Rm4ocmVzdWx0c1tpbmRleF0uaXRlbSwgb3B0aW9ucy5pZCwgW10pWzBdXG4gICAgfSA6IGZ1bmN0aW9uICgpIHt9XG5cbiAgICBnZXRJdGVtQXRJbmRleCA9IGZ1bmN0aW9uIChpbmRleCkge1xuICAgICAgdmFyIHJlY29yZCA9IHJlc3VsdHNbaW5kZXhdXG4gICAgICB2YXIgZGF0YVxuICAgICAgdmFyIGpcbiAgICAgIHZhciBvdXRwdXRcbiAgICAgIHZhciBfaXRlbVxuICAgICAgdmFyIF9yZXN1bHRcblxuICAgICAgLy8gSWYgYGluY2x1ZGVgIGhhcyB2YWx1ZXMsIHB1dCB0aGUgaXRlbSBpbiB0aGUgcmVzdWx0XG4gICAgICBpZiAoaW5jbHVkZS5sZW5ndGggPiAwKSB7XG4gICAgICAgIGRhdGEgPSB7XG4gICAgICAgICAgaXRlbTogcmVjb3JkLml0ZW1cbiAgICAgICAgfVxuICAgICAgICBpZiAoaW5jbHVkZS5pbmRleE9mKCdtYXRjaGVzJykgIT09IC0xKSB7XG4gICAgICAgICAgb3V0cHV0ID0gcmVjb3JkLm91dHB1dFxuICAgICAgICAgIGRhdGEubWF0Y2hlcyA9IFtdXG4gICAgICAgICAgZm9yIChqID0gMDsgaiA8IG91dHB1dC5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgX2l0ZW0gPSBvdXRwdXRbal1cbiAgICAgICAgICAgIF9yZXN1bHQgPSB7XG4gICAgICAgICAgICAgIGluZGljZXM6IF9pdGVtLm1hdGNoZWRJbmRpY2VzXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoX2l0ZW0ua2V5KSB7XG4gICAgICAgICAgICAgIF9yZXN1bHQua2V5ID0gX2l0ZW0ua2V5XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBkYXRhLm1hdGNoZXMucHVzaChfcmVzdWx0KVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChpbmNsdWRlLmluZGV4T2YoJ3Njb3JlJykgIT09IC0xKSB7XG4gICAgICAgICAgZGF0YS5zY29yZSA9IHJlc3VsdHNbaW5kZXhdLnNjb3JlXG4gICAgICAgIH1cblxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGF0YSA9IHJlY29yZC5pdGVtXG4gICAgICB9XG5cbiAgICAgIHJldHVybiBkYXRhXG4gICAgfVxuXG4gICAgLy8gRnJvbSB0aGUgcmVzdWx0cywgcHVzaCBpbnRvIGEgbmV3IGFycmF5IG9ubHkgdGhlIGl0ZW0gaWRlbnRpZmllciAoaWYgc3BlY2lmaWVkKVxuICAgIC8vIG9mIHRoZSBlbnRpcmUgaXRlbS4gIFRoaXMgaXMgYmVjYXVzZSB3ZSBkb24ndCB3YW50IHRvIHJldHVybiB0aGUgPHJlc3VsdHM+LFxuICAgIC8vIHNpbmNlIGl0IGNvbnRhaW5zIG90aGVyIG1ldGFkYXRhXG4gICAgZm9yIChpID0gMCwgbGVuID0gcmVzdWx0cy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgcmVwbGFjZVZhbHVlKGkpXG4gICAgICBmaW5hbE91dHB1dC5wdXNoKGdldEl0ZW1BdEluZGV4KGkpKVxuICAgIH1cblxuICAgIHJldHVybiBmaW5hbE91dHB1dFxuICB9XG5cbiAgLy8gSGVscGVyc1xuXG4gIGZ1bmN0aW9uIGRlZXBWYWx1ZSAob2JqLCBwYXRoLCBsaXN0KSB7XG4gICAgdmFyIGZpcnN0U2VnbWVudFxuICAgIHZhciByZW1haW5pbmdcbiAgICB2YXIgZG90SW5kZXhcbiAgICB2YXIgdmFsdWVcbiAgICB2YXIgaVxuICAgIHZhciBsZW5cblxuICAgIGlmICghcGF0aCkge1xuICAgICAgLy8gSWYgdGhlcmUncyBubyBwYXRoIGxlZnQsIHdlJ3ZlIGdvdHRlbiB0byB0aGUgb2JqZWN0IHdlIGNhcmUgYWJvdXQuXG4gICAgICBsaXN0LnB1c2gob2JqKVxuICAgIH0gZWxzZSB7XG4gICAgICBkb3RJbmRleCA9IHBhdGguaW5kZXhPZignLicpXG5cbiAgICAgIGlmIChkb3RJbmRleCAhPT0gLTEpIHtcbiAgICAgICAgZmlyc3RTZWdtZW50ID0gcGF0aC5zbGljZSgwLCBkb3RJbmRleClcbiAgICAgICAgcmVtYWluaW5nID0gcGF0aC5zbGljZShkb3RJbmRleCArIDEpXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBmaXJzdFNlZ21lbnQgPSBwYXRoXG4gICAgICB9XG5cbiAgICAgIHZhbHVlID0gb2JqW2ZpcnN0U2VnbWVudF1cbiAgICAgIGlmICh2YWx1ZSAhPT0gbnVsbCAmJiB2YWx1ZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGlmICghcmVtYWluaW5nICYmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpKSB7XG4gICAgICAgICAgbGlzdC5wdXNoKHZhbHVlKVxuICAgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgLy8gU2VhcmNoIGVhY2ggaXRlbSBpbiB0aGUgYXJyYXkuXG4gICAgICAgICAgZm9yIChpID0gMCwgbGVuID0gdmFsdWUubGVuZ3RoOyBpIDwgbGVuOyBpKyspIHtcbiAgICAgICAgICAgIGRlZXBWYWx1ZSh2YWx1ZVtpXSwgcmVtYWluaW5nLCBsaXN0KVxuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIGlmIChyZW1haW5pbmcpIHtcbiAgICAgICAgICAvLyBBbiBvYmplY3QuIFJlY3Vyc2UgZnVydGhlci5cbiAgICAgICAgICBkZWVwVmFsdWUodmFsdWUsIHJlbWFpbmluZywgbGlzdClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBsaXN0XG4gIH1cblxuICBmdW5jdGlvbiBpc0FycmF5IChvYmopIHtcbiAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaikgPT09ICdbb2JqZWN0IEFycmF5XSdcbiAgfVxuXG4gIC8qKlxuICAgKiBBZGFwdGVkIGZyb20gXCJEaWZmLCBNYXRjaCBhbmQgUGF0Y2hcIiwgYnkgR29vZ2xlXG4gICAqXG4gICAqICAgaHR0cDovL2NvZGUuZ29vZ2xlLmNvbS9wL2dvb2dsZS1kaWZmLW1hdGNoLXBhdGNoL1xuICAgKlxuICAgKiBNb2RpZmllZCBieTogS2lyb2xsb3MgUmlzayA8a2lyb2xsb3NAZ21haWwuY29tPlxuICAgKiAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuICAgKiBEZXRhaWxzOiB0aGUgYWxnb3JpdGhtIGFuZCBzdHJ1Y3R1cmUgd2FzIG1vZGlmaWVkIHRvIGFsbG93IHRoZSBjcmVhdGlvbiBvZlxuICAgKiA8U2VhcmNoZXI+IGluc3RhbmNlcyB3aXRoIGEgPHNlYXJjaD4gbWV0aG9kIHdoaWNoIGRvZXMgdGhlIGFjdHVhbFxuICAgKiBiaXRhcCBzZWFyY2guIFRoZSA8cGF0dGVybj4gKHRoZSBzdHJpbmcgdGhhdCBpcyBzZWFyY2hlZCBmb3IpIGlzIG9ubHkgZGVmaW5lZFxuICAgKiBvbmNlIHBlciBpbnN0YW5jZSBhbmQgdGh1cyBpdCBlbGltaW5hdGVzIHJlZHVuZGFudCByZS1jcmVhdGlvbiB3aGVuIHNlYXJjaGluZ1xuICAgKiBvdmVyIGEgbGlzdCBvZiBzdHJpbmdzLlxuICAgKlxuICAgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpXG4gICAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAgICpcbiAgICogQGNvbnN0cnVjdG9yXG4gICAqL1xuICBmdW5jdGlvbiBCaXRhcFNlYXJjaGVyIChwYXR0ZXJuLCBvcHRpb25zKSB7XG4gICAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge31cbiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zXG4gICAgdGhpcy5vcHRpb25zLmxvY2F0aW9uID0gb3B0aW9ucy5sb2NhdGlvbiB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLmxvY2F0aW9uXG4gICAgdGhpcy5vcHRpb25zLmRpc3RhbmNlID0gJ2Rpc3RhbmNlJyBpbiBvcHRpb25zID8gb3B0aW9ucy5kaXN0YW5jZSA6IEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMuZGlzdGFuY2VcbiAgICB0aGlzLm9wdGlvbnMudGhyZXNob2xkID0gJ3RocmVzaG9sZCcgaW4gb3B0aW9ucyA/IG9wdGlvbnMudGhyZXNob2xkIDogQml0YXBTZWFyY2hlci5kZWZhdWx0T3B0aW9ucy50aHJlc2hvbGRcbiAgICB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCA9IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCB8fCBCaXRhcFNlYXJjaGVyLmRlZmF1bHRPcHRpb25zLm1heFBhdHRlcm5MZW5ndGhcblxuICAgIHRoaXMucGF0dGVybiA9IG9wdGlvbnMuY2FzZVNlbnNpdGl2ZSA/IHBhdHRlcm4gOiBwYXR0ZXJuLnRvTG93ZXJDYXNlKClcbiAgICB0aGlzLnBhdHRlcm5MZW4gPSBwYXR0ZXJuLmxlbmd0aFxuXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA8PSB0aGlzLm9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgdGhpcy5tYXRjaG1hc2sgPSAxIDw8ICh0aGlzLnBhdHRlcm5MZW4gLSAxKVxuICAgICAgdGhpcy5wYXR0ZXJuQWxwaGFiZXQgPSB0aGlzLl9jYWxjdWxhdGVQYXR0ZXJuQWxwaGFiZXQoKVxuICAgIH1cbiAgfVxuXG4gIEJpdGFwU2VhcmNoZXIuZGVmYXVsdE9wdGlvbnMgPSB7XG4gICAgLy8gQXBwcm94aW1hdGVseSB3aGVyZSBpbiB0aGUgdGV4dCBpcyB0aGUgcGF0dGVybiBleHBlY3RlZCB0byBiZSBmb3VuZD9cbiAgICBsb2NhdGlvbjogMCxcblxuICAgIC8vIERldGVybWluZXMgaG93IGNsb3NlIHRoZSBtYXRjaCBtdXN0IGJlIHRvIHRoZSBmdXp6eSBsb2NhdGlvbiAoc3BlY2lmaWVkIGFib3ZlKS5cbiAgICAvLyBBbiBleGFjdCBsZXR0ZXIgbWF0Y2ggd2hpY2ggaXMgJ2Rpc3RhbmNlJyBjaGFyYWN0ZXJzIGF3YXkgZnJvbSB0aGUgZnV6enkgbG9jYXRpb25cbiAgICAvLyB3b3VsZCBzY29yZSBhcyBhIGNvbXBsZXRlIG1pc21hdGNoLiBBIGRpc3RhbmNlIG9mICcwJyByZXF1aXJlcyB0aGUgbWF0Y2ggYmUgYXRcbiAgICAvLyB0aGUgZXhhY3QgbG9jYXRpb24gc3BlY2lmaWVkLCBhIHRocmVzaG9sZCBvZiAnMTAwMCcgd291bGQgcmVxdWlyZSBhIHBlcmZlY3QgbWF0Y2hcbiAgICAvLyB0byBiZSB3aXRoaW4gODAwIGNoYXJhY3RlcnMgb2YgdGhlIGZ1enp5IGxvY2F0aW9uIHRvIGJlIGZvdW5kIHVzaW5nIGEgMC44IHRocmVzaG9sZC5cbiAgICBkaXN0YW5jZTogMTAwLFxuXG4gICAgLy8gQXQgd2hhdCBwb2ludCBkb2VzIHRoZSBtYXRjaCBhbGdvcml0aG0gZ2l2ZSB1cC4gQSB0aHJlc2hvbGQgb2YgJzAuMCcgcmVxdWlyZXMgYSBwZXJmZWN0IG1hdGNoXG4gICAgLy8gKG9mIGJvdGggbGV0dGVycyBhbmQgbG9jYXRpb24pLCBhIHRocmVzaG9sZCBvZiAnMS4wJyB3b3VsZCBtYXRjaCBhbnl0aGluZy5cbiAgICB0aHJlc2hvbGQ6IDAuNixcblxuICAgIC8vIE1hY2hpbmUgd29yZCBzaXplXG4gICAgbWF4UGF0dGVybkxlbmd0aDogMzJcbiAgfVxuXG4gIC8qKlxuICAgKiBJbml0aWFsaXplIHRoZSBhbHBoYWJldCBmb3IgdGhlIEJpdGFwIGFsZ29yaXRobS5cbiAgICogQHJldHVybiB7T2JqZWN0fSBIYXNoIG9mIGNoYXJhY3RlciBsb2NhdGlvbnMuXG4gICAqIEBwcml2YXRlXG4gICAqL1xuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fY2FsY3VsYXRlUGF0dGVybkFscGhhYmV0ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBtYXNrID0ge30sXG4gICAgICBpID0gMFxuXG4gICAgZm9yIChpID0gMDsgaSA8IHRoaXMucGF0dGVybkxlbjsgaSsrKSB7XG4gICAgICBtYXNrW3RoaXMucGF0dGVybi5jaGFyQXQoaSldID0gMFxuICAgIH1cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgbWFza1t0aGlzLnBhdHRlcm4uY2hhckF0KGkpXSB8PSAxIDw8ICh0aGlzLnBhdHRlcm4ubGVuZ3RoIC0gaSAtIDEpXG4gICAgfVxuXG4gICAgcmV0dXJuIG1hc2tcbiAgfVxuXG4gIC8qKlxuICAgKiBDb21wdXRlIGFuZCByZXR1cm4gdGhlIHNjb3JlIGZvciBhIG1hdGNoIHdpdGggYGVgIGVycm9ycyBhbmQgYHhgIGxvY2F0aW9uLlxuICAgKiBAcGFyYW0ge251bWJlcn0gZXJyb3JzIE51bWJlciBvZiBlcnJvcnMgaW4gbWF0Y2guXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBsb2NhdGlvbiBMb2NhdGlvbiBvZiBtYXRjaC5cbiAgICogQHJldHVybiB7bnVtYmVyfSBPdmVyYWxsIHNjb3JlIGZvciBtYXRjaCAoMC4wID0gZ29vZCwgMS4wID0gYmFkKS5cbiAgICogQHByaXZhdGVcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLl9iaXRhcFNjb3JlID0gZnVuY3Rpb24gKGVycm9ycywgbG9jYXRpb24pIHtcbiAgICB2YXIgYWNjdXJhY3kgPSBlcnJvcnMgLyB0aGlzLnBhdHRlcm5MZW4sXG4gICAgICBwcm94aW1pdHkgPSBNYXRoLmFicyh0aGlzLm9wdGlvbnMubG9jYXRpb24gLSBsb2NhdGlvbilcblxuICAgIGlmICghdGhpcy5vcHRpb25zLmRpc3RhbmNlKSB7XG4gICAgICAvLyBEb2RnZSBkaXZpZGUgYnkgemVybyBlcnJvci5cbiAgICAgIHJldHVybiBwcm94aW1pdHkgPyAxLjAgOiBhY2N1cmFjeVxuICAgIH1cbiAgICByZXR1cm4gYWNjdXJhY3kgKyAocHJveGltaXR5IC8gdGhpcy5vcHRpb25zLmRpc3RhbmNlKVxuICB9XG5cbiAgLyoqXG4gICAqIENvbXB1dGUgYW5kIHJldHVybiB0aGUgcmVzdWx0IG9mIHRoZSBzZWFyY2hcbiAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgVGhlIHRleHQgdG8gc2VhcmNoIGluXG4gICAqIEByZXR1cm4ge3tpc01hdGNoOiBib29sZWFuLCBzY29yZTogbnVtYmVyfX0gTGl0ZXJhbCBjb250YWluaW5nOlxuICAgKiAgICAgICAgICAgICAgICAgICAgICAgICAgaXNNYXRjaCAtIFdoZXRoZXIgdGhlIHRleHQgaXMgYSBtYXRjaCBvciBub3RcbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3JlIC0gT3ZlcmFsbCBzY29yZSBmb3IgdGhlIG1hdGNoXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEJpdGFwU2VhcmNoZXIucHJvdG90eXBlLnNlYXJjaCA9IGZ1bmN0aW9uICh0ZXh0KSB7XG4gICAgdmFyIG9wdGlvbnMgPSB0aGlzLm9wdGlvbnNcbiAgICB2YXIgaVxuICAgIHZhciBqXG4gICAgdmFyIHRleHRMZW5cbiAgICB2YXIgZmluZEFsbE1hdGNoZXNcbiAgICB2YXIgbG9jYXRpb25cbiAgICB2YXIgdGhyZXNob2xkXG4gICAgdmFyIGJlc3RMb2NcbiAgICB2YXIgYmluTWluXG4gICAgdmFyIGJpbk1pZFxuICAgIHZhciBiaW5NYXhcbiAgICB2YXIgc3RhcnQsIGZpbmlzaFxuICAgIHZhciBiaXRBcnJcbiAgICB2YXIgbGFzdEJpdEFyclxuICAgIHZhciBjaGFyTWF0Y2hcbiAgICB2YXIgc2NvcmVcbiAgICB2YXIgbG9jYXRpb25zXG4gICAgdmFyIG1hdGNoZXNcbiAgICB2YXIgaXNNYXRjaGVkXG4gICAgdmFyIG1hdGNoTWFza1xuICAgIHZhciBtYXRjaGVkSW5kaWNlc1xuICAgIHZhciBtYXRjaGVzTGVuXG4gICAgdmFyIG1hdGNoXG5cbiAgICB0ZXh0ID0gb3B0aW9ucy5jYXNlU2Vuc2l0aXZlID8gdGV4dCA6IHRleHQudG9Mb3dlckNhc2UoKVxuXG4gICAgaWYgKHRoaXMucGF0dGVybiA9PT0gdGV4dCkge1xuICAgICAgLy8gRXhhY3QgbWF0Y2hcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGlzTWF0Y2g6IHRydWUsXG4gICAgICAgIHNjb3JlOiAwLFxuICAgICAgICBtYXRjaGVkSW5kaWNlczogW1swLCB0ZXh0Lmxlbmd0aCAtIDFdXVxuICAgICAgfVxuICAgIH1cblxuICAgIC8vIFdoZW4gcGF0dGVybiBsZW5ndGggaXMgZ3JlYXRlciB0aGFuIHRoZSBtYWNoaW5lIHdvcmQgbGVuZ3RoLCBqdXN0IGRvIGEgYSByZWdleCBjb21wYXJpc29uXG4gICAgaWYgKHRoaXMucGF0dGVybkxlbiA+IG9wdGlvbnMubWF4UGF0dGVybkxlbmd0aCkge1xuICAgICAgbWF0Y2hlcyA9IHRleHQubWF0Y2gobmV3IFJlZ0V4cCh0aGlzLnBhdHRlcm4ucmVwbGFjZShvcHRpb25zLnRva2VuU2VwYXJhdG9yLCAnfCcpKSlcbiAgICAgIGlzTWF0Y2hlZCA9ICEhbWF0Y2hlc1xuXG4gICAgICBpZiAoaXNNYXRjaGVkKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICAgICAgZm9yIChpID0gMCwgbWF0Y2hlc0xlbiA9IG1hdGNoZXMubGVuZ3RoOyBpIDwgbWF0Y2hlc0xlbjsgaSsrKSB7XG4gICAgICAgICAgbWF0Y2ggPSBtYXRjaGVzW2ldXG4gICAgICAgICAgbWF0Y2hlZEluZGljZXMucHVzaChbdGV4dC5pbmRleE9mKG1hdGNoKSwgbWF0Y2gubGVuZ3RoIC0gMV0pXG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaXNNYXRjaDogaXNNYXRjaGVkLFxuICAgICAgICAvLyBUT0RPOiByZXZpc2l0IHRoaXMgc2NvcmVcbiAgICAgICAgc2NvcmU6IGlzTWF0Y2hlZCA/IDAuNSA6IDEsXG4gICAgICAgIG1hdGNoZWRJbmRpY2VzOiBtYXRjaGVkSW5kaWNlc1xuICAgICAgfVxuICAgIH1cblxuICAgIGZpbmRBbGxNYXRjaGVzID0gb3B0aW9ucy5maW5kQWxsTWF0Y2hlc1xuXG4gICAgbG9jYXRpb24gPSBvcHRpb25zLmxvY2F0aW9uXG4gICAgLy8gU2V0IHN0YXJ0aW5nIGxvY2F0aW9uIGF0IGJlZ2lubmluZyB0ZXh0IGFuZCBpbml0aWFsaXplIHRoZSBhbHBoYWJldC5cbiAgICB0ZXh0TGVuID0gdGV4dC5sZW5ndGhcbiAgICAvLyBIaWdoZXN0IHNjb3JlIGJleW9uZCB3aGljaCB3ZSBnaXZlIHVwLlxuICAgIHRocmVzaG9sZCA9IG9wdGlvbnMudGhyZXNob2xkXG4gICAgLy8gSXMgdGhlcmUgYSBuZWFyYnkgZXhhY3QgbWF0Y2g/IChzcGVlZHVwKVxuICAgIGJlc3RMb2MgPSB0ZXh0LmluZGV4T2YodGhpcy5wYXR0ZXJuLCBsb2NhdGlvbilcblxuICAgIC8vIGEgbWFzayBvZiB0aGUgbWF0Y2hlc1xuICAgIG1hdGNoTWFzayA9IFtdXG4gICAgZm9yIChpID0gMDsgaSA8IHRleHRMZW47IGkrKykge1xuICAgICAgbWF0Y2hNYXNrW2ldID0gMFxuICAgIH1cblxuICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICB0aHJlc2hvbGQgPSBNYXRoLm1pbih0aGlzLl9iaXRhcFNjb3JlKDAsIGJlc3RMb2MpLCB0aHJlc2hvbGQpXG4gICAgICAvLyBXaGF0IGFib3V0IGluIHRoZSBvdGhlciBkaXJlY3Rpb24/IChzcGVlZCB1cClcbiAgICAgIGJlc3RMb2MgPSB0ZXh0Lmxhc3RJbmRleE9mKHRoaXMucGF0dGVybiwgbG9jYXRpb24gKyB0aGlzLnBhdHRlcm5MZW4pXG5cbiAgICAgIGlmIChiZXN0TG9jICE9IC0xKSB7XG4gICAgICAgIHRocmVzaG9sZCA9IE1hdGgubWluKHRoaXMuX2JpdGFwU2NvcmUoMCwgYmVzdExvYyksIHRocmVzaG9sZClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBiZXN0TG9jID0gLTFcbiAgICBzY29yZSA9IDFcbiAgICBsb2NhdGlvbnMgPSBbXVxuICAgIGJpbk1heCA9IHRoaXMucGF0dGVybkxlbiArIHRleHRMZW5cblxuICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLnBhdHRlcm5MZW47IGkrKykge1xuICAgICAgLy8gU2NhbiBmb3IgdGhlIGJlc3QgbWF0Y2g7IGVhY2ggaXRlcmF0aW9uIGFsbG93cyBmb3Igb25lIG1vcmUgZXJyb3IuXG4gICAgICAvLyBSdW4gYSBiaW5hcnkgc2VhcmNoIHRvIGRldGVybWluZSBob3cgZmFyIGZyb20gdGhlIG1hdGNoIGxvY2F0aW9uIHdlIGNhbiBzdHJheVxuICAgICAgLy8gYXQgdGhpcyBlcnJvciBsZXZlbC5cbiAgICAgIGJpbk1pbiA9IDBcbiAgICAgIGJpbk1pZCA9IGJpbk1heFxuICAgICAgd2hpbGUgKGJpbk1pbiA8IGJpbk1pZCkge1xuICAgICAgICBpZiAodGhpcy5fYml0YXBTY29yZShpLCBsb2NhdGlvbiArIGJpbk1pZCkgPD0gdGhyZXNob2xkKSB7XG4gICAgICAgICAgYmluTWluID0gYmluTWlkXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICAgIH1cbiAgICAgICAgYmluTWlkID0gTWF0aC5mbG9vcigoYmluTWF4IC0gYmluTWluKSAvIDIgKyBiaW5NaW4pXG4gICAgICB9XG5cbiAgICAgIC8vIFVzZSB0aGUgcmVzdWx0IGZyb20gdGhpcyBpdGVyYXRpb24gYXMgdGhlIG1heGltdW0gZm9yIHRoZSBuZXh0LlxuICAgICAgYmluTWF4ID0gYmluTWlkXG4gICAgICBzdGFydCA9IE1hdGgubWF4KDEsIGxvY2F0aW9uIC0gYmluTWlkICsgMSlcbiAgICAgIGlmIChmaW5kQWxsTWF0Y2hlcykge1xuICAgICAgICBmaW5pc2ggPSB0ZXh0TGVuO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZmluaXNoID0gTWF0aC5taW4obG9jYXRpb24gKyBiaW5NaWQsIHRleHRMZW4pICsgdGhpcy5wYXR0ZXJuTGVuXG4gICAgICB9XG5cbiAgICAgIC8vIEluaXRpYWxpemUgdGhlIGJpdCBhcnJheVxuICAgICAgYml0QXJyID0gQXJyYXkoZmluaXNoICsgMilcblxuICAgICAgYml0QXJyW2ZpbmlzaCArIDFdID0gKDEgPDwgaSkgLSAxXG5cbiAgICAgIGZvciAoaiA9IGZpbmlzaDsgaiA+PSBzdGFydDsgai0tKSB7XG4gICAgICAgIGNoYXJNYXRjaCA9IHRoaXMucGF0dGVybkFscGhhYmV0W3RleHQuY2hhckF0KGogLSAxKV1cblxuICAgICAgICBpZiAoY2hhck1hdGNoKSB7XG4gICAgICAgICAgbWF0Y2hNYXNrW2ogLSAxXSA9IDFcbiAgICAgICAgfVxuXG4gICAgICAgIGJpdEFycltqXSA9ICgoYml0QXJyW2ogKyAxXSA8PCAxKSB8IDEpICYgY2hhck1hdGNoXG5cbiAgICAgICAgaWYgKGkgIT09IDApIHtcbiAgICAgICAgICAvLyBTdWJzZXF1ZW50IHBhc3NlczogZnV6enkgbWF0Y2guXG4gICAgICAgICAgYml0QXJyW2pdIHw9ICgoKGxhc3RCaXRBcnJbaiArIDFdIHwgbGFzdEJpdEFycltqXSkgPDwgMSkgfCAxKSB8IGxhc3RCaXRBcnJbaiArIDFdXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGJpdEFycltqXSAmIHRoaXMubWF0Y2htYXNrKSB7XG4gICAgICAgICAgc2NvcmUgPSB0aGlzLl9iaXRhcFNjb3JlKGksIGogLSAxKVxuXG4gICAgICAgICAgLy8gVGhpcyBtYXRjaCB3aWxsIGFsbW9zdCBjZXJ0YWlubHkgYmUgYmV0dGVyIHRoYW4gYW55IGV4aXN0aW5nIG1hdGNoLlxuICAgICAgICAgIC8vIEJ1dCBjaGVjayBhbnl3YXkuXG4gICAgICAgICAgaWYgKHNjb3JlIDw9IHRocmVzaG9sZCkge1xuICAgICAgICAgICAgLy8gSW5kZWVkIGl0IGlzXG4gICAgICAgICAgICB0aHJlc2hvbGQgPSBzY29yZVxuICAgICAgICAgICAgYmVzdExvYyA9IGogLSAxXG4gICAgICAgICAgICBsb2NhdGlvbnMucHVzaChiZXN0TG9jKVxuXG4gICAgICAgICAgICAvLyBBbHJlYWR5IHBhc3NlZCBsb2MsIGRvd25oaWxsIGZyb20gaGVyZSBvbiBpbi5cbiAgICAgICAgICAgIGlmIChiZXN0TG9jIDw9IGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgIGJyZWFrXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIFdoZW4gcGFzc2luZyBsb2MsIGRvbid0IGV4Y2VlZCBvdXIgY3VycmVudCBkaXN0YW5jZSBmcm9tIGxvYy5cbiAgICAgICAgICAgIHN0YXJ0ID0gTWF0aC5tYXgoMSwgMiAqIGxvY2F0aW9uIC0gYmVzdExvYylcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgLy8gTm8gaG9wZSBmb3IgYSAoYmV0dGVyKSBtYXRjaCBhdCBncmVhdGVyIGVycm9yIGxldmVscy5cbiAgICAgIGlmICh0aGlzLl9iaXRhcFNjb3JlKGkgKyAxLCBsb2NhdGlvbikgPiB0aHJlc2hvbGQpIHtcbiAgICAgICAgYnJlYWtcbiAgICAgIH1cbiAgICAgIGxhc3RCaXRBcnIgPSBiaXRBcnJcbiAgICB9XG5cbiAgICBtYXRjaGVkSW5kaWNlcyA9IHRoaXMuX2dldE1hdGNoZWRJbmRpY2VzKG1hdGNoTWFzaylcblxuICAgIC8vIENvdW50IGV4YWN0IG1hdGNoZXMgKHRob3NlIHdpdGggYSBzY29yZSBvZiAwKSB0byBiZSBcImFsbW9zdFwiIGV4YWN0XG4gICAgcmV0dXJuIHtcbiAgICAgIGlzTWF0Y2g6IGJlc3RMb2MgPj0gMCxcbiAgICAgIHNjb3JlOiBzY29yZSA9PT0gMCA/IDAuMDAxIDogc2NvcmUsXG4gICAgICBtYXRjaGVkSW5kaWNlczogbWF0Y2hlZEluZGljZXNcbiAgICB9XG4gIH1cblxuICBCaXRhcFNlYXJjaGVyLnByb3RvdHlwZS5fZ2V0TWF0Y2hlZEluZGljZXMgPSBmdW5jdGlvbiAobWF0Y2hNYXNrKSB7XG4gICAgdmFyIG1hdGNoZWRJbmRpY2VzID0gW11cbiAgICB2YXIgc3RhcnQgPSAtMVxuICAgIHZhciBlbmQgPSAtMVxuICAgIHZhciBpID0gMFxuICAgIHZhciBtYXRjaFxuICAgIHZhciBsZW4gPSBtYXRjaE1hc2subGVuZ3RoXG4gICAgZm9yICg7IGkgPCBsZW47IGkrKykge1xuICAgICAgbWF0Y2ggPSBtYXRjaE1hc2tbaV1cbiAgICAgIGlmIChtYXRjaCAmJiBzdGFydCA9PT0gLTEpIHtcbiAgICAgICAgc3RhcnQgPSBpXG4gICAgICB9IGVsc2UgaWYgKCFtYXRjaCAmJiBzdGFydCAhPT0gLTEpIHtcbiAgICAgICAgZW5kID0gaSAtIDFcbiAgICAgICAgaWYgKChlbmQgLSBzdGFydCkgKyAxID49IHRoaXMub3B0aW9ucy5taW5NYXRjaENoYXJMZW5ndGgpIHtcbiAgICAgICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBlbmRdKVxuICAgICAgICB9XG4gICAgICAgIHN0YXJ0ID0gLTFcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1hdGNoTWFza1tpIC0gMV0pIHtcbiAgICAgIGlmICgoaS0xIC0gc3RhcnQpICsgMSA+PSB0aGlzLm9wdGlvbnMubWluTWF0Y2hDaGFyTGVuZ3RoKSB7XG4gICAgICAgIG1hdGNoZWRJbmRpY2VzLnB1c2goW3N0YXJ0LCBpIC0gMV0pXG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtYXRjaGVkSW5kaWNlc1xuICB9XG5cbiAgLy8gRXhwb3J0IHRvIENvbW1vbiBKUyBMb2FkZXJcbiAgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIC8vIE5vZGUuIERvZXMgbm90IHdvcmsgd2l0aCBzdHJpY3QgQ29tbW9uSlMsIGJ1dFxuICAgIC8vIG9ubHkgQ29tbW9uSlMtbGlrZSBlbnZpcm9ubWVudHMgdGhhdCBzdXBwb3J0IG1vZHVsZS5leHBvcnRzLFxuICAgIC8vIGxpa2UgTm9kZS5cbiAgICBtb2R1bGUuZXhwb3J0cyA9IEZ1c2VcbiAgfSBlbHNlIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICAvLyBBTUQuIFJlZ2lzdGVyIGFzIGFuIGFub255bW91cyBtb2R1bGUuXG4gICAgZGVmaW5lKGZ1bmN0aW9uICgpIHtcbiAgICAgIHJldHVybiBGdXNlXG4gICAgfSlcbiAgfSBlbHNlIHtcbiAgICAvLyBCcm93c2VyIGdsb2JhbHMgKHJvb3QgaXMgd2luZG93KVxuICAgIGdsb2JhbC5GdXNlID0gRnVzZVxuICB9XG5cbn0pKHRoaXMpO1xuIiwiLyohXG4gKiBEZXRlcm1pbmUgaWYgYW4gb2JqZWN0IGlzIGEgQnVmZmVyXG4gKlxuICogQGF1dGhvciAgIEZlcm9zcyBBYm91a2hhZGlqZWggPGh0dHBzOi8vZmVyb3NzLm9yZz5cbiAqIEBsaWNlbnNlICBNSVRcbiAqL1xuXG4vLyBUaGUgX2lzQnVmZmVyIGNoZWNrIGlzIGZvciBTYWZhcmkgNS03IHN1cHBvcnQsIGJlY2F1c2UgaXQncyBtaXNzaW5nXG4vLyBPYmplY3QucHJvdG90eXBlLmNvbnN0cnVjdG9yLiBSZW1vdmUgdGhpcyBldmVudHVhbGx5XG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uIChvYmopIHtcbiAgcmV0dXJuIG9iaiAhPSBudWxsICYmIChpc0J1ZmZlcihvYmopIHx8IGlzU2xvd0J1ZmZlcihvYmopIHx8ICEhb2JqLl9pc0J1ZmZlcilcbn1cblxuZnVuY3Rpb24gaXNCdWZmZXIgKG9iaikge1xuICByZXR1cm4gISFvYmouY29uc3RydWN0b3IgJiYgdHlwZW9mIG9iai5jb25zdHJ1Y3Rvci5pc0J1ZmZlciA9PT0gJ2Z1bmN0aW9uJyAmJiBvYmouY29uc3RydWN0b3IuaXNCdWZmZXIob2JqKVxufVxuXG4vLyBGb3IgTm9kZSB2MC4xMCBzdXBwb3J0LiBSZW1vdmUgdGhpcyBldmVudHVhbGx5LlxuZnVuY3Rpb24gaXNTbG93QnVmZmVyIChvYmopIHtcbiAgcmV0dXJuIHR5cGVvZiBvYmoucmVhZEZsb2F0TEUgPT09ICdmdW5jdGlvbicgJiYgdHlwZW9mIG9iai5zbGljZSA9PT0gJ2Z1bmN0aW9uJyAmJiBpc0J1ZmZlcihvYmouc2xpY2UoMCwgMCkpXG59XG4iLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIl19
